{% set tasks = pagination.items %}

<style>
    .timeline-item {
        width: 100% !important;
    }
</style>

{% if tasks|length %}

    {% for task in tasks %}

        <hr/>
        <div class="timeline-item">
            <div class="row">
                <div class="col-xs-2">
                <span style="font-size: 1rem;" class="label label-info col-md-12 text-left">
                    <i class="fa {{ task.iconType }}"></i> {{ ['tag.', task.tagType]|join|trans }}
                </span>
                    {{ task.startAt|date('d/m/Y H:i') }}
                    <br/>
                </div>
                <div class="col-xs-10 content no-top-border">
                    <div class="row">

                        <div class="col-md-12">
                            {% if task.contact %}
                                <strong>{{ task.contact.name }}</strong>
                            {% endif %}
                        </div>

                        <div class="col-md-9">
                            {{ task.description }}
                        </div>

                        <div class="col-md-3">
                            {% if task.isDone %}
                                <button class="btn btn-sm btn-warning btn-block"
                                        data-task-action="{{ path('task_open',{token:task.token}) }}"
                                        data-title="Reabrir esta tarefa?">
                                    <i class="fa fa-rotate-left"></i> Reabrir
                                </button>
                            {% else %}
                                <button data-url="{{ path('task_done',{token:task.token}) }}"
                                        class="btn btn-sm btn-block {{ task.pending ? 'task-done btn-primary' : 'done btn-default' }}">
                                    <i class="fa fa-check"></i>
                                    {{ task.pending ? 'Finalizar' : 'Finalizada' }}
                                </button>
                            {% endif %}

                            <div style="width: 100%;"
                                 class="btn-group btn-group-sm btn-group-justified">
                                <a data-url="{{ path('task_update',{token:task.token}) }}"
                                   class="btn btn-success task-edit">
                                    <i class="fa fa-pencil"></i>
                                </a>
                                <a data-url="{{ path('task_delete',{token:task.token}) }}"
                                   class="btn btn-danger task-delete">
                                    <i class="fa fa-trash"></i>
                                </a>
                            </div>
                        </div>

                        <div class="col-md-12" style="padding-bottom: 2rem;">
                            {% for member in task.members %}
                                <a href="#"> <span class="badge">{{ member.firstname }}</span> </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

    {% endfor %}

    <div class="row">
        <div class="col-md-8 text-center">
            <div class="btn-group">
                {{ knp_pagination_render(pagination) }}
            </div>
        </div>
    </div>

{% else %}

    <div class="alert alert-info text-center col-md-12">
        <h3 class="text-center">
            <i class="fa fa-info"></i> Nenhuma tarefa encontrada!
        </h3>
    </div>

{% endif %}

{% if tasks|length %}
    {% include view('task.scripts') %}
{% endif %}