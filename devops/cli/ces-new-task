#!/usr/bin/env bash

cd $SICES_PATH

if [[ -z $1 ]] || [ $1 = '--help' ] || [ $1 = '-h' ]; then
  printf "ces-new-task - help:
  Usage:
  ces-new-task [ISSUE_NUMBER] [GITHUB_USER_NAME]

  Exemple:
  ces-new-task 100 rafaelkendrik
  "
  exit 0;
fi

git checkout master
git fetch origin
git pull origin master
git checkout -b issue-$1

$CLI_PATH/ces-app-install
$CLI_PATH/ces-database-update

if [ $2 ]; then
  curl -X POST -u "$2" -d '{"assignees": ["$2"]}' \
    https://api.github.com/repos/sices/sices/issues/$1/assignees
fi

$CLI_PATH/util/user-notify "Branch created" "now on issue-$1"
echo "Done, now on Branch: issue-$1"
