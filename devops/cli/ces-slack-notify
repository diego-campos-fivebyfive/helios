#!/usr/bin/env bash

echo "Sending Slack notification..."

message=$(echo ${2:0:1500} | sed 's/"/\\"/g')

if [[ $1 == '--devops' ]]; then
  slack_hook=$SLACK_HOOK_DEVOPS
elif [[ $1 == '--homolog' ]]; then
  slack_hook=$SLACK_HOOK_HOMOLOG
elif [[ $1 == '--production' ]]; then
  slack_hook=$SLACK_HOOK_PRODUCTION
elif [[ $1 == '--tester' ]]; then
  slack_hook=$SLACK_HOOK_TESTER
elif [[ $1 == '--tasks' ]]; then
  slack_hook=$SLACK_HOOK_TASKS
else
  echo "Invalid chat argument"
  exit 1
fi

json="{\"text\": \"$message\", \"link_names\": \"1\"}"
curl -s -X POST -H "Content-type:application/json" -d "$json" $slack_hook > /dev/null 2>&1
