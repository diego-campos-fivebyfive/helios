
{% set _step = app.request.attributes.get('_route') %}
<div class="row">
    <div class="col-lg-12">
        <div class="btn-group btn-group-sm btn-group-justified">

            <a data-step="project_update" class="btn btn-default nav-link project_scaling {% if _step=='project_create' or _step=='project_update' %}active{% endif %}">
                <i class="fa fa-sliders"></i>
               <span class="mobile-hidden"> {{ 'project.design'|trans|upper }}</span>
            </a>

            <a data-step="project_financial" class="btn btn-default nav-link project_financial {% if _step=='project_financial' %}active{% endif %}">
                <i class="fa fa-line-chart"></i>
                <span class="mobile-hidden"> {{ 'project.financial'|trans|upper }} </span>
            </a>

            <a data-step="proposal_editor" class="btn btn-default nav-link project_proposal {% if _step=='proposal_editor' %}active{% endif %}">
                <i class="fa fa-file-text-o"></i>
                <span class="mobile-hidden"> {{ 'project.proposal'|trans|upper }} </span>
            </a>

        </div>
    </div>
</div>
<div class="hr-line-dashed"></div>

{% if true %}

    <script>

        if('undefined' == typeof Navbar){

            Navbar = {
                path: function(){
                    return window.location.pathname;
                },
                nav: function(id){
                    if('all' != id) {
                        return $('.project_' + id);
                    }else{
                        return $('.project_scaling, .project_financial, .project_proposal');
                    }
                },
                init: function(){

                    Navbar.nav('all').on('click', function(){

                        if({{ project.id is not null ? 'true' : 'false' }}) {

                            swal({
                                title: 'Aguarde...',
                                text: '',
                                type: 'info',
                                showConfirmButton: false
                            });

                            Request.send({
                                url: '{{ path('project_steps',{id:'_id_'}) }}'.replace(/_id_/g, Project.id),
                                method: 'post',
                                data: {step: $(this).data('step')},
                                callback: function (xhr) {
                                    var response = xhr.responseJSON;
                                    if (202 == xhr.status && response.url && 0 == response.errors.length) {
                                        window.location.href = response.url;
                                    } else {
                                        swal({
                                            title: 'Ooops',
                                            text: response.errors[0],
                                            type: 'error',
                                            html: true
                                        });
                                    }
                                }
                            });
                        } else if($(this).data('step') != 'project_update'){
                            swal({
                                title: 'Ooops',
                                text: 'O projeto n√£o foi iniciado',
                                type: 'error',
                                html: true
                            });
                        }
                    });
                }
            };

        }else{
            Navbar.init();
        }

    </script>

{% endif %}