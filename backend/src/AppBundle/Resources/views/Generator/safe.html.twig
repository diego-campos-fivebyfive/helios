{% set target = project is defined ? project : order %}
<div class="row">
    <div class="form-group col-md-8">
        <label style="font-size: small; text-align: justify; font-weight: lighter;">
            A contratação do SEGURO SICES SOLAR ALL RISKS é simples e rápida, será disponibilizada ao cliente final
            a apólice do SEGURO SICES SOLAR ALL RISKS, constando todas as coberturas previstas no prêmio de risco
            contratado na aquisição dos Equipamentos SICES SOLAR. Cobertura do Sistema Fotovoltaico limitada em 50%
            a mais do valor de Nota Fiscal dos equipamentos SICES Solar. O produto e solução é uma exclusividade da
            SICES Solar com a ARGO SEGUROS em parceria com a UMBRIA PRIVATE CORRETORA.
        </label>
    </div>

    <div class="col-md-2">
        <div class="form-group col-md-12">
            <label>
                <input id="financial_insurance" type="checkbox" {{ isPromo ? 'disabled="disabled"' }} {{ isPromo or target.insurance ? 'checked="checked"' }}/> &nbsp;
                Seguro All Risk
            </label>
        </div>
    </div>

    <div class="form-group col-md-2 text-center">
        <label> Valor do Seguro </label>
        <h2 id="safe_output"> {{ target.insurance|currency }} </h2>
    </div>

</div>

<script>
    var InsuranceHandler = {
        checker: $('#financial_insurance'),
        output: $('#safe_output'),
        apply: function(){
            var insure = this.checker.is(':checked')?1:0;
            $.post('{{ path( project is defined ? 'financial_insure' : 'order_insure' ,{id:target.id}) }}',{insure:insure}, function(response){
                var value = 0;
                var total = 0;
                if(response.hasOwnProperty('project')) {
                    value = response.project.insurance;
                }else{
                    value = response.order.insurance;
                    total = response.order.total;
                    OrderManager.renderTotal(total);

                    GeneratorHandler.getOrders();
                }

                InsuranceHandler.output.html(numeral(value).format('$0,0.00'));
            });
        },
        init: function(){
            this.checker.on('change', function(){
                InsuranceHandler.apply();
            });
        }
    };

    InsuranceHandler.init();

</script>
