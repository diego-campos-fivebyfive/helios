{% extends view('layout') %}

{% block body %}

    <div class="modal inmodal in" id="modal_payment_method" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content animated bounceInRight">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">Ã—</span><span
                                class="sr-only">Close</span>
                    </button>
                </div>
                <div class="modal-body">
                    {% include view('kit.spinner') %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal"> Fechar </button>
                    <button id="button_save" type="button" class="btn btn-primary"> Salvar </button>
                </div>
            </div>
        </div>
    </div>

    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">

            <div class="row" id="real-content">
                <div class="col-md-12">
                    <div class="ibox flow-h">
                        <div class="ibox-content flow-lg" style="min-height: 650px;">
                            <div class="row">

                                <div class="col-md-12" style="margin-bottom: 1rem;">
                                    <a data-href="{{ path('payment_methods_create') }}" data-toggle="modal" data-target="#modal_payment_method" class="btn btn-md btn-success pull-right">
                                        <i class="fa fa-plus"></i> Adicionar
                                    </a>
                                </div>

                                <div class="col-md-12">
                                    <table class="table table-bordered table-stripped">
                                        <thead>
                                        <tr>
                                            <th class="text-center"> Nome</th>
                                            <th class="text-center col-md-2"> Status</th>
                                            <th class="text-center col-md-2"> Parcelas</th>
                                            <th class="col-md-2"> &nbsp; </th>
                                        </tr>
                                        </thead>
                                        <tbody id="payment_methods_list">
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>

{% endblock %}

{% block scripts %}

    {% include view('helper.plugins_js') %}

    <script>

        var payModal = $('#modal_payment_method');
        var payBody = payModal.find('.modal-body');
        var payTitle = payModal.find('.modal-title');
        var paySpinner = payBody.html();

        function getPaymentMethods(){
            $.ajax({
                url: '{{ path('payment_methods_list') }}',
                complete: function(xhr){
                    $('#payment_methods_list').html(xhr.responseText);
                }
            });
        }getPaymentMethods();

        payModal.on('show.bs.modal', function (event) {
            var target = $(event.relatedTarget);
            var url = target.data('href');
            $.ajax({
                url: url,
                complete: function (xhr) {
                    payBody.html(xhr.responseText);
                },
                beforeSend: function(){
                    payBody.html(paySpinner);
                }
            });
        });

        $('#button_save').on('click', function(){
            $('#payment_method_save').trigger('click');
        });

    </script>

{% endblock %}
