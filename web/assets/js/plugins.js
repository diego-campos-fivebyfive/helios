(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof module==="object"&&module.exports){module.exports=factory(require("jquery"))}else{factory(window.jQuery)}})(function($){"use strict";var func=function(){var eq=function(itemA){return function(itemB){return itemA===itemB}};var eq2=function(itemA,itemB){return itemA===itemB};var peq2=function(propName){return function(itemA,itemB){return itemA[propName]===itemB[propName]}};var ok=function(){return true};var fail=function(){return false};var not=function(f){return function(){return!f.apply(f,arguments)}};var and=function(fA,fB){return function(item){return fA(item)&&fB(item)}};var self=function(a){return a};var invoke=function(obj,method){return function(){return obj[method].apply(obj,arguments)}};var idCounter=0;var uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};var rect2bnd=function(rect){var $document=$(document);return{top:rect.top+$document.scrollTop(),left:rect.left+$document.scrollLeft(),width:rect.right-rect.left,height:rect.bottom-rect.top}};var invertObject=function(obj){var inverted={};for(var key in obj){if(obj.hasOwnProperty(key)){inverted[obj[key]]=key}}return inverted};var namespaceToCamel=function(namespace,prefix){prefix=prefix||"";return prefix+namespace.split(".").map(function(name){return name.substring(0,1).toUpperCase()+name.substring(1)}).join("")};var debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate){func.apply(context,args)}};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){func.apply(context,args)}}};return{eq:eq,eq2:eq2,peq2:peq2,ok:ok,fail:fail,self:self,not:not,and:and,invoke:invoke,uniqueId:uniqueId,rect2bnd:rect2bnd,invertObject:invertObject,namespaceToCamel:namespaceToCamel,debounce:debounce}}();var list=function(){var head=function(array){return array[0]};var last=function(array){return array[array.length-1]};var initial=function(array){return array.slice(0,array.length-1)};var tail=function(array){return array.slice(1)};var find=function(array,pred){for(var idx=0,len=array.length;idx<len;idx++){var item=array[idx];if(pred(item)){return item}}};var all=function(array,pred){for(var idx=0,len=array.length;idx<len;idx++){if(!pred(array[idx])){return false}}return true};var indexOf=function(array,item){return $.inArray(item,array)};var contains=function(array,item){return indexOf(array,item)!==-1};var sum=function(array,fn){fn=fn||func.self;return array.reduce(function(memo,v){return memo+fn(v)},0)};var from=function(collection){var result=[],idx=-1,length=collection.length;while(++idx<length){result[idx]=collection[idx]}return result};var isEmpty=function(array){return!array||!array.length};var clusterBy=function(array,fn){if(!array.length){return[]}var aTail=tail(array);return aTail.reduce(function(memo,v){var aLast=last(memo);if(fn(last(aLast),v)){aLast[aLast.length]=v}else{memo[memo.length]=[v]}return memo},[[head(array)]])};var compact=function(array){var aResult=[];for(var idx=0,len=array.length;idx<len;idx++){if(array[idx]){aResult.push(array[idx])}}return aResult};var unique=function(array){var results=[];for(var idx=0,len=array.length;idx<len;idx++){if(!contains(results,array[idx])){results.push(array[idx])}}return results};var next=function(array,item){var idx=indexOf(array,item);if(idx===-1){return null}return array[idx+1]};var prev=function(array,item){var idx=indexOf(array,item);if(idx===-1){return null}return array[idx-1]};return{head:head,last:last,initial:initial,tail:tail,prev:prev,next:next,find:find,contains:contains,all:all,sum:sum,from:from,isEmpty:isEmpty,clusterBy:clusterBy,compact:compact,unique:unique}}();var isSupportAmd=typeof define==="function"&&define.amd;var isFontInstalled=function(fontName){var testFontName=fontName==="Comic Sans MS"?"Courier New":"Comic Sans MS";var $tester=$("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body);var originalWidth=$tester.css("fontFamily",testFontName).width();var width=$tester.css("fontFamily",fontName+","+testFontName).width();$tester.remove();return originalWidth!==width};var userAgent=navigator.userAgent;var isMSIE=/MSIE|Trident/i.test(userAgent);var browserVersion;if(isMSIE){var matches=/MSIE (\d+[.]\d+)/.exec(userAgent);if(matches){browserVersion=parseFloat(matches[1])}matches=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(userAgent);if(matches){browserVersion=parseFloat(matches[1])}}var isEdge=/Edge\/\d+/.test(userAgent);var hasCodeMirror=!!window.CodeMirror;if(!hasCodeMirror&&isSupportAmd&&typeof require!=="undefined"){if(typeof require.resolve!=="undefined"){try{require.resolve("codemirror");hasCodeMirror=true}catch(e){}}else if(typeof eval("require").specified!=="undefined"){hasCodeMirror=eval("require").specified("codemirror")}}var agent={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:isMSIE,isEdge:isEdge,isFF:!isEdge&&/firefox/i.test(userAgent),isPhantom:/PhantomJS/i.test(userAgent),isWebkit:!isEdge&&/webkit/i.test(userAgent),isChrome:!isEdge&&/chrome/i.test(userAgent),isSafari:!isEdge&&/safari/i.test(userAgent),browserVersion:browserVersion,jqueryVersion:parseFloat($.fn.jquery),isSupportAmd:isSupportAmd,hasCodeMirror:hasCodeMirror,isFontInstalled:isFontInstalled,isW3CRangeSupport:!!document.createRange};var NBSP_CHAR=String.fromCharCode(160);var ZERO_WIDTH_NBSP_CHAR="\ufeff";var dom=function(){var isEditable=function(node){return node&&$(node).hasClass("note-editable")};var isControlSizing=function(node){return node&&$(node).hasClass("note-control-sizing")};var makePredByNodeName=function(nodeName){nodeName=nodeName.toUpperCase();return function(node){return node&&node.nodeName.toUpperCase()===nodeName}};var isText=function(node){return node&&node.nodeType===3};var isElement=function(node){return node&&node.nodeType===1};var isVoid=function(node){return node&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(node.nodeName.toUpperCase())};var isPara=function(node){if(isEditable(node)){return false}return node&&/^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase())};var isHeading=function(node){return node&&/^H[1-7]/.test(node.nodeName.toUpperCase())};var isPre=makePredByNodeName("PRE");var isLi=makePredByNodeName("LI");var isPurePara=function(node){return isPara(node)&&!isLi(node)};var isTable=makePredByNodeName("TABLE");var isData=makePredByNodeName("DATA");var isInline=function(node){return!isBodyContainer(node)&&!isList(node)&&!isHr(node)&&!isPara(node)&&!isTable(node)&&!isBlockquote(node)&&!isData(node)};var isList=function(node){return node&&/^UL|^OL/.test(node.nodeName.toUpperCase())};var isHr=makePredByNodeName("HR");var isCell=function(node){return node&&/^TD|^TH/.test(node.nodeName.toUpperCase())};var isBlockquote=makePredByNodeName("BLOCKQUOTE");var isBodyContainer=function(node){return isCell(node)||isBlockquote(node)||isEditable(node)};var isAnchor=makePredByNodeName("A");var isParaInline=function(node){return isInline(node)&&!!ancestor(node,isPara)};var isBodyInline=function(node){return isInline(node)&&!ancestor(node,isPara)};var isBody=makePredByNodeName("BODY");var isClosestSibling=function(nodeA,nodeB){return nodeA.nextSibling===nodeB||nodeA.previousSibling===nodeB};var withClosestSiblings=function(node,pred){pred=pred||func.ok;var siblings=[];if(node.previousSibling&&pred(node.previousSibling)){siblings.push(node.previousSibling)}siblings.push(node);if(node.nextSibling&&pred(node.nextSibling)){siblings.push(node.nextSibling)}return siblings};var blankHTML=agent.isMSIE&&agent.browserVersion<11?"&nbsp;":"<br>";var nodeLength=function(node){if(isText(node)){return node.nodeValue.length}if(node){return node.childNodes.length}return 0};var isEmpty=function(node){var len=nodeLength(node);if(len===0){return true}else if(!isText(node)&&len===1&&node.innerHTML===blankHTML){return true}else if(list.all(node.childNodes,isText)&&node.innerHTML===""){return true}return false};var paddingBlankHTML=function(node){if(!isVoid(node)&&!nodeLength(node)){node.innerHTML=blankHTML}};var ancestor=function(node,pred){while(node){if(pred(node)){return node}if(isEditable(node)){break}node=node.parentNode}return null};var singleChildAncestor=function(node,pred){node=node.parentNode;while(node){if(nodeLength(node)!==1){break}if(pred(node)){return node}if(isEditable(node)){break}node=node.parentNode}return null};var listAncestor=function(node,pred){pred=pred||func.fail;var ancestors=[];ancestor(node,function(el){if(!isEditable(el)){ancestors.push(el)}return pred(el)});return ancestors};var lastAncestor=function(node,pred){var ancestors=listAncestor(node);return list.last(ancestors.filter(pred))};var commonAncestor=function(nodeA,nodeB){var ancestors=listAncestor(nodeA);for(var n=nodeB;n;n=n.parentNode){if($.inArray(n,ancestors)>-1){return n}}return null};var listPrev=function(node,pred){pred=pred||func.fail;var nodes=[];while(node){if(pred(node)){break}nodes.push(node);node=node.previousSibling}return nodes};var listNext=function(node,pred){pred=pred||func.fail;var nodes=[];while(node){if(pred(node)){break}nodes.push(node);node=node.nextSibling}return nodes};var listDescendant=function(node,pred){var descendants=[];pred=pred||func.ok;(function fnWalk(current){if(node!==current&&pred(current)){descendants.push(current)}for(var idx=0,len=current.childNodes.length;idx<len;idx++){fnWalk(current.childNodes[idx])}})(node);return descendants};var wrap=function(node,wrapperName){var parent=node.parentNode;var wrapper=$("<"+wrapperName+">")[0];parent.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper};var insertAfter=function(node,preceding){var next=preceding.nextSibling,parent=preceding.parentNode;if(next){parent.insertBefore(node,next)}else{parent.appendChild(node)}return node};var appendChildNodes=function(node,aChild){$.each(aChild,function(idx,child){node.appendChild(child)});return node};var isLeftEdgePoint=function(point){return point.offset===0};var isRightEdgePoint=function(point){return point.offset===nodeLength(point.node)};var isEdgePoint=function(point){return isLeftEdgePoint(point)||isRightEdgePoint(point)};var isLeftEdgeOf=function(node,ancestor){while(node&&node!==ancestor){if(position(node)!==0){return false}node=node.parentNode}return true};var isRightEdgeOf=function(node,ancestor){if(!ancestor){return false}while(node&&node!==ancestor){if(position(node)!==nodeLength(node.parentNode)-1){return false}node=node.parentNode}return true};var isLeftEdgePointOf=function(point,ancestor){return isLeftEdgePoint(point)&&isLeftEdgeOf(point.node,ancestor)};var isRightEdgePointOf=function(point,ancestor){return isRightEdgePoint(point)&&isRightEdgeOf(point.node,ancestor)};var position=function(node){var offset=0;while(node=node.previousSibling){offset+=1}return offset};var hasChildren=function(node){return!!(node&&node.childNodes&&node.childNodes.length)};var prevPoint=function(point,isSkipInnerOffset){var node,offset;if(point.offset===0){if(isEditable(point.node)){return null}node=point.node.parentNode;offset=position(point.node)}else if(hasChildren(point.node)){node=point.node.childNodes[point.offset-1];offset=nodeLength(node)}else{node=point.node;offset=isSkipInnerOffset?0:point.offset-1}return{node:node,offset:offset}};var nextPoint=function(point,isSkipInnerOffset){var node,offset;if(nodeLength(point.node)===point.offset){if(isEditable(point.node)){return null}node=point.node.parentNode;offset=position(point.node)+1}else if(hasChildren(point.node)){node=point.node.childNodes[point.offset];offset=0}else{node=point.node;offset=isSkipInnerOffset?nodeLength(point.node):point.offset+1}return{node:node,offset:offset}};var isSamePoint=function(pointA,pointB){return pointA.node===pointB.node&&pointA.offset===pointB.offset};var isVisiblePoint=function(point){if(isText(point.node)||!hasChildren(point.node)||isEmpty(point.node)){return true}var leftNode=point.node.childNodes[point.offset-1];var rightNode=point.node.childNodes[point.offset];if((!leftNode||isVoid(leftNode))&&(!rightNode||isVoid(rightNode))){return true}return false};var prevPointUntil=function(point,pred){while(point){if(pred(point)){return point}point=prevPoint(point)}return null};var nextPointUntil=function(point,pred){while(point){if(pred(point)){return point}point=nextPoint(point)}return null};var isCharPoint=function(point){if(!isText(point.node)){return false}var ch=point.node.nodeValue.charAt(point.offset-1);return ch&&(ch!==" "&&ch!==NBSP_CHAR)};var walkPoint=function(startPoint,endPoint,handler,isSkipInnerOffset){var point=startPoint;while(point){handler(point);if(isSamePoint(point,endPoint)){break}var isSkipOffset=isSkipInnerOffset&&startPoint.node!==point.node&&endPoint.node!==point.node;point=nextPoint(point,isSkipOffset)}};var makeOffsetPath=function(ancestor,node){var ancestors=listAncestor(node,func.eq(ancestor));return ancestors.map(position).reverse()};var fromOffsetPath=function(ancestor,offsets){var current=ancestor;for(var i=0,len=offsets.length;i<len;i++){if(current.childNodes.length<=offsets[i]){current=current.childNodes[current.childNodes.length-1]}else{current=current.childNodes[offsets[i]]}}return current};var splitNode=function(point,options){var isSkipPaddingBlankHTML=options&&options.isSkipPaddingBlankHTML;var isNotSplitEdgePoint=options&&options.isNotSplitEdgePoint;if(isEdgePoint(point)&&(isText(point.node)||isNotSplitEdgePoint)){if(isLeftEdgePoint(point)){return point.node}else if(isRightEdgePoint(point)){return point.node.nextSibling}}if(isText(point.node)){return point.node.splitText(point.offset)}else{var childNode=point.node.childNodes[point.offset];var clone=insertAfter(point.node.cloneNode(false),point.node);appendChildNodes(clone,listNext(childNode));if(!isSkipPaddingBlankHTML){paddingBlankHTML(point.node);paddingBlankHTML(clone)}return clone}};var splitTree=function(root,point,options){var ancestors=listAncestor(point.node,func.eq(root));if(!ancestors.length){return null}else if(ancestors.length===1){return splitNode(point,options)}return ancestors.reduce(function(node,parent){if(node===point.node){node=splitNode(point,options)}return splitNode({node:parent,offset:node?dom.position(node):nodeLength(parent)},options)})};var splitPoint=function(point,isInline){var pred=isInline?isPara:isBodyContainer;var ancestors=listAncestor(point.node,pred);var topAncestor=list.last(ancestors)||point.node;var splitRoot,container;if(pred(topAncestor)){splitRoot=ancestors[ancestors.length-2];container=topAncestor}else{splitRoot=topAncestor;container=splitRoot.parentNode}var pivot=splitRoot&&splitTree(splitRoot,point,{isSkipPaddingBlankHTML:isInline,isNotSplitEdgePoint:isInline});if(!pivot&&container===point.node){pivot=point.node.childNodes[point.offset]}return{rightNode:pivot,container:container}};var create=function(nodeName){return document.createElement(nodeName)};var createText=function(text){return document.createTextNode(text)};var remove=function(node,isRemoveChild){if(!node||!node.parentNode){return}if(node.removeNode){return node.removeNode(isRemoveChild)}var parent=node.parentNode;if(!isRemoveChild){var nodes=[];var i,len;for(i=0,len=node.childNodes.length;i<len;i++){nodes.push(node.childNodes[i])}for(i=0,len=nodes.length;i<len;i++){parent.insertBefore(nodes[i],node)}}parent.removeChild(node)};var removeWhile=function(node,pred){while(node){if(isEditable(node)||!pred(node)){break}var parent=node.parentNode;remove(node);node=parent}};var replace=function(node,nodeName){if(node.nodeName.toUpperCase()===nodeName.toUpperCase()){return node}var newNode=create(nodeName);if(node.style.cssText){newNode.style.cssText=node.style.cssText}appendChildNodes(newNode,list.from(node.childNodes));insertAfter(newNode,node);remove(node);return newNode};var isTextarea=makePredByNodeName("TEXTAREA");var value=function($node,stripLinebreaks){var val=isTextarea($node[0])?$node.val():$node.html();if(stripLinebreaks){return val.replace(/[\n\r]/g,"")}return val};var html=function($node,isNewlineOnBlock){var markup=value($node);if(isNewlineOnBlock){var regexTag=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;markup=markup.replace(regexTag,function(match,endSlash,name){name=name.toUpperCase();var isEndOfInlineContainer=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name)&&!!endSlash;var isBlockNode=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);return match+(isEndOfInlineContainer||isBlockNode?"\n":"")});markup=$.trim(markup)}return markup};var posFromPlaceholder=function(placeholder){var $placeholder=$(placeholder);var pos=$placeholder.offset();var height=$placeholder.outerHeight(true);return{left:pos.left,top:pos.top+height}};var attachEvents=function($node,events){Object.keys(events).forEach(function(key){$node.on(key,events[key])})};var detachEvents=function($node,events){Object.keys(events).forEach(function(key){$node.off(key,events[key])})};return{NBSP_CHAR:NBSP_CHAR,ZERO_WIDTH_NBSP_CHAR:ZERO_WIDTH_NBSP_CHAR,blank:blankHTML,emptyPara:"<p>"+blankHTML+"</p>",makePredByNodeName:makePredByNodeName,isEditable:isEditable,isControlSizing:isControlSizing,isText:isText,isElement:isElement,isVoid:isVoid,isPara:isPara,isPurePara:isPurePara,isHeading:isHeading,isInline:isInline,isBlock:func.not(isInline),isBodyInline:isBodyInline,isBody:isBody,isParaInline:isParaInline,isPre:isPre,isList:isList,isTable:isTable,isData:isData,isCell:isCell,isBlockquote:isBlockquote,isBodyContainer:isBodyContainer,isAnchor:isAnchor,isDiv:makePredByNodeName("DIV"),isLi:isLi,isBR:makePredByNodeName("BR"),isSpan:makePredByNodeName("SPAN"),isB:makePredByNodeName("B"),isU:makePredByNodeName("U"),isS:makePredByNodeName("S"),isI:makePredByNodeName("I"),isImg:makePredByNodeName("IMG"),isTextarea:isTextarea,isEmpty:isEmpty,isEmptyAnchor:func.and(isAnchor,isEmpty),isClosestSibling:isClosestSibling,withClosestSiblings:withClosestSiblings,nodeLength:nodeLength,isLeftEdgePoint:isLeftEdgePoint,isRightEdgePoint:isRightEdgePoint,isEdgePoint:isEdgePoint,isLeftEdgeOf:isLeftEdgeOf,isRightEdgeOf:isRightEdgeOf,isLeftEdgePointOf:isLeftEdgePointOf,isRightEdgePointOf:isRightEdgePointOf,prevPoint:prevPoint,nextPoint:nextPoint,isSamePoint:isSamePoint,isVisiblePoint:isVisiblePoint,prevPointUntil:prevPointUntil,nextPointUntil:nextPointUntil,isCharPoint:isCharPoint,walkPoint:walkPoint,ancestor:ancestor,singleChildAncestor:singleChildAncestor,listAncestor:listAncestor,lastAncestor:lastAncestor,listNext:listNext,listPrev:listPrev,listDescendant:listDescendant,commonAncestor:commonAncestor,wrap:wrap,insertAfter:insertAfter,appendChildNodes:appendChildNodes,position:position,hasChildren:hasChildren,makeOffsetPath:makeOffsetPath,fromOffsetPath:fromOffsetPath,splitTree:splitTree,splitPoint:splitPoint,create:create,createText:createText,remove:remove,removeWhile:removeWhile,replace:replace,html:html,value:value,posFromPlaceholder:posFromPlaceholder,attachEvents:attachEvents,detachEvents:detachEvents}}();var Context=function($note,options){var self=this;var ui=$.summernote.ui;this.memos={};this.modules={};this.layoutInfo={};this.options=options;this.initialize=function(){this.layoutInfo=ui.createLayout($note,options);this._initialize();$note.hide();return this};this.destroy=function(){this._destroy();$note.removeData("summernote");ui.removeLayout($note,this.layoutInfo)};this.reset=function(){var disabled=self.isDisabled();this.code(dom.emptyPara);this._destroy();this._initialize();if(disabled){self.disable()}};this._initialize=function(){var buttons=$.extend({},this.options.buttons);Object.keys(buttons).forEach(function(key){self.memo("button."+key,buttons[key])});var modules=$.extend({},this.options.modules,$.summernote.plugins||{});Object.keys(modules).forEach(function(key){self.module(key,modules[key],true)});Object.keys(this.modules).forEach(function(key){self.initializeModule(key)})};this._destroy=function(){Object.keys(this.modules).reverse().forEach(function(key){self.removeModule(key)});Object.keys(this.memos).forEach(function(key){self.removeMemo(key)})};this.code=function(html){var isActivated=this.invoke("codeview.isActivated");if(html===undefined){this.invoke("codeview.sync");return isActivated?this.layoutInfo.codable.val():this.layoutInfo.editable.html()}else{if(isActivated){this.layoutInfo.codable.val(html)}else{this.layoutInfo.editable.html(html)}$note.val(html);this.triggerEvent("change",html)}};this.isDisabled=function(){return this.layoutInfo.editable.attr("contenteditable")==="false"};this.enable=function(){this.layoutInfo.editable.attr("contenteditable",true);this.invoke("toolbar.activate",true)};this.disable=function(){if(this.invoke("codeview.isActivated")){this.invoke("codeview.deactivate")}this.layoutInfo.editable.attr("contenteditable",false);this.invoke("toolbar.deactivate",true)};this.triggerEvent=function(){var namespace=list.head(arguments);var args=list.tail(list.from(arguments));var callback=this.options.callbacks[func.namespaceToCamel(namespace,"on")];if(callback){callback.apply($note[0],args)}$note.trigger("summernote."+namespace,args)};this.initializeModule=function(key){var module=this.modules[key];module.shouldInitialize=module.shouldInitialize||func.ok;if(!module.shouldInitialize()){return}if(module.initialize){module.initialize()}if(module.events){dom.attachEvents($note,module.events)}};this.module=function(key,ModuleClass,withoutIntialize){if(arguments.length===1){return this.modules[key]}this.modules[key]=new ModuleClass(this);if(!withoutIntialize){this.initializeModule(key)}};this.removeModule=function(key){var module=this.modules[key];if(module.shouldInitialize()){if(module.events){dom.detachEvents($note,module.events)}if(module.destroy){module.destroy()}}delete this.modules[key]};this.memo=function(key,obj){if(arguments.length===1){return this.memos[key]}this.memos[key]=obj};this.removeMemo=function(key){if(this.memos[key]&&this.memos[key].destroy){this.memos[key].destroy()}delete this.memos[key]};this.createInvokeHandler=function(namespace,value){return function(event){event.preventDefault();self.invoke(namespace,value||$(event.target).closest("[data-value]").data("value"))}};this.invoke=function(){var namespace=list.head(arguments);var args=list.tail(list.from(arguments));var splits=namespace.split(".");var hasSeparator=splits.length>1;var moduleName=hasSeparator&&list.head(splits);var methodName=hasSeparator?list.last(splits):list.head(splits);var module=this.modules[moduleName||"editor"];if(!moduleName&&this[methodName]){return this[methodName].apply(this,args)}else if(module&&module[methodName]&&module.shouldInitialize()){return module[methodName].apply(module,args)}};return this.initialize()};$.fn.extend({summernote:function(){var type=$.type(list.head(arguments));var isExternalAPICalled=type==="string";var hasInitOptions=type==="object";var options=hasInitOptions?list.head(arguments):{};options=$.extend({},$.summernote.options,options);options.langInfo=$.extend(true,{},$.summernote.lang["en-US"],$.summernote.lang[options.lang]);options.icons=$.extend(true,{},$.summernote.options.icons,options.icons);this.each(function(idx,note){var $note=$(note);if(!$note.data("summernote")){var context=new Context($note,options);$note.data("summernote",context);$note.data("summernote").triggerEvent("init",context.layoutInfo)}});var $note=this.first();if($note.length){var context=$note.data("summernote");if(isExternalAPICalled){return context.invoke.apply(context,list.from(arguments))}else if(options.focus){context.invoke("editor.focus")}}return this}});var Renderer=function(markup,children,options,callback){this.render=function($parent){var $node=$(markup);if(options&&options.contents){$node.html(options.contents)}if(options&&options.className){$node.addClass(options.className)}if(options&&options.data){$.each(options.data,function(k,v){$node.attr("data-"+k,v)})}if(options&&options.click){$node.on("click",options.click)}if(children){var $container=$node.find(".note-children-container");children.forEach(function(child){child.render($container.length?$container:$node)})}if(callback){callback($node,options)}if(options&&options.callback){options.callback($node)}if($parent){$parent.append($node)}return $node}};var renderer={create:function(markup,callback){return function(){var children=$.isArray(arguments[0])?arguments[0]:[];var options=typeof arguments[1]==="object"?arguments[1]:arguments[0];if(options&&options.children){children=options.children}return new Renderer(markup,children,options,callback)}}};var editor=renderer.create('<div class="note-editor note-frame panel panel-default"/>');var toolbar=renderer.create('<div class="note-toolbar panel-heading"/>');var editingArea=renderer.create('<div class="note-editing-area"/>');var codable=renderer.create('<textarea class="note-codable"/>');var editable=renderer.create('<div class="note-editable panel-body" contentEditable="true"/>');var statusbar=renderer.create(['<div class="note-statusbar">','  <div class="note-resizebar">','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>',"  </div>","</div>"].join(""));var airEditor=renderer.create('<div class="note-editor"/>');var airEditable=renderer.create('<div class="note-editable" contentEditable="true"/>');var buttonGroup=renderer.create('<div class="note-btn-group btn-group">');var button=renderer.create('<button type="button" class="note-btn btn btn-default btn-sm" tabindex="-1">',function($node,options){if(options&&options.tooltip){$node.attr({title:options.tooltip}).tooltip({container:"body",trigger:"hover",placement:"bottom"})}});var dropdown=renderer.create('<div class="dropdown-menu">',function($node,options){var markup=$.isArray(options.items)?options.items.map(function(item){var value=typeof item==="string"?item:item.value||"";var content=options.template?options.template(item):item;return'<li><a href="#" data-value="'+value+'">'+content+"</a></li>"}).join(""):options.items;$node.html(markup)});var dropdownCheck=renderer.create('<div class="dropdown-menu note-check">',function($node,options){var markup=$.isArray(options.items)?options.items.map(function(item){var value=typeof item==="string"?item:item.value||"";var content=options.template?options.template(item):item;return'<li><a href="#" data-value="'+value+'">'+icon(options.checkClassName)+" "+content+"</a></li>"}).join(""):options.items;$node.html(markup)});var palette=renderer.create('<div class="note-color-palette"/>',function($node,options){var contents=[];for(var row=0,rowSize=options.colors.length;row<rowSize;row++){var eventName=options.eventName;var colors=options.colors[row];var buttons=[];for(var col=0,colSize=colors.length;col<colSize;col++){var color=colors[col];buttons.push(['<button type="button" class="note-color-btn"','style="background-color:',color,'" ','data-event="',eventName,'" ','data-value="',color,'" ','title="',color,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}contents.push('<div class="note-color-row">'+buttons.join("")+"</div>")}$node.html(contents.join(""));$node.find(".note-color-btn").tooltip({container:"body",trigger:"hover",placement:"bottom"})});var dialog=renderer.create('<div class="modal" aria-hidden="false" tabindex="-1"/>',function($node,options){if(options.fade){$node.addClass("fade")}$node.html(['<div class="modal-dialog">','  <div class="modal-content">',options.title?'    <div class="modal-header">'+'      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+'      <h4 class="modal-title">'+options.title+"</h4>"+"    </div>":"",'    <div class="modal-body">'+options.body+"</div>",options.footer?'    <div class="modal-footer">'+options.footer+"</div>":"","  </div>","</div>"].join(""))});var popover=renderer.create(['<div class="note-popover popover in">','  <div class="arrow"/>','  <div class="popover-content note-children-container"/>',"</div>"].join(""),function($node,options){var direction=typeof options.direction!=="undefined"?options.direction:"bottom";$node.addClass(direction);if(options.hideArrow){$node.find(".arrow").hide()}});var icon=function(iconClassName,tagName){tagName=tagName||"i";return"<"+tagName+' class="'+iconClassName+'"/>'};var ui={editor:editor,toolbar:toolbar,editingArea:editingArea,codable:codable,editable:editable,statusbar:statusbar,airEditor:airEditor,airEditable:airEditable,buttonGroup:buttonGroup,button:button,dropdown:dropdown,dropdownCheck:dropdownCheck,palette:palette,dialog:dialog,popover:popover,icon:icon,toggleBtn:function($btn,isEnable){$btn.toggleClass("disabled",!isEnable);$btn.attr("disabled",!isEnable)},toggleBtnActive:function($btn,isActive){$btn.toggleClass("active",isActive)},onDialogShown:function($dialog,handler){$dialog.one("shown.bs.modal",handler)},onDialogHidden:function($dialog,handler){$dialog.one("hidden.bs.modal",handler)},showDialog:function($dialog){$dialog.modal("show")},hideDialog:function($dialog){$dialog.modal("hide")},createLayout:function($note,options){var $editor=(options.airMode?ui.airEditor([ui.editingArea([ui.airEditable()])]):ui.editor([ui.toolbar(),ui.editingArea([ui.codable(),ui.editable()]),ui.statusbar()])).render();$editor.insertAfter($note);return{note:$note,editor:$editor,toolbar:$editor.find(".note-toolbar"),editingArea:$editor.find(".note-editing-area"),editable:$editor.find(".note-editable"),codable:$editor.find(".note-codable"),statusbar:$editor.find(".note-statusbar")}},removeLayout:function($note,layoutInfo){$note.html(layoutInfo.editable.html());layoutInfo.editor.remove();$note.show()}};$.summernote=$.summernote||{lang:{}};$.extend($.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});var key=function(){var keyMap={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221};return{isEdit:function(keyCode){return list.contains([keyMap.BACKSPACE,keyMap.TAB,keyMap.ENTER,keyMap.SPACE],keyCode)},isMove:function(keyCode){return list.contains([keyMap.LEFT,keyMap.UP,keyMap.RIGHT,keyMap.DOWN],keyCode)},nameFromCode:func.invertObject(keyMap),code:keyMap}}();var range=function(){var textRangeToPoint=function(textRange,isStart){var container=textRange.parentElement(),offset;var tester=document.body.createTextRange(),prevContainer;var childNodes=list.from(container.childNodes);for(offset=0;offset<childNodes.length;offset++){if(dom.isText(childNodes[offset])){continue}tester.moveToElementText(childNodes[offset]);if(tester.compareEndPoints("StartToStart",textRange)>=0){break}prevContainer=childNodes[offset]}if(offset!==0&&dom.isText(childNodes[offset-1])){var textRangeStart=document.body.createTextRange(),curTextNode=null;textRangeStart.moveToElementText(prevContainer||container);textRangeStart.collapse(!prevContainer);curTextNode=prevContainer?prevContainer.nextSibling:container.firstChild;var pointTester=textRange.duplicate();pointTester.setEndPoint("StartToStart",textRangeStart);var textCount=pointTester.text.replace(/[\r\n]/g,"").length;while(textCount>curTextNode.nodeValue.length&&curTextNode.nextSibling){textCount-=curTextNode.nodeValue.length;curTextNode=curTextNode.nextSibling}var dummy=curTextNode.nodeValue;if(isStart&&curTextNode.nextSibling&&dom.isText(curTextNode.nextSibling)&&textCount===curTextNode.nodeValue.length){textCount-=curTextNode.nodeValue.length;curTextNode=curTextNode.nextSibling}container=curTextNode;offset=textCount}return{cont:container,offset:offset}};var pointToTextRange=function(point){var textRangeInfo=function(container,offset){var node,isCollapseToStart;if(dom.isText(container)){var prevTextNodes=dom.listPrev(container,func.not(dom.isText));var prevContainer=list.last(prevTextNodes).previousSibling;node=prevContainer||container.parentNode;offset+=list.sum(list.tail(prevTextNodes),dom.nodeLength);isCollapseToStart=!prevContainer}else{node=container.childNodes[offset]||container;if(dom.isText(node)){return textRangeInfo(node,0)}offset=0;isCollapseToStart=false}return{node:node,collapseToStart:isCollapseToStart,offset:offset}};var textRange=document.body.createTextRange();var info=textRangeInfo(point.node,point.offset);textRange.moveToElementText(info.node);textRange.collapse(info.collapseToStart);textRange.moveStart("character",info.offset);return textRange};var WrappedRange=function(sc,so,ec,eo){this.sc=sc;this.so=so;this.ec=ec;this.eo=eo;var nativeRange=function(){if(agent.isW3CRangeSupport){var w3cRange=document.createRange();w3cRange.setStart(sc,so);w3cRange.setEnd(ec,eo);return w3cRange}else{var textRange=pointToTextRange({node:sc,offset:so});textRange.setEndPoint("EndToEnd",pointToTextRange({node:ec,offset:eo}));return textRange}};this.getPoints=function(){return{sc:sc,so:so,ec:ec,eo:eo}};this.getStartPoint=function(){return{node:sc,offset:so}};this.getEndPoint=function(){return{node:ec,offset:eo}};this.select=function(){var nativeRng=nativeRange();if(agent.isW3CRangeSupport){var selection=document.getSelection();if(selection.rangeCount>0){selection.removeAllRanges()}selection.addRange(nativeRng)}else{nativeRng.select()}return this};this.scrollIntoView=function(container){var height=$(container).height();if(container.scrollTop+height<this.sc.offsetTop){container.scrollTop+=Math.abs(container.scrollTop+height-this.sc.offsetTop)}return this};this.normalize=function(){var getVisiblePoint=function(point,isLeftToRight){if(dom.isVisiblePoint(point)&&!dom.isEdgePoint(point)||dom.isVisiblePoint(point)&&dom.isRightEdgePoint(point)&&!isLeftToRight||dom.isVisiblePoint(point)&&dom.isLeftEdgePoint(point)&&isLeftToRight||dom.isVisiblePoint(point)&&dom.isBlock(point.node)&&dom.isEmpty(point.node)){return point}var block=dom.ancestor(point.node,dom.isBlock);if((dom.isLeftEdgePointOf(point,block)||dom.isVoid(dom.prevPoint(point).node))&&!isLeftToRight||(dom.isRightEdgePointOf(point,block)||dom.isVoid(dom.nextPoint(point).node))&&isLeftToRight){if(dom.isVisiblePoint(point)){return point}isLeftToRight=!isLeftToRight}var nextPoint=isLeftToRight?dom.nextPointUntil(dom.nextPoint(point),dom.isVisiblePoint):dom.prevPointUntil(dom.prevPoint(point),dom.isVisiblePoint);return nextPoint||point};var endPoint=getVisiblePoint(this.getEndPoint(),false);var startPoint=this.isCollapsed()?endPoint:getVisiblePoint(this.getStartPoint(),true);return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)};this.nodes=function(pred,options){pred=pred||func.ok;var includeAncestor=options&&options.includeAncestor;var fullyContains=options&&options.fullyContains;var startPoint=this.getStartPoint();var endPoint=this.getEndPoint();var nodes=[];var leftEdgeNodes=[];dom.walkPoint(startPoint,endPoint,function(point){if(dom.isEditable(point.node)){return}var node;if(fullyContains){if(dom.isLeftEdgePoint(point)){leftEdgeNodes.push(point.node)}if(dom.isRightEdgePoint(point)&&list.contains(leftEdgeNodes,point.node)){node=point.node}}else if(includeAncestor){node=dom.ancestor(point.node,pred)}else{node=point.node}if(node&&pred(node)){nodes.push(node)}},true);return list.unique(nodes)};this.commonAncestor=function(){return dom.commonAncestor(sc,ec)};this.expand=function(pred){var startAncestor=dom.ancestor(sc,pred);var endAncestor=dom.ancestor(ec,pred);if(!startAncestor&&!endAncestor){return new WrappedRange(sc,so,ec,eo)}var boundaryPoints=this.getPoints();if(startAncestor){boundaryPoints.sc=startAncestor;boundaryPoints.so=0}if(endAncestor){boundaryPoints.ec=endAncestor;boundaryPoints.eo=dom.nodeLength(endAncestor)}return new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo)};this.collapse=function(isCollapseToStart){if(isCollapseToStart){return new WrappedRange(sc,so,sc,so)}else{return new WrappedRange(ec,eo,ec,eo)}};this.splitText=function(){var isSameContainer=sc===ec;var boundaryPoints=this.getPoints();if(dom.isText(ec)&&!dom.isEdgePoint(this.getEndPoint())){ec.splitText(eo)}if(dom.isText(sc)&&!dom.isEdgePoint(this.getStartPoint())){boundaryPoints.sc=sc.splitText(so);boundaryPoints.so=0;if(isSameContainer){boundaryPoints.ec=boundaryPoints.sc;boundaryPoints.eo=eo-so}}return new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo)};this.deleteContents=function(){if(this.isCollapsed()){return this}var rng=this.splitText();var nodes=rng.nodes(null,{fullyContains:true});var point=dom.prevPointUntil(rng.getStartPoint(),function(point){return!list.contains(nodes,point.node)});var emptyParents=[];$.each(nodes,function(idx,node){var parent=node.parentNode;if(point.node!==parent&&dom.nodeLength(parent)===1){emptyParents.push(parent)}dom.remove(node,false)});$.each(emptyParents,function(idx,node){dom.remove(node,false)});return new WrappedRange(point.node,point.offset,point.node,point.offset).normalize()};var makeIsOn=function(pred){return function(){var ancestor=dom.ancestor(sc,pred);return!!ancestor&&ancestor===dom.ancestor(ec,pred)}};this.isOnEditable=makeIsOn(dom.isEditable);this.isOnList=makeIsOn(dom.isList);this.isOnAnchor=makeIsOn(dom.isAnchor);this.isOnCell=makeIsOn(dom.isCell);this.isOnData=makeIsOn(dom.isData);this.isLeftEdgeOf=function(pred){if(!dom.isLeftEdgePoint(this.getStartPoint())){return false}var node=dom.ancestor(this.sc,pred);return node&&dom.isLeftEdgeOf(this.sc,node)};this.isCollapsed=function(){return sc===ec&&so===eo};this.wrapBodyInlineWithPara=function(){if(dom.isBodyContainer(sc)&&dom.isEmpty(sc)){sc.innerHTML=dom.emptyPara;return new WrappedRange(sc.firstChild,0,sc.firstChild,0)}var rng=this.normalize();if(dom.isParaInline(sc)||dom.isPara(sc)){return rng}var topAncestor;if(dom.isInline(rng.sc)){var ancestors=dom.listAncestor(rng.sc,func.not(dom.isInline));topAncestor=list.last(ancestors);if(!dom.isInline(topAncestor)){topAncestor=ancestors[ancestors.length-2]||rng.sc.childNodes[rng.so]}}else{topAncestor=rng.sc.childNodes[rng.so>0?rng.so-1:0]}var inlineSiblings=dom.listPrev(topAncestor,dom.isParaInline).reverse();inlineSiblings=inlineSiblings.concat(dom.listNext(topAncestor.nextSibling,dom.isParaInline));if(inlineSiblings.length){var para=dom.wrap(list.head(inlineSiblings),"p");dom.appendChildNodes(para,list.tail(inlineSiblings))}return this.normalize()};this.insertNode=function(node){var rng=this.wrapBodyInlineWithPara().deleteContents();var info=dom.splitPoint(rng.getStartPoint(),dom.isInline(node));if(info.rightNode){info.rightNode.parentNode.insertBefore(node,info.rightNode)}else{info.container.appendChild(node)}return node};this.pasteHTML=function(markup){var contentsContainer=$("<div></div>").html(markup)[0];var childNodes=list.from(contentsContainer.childNodes);var rng=this.wrapBodyInlineWithPara().deleteContents();return childNodes.reverse().map(function(childNode){return rng.insertNode(childNode)}).reverse()};this.toString=function(){var nativeRng=nativeRange();return agent.isW3CRangeSupport?nativeRng.toString():nativeRng.text};this.getWordRange=function(findAfter){var endPoint=this.getEndPoint();if(!dom.isCharPoint(endPoint)){return this}var startPoint=dom.prevPointUntil(endPoint,function(point){return!dom.isCharPoint(point)});if(findAfter){endPoint=dom.nextPointUntil(endPoint,function(point){return!dom.isCharPoint(point)})}return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)};this.bookmark=function(editable){return{s:{path:dom.makeOffsetPath(editable,sc),offset:so},e:{path:dom.makeOffsetPath(editable,ec),offset:eo}}};this.paraBookmark=function(paras){return{s:{path:list.tail(dom.makeOffsetPath(list.head(paras),sc)),offset:so},e:{path:list.tail(dom.makeOffsetPath(list.last(paras),ec)),offset:eo}}};this.getClientRects=function(){var nativeRng=nativeRange();return nativeRng.getClientRects()}};return{create:function(sc,so,ec,eo){if(arguments.length===4){return new WrappedRange(sc,so,ec,eo)}else if(arguments.length===2){ec=sc;eo=so;return new WrappedRange(sc,so,ec,eo)}else{var wrappedRange=this.createFromSelection();if(!wrappedRange&&arguments.length===1){wrappedRange=this.createFromNode(arguments[0]);return wrappedRange.collapse(dom.emptyPara===arguments[0].innerHTML)}return wrappedRange}},createFromSelection:function(){var sc,so,ec,eo;if(agent.isW3CRangeSupport){var selection=document.getSelection();if(!selection||selection.rangeCount===0){return null}else if(dom.isBody(selection.anchorNode)){return null}var nativeRng=selection.getRangeAt(0);sc=nativeRng.startContainer;so=nativeRng.startOffset;ec=nativeRng.endContainer;eo=nativeRng.endOffset}else{var textRange=document.selection.createRange();var textRangeEnd=textRange.duplicate();textRangeEnd.collapse(false);var textRangeStart=textRange;textRangeStart.collapse(true);var startPoint=textRangeToPoint(textRangeStart,true),endPoint=textRangeToPoint(textRangeEnd,false);if(dom.isText(startPoint.node)&&dom.isLeftEdgePoint(startPoint)&&dom.isTextNode(endPoint.node)&&dom.isRightEdgePoint(endPoint)&&endPoint.node.nextSibling===startPoint.node){startPoint=endPoint}sc=startPoint.cont;so=startPoint.offset;ec=endPoint.cont;eo=endPoint.offset}return new WrappedRange(sc,so,ec,eo)},createFromNode:function(node){var sc=node;var so=0;var ec=node;var eo=dom.nodeLength(ec);if(dom.isVoid(sc)){so=dom.listPrev(sc).length-1;sc=sc.parentNode}if(dom.isBR(ec)){eo=dom.listPrev(ec).length-1;ec=ec.parentNode}else if(dom.isVoid(ec)){eo=dom.listPrev(ec).length;ec=ec.parentNode}return this.create(sc,so,ec,eo)},createFromNodeBefore:function(node){return this.createFromNode(node).collapse(true)},createFromNodeAfter:function(node){return this.createFromNode(node).collapse()},createFromBookmark:function(editable,bookmark){var sc=dom.fromOffsetPath(editable,bookmark.s.path);var so=bookmark.s.offset;var ec=dom.fromOffsetPath(editable,bookmark.e.path);var eo=bookmark.e.offset;return new WrappedRange(sc,so,ec,eo)},createFromParaBookmark:function(bookmark,paras){var so=bookmark.s.offset;var eo=bookmark.e.offset;var sc=dom.fromOffsetPath(list.head(paras),bookmark.s.path);var ec=dom.fromOffsetPath(list.last(paras),bookmark.e.path);return new WrappedRange(sc,so,ec,eo)}}}();var async=function(){var readFileAsDataURL=function(file){return $.Deferred(function(deferred){$.extend(new FileReader,{onload:function(e){var dataURL=e.target.result;deferred.resolve(dataURL)},onerror:function(){deferred.reject(this)}}).readAsDataURL(file)}).promise()};var createImage=function(url){return $.Deferred(function(deferred){var $img=$("<img>");$img.one("load",function(){$img.off("error abort");deferred.resolve($img)}).one("error abort",function(){$img.off("load").detach();deferred.reject($img)}).css({display:"none"}).appendTo(document.body).attr("src",url)}).promise()};return{readFileAsDataURL:readFileAsDataURL,createImage:createImage}}();var History=function($editable){var stack=[],stackOffset=-1;var editable=$editable[0];var makeSnapshot=function(){var rng=range.create(editable);var emptyBookmark={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:$editable.html(),bookmark:rng?rng.bookmark(editable):emptyBookmark}};var applySnapshot=function(snapshot){if(snapshot.contents!==null){$editable.html(snapshot.contents)}if(snapshot.bookmark!==null){range.createFromBookmark(editable,snapshot.bookmark).select()}};this.rewind=function(){if($editable.html()!==stack[stackOffset].contents){this.recordUndo()}stackOffset=0;applySnapshot(stack[stackOffset])};this.reset=function(){stack=[];stackOffset=-1;$editable.html("");this.recordUndo()};this.undo=function(){if($editable.html()!==stack[stackOffset].contents){this.recordUndo()}if(0<stackOffset){stackOffset--;applySnapshot(stack[stackOffset])}};this.redo=function(){if(stack.length-1>stackOffset){stackOffset++;applySnapshot(stack[stackOffset])}};this.recordUndo=function(){stackOffset++;if(stack.length>stackOffset){stack=stack.slice(0,stackOffset)}stack.push(makeSnapshot())}};var Style=function(){var jQueryCSS=function($obj,propertyNames){if(agent.jqueryVersion<1.9){var result={};$.each(propertyNames,function(idx,propertyName){result[propertyName]=$obj.css(propertyName)});return result}return $obj.css.call($obj,propertyNames)};this.fromNode=function($node){var properties=["font-family","font-size","text-align","list-style-type","line-height"];var styleInfo=jQueryCSS($node,properties)||{};styleInfo["font-size"]=parseInt(styleInfo["font-size"],10);return styleInfo};this.stylePara=function(rng,styleInfo){$.each(rng.nodes(dom.isPara,{includeAncestor:true}),function(idx,para){$(para).css(styleInfo)})};this.styleNodes=function(rng,options){rng=rng.splitText();var nodeName=options&&options.nodeName||"SPAN";var expandClosestSibling=!!(options&&options.expandClosestSibling);var onlyPartialContains=!!(options&&options.onlyPartialContains);if(rng.isCollapsed()){return[rng.insertNode(dom.create(nodeName))]}var pred=dom.makePredByNodeName(nodeName);var nodes=rng.nodes(dom.isText,{fullyContains:true}).map(function(text){return dom.singleChildAncestor(text,pred)||dom.wrap(text,nodeName)});if(expandClosestSibling){if(onlyPartialContains){var nodesInRange=rng.nodes();pred=func.and(pred,function(node){return list.contains(nodesInRange,node)})}return nodes.map(function(node){var siblings=dom.withClosestSiblings(node,pred);var head=list.head(siblings);var tails=list.tail(siblings);$.each(tails,function(idx,elem){dom.appendChildNodes(head,elem.childNodes);dom.remove(elem)});return list.head(siblings)})}else{return nodes}};this.current=function(rng){var $cont=$(!dom.isElement(rng.sc)?rng.sc.parentNode:rng.sc);var styleInfo=this.fromNode($cont);try{styleInfo=$.extend(styleInfo,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal"})}catch(e){}if(!rng.isOnList()){styleInfo["list-style"]="none"}else{var orderedTypes=["circle","disc","disc-leading-zero","square"];var isUnordered=$.inArray(styleInfo["list-style-type"],orderedTypes)>-1;styleInfo["list-style"]=isUnordered?"unordered":"ordered"}var para=dom.ancestor(rng.sc,dom.isPara);if(para&&para.style["line-height"]){styleInfo["line-height"]=para.style.lineHeight}else{var lineHeight=parseInt(styleInfo["line-height"],10)/parseInt(styleInfo["font-size"],10);styleInfo["line-height"]=lineHeight.toFixed(1)}styleInfo.anchor=rng.isOnAnchor()&&dom.ancestor(rng.sc,dom.isAnchor);styleInfo.ancestors=dom.listAncestor(rng.sc,dom.isEditable);styleInfo.range=rng;return styleInfo}};var Bullet=function(){var self=this;this.insertOrderedList=function(editable){this.toggleList("OL",editable)};this.insertUnorderedList=function(editable){this.toggleList("UL",editable)};this.indent=function(editable){var self=this;var rng=range.create(editable).wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var clustereds=list.clusterBy(paras,func.peq2("parentNode"));$.each(clustereds,function(idx,paras){var head=list.head(paras);if(dom.isLi(head)){self.wrapList(paras,head.parentNode.nodeName)}else{$.each(paras,function(idx,para){$(para).css("marginLeft",function(idx,val){return(parseInt(val,10)||0)+25})})}});rng.select()};this.outdent=function(editable){var self=this;var rng=range.create(editable).wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var clustereds=list.clusterBy(paras,func.peq2("parentNode"));$.each(clustereds,function(idx,paras){var head=list.head(paras);if(dom.isLi(head)){self.releaseList([paras])}else{$.each(paras,function(idx,para){$(para).css("marginLeft",function(idx,val){val=parseInt(val,10)||0;return val>25?val-25:""})})}});rng.select()};this.toggleList=function(listName,editable){var rng=range.create(editable).wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var bookmark=rng.paraBookmark(paras);var clustereds=list.clusterBy(paras,func.peq2("parentNode"));if(list.find(paras,dom.isPurePara)){var wrappedParas=[];$.each(clustereds,function(idx,paras){wrappedParas=wrappedParas.concat(self.wrapList(paras,listName))});paras=wrappedParas}else{var diffLists=rng.nodes(dom.isList,{includeAncestor:true}).filter(function(listNode){return!$.nodeName(listNode,listName)});if(diffLists.length){$.each(diffLists,function(idx,listNode){dom.replace(listNode,listName)})}else{paras=this.releaseList(clustereds,true)}}range.createFromParaBookmark(bookmark,paras).select()};this.wrapList=function(paras,listName){var head=list.head(paras);var last=list.last(paras);var prevList=dom.isList(head.previousSibling)&&head.previousSibling;var nextList=dom.isList(last.nextSibling)&&last.nextSibling;var listNode=prevList||dom.insertAfter(dom.create(listName||"UL"),last);paras=paras.map(function(para){return dom.isPurePara(para)?dom.replace(para,"LI"):para});dom.appendChildNodes(listNode,paras);if(nextList){dom.appendChildNodes(listNode,list.from(nextList.childNodes));dom.remove(nextList)}return paras};this.releaseList=function(clustereds,isEscapseToBody){var releasedParas=[];$.each(clustereds,function(idx,paras){var head=list.head(paras);var last=list.last(paras);var headList=isEscapseToBody?dom.lastAncestor(head,dom.isList):head.parentNode;var lastList=headList.childNodes.length>1?dom.splitTree(headList,{node:last.parentNode,offset:dom.position(last)+1},{isSkipPaddingBlankHTML:true}):null;var middleList=dom.splitTree(headList,{node:head.parentNode,offset:dom.position(head)},{isSkipPaddingBlankHTML:true});paras=isEscapseToBody?dom.listDescendant(middleList,dom.isLi):list.from(middleList.childNodes).filter(dom.isLi);if(isEscapseToBody||!dom.isList(headList.parentNode)){paras=paras.map(function(para){return dom.replace(para,"P")})}$.each(list.from(paras).reverse(),function(idx,para){dom.insertAfter(para,headList)});var rootLists=list.compact([headList,middleList,lastList]);$.each(rootLists,function(idx,rootList){var listNodes=[rootList].concat(dom.listDescendant(rootList,dom.isList));$.each(listNodes.reverse(),function(idx,listNode){if(!dom.nodeLength(listNode)){dom.remove(listNode,true)}})});releasedParas=releasedParas.concat(paras)});return releasedParas}};var Typing=function(){var bullet=new Bullet;this.insertTab=function(rng,tabsize){var tab=dom.createText(new Array(tabsize+1).join(dom.NBSP_CHAR));rng=rng.deleteContents();rng.insertNode(tab,true);rng=range.create(tab,tabsize);rng.select()};this.insertParagraph=function(editable){var rng=range.create(editable);rng=rng.deleteContents();rng=rng.wrapBodyInlineWithPara();var splitRoot=dom.ancestor(rng.sc,dom.isPara);var nextPara;if(splitRoot){if(dom.isEmpty(splitRoot)&&dom.isLi(splitRoot)){bullet.toggleList(splitRoot.parentNode.nodeName);return}else if(dom.isEmpty(splitRoot)&&dom.isPara(splitRoot)&&dom.isBlockquote(splitRoot.parentNode)){dom.insertAfter(splitRoot,splitRoot.parentNode);nextPara=splitRoot}else{nextPara=dom.splitTree(splitRoot,rng.getStartPoint());var emptyAnchors=dom.listDescendant(splitRoot,dom.isEmptyAnchor);emptyAnchors=emptyAnchors.concat(dom.listDescendant(nextPara,dom.isEmptyAnchor));$.each(emptyAnchors,function(idx,anchor){dom.remove(anchor)});if((dom.isHeading(nextPara)||dom.isPre(nextPara))&&dom.isEmpty(nextPara)){nextPara=dom.replace(nextPara,"p")}}}else{var next=rng.sc.childNodes[rng.so];nextPara=$(dom.emptyPara)[0];if(next){rng.sc.insertBefore(nextPara,next)}else{rng.sc.appendChild(nextPara)}}range.create(nextPara,0).normalize().select().scrollIntoView(editable)}};var Table=function(){this.tab=function(rng,isShift){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell);var table=dom.ancestor(cell,dom.isTable);var cells=dom.listDescendant(table,dom.isCell);var nextCell=list[isShift?"prev":"next"](cells,cell);if(nextCell){range.create(nextCell,0).select()}};this.createTable=function(colCount,rowCount,options){var tds=[],tdHTML;for(var idxCol=0;idxCol<colCount;idxCol++){tds.push("<td>"+dom.blank+"</td>")}tdHTML=tds.join("");var trs=[],trHTML;for(var idxRow=0;idxRow<rowCount;idxRow++){trs.push("<tr>"+tdHTML+"</tr>")}trHTML=trs.join("");var $table=$("<table>"+trHTML+"</table>");if(options&&options.tableClassName){$table.addClass(options.tableClassName)}return $table[0]}};var KEY_BOGUS="bogus";var Editor=function(context){var self=this;var $note=context.layoutInfo.note;var $editor=context.layoutInfo.editor;var $editable=context.layoutInfo.editable;var options=context.options;var lang=options.langInfo;var editable=$editable[0];var lastRange=null;var style=new Style;var table=new Table;var typing=new Typing;var bullet=new Bullet;var history=new History($editable);this.initialize=function(){$editable.on("keydown",function(event){if(event.keyCode===key.code.ENTER){context.triggerEvent("enter",event)}context.triggerEvent("keydown",event);if(!event.isDefaultPrevented()){if(options.shortcuts){self.handleKeyMap(event)}else{self.preventDefaultEditableShortCuts(event)}}}).on("keyup",function(event){context.triggerEvent("keyup",event)}).on("focus",function(event){context.triggerEvent("focus",event)}).on("blur",function(event){context.triggerEvent("blur",event)}).on("mousedown",function(event){context.triggerEvent("mousedown",event)}).on("mouseup",function(event){context.triggerEvent("mouseup",event)}).on("scroll",function(event){context.triggerEvent("scroll",event)}).on("paste",function(event){context.triggerEvent("paste",event)});$editable.html(dom.html($note)||dom.emptyPara);var changeEventName=agent.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";$editable.on(changeEventName,func.debounce(function(){context.triggerEvent("change",$editable.html())},250));$editor.on("focusin",function(event){context.triggerEvent("focusin",event)}).on("focusout",function(event){context.triggerEvent("focusout",event)});if(!options.airMode){if(options.width){$editor.outerWidth(options.width)}if(options.height){$editable.outerHeight(options.height)}if(options.maxHeight){$editable.css("max-height",options.maxHeight)}if(options.minHeight){$editable.css("min-height",options.minHeight)}}history.recordUndo()};this.destroy=function(){$editable.off()};this.handleKeyMap=function(event){var keyMap=options.keyMap[agent.isMac?"mac":"pc"];var keys=[];if(event.metaKey){keys.push("CMD")}if(event.ctrlKey&&!event.altKey){keys.push("CTRL")}if(event.shiftKey){keys.push("SHIFT")}var keyName=key.nameFromCode[event.keyCode];if(keyName){keys.push(keyName)}var eventName=keyMap[keys.join("+")];if(eventName){event.preventDefault();context.invoke(eventName)}else if(key.isEdit(event.keyCode)){this.afterCommand()}};this.preventDefaultEditableShortCuts=function(event){if((event.ctrlKey||event.metaKey)&&list.contains([66,73,85],event.keyCode)){event.preventDefault()}};this.createRange=function(){this.focus();return range.create(editable)};this.saveRange=function(thenCollapse){lastRange=this.createRange();if(thenCollapse){lastRange.collapse().select()}};this.restoreRange=function(){if(lastRange){lastRange.select();this.focus()}};this.saveTarget=function(node){$editable.data("target",node)};this.clearTarget=function(){$editable.removeData("target")};this.restoreTarget=function(){return $editable.data("target")};this.currentStyle=function(){var rng=range.create();if(rng){rng=rng.normalize()}return rng?style.current(rng):style.fromNode($editable)};this.styleFromNode=function($node){return style.fromNode($node)};this.undo=function(){context.triggerEvent("before.command",$editable.html());history.undo();context.triggerEvent("change",$editable.html())};context.memo("help.undo",lang.help.undo);this.redo=function(){context.triggerEvent("before.command",$editable.html());history.redo();context.triggerEvent("change",$editable.html())};context.memo("help.redo",lang.help.redo);var beforeCommand=this.beforeCommand=function(){context.triggerEvent("before.command",$editable.html());self.focus()};var afterCommand=this.afterCommand=function(isPreventTrigger){history.recordUndo();if(!isPreventTrigger){context.triggerEvent("change",$editable.html())}};var commands=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"];for(var idx=0,len=commands.length;idx<len;idx++){this[commands[idx]]=function(sCmd){return function(value){beforeCommand();document.execCommand(sCmd,false,value);afterCommand(true)}}(commands[idx]);context.memo("help."+commands[idx],lang.help[commands[idx]])}this.tab=function(){var rng=this.createRange();if(rng.isCollapsed()&&rng.isOnCell()){table.tab(rng)}else{beforeCommand();typing.insertTab(rng,options.tabSize);afterCommand()}};context.memo("help.tab",lang.help.tab);this.untab=function(){var rng=this.createRange();if(rng.isCollapsed()&&rng.isOnCell()){table.tab(rng,true)}};context.memo("help.untab",lang.help.untab);this.wrapCommand=function(fn){return function(){beforeCommand();fn.apply(self,arguments);afterCommand()}};this.insertParagraph=this.wrapCommand(function(){typing.insertParagraph(editable)});context.memo("help.insertParagraph",lang.help.insertParagraph);this.insertOrderedList=this.wrapCommand(function(){bullet.insertOrderedList(editable)});context.memo("help.insertOrderedList",lang.help.insertOrderedList);this.insertUnorderedList=this.wrapCommand(function(){bullet.insertUnorderedList(editable)});context.memo("help.insertUnorderedList",lang.help.insertUnorderedList);this.indent=this.wrapCommand(function(){bullet.indent(editable)});context.memo("help.indent",lang.help.indent);this.outdent=this.wrapCommand(function(){bullet.outdent(editable)});context.memo("help.outdent",lang.help.outdent);this.insertImage=function(src,param){return async.createImage(src,param).then(function($image){beforeCommand();if(typeof param==="function"){param($image)}else{if(typeof param==="string"){$image.attr("data-filename",param)}$image.css("width",Math.min($editable.width(),$image.width()))}$image.show();range.create(editable).insertNode($image[0]);range.createFromNodeAfter($image[0]).select();afterCommand()}).fail(function(e){context.triggerEvent("image.upload.error",e)})};this.insertImages=function(files){$.each(files,function(idx,file){var filename=file.name;if(options.maximumImageFileSize&&options.maximumImageFileSize<file.size){context.triggerEvent("image.upload.error",lang.image.maximumFileSizeError)}else{async.readFileAsDataURL(file).then(function(dataURL){return self.insertImage(dataURL,filename)}).fail(function(){context.triggerEvent("image.upload.error")})}})};this.insertImagesOrCallback=function(files){var callbacks=options.callbacks;if(callbacks.onImageUpload){context.triggerEvent("image.upload",files)}else{this.insertImages(files)}};this.insertNode=this.wrapCommand(function(node){var rng=this.createRange();rng.insertNode(node);range.createFromNodeAfter(node).select()});this.insertText=this.wrapCommand(function(text){var rng=this.createRange();var textNode=rng.insertNode(dom.createText(text));range.create(textNode,dom.nodeLength(textNode)).select()});this.getSelectedText=function(){var rng=this.createRange();if(rng.isOnAnchor()){rng=range.createFromNode(dom.ancestor(rng.sc,dom.isAnchor))}return rng.toString()};this.pasteHTML=this.wrapCommand(function(markup){var contents=this.createRange().pasteHTML(markup);range.createFromNodeAfter(list.last(contents)).select()});this.formatBlock=this.wrapCommand(function(tagName){tagName=agent.isMSIE?"<"+tagName+">":tagName;document.execCommand("FormatBlock",false,tagName)});this.formatPara=function(){this.formatBlock("P")};context.memo("help.formatPara",lang.help.formatPara);for(var idx=1;idx<=6;idx++){this["formatH"+idx]=function(idx){return function(){this.formatBlock("H"+idx)}}(idx);context.memo("help.formatH"+idx,lang.help["formatH"+idx])}this.fontSize=function(value){var rng=this.createRange();if(rng&&rng.isCollapsed()){var spans=style.styleNodes(rng);var firstSpan=list.head(spans);$(spans).css({"font-size":value+"px"});if(firstSpan&&!dom.nodeLength(firstSpan)){firstSpan.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR;range.createFromNodeAfter(firstSpan.firstChild).select();$editable.data(KEY_BOGUS,firstSpan)}}else{beforeCommand();$(style.styleNodes(rng)).css({"font-size":value+"px"});afterCommand()}};this.insertHorizontalRule=this.wrapCommand(function(){var hrNode=this.createRange().insertNode(dom.create("HR"));if(hrNode.nextSibling){range.create(hrNode.nextSibling,0).normalize().select()}});context.memo("help.insertHorizontalRule",lang.help.insertHorizontalRule);this.removeBogus=function(){var bogusNode=$editable.data(KEY_BOGUS);if(!bogusNode){return}var textNode=list.find(list.from(bogusNode.childNodes),dom.isText);var bogusCharIdx=textNode.nodeValue.indexOf(dom.ZERO_WIDTH_NBSP_CHAR);if(bogusCharIdx!==-1){textNode.deleteData(bogusCharIdx,1)}if(dom.isEmpty(bogusNode)){dom.remove(bogusNode)}$editable.removeData(KEY_BOGUS)};this.lineHeight=this.wrapCommand(function(value){style.stylePara(this.createRange(),{lineHeight:value})});this.unlink=function(){var rng=this.createRange();if(rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);rng=range.createFromNode(anchor);rng.select();beforeCommand();document.execCommand("unlink");afterCommand()}};this.createLink=this.wrapCommand(function(linkInfo){var linkUrl=linkInfo.url;var linkText=linkInfo.text;var isNewWindow=linkInfo.isNewWindow;var rng=linkInfo.range||this.createRange();var isTextChanged=rng.toString()!==linkText;if(typeof linkUrl==="string"){linkUrl=linkUrl.trim()}if(options.onCreateLink){linkUrl=options.onCreateLink(linkUrl)}var anchors=[];if(isTextChanged){rng=rng.deleteContents();var anchor=rng.insertNode($("<A>"+linkText+"</A>")[0]);anchors.push(anchor)}else{anchors=style.styleNodes(rng,{nodeName:"A",expandClosestSibling:true,onlyPartialContains:true})}$.each(anchors,function(idx,anchor){linkUrl=/^[A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?/.test(linkUrl)?linkUrl:"http://"+linkUrl;$(anchor).attr("href",linkUrl);if(isNewWindow){$(anchor).attr("target","_blank")}else{$(anchor).removeAttr("target")}});var startRange=range.createFromNodeBefore(list.head(anchors));var startPoint=startRange.getStartPoint();var endRange=range.createFromNodeAfter(list.last(anchors));var endPoint=endRange.getEndPoint();range.create(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset).select()});this.getLinkInfo=function(){var rng=this.createRange().expand(dom.isAnchor);var $anchor=$(list.head(rng.nodes(dom.isAnchor)));return{range:rng,text:rng.toString(),isNewWindow:$anchor.length?$anchor.attr("target")==="_blank":false,url:$anchor.length?$anchor.attr("href"):""}};this.color=this.wrapCommand(function(colorInfo){var foreColor=colorInfo.foreColor;var backColor=colorInfo.backColor;if(foreColor){document.execCommand("foreColor",false,foreColor)}if(backColor){document.execCommand("backColor",false,backColor)}});this.insertTable=this.wrapCommand(function(dim){var dimension=dim.split("x");var rng=this.createRange().deleteContents();rng.insertNode(table.createTable(dimension[0],dimension[1],options))});this.floatMe=this.wrapCommand(function(value){var $target=$(this.restoreTarget());$target.css("float",value)});this.resize=this.wrapCommand(function(value){var $target=$(this.restoreTarget());$target.css({width:value*100+"%",height:""})});this.resizeTo=function(pos,$target,bKeepRatio){var imageSize;if(bKeepRatio){var newRatio=pos.y/pos.x;var ratio=$target.data("ratio");imageSize={width:ratio>newRatio?pos.x:pos.y/ratio,height:ratio>newRatio?pos.x*ratio:pos.y}}else{imageSize={width:pos.x,height:pos.y}}$target.css(imageSize)};this.removeMedia=this.wrapCommand(function(){var $target=$(this.restoreTarget()).detach();context.triggerEvent("media.delete",$target,$editable)});this.hasFocus=function(){return $editable.is(":focus")};this.focus=function(){if(!this.hasFocus()){$editable.focus()}};this.isEmpty=function(){return dom.isEmpty($editable[0])||dom.emptyPara===$editable.html()};this.empty=function(){context.invoke("code",dom.emptyPara)}};var Clipboard=function(context){var self=this;var $editable=context.layoutInfo.editable;this.events={"summernote.keydown":function(we,e){if(self.needKeydownHook()){if((e.ctrlKey||e.metaKey)&&e.keyCode===key.code.V){context.invoke("editor.saveRange");self.$paste.focus();setTimeout(function(){self.pasteByHook()},0)}}}};this.needKeydownHook=function(){return agent.isMSIE&&agent.browserVersion>10||agent.isFF};this.initialize=function(){if(this.needKeydownHook()){this.$paste=$('<div tabindex="-1" />').attr("contenteditable",true).css({position:"absolute",left:-1e5,opacity:0});$editable.before(this.$paste);this.$paste.on("paste",function(event){context.triggerEvent("paste",event)})}else{$editable.on("paste",this.pasteByEvent)}};this.destroy=function(){if(this.needKeydownHook()){this.$paste.remove();this.$paste=null}};this.pasteByHook=function(){var node=this.$paste[0].firstChild;if(dom.isImg(node)){var dataURI=node.src;var decodedData=atob(dataURI.split(",")[1]);var array=new Uint8Array(decodedData.length);for(var i=0;i<decodedData.length;i++){array[i]=decodedData.charCodeAt(i)}var blob=new Blob([array],{type:"image/png"});blob.name="clipboard.png";context.invoke("editor.restoreRange");context.invoke("editor.focus");context.invoke("editor.insertImagesOrCallback",[blob])}else{var pasteContent=$("<div />").html(this.$paste.html()).html();context.invoke("editor.restoreRange");context.invoke("editor.focus");if(pasteContent){context.invoke("editor.pasteHTML",pasteContent)}}this.$paste.empty()};this.pasteByEvent=function(event){var clipboardData=event.originalEvent.clipboardData;if(clipboardData&&clipboardData.items&&clipboardData.items.length){var item=list.head(clipboardData.items);if(item.kind==="file"&&item.type.indexOf("image/")!==-1){context.invoke("editor.insertImagesOrCallback",[item.getAsFile()])}context.invoke("editor.afterCommand")}}};var Dropzone=function(context){var $document=$(document);var $editor=context.layoutInfo.editor;var $editable=context.layoutInfo.editable;var options=context.options;var lang=options.langInfo;var documentEventHandlers={};var $dropzone=$(['<div class="note-dropzone">','  <div class="note-dropzone-message"/>',"</div>"].join("")).prependTo($editor);var detachDocumentEvent=function(){Object.keys(documentEventHandlers).forEach(function(key){$document.off(key.substr(2).toLowerCase(),documentEventHandlers[key])});documentEventHandlers={}};this.initialize=function(){if(options.disableDragAndDrop){documentEventHandlers.onDrop=function(e){e.preventDefault()};$document.on("drop",documentEventHandlers.onDrop)}else{this.attachDragAndDropEvent()}};this.attachDragAndDropEvent=function(){var collection=$(),$dropzoneMessage=$dropzone.find(".note-dropzone-message");documentEventHandlers.onDragenter=function(e){var isCodeview=context.invoke("codeview.isActivated");var hasEditorSize=$editor.width()>0&&$editor.height()>0;if(!isCodeview&&!collection.length&&hasEditorSize){$editor.addClass("dragover");$dropzone.width($editor.width());$dropzone.height($editor.height());$dropzoneMessage.text(lang.image.dragImageHere)}collection=collection.add(e.target)};documentEventHandlers.onDragleave=function(e){collection=collection.not(e.target);if(!collection.length){$editor.removeClass("dragover")}};documentEventHandlers.onDrop=function(){collection=$();$editor.removeClass("dragover")};$document.on("dragenter",documentEventHandlers.onDragenter).on("dragleave",documentEventHandlers.onDragleave).on("drop",documentEventHandlers.onDrop);$dropzone.on("dragenter",function(){$dropzone.addClass("hover");$dropzoneMessage.text(lang.image.dropImage)}).on("dragleave",function(){$dropzone.removeClass("hover");$dropzoneMessage.text(lang.image.dragImageHere)});$dropzone.on("drop",function(event){var dataTransfer=event.originalEvent.dataTransfer;if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){event.preventDefault();$editable.focus();context.invoke("editor.insertImagesOrCallback",dataTransfer.files)}else{$.each(dataTransfer.types,function(idx,type){var content=dataTransfer.getData(type);if(type.toLowerCase().indexOf("text")>-1){context.invoke("editor.pasteHTML",content)}else{$(content).each(function(){context.invoke("editor.insertNode",this)})}})}}).on("dragover",false)};this.destroy=function(){detachDocumentEvent()}};var CodeMirror;if(agent.hasCodeMirror){if(agent.isSupportAmd){require(["codemirror"],function(cm){CodeMirror=cm})}else{CodeMirror=window.CodeMirror}}var Codeview=function(context){var $editor=context.layoutInfo.editor;var $editable=context.layoutInfo.editable;var $codable=context.layoutInfo.codable;var options=context.options;this.sync=function(){var isCodeview=this.isActivated();if(isCodeview&&agent.hasCodeMirror){$codable.data("cmEditor").save()}};this.isActivated=function(){return $editor.hasClass("codeview")};this.toggle=function(){if(this.isActivated()){this.deactivate()}else{this.activate()}context.triggerEvent("codeview.toggled")};this.activate=function(){$codable.val(dom.html($editable,options.prettifyHtml));$codable.height($editable.height());context.invoke("toolbar.updateCodeview",true);$editor.addClass("codeview");$codable.focus();if(agent.hasCodeMirror){var cmEditor=CodeMirror.fromTextArea($codable[0],options.codemirror);if(options.codemirror.tern){var server=new CodeMirror.TernServer(options.codemirror.tern);cmEditor.ternServer=server;cmEditor.on("cursorActivity",function(cm){server.updateArgHints(cm)})}cmEditor.setSize(null,$editable.outerHeight());$codable.data("cmEditor",cmEditor)}};this.deactivate=function(){if(agent.hasCodeMirror){var cmEditor=$codable.data("cmEditor");$codable.val(cmEditor.getValue());cmEditor.toTextArea()}var value=dom.value($codable,options.prettifyHtml)||dom.emptyPara;var isChange=$editable.html()!==value;$editable.html(value);$editable.height(options.height?$codable.height():"auto");$editor.removeClass("codeview");if(isChange){context.triggerEvent("change",$editable.html(),$editable)}$editable.focus();context.invoke("toolbar.updateCodeview",false)};this.destroy=function(){if(this.isActivated()){this.deactivate()}}};var EDITABLE_PADDING=24;var Statusbar=function(context){var $document=$(document);var $statusbar=context.layoutInfo.statusbar;var $editable=context.layoutInfo.editable;var options=context.options;this.initialize=function(){if(options.airMode||options.disableResizeEditor){return}$statusbar.on("mousedown",function(event){event.preventDefault();event.stopPropagation();var editableTop=$editable.offset().top-$document.scrollTop();$document.on("mousemove",function(event){var height=event.clientY-(editableTop+EDITABLE_PADDING);height=options.minheight>0?Math.max(height,options.minheight):height;height=options.maxHeight>0?Math.min(height,options.maxHeight):height;$editable.height(height)}).one("mouseup",function(){$document.off("mousemove")})})};this.destroy=function(){$statusbar.off();$statusbar.remove()}};var Fullscreen=function(context){var $editor=context.layoutInfo.editor;var $toolbar=context.layoutInfo.toolbar;var $editable=context.layoutInfo.editable;var $codable=context.layoutInfo.codable;var $window=$(window);var $scrollbar=$("html, body");this.toggle=function(){var resize=function(size){$editable.css("height",size.h);$codable.css("height",size.h);if($codable.data("cmeditor")){$codable.data("cmeditor").setsize(null,size.h)}};$editor.toggleClass("fullscreen");if(this.isFullscreen()){$editable.data("orgHeight",$editable.css("height"));$window.on("resize",function(){resize({h:$window.height()-$toolbar.outerHeight()})}).trigger("resize");$scrollbar.css("overflow","hidden")}else{$window.off("resize");resize({h:$editable.data("orgHeight")});$scrollbar.css("overflow","visible")}context.invoke("toolbar.updateFullscreen",this.isFullscreen())};this.isFullscreen=function(){return $editor.hasClass("fullscreen")}};var Handle=function(context){var self=this;var $document=$(document);var $editingArea=context.layoutInfo.editingArea;var options=context.options;this.events={"summernote.mousedown":function(we,e){if(self.update(e.target)){e.preventDefault()}},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){self.update()}};this.initialize=function(){this.$handle=$(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',options.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',options.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo($editingArea);this.$handle.on("mousedown",function(event){if(dom.isControlSizing(event.target)){event.preventDefault();event.stopPropagation();var $target=self.$handle.find(".note-control-selection").data("target"),posStart=$target.offset(),scrollTop=$document.scrollTop();$document.on("mousemove",function(event){context.invoke("editor.resizeTo",{x:event.clientX-posStart.left,y:event.clientY-(posStart.top-scrollTop)},$target,!event.shiftKey);self.update($target[0])}).one("mouseup",function(e){e.preventDefault();$document.off("mousemove");context.invoke("editor.afterCommand")});if(!$target.data("ratio")){$target.data("ratio",$target.height()/$target.width())}}})};this.destroy=function(){this.$handle.remove()};this.update=function(target){var isImage=dom.isImg(target);var $selection=this.$handle.find(".note-control-selection");context.invoke("imagePopover.update",target);if(isImage){var $image=$(target);var pos=$image.position();var imageSize={w:$image.outerWidth(true),h:$image.outerHeight(true)};$selection.css({display:"block",left:pos.left,top:pos.top,width:imageSize.w,height:imageSize.h}).data("target",$image);var sizingText=imageSize.w+"x"+imageSize.h;$selection.find(".note-control-selection-info").text(sizingText);context.invoke("editor.saveTarget",target)}else{this.hide()}return isImage};this.hide=function(){context.invoke("editor.clearTarget");this.$handle.children().hide()}};var AutoLink=function(context){var self=this;var defaultScheme="http://";var linkPattern=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i;this.events={"summernote.keyup":function(we,e){if(!e.isDefaultPrevented()){self.handleKeyup(e)}},"summernote.keydown":function(we,e){self.handleKeydown(e)}};this.initialize=function(){this.lastWordRange=null};this.destroy=function(){this.lastWordRange=null};this.replace=function(){if(!this.lastWordRange){return}var keyword=this.lastWordRange.toString();var match=keyword.match(linkPattern);if(match&&(match[1]||match[2])){var link=match[1]?keyword:defaultScheme+keyword;var node=$("<a />").html(keyword).attr("href",link)[0];this.lastWordRange.insertNode(node);this.lastWordRange=null;context.invoke("editor.focus")}};this.handleKeydown=function(e){if(list.contains([key.code.ENTER,key.code.SPACE],e.keyCode)){var wordRange=context.invoke("editor.createRange").getWordRange();this.lastWordRange=wordRange}};this.handleKeyup=function(e){if(list.contains([key.code.ENTER,key.code.SPACE],e.keyCode)){this.replace()}}};var AutoSync=function(context){var $note=context.layoutInfo.note;this.events={"summernote.change":function(){$note.val(context.invoke("code"))}};this.shouldInitialize=function(){return dom.isTextarea($note[0])}};var Placeholder=function(context){var self=this;var $editingArea=context.layoutInfo.editingArea;var options=context.options;this.events={"summernote.init summernote.change":function(){self.update()},"summernote.codeview.toggled":function(){self.update()}};this.shouldInitialize=function(){return!!options.placeholder};this.initialize=function(){this.$placeholder=$('<div class="note-placeholder">');this.$placeholder.on("click",function(){context.invoke("focus")}).text(options.placeholder).prependTo($editingArea)};this.destroy=function(){this.$placeholder.remove()};this.update=function(){var isShow=!context.invoke("codeview.isActivated")&&context.invoke("editor.isEmpty");this.$placeholder.toggle(isShow)}};var Buttons=function(context){var self=this;var ui=$.summernote.ui;var $toolbar=context.layoutInfo.toolbar;var options=context.options;var lang=options.langInfo;var invertedKeyMap=func.invertObject(options.keyMap[agent.isMac?"mac":"pc"]);var representShortcut=this.representShortcut=function(editorMethod){var shortcut=invertedKeyMap[editorMethod];if(!options.shortcuts||!shortcut){return""}if(agent.isMac){shortcut=shortcut.replace("CMD","").replace("SHIFT","")}shortcut=shortcut.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]");return" ("+shortcut+")"};this.initialize=function(){this.addToolbarButtons();this.addImagePopoverButtons();this.addLinkPopoverButtons();this.fontInstalledMap={}};this.destroy=function(){delete this.fontInstalledMap};this.isFontInstalled=function(name){if(!self.fontInstalledMap.hasOwnProperty(name)){self.fontInstalledMap[name]=agent.isFontInstalled(name)||list.contains(options.fontNamesIgnoreCheck,name)}return self.fontInstalledMap[name]};this.addToolbarButtons=function(){context.memo("button.style",function(){return ui.buttonGroup([ui.button({className:"dropdown-toggle",contents:ui.icon(options.icons.magic)+" "+ui.icon(options.icons.caret,"span"),tooltip:lang.style.style,data:{toggle:"dropdown"}}),ui.dropdown({className:"dropdown-style",items:context.options.styleTags,template:function(item){if(typeof item==="string"){item={tag:item,title:lang.style.hasOwnProperty(item)?lang.style[item]:item}}var tag=item.tag;var title=item.title;var style=item.style?' style="'+item.style+'" ':"";var className=item.className?' class="'+item.className+'"':"";return"<"+tag+style+className+">"+title+"</"+tag+">"},click:context.createInvokeHandler("editor.formatBlock")})]).render()});context.memo("button.bold",function(){return ui.button({className:"note-btn-bold",contents:ui.icon(options.icons.bold),tooltip:lang.font.bold+representShortcut("bold"),click:context.createInvokeHandler("editor.bold")}).render()});context.memo("button.italic",function(){return ui.button({className:"note-btn-italic",contents:ui.icon(options.icons.italic),tooltip:lang.font.italic+representShortcut("italic"),click:context.createInvokeHandler("editor.italic")}).render()});context.memo("button.underline",function(){return ui.button({className:"note-btn-underline",contents:ui.icon(options.icons.underline),tooltip:lang.font.underline+representShortcut("underline"),click:context.createInvokeHandler("editor.underline")}).render()});context.memo("button.clear",function(){return ui.button({contents:ui.icon(options.icons.eraser),tooltip:lang.font.clear+representShortcut("removeFormat"),click:context.createInvokeHandler("editor.removeFormat")}).render()});context.memo("button.strikethrough",function(){return ui.button({className:"note-btn-strikethrough",contents:ui.icon(options.icons.strikethrough),tooltip:lang.font.strikethrough+representShortcut("strikethrough"),click:context.createInvokeHandler("editor.strikethrough")}).render()});context.memo("button.superscript",function(){return ui.button({className:"note-btn-superscript",contents:ui.icon(options.icons.superscript),tooltip:lang.font.superscript,click:context.createInvokeHandler("editor.superscript")}).render()});context.memo("button.subscript",function(){return ui.button({className:"note-btn-subscript",contents:ui.icon(options.icons.subscript),tooltip:lang.font.subscript,click:context.createInvokeHandler("editor.subscript")}).render()});context.memo("button.fontname",function(){return ui.buttonGroup([ui.button({className:"dropdown-toggle",contents:'<span class="note-current-fontname"/> '+ui.icon(options.icons.caret,"span"),tooltip:lang.font.name,data:{toggle:"dropdown"}}),ui.dropdownCheck({className:"dropdown-fontname",checkClassName:options.icons.menuCheck,items:options.fontNames.filter(self.isFontInstalled),template:function(item){return'<span style="font-family:'+item+'">'+item+"</span>"},click:context.createInvokeHandler("editor.fontName")})]).render()});context.memo("button.fontsize",function(){return ui.buttonGroup([ui.button({className:"dropdown-toggle",contents:'<span class="note-current-fontsize"/>'+ui.icon(options.icons.caret,"span"),tooltip:lang.font.size,data:{toggle:"dropdown"}}),ui.dropdownCheck({className:"dropdown-fontsize",checkClassName:options.icons.menuCheck,items:options.fontSizes,click:context.createInvokeHandler("editor.fontSize")})]).render()});context.memo("button.color",function(){return ui.buttonGroup({className:"note-color",children:[ui.button({className:"note-current-color-button",contents:ui.icon(options.icons.font+" note-recent-color"),tooltip:lang.color.recent,click:function(e){var $button=$(e.currentTarget);context.invoke("editor.color",{backColor:$button.attr("data-backColor"),foreColor:$button.attr("data-foreColor")})},callback:function($button){var $recentColor=$button.find(".note-recent-color");$recentColor.css("background-color","#FFFF00");$button.attr("data-backColor","#FFFF00")}}),ui.button({className:"dropdown-toggle",contents:ui.icon(options.icons.caret,"span"),tooltip:lang.color.more,data:{toggle:"dropdown"}}),ui.dropdown({items:["<li>",'<div class="btn-group">','  <div class="note-palette-title">'+lang.color.background+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="backColor" data-value="inherit">',lang.color.transparent,"    </button>","  </div>",'  <div class="note-holder" data-event="backColor"/>',"</div>",'<div class="btn-group">','  <div class="note-palette-title">'+lang.color.foreground+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="removeFormat" data-value="foreColor">',lang.color.resetToDefault,"    </button>","  </div>",'  <div class="note-holder" data-event="foreColor"/>',"</div>","</li>"].join(""),callback:function($dropdown){$dropdown.find(".note-holder").each(function(){var $holder=$(this);$holder.append(ui.palette({colors:options.colors,eventName:$holder.data("event")}).render())})},click:function(event){var $button=$(event.target);var eventName=$button.data("event");var value=$button.data("value");if(eventName&&value){var key=eventName==="backColor"?"background-color":"color";var $color=$button.closest(".note-color").find(".note-recent-color");var $currentButton=$button.closest(".note-color").find(".note-current-color-button");$color.css(key,value);$currentButton.attr("data-"+eventName,value);context.invoke("editor."+eventName,value)}}})]}).render()});context.memo("button.ul",function(){return ui.button({contents:ui.icon(options.icons.unorderedlist),tooltip:lang.lists.unordered+representShortcut("insertUnorderedList"),click:context.createInvokeHandler("editor.insertUnorderedList")}).render()});context.memo("button.ol",function(){return ui.button({contents:ui.icon(options.icons.orderedlist),tooltip:lang.lists.ordered+representShortcut("insertOrderedList"),click:context.createInvokeHandler("editor.insertOrderedList")}).render()});var justifyLeft=ui.button({contents:ui.icon(options.icons.alignLeft),tooltip:lang.paragraph.left+representShortcut("justifyLeft"),click:context.createInvokeHandler("editor.justifyLeft")});var justifyCenter=ui.button({contents:ui.icon(options.icons.alignCenter),tooltip:lang.paragraph.center+representShortcut("justifyCenter"),click:context.createInvokeHandler("editor.justifyCenter")});var justifyRight=ui.button({contents:ui.icon(options.icons.alignRight),tooltip:lang.paragraph.right+representShortcut("justifyRight"),click:context.createInvokeHandler("editor.justifyRight")});var justifyFull=ui.button({contents:ui.icon(options.icons.alignJustify),tooltip:lang.paragraph.justify+representShortcut("justifyFull"),click:context.createInvokeHandler("editor.justifyFull")});var outdent=ui.button({contents:ui.icon(options.icons.outdent),tooltip:lang.paragraph.outdent+representShortcut("outdent"),click:context.createInvokeHandler("editor.outdent")});var indent=ui.button({contents:ui.icon(options.icons.indent),tooltip:lang.paragraph.indent+representShortcut("indent"),click:context.createInvokeHandler("editor.indent")});context.memo("button.justifyLeft",func.invoke(justifyLeft,"render"));context.memo("button.justifyCenter",func.invoke(justifyCenter,"render"));context.memo("button.justifyRight",func.invoke(justifyRight,"render"));context.memo("button.justifyFull",func.invoke(justifyFull,"render"));context.memo("button.outdent",func.invoke(outdent,"render"));context.memo("button.indent",func.invoke(indent,"render"));context.memo("button.paragraph",function(){return ui.buttonGroup([ui.button({className:"dropdown-toggle",contents:ui.icon(options.icons.alignLeft)+" "+ui.icon(options.icons.caret,"span"),tooltip:lang.paragraph.paragraph,data:{toggle:"dropdown"}}),ui.dropdown([ui.buttonGroup({className:"note-align",children:[justifyLeft,justifyCenter,justifyRight,justifyFull]}),ui.buttonGroup({className:"note-list",children:[outdent,indent]})])]).render()});context.memo("button.height",function(){return ui.buttonGroup([ui.button({className:"dropdown-toggle",contents:ui.icon(options.icons.textHeight)+" "+ui.icon(options.icons.caret,"span"),tooltip:lang.font.height,data:{toggle:"dropdown"}}),ui.dropdownCheck({items:options.lineHeights,checkClassName:options.icons.menuCheck,className:"dropdown-line-height",click:context.createInvokeHandler("editor.lineHeight")})]).render()});context.memo("button.table",function(){return ui.buttonGroup([ui.button({className:"dropdown-toggle",contents:ui.icon(options.icons.table)+" "+ui.icon(options.icons.caret,"span"),tooltip:lang.table.table,data:{toggle:"dropdown"}}),ui.dropdown({className:"note-table",items:['<div class="note-dimension-picker">','  <div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"/>','  <div class="note-dimension-picker-highlighted"/>','  <div class="note-dimension-picker-unhighlighted"/>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function($node){var $catcher=$node.find(".note-dimension-picker-mousecatcher");$catcher.css({width:options.insertTableMaxSize.col+"em",height:options.insertTableMaxSize.row+"em"}).mousedown(context.createInvokeHandler("editor.insertTable")).on("mousemove",self.tableMoveHandler)}}).render()});context.memo("button.link",function(){return ui.button({contents:ui.icon(options.icons.link),tooltip:lang.link.link+representShortcut("linkDialog.show"),click:context.createInvokeHandler("linkDialog.show")}).render()});context.memo("button.picture",function(){return ui.button({contents:ui.icon(options.icons.picture),tooltip:lang.image.image,click:context.createInvokeHandler("imageDialog.show")}).render()});context.memo("button.video",function(){return ui.button({contents:ui.icon(options.icons.video),tooltip:lang.video.video,click:context.createInvokeHandler("videoDialog.show")}).render()});context.memo("button.hr",function(){return ui.button({contents:ui.icon(options.icons.minus),tooltip:lang.hr.insert+representShortcut("insertHorizontalRule"),click:context.createInvokeHandler("editor.insertHorizontalRule")}).render()});context.memo("button.fullscreen",function(){return ui.button({className:"btn-fullscreen",contents:ui.icon(options.icons.arrowsAlt),tooltip:lang.options.fullscreen,click:context.createInvokeHandler("fullscreen.toggle")}).render()});context.memo("button.codeview",function(){return ui.button({className:"btn-codeview",contents:ui.icon(options.icons.code),tooltip:lang.options.codeview,click:context.createInvokeHandler("codeview.toggle")}).render()});context.memo("button.redo",function(){return ui.button({contents:ui.icon(options.icons.redo),tooltip:lang.history.redo+representShortcut("redo"),click:context.createInvokeHandler("editor.redo")}).render()});context.memo("button.undo",function(){return ui.button({contents:ui.icon(options.icons.undo),tooltip:lang.history.undo+representShortcut("undo"),click:context.createInvokeHandler("editor.undo")}).render()});context.memo("button.help",function(){return ui.button({contents:ui.icon(options.icons.question),tooltip:lang.options.help,click:context.createInvokeHandler("helpDialog.show")}).render()})};this.addImagePopoverButtons=function(){context.memo("button.imageSize100",function(){return ui.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:lang.image.resizeFull,click:context.createInvokeHandler("editor.resize","1")}).render()});context.memo("button.imageSize50",function(){return ui.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:lang.image.resizeHalf,click:context.createInvokeHandler("editor.resize","0.5")}).render()});context.memo("button.imageSize25",function(){return ui.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:lang.image.resizeQuarter,click:context.createInvokeHandler("editor.resize","0.25")}).render()});context.memo("button.floatLeft",function(){return ui.button({contents:ui.icon(options.icons.alignLeft),tooltip:lang.image.floatLeft,click:context.createInvokeHandler("editor.floatMe","left")}).render()});context.memo("button.floatRight",function(){return ui.button({contents:ui.icon(options.icons.alignRight),tooltip:lang.image.floatRight,click:context.createInvokeHandler("editor.floatMe","right")}).render()});context.memo("button.floatNone",function(){return ui.button({contents:ui.icon(options.icons.alignJustify),tooltip:lang.image.floatNone,click:context.createInvokeHandler("editor.floatMe","none")}).render()});context.memo("button.removeMedia",function(){return ui.button({contents:ui.icon(options.icons.trash),tooltip:lang.image.remove,click:context.createInvokeHandler("editor.removeMedia")}).render()})};this.addLinkPopoverButtons=function(){context.memo("button.linkDialogShow",function(){return ui.button({contents:ui.icon(options.icons.link),tooltip:lang.link.edit,click:context.createInvokeHandler("linkDialog.show")}).render()});context.memo("button.unlink",function(){return ui.button({contents:ui.icon(options.icons.unlink),tooltip:lang.link.unlink,click:context.createInvokeHandler("editor.unlink")}).render()})};this.build=function($container,groups){for(var groupIdx=0,groupLen=groups.length;groupIdx<groupLen;groupIdx++){var group=groups[groupIdx];var groupName=group[0];var buttons=group[1];var $group=ui.buttonGroup({className:"note-"+groupName}).render();for(var idx=0,len=buttons.length;idx<len;idx++){var button=context.memo("button."+buttons[idx]);if(button){$group.append(typeof button==="function"?button(context):button)}}$group.appendTo($container)}};this.updateCurrentStyle=function(){var styleInfo=context.invoke("editor.currentStyle");this.updateBtnStates({".note-btn-bold":function(){return styleInfo["font-bold"]==="bold"},".note-btn-italic":function(){return styleInfo["font-italic"]==="italic"},".note-btn-underline":function(){return styleInfo["font-underline"]==="underline"},".note-btn-subscript":function(){return styleInfo["font-subscript"]==="subscript"},".note-btn-superscript":function(){return styleInfo["font-superscript"]==="superscript"},".note-btn-strikethrough":function(){return styleInfo["font-strikethrough"]==="strikethrough"}});if(styleInfo["font-family"]){var fontNames=styleInfo["font-family"].split(",").map(function(name){return name.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")});var fontName=list.find(fontNames,self.isFontInstalled);$toolbar.find(".dropdown-fontname li a").each(function(){var isChecked=$(this).data("value")+""===fontName+"";this.className=isChecked?"checked":""});$toolbar.find(".note-current-fontname").text(fontName)}if(styleInfo["font-size"]){var fontSize=styleInfo["font-size"];$toolbar.find(".dropdown-fontsize li a").each(function(){var isChecked=$(this).data("value")+""===fontSize+"";this.className=isChecked?"checked":""});$toolbar.find(".note-current-fontsize").text(fontSize)}if(styleInfo["line-height"]){var lineHeight=styleInfo["line-height"];$toolbar.find(".dropdown-line-height li a").each(function(){var isChecked=$(this).data("value")+""===lineHeight+"";this.className=isChecked?"checked":""})}};this.updateBtnStates=function(infos){$.each(infos,function(selector,pred){ui.toggleBtnActive($toolbar.find(selector),pred())})};this.tableMoveHandler=function(event){var PX_PER_EM=18;var $picker=$(event.target.parentNode);var $dimensionDisplay=$picker.next();var $catcher=$picker.find(".note-dimension-picker-mousecatcher");var $highlighted=$picker.find(".note-dimension-picker-highlighted");var $unhighlighted=$picker.find(".note-dimension-picker-unhighlighted");var posOffset;if(event.offsetX===undefined){var posCatcher=$(event.target).offset();posOffset={x:event.pageX-posCatcher.left,y:event.pageY-posCatcher.top}}else{posOffset={x:event.offsetX,y:event.offsetY}}var dim={c:Math.ceil(posOffset.x/PX_PER_EM)||1,r:Math.ceil(posOffset.y/PX_PER_EM)||1};$highlighted.css({width:dim.c+"em",height:dim.r+"em"});$catcher.data("value",dim.c+"x"+dim.r);if(3<dim.c&&dim.c<options.insertTableMaxSize.col){$unhighlighted.css({width:dim.c+1+"em"})}if(3<dim.r&&dim.r<options.insertTableMaxSize.row){$unhighlighted.css({height:dim.r+1+"em"})}$dimensionDisplay.html(dim.c+" x "+dim.r)}};var Toolbar=function(context){var ui=$.summernote.ui;var $note=context.layoutInfo.note;var $toolbar=context.layoutInfo.toolbar;var options=context.options;this.shouldInitialize=function(){return!options.airMode};this.initialize=function(){options.toolbar=options.toolbar||[];if(!options.toolbar.length){$toolbar.hide()}else{context.invoke("buttons.build",$toolbar,options.toolbar)}if(options.toolbarContainer){$toolbar.appendTo(options.toolbarContainer)}$note.on("summernote.keyup summernote.mouseup summernote.change",function(){context.invoke("buttons.updateCurrentStyle")});context.invoke("buttons.updateCurrentStyle")};this.destroy=function(){$toolbar.children().remove()};this.updateFullscreen=function(isFullscreen){ui.toggleBtnActive($toolbar.find(".btn-fullscreen"),isFullscreen)};this.updateCodeview=function(isCodeview){ui.toggleBtnActive($toolbar.find(".btn-codeview"),isCodeview);if(isCodeview){this.deactivate()}else{this.activate()}};this.activate=function(isIncludeCodeview){var $btn=$toolbar.find("button");if(!isIncludeCodeview){$btn=$btn.not(".btn-codeview")}ui.toggleBtn($btn,true)};this.deactivate=function(isIncludeCodeview){var $btn=$toolbar.find("button");if(!isIncludeCodeview){$btn=$btn.not(".btn-codeview")}ui.toggleBtn($btn,false)}};var LinkDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var body='<div class="form-group">'+"<label>"+lang.link.textToDisplay+"</label>"+'<input class="note-link-text form-control" type="text" />'+"</div>"+'<div class="form-group">'+"<label>"+lang.link.url+"</label>"+'<input class="note-link-url form-control" type="text" value="http://" />'+"</div>"+(!options.disableLinkTarget?'<div class="checkbox">'+"<label>"+'<input type="checkbox" checked> '+lang.link.openInNewWindow+"</label>"+"</div>":"");var footer='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+lang.link.insert+"</button>";this.$dialog=ui.dialog({className:"link-dialog",title:lang.link.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container)};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove()};this.bindEnterKey=function($input,$btn){$input.on("keypress",function(event){if(event.keyCode===key.code.ENTER){$btn.trigger("click")}})};this.toggleLinkBtn=function($linkBtn,$linkText,$linkUrl){ui.toggleBtn($linkBtn,$linkText.val()&&$linkUrl.val())};this.showLinkDialog=function(linkInfo){return $.Deferred(function(deferred){var $linkText=self.$dialog.find(".note-link-text"),$linkUrl=self.$dialog.find(".note-link-url"),$linkBtn=self.$dialog.find(".note-link-btn"),$openInNewWindow=self.$dialog.find("input[type=checkbox]");ui.onDialogShown(self.$dialog,function(){context.triggerEvent("dialog.shown");if(!linkInfo.url){linkInfo.url=linkInfo.text}$linkText.val(linkInfo.text);var handleLinkTextUpdate=function(){self.toggleLinkBtn($linkBtn,$linkText,$linkUrl);linkInfo.text=$linkText.val()};$linkText.on("input",handleLinkTextUpdate).on("paste",function(){setTimeout(handleLinkTextUpdate,0)});var handleLinkUrlUpdate=function(){self.toggleLinkBtn($linkBtn,$linkText,$linkUrl);if(!linkInfo.text){$linkText.val($linkUrl.val())}};$linkUrl.on("input",handleLinkUrlUpdate).on("paste",function(){setTimeout(handleLinkUrlUpdate,0)}).val(linkInfo.url).trigger("focus");self.toggleLinkBtn($linkBtn,$linkText,$linkUrl);self.bindEnterKey($linkUrl,$linkBtn);self.bindEnterKey($linkText,$linkBtn);$openInNewWindow.prop("checked",linkInfo.isNewWindow);$linkBtn.one("click",function(event){event.preventDefault();deferred.resolve({range:linkInfo.range,url:$linkUrl.val(),text:$linkText.val(),isNewWindow:$openInNewWindow.is(":checked")});self.$dialog.modal("hide")})});ui.onDialogHidden(self.$dialog,function(){$linkText.off("input paste keypress");$linkUrl.off("input paste keypress");$linkBtn.off("click");if(deferred.state()==="pending"){deferred.reject()}});ui.showDialog(self.$dialog)}).promise()};this.show=function(){var linkInfo=context.invoke("editor.getLinkInfo");context.invoke("editor.saveRange");this.showLinkDialog(linkInfo).then(function(linkInfo){context.invoke("editor.restoreRange");context.invoke("editor.createLink",linkInfo)}).fail(function(){context.invoke("editor.restoreRange")})};context.memo("help.linkDialog.show",options.langInfo.help["linkDialog.show"])};var LinkPopover=function(context){var self=this;var ui=$.summernote.ui;var options=context.options;this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){self.update()},"summernote.dialog.shown":function(){self.hide()}};this.shouldInitialize=function(){return!list.isEmpty(options.popover.link)};this.initialize=function(){this.$popover=ui.popover({className:"note-link-popover",callback:function($node){var $content=$node.find(".popover-content");$content.prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo("body");var $content=this.$popover.find(".popover-content");context.invoke("buttons.build",$content,options.popover.link)};this.destroy=function(){this.$popover.remove()};this.update=function(){if(!context.invoke("editor.hasFocus")){this.hide();return}var rng=context.invoke("editor.createRange");if(rng.isCollapsed()&&rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);var href=$(anchor).attr("href");this.$popover.find("a").attr("href",href).html(href);var pos=dom.posFromPlaceholder(anchor);this.$popover.css({display:"block",left:pos.left,top:pos.top})}else{this.hide()}};this.hide=function(){this.$popover.hide()}};var ImageDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var imageLimitation="";if(options.maximumImageFileSize){var unit=Math.floor(Math.log(options.maximumImageFileSize)/Math.log(1024));var readableSize=(options.maximumImageFileSize/Math.pow(1024,unit)).toFixed(2)*1+" "+" KMGTP"[unit]+"B";imageLimitation="<small>"+lang.image.maximumFileSize+" : "+readableSize+"</small>"}var body='<div class="form-group note-group-select-from-files">'+"<label>"+lang.image.selectFromFiles+"</label>"+'<input class="note-image-input form-control" type="file" name="files" accept="image/*" multiple="multiple" />'+imageLimitation+"</div>"+'<div class="form-group note-group-image-url" style="overflow:auto;">'+"<label>"+lang.image.url+"</label>"+'<input class="note-image-url form-control col-md-12" type="text" />'+"</div>";var footer='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+lang.image.insert+"</button>";this.$dialog=ui.dialog({title:lang.image.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container)};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove()};this.bindEnterKey=function($input,$btn){$input.on("keypress",function(event){if(event.keyCode===key.code.ENTER){$btn.trigger("click")}})};this.show=function(){context.invoke("editor.saveRange");this.showImageDialog().then(function(data){ui.hideDialog(self.$dialog);context.invoke("editor.restoreRange");if(typeof data==="string"){context.invoke("editor.insertImage",data)}else{context.invoke("editor.insertImagesOrCallback",data)}}).fail(function(){context.invoke("editor.restoreRange")})};this.showImageDialog=function(){return $.Deferred(function(deferred){var $imageInput=self.$dialog.find(".note-image-input"),$imageUrl=self.$dialog.find(".note-image-url"),$imageBtn=self.$dialog.find(".note-image-btn");ui.onDialogShown(self.$dialog,function(){context.triggerEvent("dialog.shown");$imageInput.replaceWith($imageInput.clone().on("change",function(){deferred.resolve(this.files||this.value)}).val(""));$imageBtn.click(function(event){event.preventDefault();deferred.resolve($imageUrl.val())});$imageUrl.on("keyup paste",function(){var url=$imageUrl.val();ui.toggleBtn($imageBtn,url)}).val("").trigger("focus");self.bindEnterKey($imageUrl,$imageBtn)});ui.onDialogHidden(self.$dialog,function(){$imageInput.off("change");$imageUrl.off("keyup paste keypress");$imageBtn.off("click");if(deferred.state()==="pending"){deferred.reject()}});ui.showDialog(self.$dialog)})}};var ImagePopover=function(context){var ui=$.summernote.ui;var options=context.options;this.shouldInitialize=function(){return!list.isEmpty(options.popover.image)};this.initialize=function(){this.$popover=ui.popover({className:"note-image-popover"}).render().appendTo("body");var $content=this.$popover.find(".popover-content");context.invoke("buttons.build",$content,options.popover.image)};this.destroy=function(){this.$popover.remove()};this.update=function(target){if(dom.isImg(target)){var pos=dom.posFromPlaceholder(target);this.$popover.css({display:"block",left:pos.left,top:pos.top})}else{this.hide()}};this.hide=function(){this.$popover.hide()}};var VideoDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var body='<div class="form-group row-fluid">'+"<label>"+lang.video.url+' <small class="text-muted">'+lang.video.providers+"</small></label>"+'<input class="note-video-url form-control span12" type="text" />'+"</div>";var footer='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+lang.video.insert+"</button>";this.$dialog=ui.dialog({title:lang.video.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container)};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove()};this.bindEnterKey=function($input,$btn){$input.on("keypress",function(event){if(event.keyCode===key.code.ENTER){$btn.trigger("click")}})};this.createVideoNode=function(url){var ytRegExp=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;var ytMatch=url.match(ytRegExp);var igRegExp=/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/;var igMatch=url.match(igRegExp);var vRegExp=/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/;var vMatch=url.match(vRegExp);var vimRegExp=/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/;var vimMatch=url.match(vimRegExp);var dmRegExp=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/;var dmMatch=url.match(dmRegExp);var youkuRegExp=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/;var youkuMatch=url.match(youkuRegExp);var mp4RegExp=/^.+.(mp4|m4v)$/;var mp4Match=url.match(mp4RegExp);var oggRegExp=/^.+.(ogg|ogv)$/;var oggMatch=url.match(oggRegExp);var webmRegExp=/^.+.(webm)$/;var webmMatch=url.match(webmRegExp);var $video;if(ytMatch&&ytMatch[1].length===11){var youtubeId=ytMatch[1];$video=$("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+youtubeId).attr("width","640").attr("height","360")}else if(igMatch&&igMatch[0].length){$video=$("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+igMatch[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true")}else if(vMatch&&vMatch[0].length){$video=$("<iframe>").attr("frameborder",0).attr("src",vMatch[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed")}else if(vimMatch&&vimMatch[3].length){$video=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+vimMatch[3]).attr("width","640").attr("height","360")}else if(dmMatch&&dmMatch[2].length){$video=$("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+dmMatch[2]).attr("width","640").attr("height","360")}else if(youkuMatch&&youkuMatch[1].length){$video=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+youkuMatch[1])}else if(mp4Match||oggMatch||webmMatch){$video=$("<video controls>").attr("src",url).attr("width","640").attr("height","360")}else{return false}$video.addClass("note-video-clip");return $video[0]};this.show=function(){var text=context.invoke("editor.getSelectedText");context.invoke("editor.saveRange");this.showVideoDialog(text).then(function(url){ui.hideDialog(self.$dialog);context.invoke("editor.restoreRange");var $node=self.createVideoNode(url);if($node){context.invoke("editor.insertNode",$node)}}).fail(function(){context.invoke("editor.restoreRange")})};this.showVideoDialog=function(text){return $.Deferred(function(deferred){var $videoUrl=self.$dialog.find(".note-video-url"),$videoBtn=self.$dialog.find(".note-video-btn");ui.onDialogShown(self.$dialog,function(){context.triggerEvent("dialog.shown");$videoUrl.val(text).on("input",function(){ui.toggleBtn($videoBtn,$videoUrl.val())}).trigger("focus");$videoBtn.click(function(event){event.preventDefault();deferred.resolve($videoUrl.val())});self.bindEnterKey($videoUrl,$videoBtn)});ui.onDialogHidden(self.$dialog,function(){$videoUrl.off("input");$videoBtn.off("click");if(deferred.state()==="pending"){deferred.reject()}});ui.showDialog(self.$dialog)})}};var HelpDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.createShortCutList=function(){var keyMap=options.keyMap[agent.isMac?"mac":"pc"];return Object.keys(keyMap).map(function(key){var command=keyMap[key];var $row=$('<div><div class="help-list-item"/></div>');$row.append($("<label><kbd>"+key+"</kdb></label>").css({width:180,"margin-right":10})).append($("<span/>").html(context.memo("help."+command)||command));return $row.html()}).join("")};this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var body=['<p class="text-center">','<a href="http://summernote.org/" target="_blank">Summernote 0.8.2</a>  ','<a href="https://github.com/summernote/summernote" target="_blank">Project</a>  ','<a href="https://github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=ui.dialog({title:lang.options.help,fade:options.dialogsFade,body:this.createShortCutList(),footer:body,callback:function($node){$node.find(".modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo($container)};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove()};this.showHelpDialog=function(){return $.Deferred(function(deferred){ui.onDialogShown(self.$dialog,function(){context.triggerEvent("dialog.shown");deferred.resolve()});ui.showDialog(self.$dialog)}).promise()};this.show=function(){context.invoke("editor.saveRange");this.showHelpDialog().then(function(){context.invoke("editor.restoreRange")})}};var AirPopover=function(context){var self=this;var ui=$.summernote.ui;var options=context.options;var AIR_MODE_POPOVER_X_OFFSET=20;this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){self.update()},"summernote.change summernote.dialog.shown":function(){self.hide()},"summernote.focusout":function(we,e){if(agent.isFF){return}if(!e.relatedTarget||!dom.ancestor(e.relatedTarget,func.eq(self.$popover[0]))){self.hide()}}};this.shouldInitialize=function(){return options.airMode&&!list.isEmpty(options.popover.air)};this.initialize=function(){this.$popover=ui.popover({className:"note-air-popover"}).render().appendTo("body");var $content=this.$popover.find(".popover-content");context.invoke("buttons.build",$content,options.popover.air)};this.destroy=function(){this.$popover.remove()};this.update=function(){var styleInfo=context.invoke("editor.currentStyle");if(styleInfo.range&&!styleInfo.range.isCollapsed()){var rect=list.last(styleInfo.range.getClientRects());if(rect){var bnd=func.rect2bnd(rect);this.$popover.css({display:"block",left:Math.max(bnd.left+bnd.width/2,0)-AIR_MODE_POPOVER_X_OFFSET,top:bnd.top+bnd.height})}}else{this.hide()}};this.hide=function(){this.$popover.hide()}};var HintPopover=function(context){var self=this;var ui=$.summernote.ui;var POPOVER_DIST=5;var hint=context.options.hint||[];var direction=context.options.hintDirection||"bottom";var hints=$.isArray(hint)?hint:[hint];this.events={"summernote.keyup":function(we,e){if(!e.isDefaultPrevented()){self.handleKeyup(e)}},"summernote.keydown":function(we,e){self.handleKeydown(e)},"summernote.dialog.shown":function(){self.hide()}};this.shouldInitialize=function(){return hints.length>0};this.initialize=function(){this.lastWordRange=null;this.$popover=ui.popover({className:"note-hint-popover",hideArrow:true,direction:""}).render().appendTo("body");this.$popover.hide();this.$content=this.$popover.find(".popover-content");this.$content.on("click",".note-hint-item",function(){self.$content.find(".active").removeClass("active");$(this).addClass("active");self.replace()})};this.destroy=function(){this.$popover.remove()};this.selectItem=function($item){this.$content.find(".active").removeClass("active");$item.addClass("active");this.$content[0].scrollTop=$item[0].offsetTop-this.$content.innerHeight()/2};this.moveDown=function(){var $current=this.$content.find(".note-hint-item.active");var $next=$current.next();if($next.length){this.selectItem($next)}else{var $nextGroup=$current.parent().next();if(!$nextGroup.length){$nextGroup=this.$content.find(".note-hint-group").first()}this.selectItem($nextGroup.find(".note-hint-item").first())}};this.moveUp=function(){var $current=this.$content.find(".note-hint-item.active");var $prev=$current.prev();if($prev.length){this.selectItem($prev)}else{var $prevGroup=$current.parent().prev();if(!$prevGroup.length){$prevGroup=this.$content.find(".note-hint-group").last()}this.selectItem($prevGroup.find(".note-hint-item").last())}};this.replace=function(){var $item=this.$content.find(".note-hint-item.active");if($item.length){var node=this.nodeFromItem($item);this.lastWordRange.insertNode(node);range.createFromNode(node).collapse().select();this.lastWordRange=null;this.hide();context.invoke("editor.focus")}};this.nodeFromItem=function($item){var hint=hints[$item.data("index")];var item=$item.data("item");var node=hint.content?hint.content(item):item;if(typeof node==="string"){node=dom.createText(node)}return node};this.createItemTemplates=function(hintIdx,items){var hint=hints[hintIdx];return items.map(function(item,idx){var $item=$('<div class="note-hint-item"/>');$item.append(hint.template?hint.template(item):item+"");$item.data({index:hintIdx,item:item});if(hintIdx===0&&idx===0){$item.addClass("active")}return $item})};this.handleKeydown=function(e){if(!this.$popover.is(":visible")){return}if(e.keyCode===key.code.ENTER){e.preventDefault();this.replace()}else if(e.keyCode===key.code.UP){e.preventDefault();this.moveUp()}else if(e.keyCode===key.code.DOWN){e.preventDefault();this.moveDown()}};this.searchKeyword=function(index,keyword,callback){var hint=hints[index];if(hint&&hint.match.test(keyword)&&hint.search){var matches=hint.match.exec(keyword);hint.search(matches[1],callback)}else{callback()}};this.createGroup=function(idx,keyword){var $group=$('<div class="note-hint-group note-hint-group-'+idx+'"/>');this.searchKeyword(idx,keyword,function(items){items=items||[];if(items.length){$group.html(self.createItemTemplates(idx,items));self.show()}});return $group};this.handleKeyup=function(e){if(list.contains([key.code.ENTER,key.code.UP,key.code.DOWN],e.keyCode)){if(e.keyCode===key.code.ENTER){if(this.$popover.is(":visible")){return}}}else{var wordRange=context.invoke("editor.createRange").getWordRange();var keyword=wordRange.toString();if(hints.length&&keyword){this.$content.empty();var bnd=func.rect2bnd(list.last(wordRange.getClientRects()));if(bnd){this.$popover.hide();this.lastWordRange=wordRange;hints.forEach(function(hint,idx){if(hint.match.test(keyword)){self.createGroup(idx,keyword).appendTo(self.$content)}});if(direction==="top"){this.$popover.css({left:bnd.left,top:bnd.top-this.$popover.outerHeight()-POPOVER_DIST})}else{this.$popover.css({left:bnd.left,top:bnd.top+bnd.height+POPOVER_DIST})}}}else{this.hide()}}};this.show=function(){this.$popover.show()};this.hide=function(){this.$popover.hide()}};$.summernote=$.extend($.summernote,{version:"0.8.2",ui:ui,dom:dom,plugins:{},options:{modules:{editor:Editor,clipboard:Clipboard,dropzone:Dropzone,codeview:Codeview,statusbar:Statusbar,fullscreen:Fullscreen,handle:Handle,hintPopover:HintPopover,autoLink:AutoLink,autoSync:AutoSync,placeholder:Placeholder,buttons:Buttons,toolbar:Toolbar,linkDialog:LinkDialog,linkPopover:LinkPopover,imageDialog:ImageDialog,imagePopover:ImagePopover,videoDialog:VideoDialog,helpDialog:HelpDialog,airPopover:AirPopover},buttons:{},lang:"en-US",toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},airMode:false,width:null,height:null,focus:false,tabSize:4,styleWithSpan:true,shortcuts:true,textareaAutoSync:true,direction:null,styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:false,dialogsFade:false,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onEnter:null,onKeyup:null,onKeydown:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:true,lineNumbers:true},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}})});
(function($){$.extend($.summernote.lang,{"pt-BR":{font:{bold:"Negrito",italic:"Itlico",underline:"Sublinhado",clear:"Remover estilo da fonte",height:"Altura da linha",name:"Fonte",strikethrough:"Riscado",size:"Tamanho da fonte"},image:{image:"Imagem",insert:"Inserir imagem",resizeFull:"Redimensionar Completamente",resizeHalf:"Redimensionar pela Metade",resizeQuarter:"Redimensionar um Quarto",floatLeft:"Flutuar para Esquerda",floatRight:"Flutuar para Direira",floatNone:"No Flutuar",dragImageHere:"Arraste uma imagem para c",selectFromFiles:"Selecione a partir dos arquivos",url:"URL da imagem"},video:{video:"Vdeo",videoLink:"Link para vdeo",insert:"Inserir vdeo",url:"URL do vdeo?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion ou Youku)"},link:{link:"Link",insert:"Inserir link",unlink:"Remover link",edit:"Editar",textToDisplay:"Texto para exibir",url:"Para qual URL esse link leva?",openInNewWindow:"Abrir em uma nova janela"},table:{table:"Tabela"},hr:{insert:"Inserir linha horizontal"},style:{style:"Estilo",normal:"Normal",blockquote:"Citao",pre:"Cdigo",h1:"Ttulo 1",h2:"Ttulo 2",h3:"Ttulo 3",h4:"Ttulo 4",h5:"Ttulo 5",h6:"Ttulo 6"},lists:{unordered:"Lista com marcadores",ordered:"Lista numerada"},options:{help:"Ajuda",fullscreen:"Tela cheia",codeview:"Ver cdigo-fonte"},paragraph:{paragraph:"Pargrafo",outdent:"Menor tabulao",indent:"Maior tabulao",left:"Alinhar  esquerda",center:"Alinhar ao centro",right:"Alinha  direita",justify:"Justificado"},color:{recent:"Cor recente",more:"Mais cores",background:"Fundo",foreground:"Fonte",transparent:"Transparente",setTransparent:"Fundo transparente",reset:"Restaurar",resetToDefault:"Restaurar padro"},shortcut:{shortcuts:"Atalhos do teclado",close:"Fechar",textFormatting:"Formatao de texto",action:"Ao",paragraphFormatting:"Formatao de pargrafo",documentStyle:"Estilo de documento"},history:{undo:"Desfazer",redo:"Refazer"},help:{insertParagraph:"Inserir Pargrafo",undo:"Desfazer o ltimo comando",redo:"Refazer o ltimo comando",tab:"Tab",untab:"Desfazer tab",bold:"Colocar em negrito",italic:"Colocar em itlico",underline:"Sublinhado",strikethrough:"Tachado",removeFormat:"Remover estilo",justifyLeft:"Alinhar  esquerda",justifyCenter:"Centralizar",justifyRight:"Alinhar  esquerda",justifyFull:"Justificar",insertUnorderedList:"Lista no ordenada",insertOrderedList:"Lista ordenada",outdent:"Recuar pargrafo atual",indent:"Avanar pargrafo atual",formatPara:"Alterar formato do bloco para pargrafo(tag P)",formatH1:"Alterar formato do bloco para H1",formatH2:"Alterar formato do bloco para H2",formatH3:"Alterar formato do bloco para H3",formatH4:"Alterar formato do bloco para H4",formatH5:"Alterar formato do bloco para H5",formatH6:"Alterar formato do bloco para H6",insertHorizontalRule:"Inserir rgua horizontal","linkDialog.show":"Inserir um Hiperlink"}}})})(jQuery);
!function(t){if("function"==typeof define&&define.amd&&define("uikit",function(){var i=window.UIkit||t(window,window.jQuery,window.document);return i.load=function(t,e,n,o){var s,a=t.split(","),r=[],l=(o.config&&o.config.uikit&&o.config.uikit.base?o.config.uikit.base:"").replace(/\/+$/g,"");if(!l)throw new Error("Please define base path to UIkit in the requirejs config.");for(s=0;s<a.length;s+=1){var c=a[s].replace(/\./g,"/");r.push(l+"/components/"+c)}e(r,function(){n(i)})},i}),!window.jQuery)throw new Error("UIkit requires jQuery");window&&window.jQuery&&t(window,window.jQuery,window.document)}(function(t,i,e){"use strict";var n={},o=t.UIkit?Object.create(t.UIkit):void 0;if(n.version="2.27.1",n.noConflict=function(){return o&&(t.UIkit=o,i.UIkit=o,i.fn.uk=o.fn),n},n.prefix=function(t){return t},n.$=i,n.$doc=n.$(document),n.$win=n.$(window),n.$html=n.$("html"),n.support={},n.support.transition=function(){var t=function(){var t,i=e.body||e.documentElement,n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in n)if(void 0!==i.style[t])return n[t]}();return t&&{end:t}}(),n.support.animation=function(){var t=function(){var t,i=e.body||e.documentElement,n={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(t in n)if(void 0!==i.style[t])return n[t]}();return t&&{end:t}}(),function(){Date.now=Date.now||function(){return(new Date).getTime()};for(var t=["webkit","moz"],i=0;i<t.length&&!window.requestAnimationFrame;++i){var e=t[i];window.requestAnimationFrame=window[e+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var n=0;window.requestAnimationFrame=function(t){var i=Date.now(),e=Math.max(n+16,i);return setTimeout(function(){t(n=e)},e-i)},window.cancelAnimationFrame=clearTimeout}}(),n.support.touch="ontouchstart"in document||t.DocumentTouch&&document instanceof t.DocumentTouch||t.navigator.msPointerEnabled&&t.navigator.msMaxTouchPoints>0||t.navigator.pointerEnabled&&t.navigator.maxTouchPoints>0||!1,n.support.mutationobserver=t.MutationObserver||t.WebKitMutationObserver||null,n.Utils={},n.Utils.isFullscreen=function(){return document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.fullscreenElement||!1},n.Utils.str2json=function(t,i){try{return i?JSON.parse(t.replace(/([\$\w]+)\s*:/g,function(t,i){return'"'+i+'":'}).replace(/'([^']+)'/g,function(t,i){return'"'+i+'"'})):new Function("","var json = "+t+"; return JSON.parse(JSON.stringify(json));")()}catch(e){return!1}},n.Utils.debounce=function(t,i,e){var n;return function(){var o=this,s=arguments,a=function(){n=null,e||t.apply(o,s)},r=e&&!n;clearTimeout(n),n=setTimeout(a,i),r&&t.apply(o,s)}},n.Utils.throttle=function(t,i){var e=!1;return function(){e||(t.call(),e=!0,setTimeout(function(){e=!1},i))}},n.Utils.removeCssRules=function(t){var i,e,n,o,s,a,r,l,c,u;t&&setTimeout(function(){try{for(u=document.styleSheets,o=0,r=u.length;r>o;o++){for(n=u[o],e=[],n.cssRules=n.cssRules,i=s=0,l=n.cssRules.length;l>s;i=++s)n.cssRules[i].type===CSSRule.STYLE_RULE&&t.test(n.cssRules[i].selectorText)&&e.unshift(i);for(a=0,c=e.length;c>a;a++)n.deleteRule(e[a])}}catch(d){}},0)},n.Utils.isInView=function(t,e){var o=i(t);if(!o.is(":visible"))return!1;var s=n.$win.scrollLeft(),a=n.$win.scrollTop(),r=o.offset(),l=r.left,c=r.top;return e=i.extend({topoffset:0,leftoffset:0},e),c+o.height()>=a&&c-e.topoffset<=a+n.$win.height()&&l+o.width()>=s&&l-e.leftoffset<=s+n.$win.width()?!0:!1},n.Utils.checkDisplay=function(t,e){var o=n.$("[data-uk-margin], [data-uk-grid-match], [data-uk-grid-margin], [data-uk-check-display]",t||document);return t&&!o.length&&(o=i(t)),o.trigger("display.uk.check"),e&&("string"!=typeof e&&(e='[class*="uk-animation-"]'),o.find(e).each(function(){var t=n.$(this),i=t.attr("class"),e=i.match(/uk-animation-(.+)/);t.removeClass(e[0]).width(),t.addClass(e[0])})),o},n.Utils.options=function(t){if("string"!=i.type(t))return t;-1!=t.indexOf(":")&&"}"!=t.trim().substr(-1)&&(t="{"+t+"}");var e=t?t.indexOf("{"):-1,o={};if(-1!=e)try{o=n.Utils.str2json(t.substr(e))}catch(s){}return o},n.Utils.animate=function(t,e){var o=i.Deferred();return t=n.$(t),t.css("display","none").addClass(e).one(n.support.animation.end,function(){t.removeClass(e),o.resolve()}),t.css("display",""),o.promise()},n.Utils.uid=function(t){return(t||"id")+(new Date).getTime()+"RAND"+Math.ceil(1e5*Math.random())},n.Utils.template=function(t,i){for(var e,n,o,s,a=t.replace(/\n/g,"\\n").replace(/\{\{\{\s*(.+?)\s*\}\}\}/g,"{{!$1}}").split(/(\{\{\s*(.+?)\s*\}\})/g),r=0,l=[],c=0;r<a.length;){if(e=a[r],e.match(/\{\{\s*(.+?)\s*\}\}/))switch(r+=1,e=a[r],n=e[0],o=e.substring(e.match(/^(\^|\#|\!|\~|\:)/)?1:0),n){case"~":l.push("for(var $i=0;$i<"+o+".length;$i++) { var $item = "+o+"[$i];"),c++;break;case":":l.push("for(var $key in "+o+") { var $val = "+o+"[$key];"),c++;break;case"#":l.push("if("+o+") {"),c++;break;case"^":l.push("if(!"+o+") {"),c++;break;case"/":l.push("}"),c--;break;case"!":l.push("__ret.push("+o+");");break;default:l.push("__ret.push(escape("+o+"));")}else l.push("__ret.push('"+e.replace(/\'/g,"\\'")+"');");r+=1}return s=new Function("$data",["var __ret = [];","try {","with($data){",c?'__ret = ["Not all blocks are closed correctly."]':l.join(""),"};","}catch(e){__ret = [e.message];}",'return __ret.join("").replace(/\\n\\n/g, "\\n");',"function escape(html) { return String(html).replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');}"].join("\n")),i?s(i):s},n.Utils.focus=function(t,e){t=i(t);var n,o=t.find("[autofocus]:first");return o.length?o.focus():(o=t.find(":input"+(e&&","+e||"")).first(),o.length?o.focus():(t.attr("tabindex")||(n=1e3,t.attr("tabindex",n)),t[0].focus(),n&&t.attr("tabindex",""),t))},n.Utils.events={},n.Utils.events.click=n.support.touch?"tap":"click",t.UIkit=n,n.fn=function(t,e){var o=arguments,s=t.match(/^([a-z\-]+)(?:\.([a-z]+))?/i),a=s[1],r=s[2];return n[a]?this.each(function(){var t=i(this),s=t.data(a);s||t.data(a,s=n[a](this,r?void 0:e)),r&&s[r].apply(s,Array.prototype.slice.call(o,1))}):(i.error("UIkit component ["+a+"] does not exist."),this)},i.UIkit=n,i.fn.uk=n.fn,n.langdirection="rtl"==n.$html.attr("dir")?"right":"left",n.components={},n.component=function(t,e){var o=function(e,s){var a=this;return this.UIkit=n,this.element=e?n.$(e):null,this.options=i.extend(!0,{},this.defaults,s),this.plugins={},this.element&&this.element.data(t,this),this.init(),(this.options.plugins.length?this.options.plugins:Object.keys(o.plugins)).forEach(function(t){o.plugins[t].init&&(o.plugins[t].init(a),a.plugins[t]=!0)}),this.trigger("init.uk.component",[t,this]),this};return o.plugins={},i.extend(!0,o.prototype,{defaults:{plugins:[]},boot:function(){},init:function(){},on:function(t,i,e){return n.$(this.element||this).on(t,i,e)},one:function(t,i,e){return n.$(this.element||this).one(t,i,e)},off:function(t){return n.$(this.element||this).off(t)},trigger:function(t,i){return n.$(this.element||this).trigger(t,i)},find:function(t){return n.$(this.element?this.element:[]).find(t)},proxy:function(t,i){var e=this;i.split(" ").forEach(function(i){e[i]||(e[i]=function(){return t[i].apply(t,arguments)})})},mixin:function(t,i){var e=this;i.split(" ").forEach(function(i){e[i]||(e[i]=t[i].bind(e))})},option:function(){return 1==arguments.length?this.options[arguments[0]]||void 0:(2==arguments.length&&(this.options[arguments[0]]=arguments[1]),void 0)}},e),this.components[t]=o,this[t]=function(){var e,o;if(arguments.length)switch(arguments.length){case 1:"string"==typeof arguments[0]||arguments[0].nodeType||arguments[0]instanceof jQuery?e=i(arguments[0]):o=arguments[0];break;case 2:e=i(arguments[0]),o=arguments[1]}return e&&e.data(t)?e.data(t):new n.components[t](e,o)},n.domready&&n.component.boot(t),o},n.plugin=function(t,i,e){this.components[t].plugins[i]=e},n.component.boot=function(t){n.components[t].prototype&&n.components[t].prototype.boot&&!n.components[t].booted&&(n.components[t].prototype.boot.apply(n,[]),n.components[t].booted=!0)},n.component.bootComponents=function(){for(var t in n.components)n.component.boot(t)},n.domObservers=[],n.domready=!1,n.ready=function(t){n.domObservers.push(t),n.domready&&t(document)},n.on=function(t,i,e){return t&&t.indexOf("ready.uk.dom")>-1&&n.domready&&i.apply(n.$doc),n.$doc.on(t,i,e)},n.one=function(t,i,e){return t&&t.indexOf("ready.uk.dom")>-1&&n.domready?(i.apply(n.$doc),n.$doc):n.$doc.one(t,i,e)},n.trigger=function(t,i){return n.$doc.trigger(t,i)},n.domObserve=function(t,i){n.support.mutationobserver&&(i=i||function(){},n.$(t).each(function(){var t=this,e=n.$(t);if(!e.data("observer"))try{var o=new n.support.mutationobserver(n.Utils.debounce(function(){i.apply(t,[e]),e.trigger("changed.uk.dom")},50),{childList:!0,subtree:!0});o.observe(t,{childList:!0,subtree:!0}),e.data("observer",o)}catch(s){}}))},n.init=function(t){t=t||document,n.domObservers.forEach(function(i){i(t)})},n.on("domready.uk.dom",function(){n.init(),n.domready&&n.Utils.checkDisplay()}),document.addEventListener("DOMContentLoaded",function(){var t=function(){n.$body=n.$("body"),n.trigger("beforeready.uk.dom"),n.component.bootComponents();var t=requestAnimationFrame(function(){var i={dir:{x:0,y:0},x:window.pageXOffset,y:window.pageYOffset},e=function(){var o=window.pageXOffset,s=window.pageYOffset;(i.x!=o||i.y!=s)&&(i.dir.x=o!=i.x?o>i.x?1:-1:0,i.dir.y=s!=i.y?s>i.y?1:-1:0,i.x=o,i.y=s,n.$doc.trigger("scrolling.uk.document",[{dir:{x:i.dir.x,y:i.dir.y},x:o,y:s}])),cancelAnimationFrame(t),t=requestAnimationFrame(e)};return n.support.touch&&n.$html.on("touchmove touchend MSPointerMove MSPointerUp pointermove pointerup",e),(i.x||i.y)&&e(),e}());if(n.trigger("domready.uk.dom"),n.support.touch&&navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&n.$win.on("load orientationchange resize",n.Utils.debounce(function(){var t=function(){return i(".uk-height-viewport").css("height",window.innerHeight),t};return t()}(),100)),n.trigger("afterready.uk.dom"),n.domready=!0,n.support.mutationobserver){var e=n.Utils.debounce(function(){requestAnimationFrame(function(){n.init(document.body)})},10);new n.support.mutationobserver(function(t){var i=!1;t.every(function(t){if("childList"!=t.type)return!0;for(var e,n=0;n<t.addedNodes.length;++n)if(e=t.addedNodes[n],e.outerHTML&&-1!==e.outerHTML.indexOf("data-uk-"))return(i=!0)&&!1;return!0}),i&&e()}).observe(document.body,{childList:!0,subtree:!0})}};return("complete"==document.readyState||"interactive"==document.readyState)&&setTimeout(t),t}()),n.$html.addClass(n.support.touch?"uk-touch":"uk-notouch"),n.support.touch){var s,a=!1,r="uk-hover",l=".uk-overlay, .uk-overlay-hover, .uk-overlay-toggle, .uk-animation-hover, .uk-has-hover";n.$html.on("mouseenter touchstart MSPointerDown pointerdown",l,function(){a&&i("."+r).removeClass(r),a=i(this).addClass(r)}).on("mouseleave touchend MSPointerUp pointerup",function(t){s=i(t.target).parents(l),a&&a.not(s).removeClass(r)})}return n}),function(t){function i(t,i,e,n){return Math.abs(t-i)>=Math.abs(e-n)?t-i>0?"Left":"Right":e-n>0?"Up":"Down"}function e(){c=null,d.last&&(void 0!==d.el&&d.el.trigger("longTap"),d={})}function n(){c&&clearTimeout(c),c=null}function o(){a&&clearTimeout(a),r&&clearTimeout(r),l&&clearTimeout(l),c&&clearTimeout(c),a=r=l=c=null,d={}}function s(t){return t.pointerType==t.MSPOINTER_TYPE_TOUCH&&t.isPrimary}if(!t.fn.swipeLeft){var a,r,l,c,u,d={},h=750;t(function(){var p,f,m,g=0,v=0;"MSGesture"in window&&(u=new MSGesture,u.target=document.body),t(document).on("MSGestureEnd gestureend",function(t){var i=t.originalEvent.velocityX>1?"Right":t.originalEvent.velocityX<-1?"Left":t.originalEvent.velocityY>1?"Down":t.originalEvent.velocityY<-1?"Up":null;i&&void 0!==d.el&&(d.el.trigger("swipe"),d.el.trigger("swipe"+i))}).on("touchstart MSPointerDown pointerdown",function(i){("MSPointerDown"!=i.type||s(i.originalEvent))&&(m="MSPointerDown"==i.type||"pointerdown"==i.type?i:i.originalEvent.touches[0],p=Date.now(),f=p-(d.last||p),d.el=t("tagName"in m.target?m.target:m.target.parentNode),a&&clearTimeout(a),d.x1=m.pageX,d.y1=m.pageY,f>0&&250>=f&&(d.isDoubleTap=!0),d.last=p,c=setTimeout(e,h),!u||"MSPointerDown"!=i.type&&"pointerdown"!=i.type&&"touchstart"!=i.type||u.addPointer(i.originalEvent.pointerId))}).on("touchmove MSPointerMove pointermove",function(t){("MSPointerMove"!=t.type||s(t.originalEvent))&&(m="MSPointerMove"==t.type||"pointermove"==t.type?t:t.originalEvent.touches[0],n(),d.x2=m.pageX,d.y2=m.pageY,g+=Math.abs(d.x1-d.x2),v+=Math.abs(d.y1-d.y2))}).on("touchend MSPointerUp pointerup",function(e){("MSPointerUp"!=e.type||s(e.originalEvent))&&(n(),d.x2&&Math.abs(d.x1-d.x2)>30||d.y2&&Math.abs(d.y1-d.y2)>30?l=setTimeout(function(){void 0!==d.el&&(d.el.trigger("swipe"),d.el.trigger("swipe"+i(d.x1,d.x2,d.y1,d.y2))),d={}},0):"last"in d&&(isNaN(g)||30>g&&30>v?r=setTimeout(function(){var i=t.Event("tap");i.cancelTouch=o,void 0!==d.el&&d.el.trigger(i),d.isDoubleTap?(void 0!==d.el&&d.el.trigger("doubleTap"),d={}):a=setTimeout(function(){a=null,void 0!==d.el&&d.el.trigger("singleTap"),d={}},250)},0):d={},g=v=0))}).on("touchcancel MSPointerCancel pointercancel",o),t(window).on("scroll",o)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(i){t.fn[i]=function(e){return t(this).on(i,e)}})}}(jQuery),function(t){"use strict";var i=[];t.component("stackMargin",{defaults:{cls:"uk-margin-small-top",rowfirst:!1,observe:!1},boot:function(){t.ready(function(i){t.$("[data-uk-margin]",i).each(function(){var i=t.$(this);i.data("stackMargin")||t.stackMargin(i,t.Utils.options(i.attr("data-uk-margin")))})})},init:function(){var e=this;t.$win.on("resize orientationchange",function(){var i=function(){e.process()};return t.$(function(){i(),t.$win.on("load",i)}),t.Utils.debounce(i,20)}()),this.on("display.uk.check",function(){this.element.is(":visible")&&this.process()}.bind(this)),this.options.observe&&t.domObserve(this.element,function(){e.element.is(":visible")&&e.process()}),i.push(this)},process:function(){var i=this.element.children();if(t.Utils.stackMargin(i,this.options),!this.options.rowfirst||!i.length)return this;var e={},n=!1;return i.removeClass(this.options.rowfirst).each(function(i,o){o=t.$(this),"none"!=this.style.display&&(i=o.offset().left,((e[i]=e[i]||[])&&e[i]).push(this),n=n===!1?i:Math.min(n,i))}),t.$(e[n]).addClass(this.options.rowfirst),this}}),function(){var i=[],e=function(t){if(t.is(":visible")){var i=t.parent().width(),e=t.data("width"),n=i/e,o=Math.floor(n*t.data("height"));t.css({height:e>i?o:t.data("height")})}};t.component("responsiveElement",{defaults:{},boot:function(){t.ready(function(i){t.$("iframe.uk-responsive-width, [data-uk-responsive]",i).each(function(){var i,e=t.$(this);e.data("responsiveElement")||(i=t.responsiveElement(e,{}))})})},init:function(){var t=this.element;t.attr("width")&&t.attr("height")&&(t.data({width:t.attr("width"),height:t.attr("height")}).on("display.uk.check",function(){e(t)}),e(t),i.push(t))}}),t.$win.on("resize load",t.Utils.debounce(function(){i.forEach(function(t){e(t)})},15))}(),t.Utils.stackMargin=function(i,e){e=t.$.extend({cls:"uk-margin-small-top"},e),i=t.$(i).removeClass(e.cls);var n=!1;i.each(function(i,e,o,s){s=t.$(this),"none"!=s.css("display")&&(i=s.offset(),e=s.outerHeight(),o=i.top+e,s.data({ukMarginPos:o,ukMarginTop:i.top}),(n===!1||i.top<n.top)&&(n={top:i.top,left:i.left,pos:o}))}).each(function(i){i=t.$(this),"none"!=i.css("display")&&i.data("ukMarginTop")>n.top&&i.data("ukMarginPos")>n.pos&&i.addClass(e.cls)})},t.Utils.matchHeights=function(i,e){i=t.$(i).css("min-height",""),e=t.$.extend({row:!0},e);var n=function(i){if(!(i.length<2)){var e=0;i.each(function(){e=Math.max(e,t.$(this).outerHeight())}).each(function(){var i=t.$(this),n=e-("border-box"==i.css("box-sizing")?0:i.outerHeight()-i.height());i.css("min-height",n+"px")})}};e.row?(i.first().width(),setTimeout(function(){var e=!1,o=[];i.each(function(){var i=t.$(this),s=i.offset().top;s!=e&&o.length&&(n(t.$(o)),o=[],s=i.offset().top),o.push(i),e=s}),o.length&&n(t.$(o))},0)):n(i)},function(i){t.Utils.inlineSvg=function(e,n){t.$(e||'img[src$=".svg"]',n||document).each(function(){var e=t.$(this),n=e.attr("src");if(!i[n]){var o=t.$.Deferred();t.$.get(n,{nc:Math.random()},function(i){o.resolve(t.$(i).find("svg"))}),i[n]=o.promise()}i[n].then(function(i){var n=t.$(i).clone();e.attr("id")&&n.attr("id",e.attr("id")),e.attr("class")&&n.attr("class",e.attr("class")),e.attr("style")&&n.attr("style",e.attr("style")),e.attr("width")&&(n.attr("width",e.attr("width")),e.attr("height")||n.removeAttr("height")),e.attr("height")&&(n.attr("height",e.attr("height")),e.attr("width")||n.removeAttr("width")),e.replaceWith(n)})})},t.ready(function(i){t.Utils.inlineSvg("[data-uk-svg]",i)})}({}),t.Utils.getCssVar=function(t){var i,e=document.documentElement,n=e.appendChild(document.createElement("div"));n.classList.add("var-"+t);try{i=JSON.parse(i=getComputedStyle(n,":before").content.replace(/^["'](.*)["']$/,"$1"))}catch(o){i=void 0}return e.removeChild(n),i}}(UIkit),function(t){"use strict";function i(i,e){e=t.$.extend({duration:1e3,transition:"easeOutExpo",offset:0,complete:function(){}},e);var n=i.offset().top-e.offset,o=t.$doc.height(),s=window.innerHeight;n+s>o&&(n=o-s),t.$("html,body").stop().animate({scrollTop:n},e.duration,e.transition).promise().done(e.complete)}t.component("smoothScroll",{boot:function(){t.$html.on("click.smooth-scroll.uikit","[data-uk-smooth-scroll]",function(){var i=t.$(this);if(!i.data("smoothScroll")){{t.smoothScroll(i,t.Utils.options(i.attr("data-uk-smooth-scroll")))}i.trigger("click")}return!1})},init:function(){var e=this;this.on("click",function(n){n.preventDefault(),i(t.$(this.hash).length?t.$(this.hash):t.$("body"),e.options)})}}),t.Utils.scrollToElement=i,t.$.easing.easeOutExpo||(t.$.easing.easeOutExpo=function(t,i,e,n,o){return i==o?e+n:n*(-Math.pow(2,-10*i/o)+1)+e})}(UIkit),function(t){"use strict";var i=t.$win,e=t.$doc,n=[],o=function(){for(var t=0;t<n.length;t++)window.requestAnimationFrame.apply(window,[n[t].check])};t.component("scrollspy",{defaults:{target:!1,cls:"uk-scrollspy-inview",initcls:"uk-scrollspy-init-inview",topoffset:0,leftoffset:0,repeat:!1,delay:0},boot:function(){e.on("scrolling.uk.document",o),i.on("load resize orientationchange",t.Utils.debounce(o,50)),t.ready(function(i){t.$("[data-uk-scrollspy]",i).each(function(){var i=t.$(this);if(!i.data("scrollspy")){t.scrollspy(i,t.Utils.options(i.attr("data-uk-scrollspy")))}})})},init:function(){var i,e=this,o=this.options.cls.split(/,/),s=function(){var n=e.options.target?e.element.find(e.options.target):e.element,s=1===n.length?1:0,a=0;n.each(function(){var n=t.$(this),r=n.data("inviewstate"),l=t.Utils.isInView(n,e.options),c=n.data("ukScrollspyCls")||o[a].trim();!l||r||n.data("scrollspy-idle")||(i||(n.addClass(e.options.initcls),e.offset=n.offset(),i=!0,n.trigger("init.uk.scrollspy")),n.data("scrollspy-idle",setTimeout(function(){n.addClass("uk-scrollspy-inview").toggleClass(c).width(),n.trigger("inview.uk.scrollspy"),n.data("scrollspy-idle",!1),n.data("inviewstate",!0)},e.options.delay*s)),s++),!l&&r&&e.options.repeat&&(n.data("scrollspy-idle")&&(clearTimeout(n.data("scrollspy-idle")),n.data("scrollspy-idle",!1)),n.removeClass("uk-scrollspy-inview").toggleClass(c),n.data("inviewstate",!1),n.trigger("outview.uk.scrollspy")),a=o[a+1]?a+1:0})};s(),this.check=s,n.push(this)}});var s=[],a=function(){for(var t=0;t<s.length;t++)window.requestAnimationFrame.apply(window,[s[t].check])};t.component("scrollspynav",{defaults:{cls:"uk-active",closest:!1,topoffset:0,leftoffset:0,smoothscroll:!1},boot:function(){e.on("scrolling.uk.document",a),i.on("resize orientationchange",t.Utils.debounce(a,50)),t.ready(function(i){t.$("[data-uk-scrollspy-nav]",i).each(function(){var i=t.$(this);if(!i.data("scrollspynav")){t.scrollspynav(i,t.Utils.options(i.attr("data-uk-scrollspy-nav")))}})})},init:function(){var e,n=[],o=this.find("a[href^='#']").each(function(){"#"!==this.getAttribute("href").trim()&&n.push(this.getAttribute("href"))}),a=t.$(n.join(",")),r=this.options.cls,l=this.options.closest||this.options.closest,c=this,u=function(){e=[];for(var n=0;n<a.length;n++)t.Utils.isInView(a.eq(n),c.options)&&e.push(a.eq(n));if(e.length){var s,u=i.scrollTop(),d=function(){for(var t=0;t<e.length;t++)if(e[t].offset().top-c.options.topoffset>=u)return e[t]}();if(!d)return;c.options.closest?(o.blur().closest(l).removeClass(r),s=o.filter("a[href='#"+d.attr("id")+"']").closest(l).addClass(r)):s=o.removeClass(r).filter("a[href='#"+d.attr("id")+"']").addClass(r),c.element.trigger("inview.uk.scrollspynav",[d,s])}};this.options.smoothscroll&&t.smoothScroll&&o.each(function(){t.smoothScroll(this,c.options.smoothscroll)}),u(),this.element.data("scrollspynav",this),this.check=u,s.push(this)}})}(UIkit),function(t){"use strict";var i=[];t.component("toggle",{defaults:{target:!1,cls:"uk-hidden",animation:!1,duration:200},boot:function(){t.ready(function(e){t.$("[data-uk-toggle]",e).each(function(){var i=t.$(this);if(!i.data("toggle")){t.toggle(i,t.Utils.options(i.attr("data-uk-toggle")))}}),setTimeout(function(){i.forEach(function(t){t.getToggles()})},0)})},init:function(){var t=this;this.aria=-1!==this.options.cls.indexOf("uk-hidden"),this.on("click",function(i){t.element.is('a[href="#"]')&&i.preventDefault(),t.toggle()}),i.push(this)},toggle:function(){if(this.getToggles(),this.totoggle.length){if(this.options.animation&&t.support.animation){var i=this,e=this.options.animation.split(",");1==e.length&&(e[1]=e[0]),e[0]=e[0].trim(),e[1]=e[1].trim(),this.totoggle.css("animation-duration",this.options.duration+"ms"),this.totoggle.each(function(){var n=t.$(this);n.hasClass(i.options.cls)?(n.toggleClass(i.options.cls),t.Utils.animate(n,e[0]).then(function(){n.css("animation-duration",""),t.Utils.checkDisplay(n)})):t.Utils.animate(this,e[1]+" uk-animation-reverse").then(function(){n.toggleClass(i.options.cls).css("animation-duration",""),t.Utils.checkDisplay(n)})})}else this.totoggle.toggleClass(this.options.cls),t.Utils.checkDisplay(this.totoggle);this.updateAria()}},getToggles:function(){this.totoggle=this.options.target?t.$(this.options.target):[],this.updateAria()},updateAria:function(){this.aria&&this.totoggle.length&&this.totoggle.not("[aria-hidden]").each(function(){t.$(this).attr("aria-hidden",t.$(this).hasClass("uk-hidden"))})}})}(UIkit),function(t){"use strict";t.component("alert",{defaults:{fade:!0,duration:200,trigger:".uk-alert-close"},boot:function(){t.$html.on("click.alert.uikit","[data-uk-alert]",function(i){var e=t.$(this);if(!e.data("alert")){var n=t.alert(e,t.Utils.options(e.attr("data-uk-alert")));t.$(i.target).is(n.options.trigger)&&(i.preventDefault(),n.close())}})},init:function(){var t=this;this.on("click",this.options.trigger,function(i){i.preventDefault(),t.close()})},close:function(){var t=this.trigger("close.uk.alert"),i=function(){this.trigger("closed.uk.alert").remove()}.bind(this);this.options.fade?t.css("overflow","hidden").css("max-height",t.height()).animate({height:0,opacity:0,"padding-top":0,"padding-bottom":0,"margin-top":0,"margin-bottom":0},this.options.duration,i):i()}})}(UIkit),function(t){"use strict";t.component("buttonRadio",{defaults:{activeClass:"uk-active",target:".uk-button"},boot:function(){t.$html.on("click.buttonradio.uikit","[data-uk-button-radio]",function(i){var e=t.$(this);if(!e.data("buttonRadio")){var n=t.buttonRadio(e,t.Utils.options(e.attr("data-uk-button-radio"))),o=t.$(i.target);o.is(n.options.target)&&o.trigger("click")}})},init:function(){var i=this;this.find(i.options.target).attr("aria-checked","false").filter("."+i.options.activeClass).attr("aria-checked","true"),this.on("click",this.options.target,function(e){var n=t.$(this);n.is('a[href="#"]')&&e.preventDefault(),i.find(i.options.target).not(n).removeClass(i.options.activeClass).blur(),n.addClass(i.options.activeClass),i.find(i.options.target).not(n).attr("aria-checked","false"),n.attr("aria-checked","true"),i.trigger("change.uk.button",[n])})},getSelected:function(){return this.find("."+this.options.activeClass)}}),t.component("buttonCheckbox",{defaults:{activeClass:"uk-active",target:".uk-button"},boot:function(){t.$html.on("click.buttoncheckbox.uikit","[data-uk-button-checkbox]",function(i){var e=t.$(this);if(!e.data("buttonCheckbox")){var n=t.buttonCheckbox(e,t.Utils.options(e.attr("data-uk-button-checkbox"))),o=t.$(i.target);o.is(n.options.target)&&o.trigger("click")}})},init:function(){var i=this;this.find(i.options.target).attr("aria-checked","false").filter("."+i.options.activeClass).attr("aria-checked","true"),this.on("click",this.options.target,function(e){var n=t.$(this);n.is('a[href="#"]')&&e.preventDefault(),n.toggleClass(i.options.activeClass).blur(),n.attr("aria-checked",n.hasClass(i.options.activeClass)),i.trigger("change.uk.button",[n])})},getSelected:function(){return this.find("."+this.options.activeClass)}}),t.component("button",{defaults:{},boot:function(){t.$html.on("click.button.uikit","[data-uk-button]",function(){var i=t.$(this);if(!i.data("button")){{t.button(i,t.Utils.options(i.attr("data-uk-button")))}i.trigger("click")}})},init:function(){var t=this;this.element.attr("aria-pressed",this.element.hasClass("uk-active")),this.on("click",function(i){t.element.is('a[href="#"]')&&i.preventDefault(),t.toggle(),t.trigger("change.uk.button",[t.element.blur().hasClass("uk-active")])})},toggle:function(){this.element.toggleClass("uk-active"),this.element.attr("aria-pressed",this.element.hasClass("uk-active"))}})}(UIkit),function(t){"use strict";function i(i,e,n,o){if(i=t.$(i),e=t.$(e),n=n||window.innerWidth,o=o||i.offset(),e.length){var s=e.outerWidth();if(i.css("min-width",s),"right"==t.langdirection){var a=n-(e.offset().left+s),r=n-(i.offset().left+i.outerWidth());i.css("margin-right",a-r)}else i.css("margin-left",e.offset().left-o.left)}}var e,n=!1,o={x:{"bottom-left":"bottom-right","bottom-right":"bottom-left","bottom-center":"bottom-center","top-left":"top-right","top-right":"top-left","top-center":"top-center","left-top":"right-top","left-bottom":"right-bottom","left-center":"right-center","right-top":"left-top","right-bottom":"left-bottom","right-center":"left-center"},y:{"bottom-left":"top-left","bottom-right":"top-right","bottom-center":"top-center","top-left":"bottom-left","top-right":"bottom-right","top-center":"bottom-center","left-top":"left-bottom","left-bottom":"left-top","left-center":"left-center","right-top":"right-bottom","right-bottom":"right-top","right-center":"right-center"},xy:{"bottom-left":"top-right","bottom-right":"top-left","bottom-center":"top-center","top-left":"bottom-right","top-right":"bottom-left","top-center":"bottom-center","left-top":"right-bottom","left-bottom":"right-top","left-center":"right-center","right-top":"left-bottom","right-bottom":"left-top","right-center":"left-center"}};t.component("dropdown",{defaults:{mode:"hover",pos:"bottom-left",offset:0,remaintime:800,justify:!1,boundary:t.$win,delay:0,dropdownSelector:".uk-dropdown,.uk-dropdown-blank",hoverDelayIdle:250,preventflip:!1},remainIdle:!1,boot:function(){var i=t.support.touch?"click":"mouseenter";t.$html.on(i+".dropdown.uikit focus","[data-uk-dropdown]",function(e){var n=t.$(this);if(!n.data("dropdown")){var o=t.dropdown(n,t.Utils.options(n.attr("data-uk-dropdown")));("click"==i||"mouseenter"==i&&"hover"==o.options.mode)&&o.element.trigger(i),o.element.find(o.options.dropdownSelector).length&&e.preventDefault()}})},init:function(){var i=this;this.dropdown=this.find(this.options.dropdownSelector),this.offsetParent=this.dropdown.parents().filter(function(){return-1!==t.$.inArray(t.$(this).css("position"),["relative","fixed","absolute"])}).slice(0,1),this.centered=this.dropdown.hasClass("uk-dropdown-center"),this.justified=this.options.justify?t.$(this.options.justify):!1,this.boundary=t.$(this.options.boundary),this.boundary.length||(this.boundary=t.$win),this.dropdown.hasClass("uk-dropdown-up")&&(this.options.pos="top-left"),this.dropdown.hasClass("uk-dropdown-flip")&&(this.options.pos=this.options.pos.replace("left","right")),this.dropdown.hasClass("uk-dropdown-center")&&(this.options.pos=this.options.pos.replace(/(left|right)/,"center")),this.element.attr("aria-haspopup","true"),this.element.attr("aria-expanded",this.element.hasClass("uk-open")),this.dropdown.attr("aria-hidden","true"),"click"==this.options.mode||t.support.touch?this.on("click.uk.dropdown",function(e){var n=t.$(e.target);n.parents(i.options.dropdownSelector).length||((n.is("a[href='#']")||n.parent().is("a[href='#']")||i.dropdown.length&&!i.dropdown.is(":visible"))&&e.preventDefault(),n.blur()),i.element.hasClass("uk-open")?(!i.dropdown.find(e.target).length||n.is(".uk-dropdown-close")||n.parents(".uk-dropdown-close").length)&&i.hide():i.show()}):this.on("mouseenter",function(){i.trigger("pointerenter.uk.dropdown",[i]),i.remainIdle&&clearTimeout(i.remainIdle),e&&clearTimeout(e),n&&n==i||(e=n&&n!=i?setTimeout(function(){e=setTimeout(i.show.bind(i),i.options.delay)},i.options.hoverDelayIdle):setTimeout(i.show.bind(i),i.options.delay))}).on("mouseleave",function(){e&&clearTimeout(e),i.remainIdle=setTimeout(function(){n&&n==i&&i.hide()},i.options.remaintime),i.trigger("pointerleave.uk.dropdown",[i])}).on("click",function(e){var o=t.$(e.target);return i.remainIdle&&clearTimeout(i.remainIdle),n&&n==i?((!i.dropdown.find(e.target).length||o.is(".uk-dropdown-close")||o.parents(".uk-dropdown-close").length)&&i.hide(),void 0):((o.is("a[href='#']")||o.parent().is("a[href='#']"))&&e.preventDefault(),i.show(),void 0)})},show:function(){t.$html.off("click.outer.dropdown"),n&&n!=this&&n.hide(!0),e&&clearTimeout(e),this.trigger("beforeshow.uk.dropdown",[this]),this.checkDimensions(),this.element.addClass("uk-open"),this.element.attr("aria-expanded","true"),this.dropdown.attr("aria-hidden","false"),this.trigger("show.uk.dropdown",[this]),t.Utils.checkDisplay(this.dropdown,!0),t.Utils.focus(this.dropdown),n=this,this.registerOuterClick()},hide:function(t){this.trigger("beforehide.uk.dropdown",[this,t]),this.element.removeClass("uk-open"),this.remainIdle&&clearTimeout(this.remainIdle),this.remainIdle=!1,this.element.attr("aria-expanded","false"),this.dropdown.attr("aria-hidden","true"),this.trigger("hide.uk.dropdown",[this,t]),n==this&&(n=!1)},registerOuterClick:function(){var i=this;t.$html.off("click.outer.dropdown"),setTimeout(function(){t.$html.on("click.outer.dropdown",function(o){e&&clearTimeout(e);t.$(o.target);n!=i||i.element.find(o.target).length||(i.hide(!0),t.$html.off("click.outer.dropdown"))})},10)},checkDimensions:function(){if(this.dropdown.length){this.dropdown.removeClass("uk-dropdown-top uk-dropdown-bottom uk-dropdown-left uk-dropdown-right uk-dropdown-stack").css({"top-left":"",left:"","margin-left":"","margin-right":""}),this.justified&&this.justified.length&&this.dropdown.css("min-width","");var e,n=t.$.extend({},this.offsetParent.offset(),{width:this.offsetParent[0].offsetWidth,height:this.offsetParent[0].offsetHeight}),s=this.options.offset,a=this.dropdown,r=(a.show().offset()||{left:0,top:0},a.outerWidth()),l=a.outerHeight(),c=this.boundary.width(),u=(this.boundary[0]!==window&&this.boundary.offset()?this.boundary.offset():{top:0,left:0},this.options.pos),d={"bottom-left":{top:0+n.height+s,left:0},"bottom-right":{top:0+n.height+s,left:0+n.width-r},"bottom-center":{top:0+n.height+s,left:0+n.width/2-r/2},"top-left":{top:0-l-s,left:0},"top-right":{top:0-l-s,left:0+n.width-r},"top-center":{top:0-l-s,left:0+n.width/2-r/2},"left-top":{top:0,left:0-r-s},"left-bottom":{top:0+n.height-l,left:0-r-s},"left-center":{top:0+n.height/2-l/2,left:0-r-s},"right-top":{top:0,left:0+n.width+s},"right-bottom":{top:0+n.height-l,left:0+n.width+s},"right-center":{top:0+n.height/2-l/2,left:0+n.width+s}},h={};if(e=u.split("-"),h=d[u]?d[u]:d["bottom-left"],this.justified&&this.justified.length)i(a.css({left:0}),this.justified,c);else if(this.options.preventflip!==!0){var p;switch(this.checkBoundary(n.left+h.left,n.top+h.top,r,l,c)){case"x":"x"!==this.options.preventflip&&(p=o.x[u]||"right-top");break;case"y":"y"!==this.options.preventflip&&(p=o.y[u]||"top-left");break;case"xy":this.options.preventflip||(p=o.xy[u]||"right-bottom")}p&&(e=p.split("-"),h=d[p]?d[p]:d["bottom-left"],this.checkBoundary(n.left+h.left,n.top+h.top,r,l,c)&&(e=u.split("-"),h=d[u]?d[u]:d["bottom-left"]))}r>c&&(a.addClass("uk-dropdown-stack"),this.trigger("stack.uk.dropdown",[this])),a.css(h).css("display","").addClass("uk-dropdown-"+e[0])}},checkBoundary:function(i,e,n,o,s){var a="";return(0>i||i-t.$win.scrollLeft()+n>s)&&(a+="x"),(e-t.$win.scrollTop()<0||e-t.$win.scrollTop()+o>window.innerHeight)&&(a+="y"),a}}),t.component("dropdownOverlay",{defaults:{justify:!1,cls:"",duration:200},boot:function(){t.ready(function(i){t.$("[data-uk-dropdown-overlay]",i).each(function(){var i=t.$(this);i.data("dropdownOverlay")||t.dropdownOverlay(i,t.Utils.options(i.attr("data-uk-dropdown-overlay")))})})},init:function(){var e=this;this.justified=this.options.justify?t.$(this.options.justify):!1,this.overlay=this.element.find("uk-dropdown-overlay"),this.overlay.length||(this.overlay=t.$('<div class="uk-dropdown-overlay"></div>').appendTo(this.element)),this.overlay.addClass(this.options.cls),this.on({"beforeshow.uk.dropdown":function(t,n){e.dropdown=n,e.justified&&e.justified.length&&i(e.overlay.css({display:"block","margin-left":"","margin-right":""}),e.justified,e.justified.outerWidth())},"show.uk.dropdown":function(){var i=e.dropdown.dropdown.outerHeight(!0);e.dropdown.element.removeClass("uk-open"),e.overlay.stop().css("display","block").animate({height:i},e.options.duration,function(){e.dropdown.dropdown.css("visibility",""),e.dropdown.element.addClass("uk-open"),t.Utils.checkDisplay(e.dropdown.dropdown,!0)}),e.pointerleave=!1},"hide.uk.dropdown":function(){e.overlay.stop().animate({height:0},e.options.duration)},"pointerenter.uk.dropdown":function(){clearTimeout(e.remainIdle)},"pointerleave.uk.dropdown":function(){e.pointerleave=!0}}),this.overlay.on({mouseenter:function(){e.remainIdle&&(clearTimeout(e.dropdown.remainIdle),clearTimeout(e.remainIdle))},mouseleave:function(){e.pointerleave&&n&&(e.remainIdle=setTimeout(function(){n&&n.hide()},n.options.remaintime))}})}})}(UIkit),function(t){"use strict";var i=[];t.component("gridMatchHeight",{defaults:{target:!1,row:!0,ignorestacked:!1,observe:!1},boot:function(){t.ready(function(i){t.$("[data-uk-grid-match]",i).each(function(){var i,e=t.$(this);e.data("gridMatchHeight")||(i=t.gridMatchHeight(e,t.Utils.options(e.attr("data-uk-grid-match"))))})})},init:function(){var e=this;this.columns=this.element.children(),this.elements=this.options.target?this.find(this.options.target):this.columns,this.columns.length&&(t.$win.on("load resize orientationchange",function(){var i=function(){e.element.is(":visible")&&e.match()};return t.$(function(){i()}),t.Utils.debounce(i,50)}()),this.options.observe&&t.domObserve(this.element,function(){e.element.is(":visible")&&e.match()}),this.on("display.uk.check",function(){this.element.is(":visible")&&this.match()}.bind(this)),i.push(this))},match:function(){var i=this.columns.filter(":visible:first");if(i.length){var e=Math.ceil(100*parseFloat(i.css("width"))/parseFloat(i.parent().css("width")))>=100;return e&&!this.options.ignorestacked?this.revert():t.Utils.matchHeights(this.elements,this.options),this}},revert:function(){return this.elements.css("min-height",""),this}}),t.component("gridMargin",{defaults:{cls:"uk-grid-margin",rowfirst:"uk-row-first"},boot:function(){t.ready(function(i){t.$("[data-uk-grid-margin]",i).each(function(){var i,e=t.$(this);e.data("gridMargin")||(i=t.gridMargin(e,t.Utils.options(e.attr("data-uk-grid-margin"))))})})},init:function(){t.stackMargin(this.element,this.options)}})}(UIkit),function(t){"use strict";function i(i,e){return e?("object"==typeof i?(i=i instanceof jQuery?i:t.$(i),i.parent().length&&(e.persist=i,e.persist.data("modalPersistParent",i.parent()))):i="string"==typeof i||"number"==typeof i?t.$("<div></div>").html(i):t.$("<div></div>").html("UIkit.modal Error: Unsupported data type: "+typeof i),i.appendTo(e.element.find(".uk-modal-dialog")),e):void 0}var e,n=!1,o=0,s=t.$html;t.$win.on("resize orientationchange",t.Utils.debounce(function(){t.$(".uk-modal.uk-open").each(function(){return t.$(this).data("modal")&&t.$(this).data("modal").resize()})},150)),t.component("modal",{defaults:{keyboard:!0,bgclose:!0,minScrollHeight:150,center:!1,modal:!0},scrollable:!1,transition:!1,hasTransitioned:!0,init:function(){if(e||(e=t.$("body")),this.element.length){var i=this;this.paddingdir="padding-"+("left"==t.langdirection?"right":"left"),this.dialog=this.find(".uk-modal-dialog"),this.active=!1,this.element.attr("aria-hidden",this.element.hasClass("uk-open")),this.on("click",".uk-modal-close",function(t){t.preventDefault(),i.hide()}).on("click",function(e){var n=t.$(e.target);n[0]==i.element[0]&&i.options.bgclose&&i.hide()}),t.domObserve(this.element,function(){i.resize()})}},toggle:function(){return this[this.isActive()?"hide":"show"]()},show:function(){if(this.element.length){var i=this;if(!this.isActive())return this.options.modal&&n&&n.hide(!0),this.element.removeClass("uk-open").show(),this.resize(!0),this.options.modal&&(n=this),this.active=!0,o++,t.support.transition?(this.hasTransitioned=!1,this.element.one(t.support.transition.end,function(){i.hasTransitioned=!0,t.Utils.focus(i.dialog,"a[href]")}).addClass("uk-open")):(this.element.addClass("uk-open"),t.Utils.focus(this.dialog,"a[href]")),s.addClass("uk-modal-page").height(),this.element.attr("aria-hidden","false"),this.element.trigger("show.uk.modal"),t.Utils.checkDisplay(this.dialog,!0),this}},hide:function(i){if(!i&&t.support.transition&&this.hasTransitioned){var e=this;this.one(t.support.transition.end,function(){e._hide()}).removeClass("uk-open")}else this._hide();return this},resize:function(t){if(this.isActive()||t){var i=e.width();if(this.scrollbarwidth=window.innerWidth-i,e.css(this.paddingdir,this.scrollbarwidth),this.element.css("overflow-y",this.scrollbarwidth?"scroll":"auto"),!this.updateScrollable()&&this.options.center){var n=this.dialog.outerHeight(),o=parseInt(this.dialog.css("margin-top"),10)+parseInt(this.dialog.css("margin-bottom"),10);n+o<window.innerHeight?this.dialog.css({top:window.innerHeight/2-n/2-o}):this.dialog.css({top:""})}}},updateScrollable:function(){var t=this.dialog.find(".uk-overflow-container:visible:first");if(t.length){t.css("height",0);var i=Math.abs(parseInt(this.dialog.css("margin-top"),10)),e=this.dialog.outerHeight(),n=window.innerHeight,o=n-2*(20>i?20:i)-e;return t.css({"max-height":o<this.options.minScrollHeight?"":o,height:""}),!0}return!1},_hide:function(){this.active=!1,o>0?o--:o=0,this.element.hide().removeClass("uk-open"),this.element.attr("aria-hidden","true"),o||(s.removeClass("uk-modal-page"),e.css(this.paddingdir,"")),n===this&&(n=!1),this.trigger("hide.uk.modal")},isActive:function(){return this.element.hasClass("uk-open")}}),t.component("modalTrigger",{boot:function(){t.$html.on("click.modal.uikit","[data-uk-modal]",function(i){var e=t.$(this);if(e.is("a")&&i.preventDefault(),!e.data("modalTrigger")){var n=t.modalTrigger(e,t.Utils.options(e.attr("data-uk-modal")));n.show()}}),t.$html.on("keydown.modal.uikit",function(t){n&&27===t.keyCode&&n.options.keyboard&&(t.preventDefault(),n.hide())})},init:function(){var i=this;this.options=t.$.extend({target:i.element.is("a")?i.element.attr("href"):!1},this.options),this.modal=t.modal(this.options.target,this.options),this.on("click",function(t){t.preventDefault(),i.show()}),this.proxy(this.modal,"show hide isActive")}}),t.modal.dialog=function(e,n){var o=t.modal(t.$(t.modal.dialog.template).appendTo("body"),n);return o.on("hide.uk.modal",function(){o.persist&&(o.persist.appendTo(o.persist.data("modalPersistParent")),o.persist=!1),o.element.remove()}),i(e,o),o},t.modal.dialog.template='<div class="uk-modal"><div class="uk-modal-dialog" style="min-height:0;"></div></div>',t.modal.alert=function(i,e){e=t.$.extend(!0,{bgclose:!1,keyboard:!1,modal:!1,labels:t.modal.labels},e);var n=t.modal.dialog(['<div class="uk-margin uk-modal-content">'+String(i)+"</div>",'<div class="uk-modal-footer uk-text-right"><button class="uk-button uk-button-primary uk-modal-close">'+e.labels.Ok+"</button></div>"].join(""),e);return n.on("show.uk.modal",function(){setTimeout(function(){n.element.find("button:first").focus()},50)}),n.show()},t.modal.confirm=function(i,e,n){var o=arguments.length>1&&arguments[arguments.length-1]?arguments[arguments.length-1]:{};e=t.$.isFunction(e)?e:function(){},n=t.$.isFunction(n)?n:function(){},o=t.$.extend(!0,{bgclose:!1,keyboard:!1,modal:!1,labels:t.modal.labels},t.$.isFunction(o)?{}:o);var s=t.modal.dialog(['<div class="uk-margin uk-modal-content">'+String(i)+"</div>",'<div class="uk-modal-footer uk-text-right"><button class="uk-button js-modal-confirm-cancel">'+o.labels.Cancel+'</button> <button class="uk-button uk-button-primary js-modal-confirm">'+o.labels.Ok+"</button></div>"].join(""),o);return s.element.find(".js-modal-confirm, .js-modal-confirm-cancel").on("click",function(){t.$(this).is(".js-modal-confirm")?e():n(),s.hide()}),s.on("show.uk.modal",function(){setTimeout(function(){s.element.find(".js-modal-confirm").focus()},50)}),s.show()},t.modal.prompt=function(i,e,n,o){n=t.$.isFunction(n)?n:function(){},o=t.$.extend(!0,{bgclose:!1,keyboard:!1,modal:!1,labels:t.modal.labels},o);var s=t.modal.dialog([i?'<div class="uk-modal-content uk-form">'+String(i)+"</div>":"",'<div class="uk-margin-small-top uk-modal-content uk-form"><p><input type="text" class="uk-width-1-1"></p></div>','<div class="uk-modal-footer uk-text-right"><button class="uk-button uk-modal-close">'+o.labels.Cancel+'</button> <button class="uk-button uk-button-primary js-modal-ok">'+o.labels.Ok+"</button></div>"].join(""),o),a=s.element.find("input[type='text']").val(e||"").on("keyup",function(t){13==t.keyCode&&s.element.find(".js-modal-ok").trigger("click")});return s.element.find(".js-modal-ok").on("click",function(){n(a.val())!==!1&&s.hide()}),s.show()},t.modal.blockUI=function(i,e){var n=t.modal.dialog(['<div class="uk-margin uk-modal-content">'+String(i||'<div class="uk-text-center">...</div>')+"</div>"].join(""),t.$.extend({bgclose:!1,keyboard:!1,modal:!1},e));return n.content=n.element.find(".uk-modal-content:first"),n.show()},t.modal.labels={Ok:"Ok",Cancel:"Cancel"}}(UIkit),function(t){"use strict";function i(i){var e=t.$(i),n="auto";if(e.is(":visible"))n=e.outerHeight();else{var o={position:e.css("position"),visibility:e.css("visibility"),display:e.css("display")};n=e.css({position:"absolute",visibility:"hidden",display:"block"}).outerHeight(),e.css(o)}return n}t.component("nav",{defaults:{toggle:">li.uk-parent > a[href='#']",lists:">li.uk-parent > ul",multiple:!1},boot:function(){t.ready(function(i){t.$("[data-uk-nav]",i).each(function(){var i=t.$(this);if(!i.data("nav")){t.nav(i,t.Utils.options(i.attr("data-uk-nav")))}})})},init:function(){var i=this;this.on("click.uk.nav",this.options.toggle,function(e){e.preventDefault();var n=t.$(this);i.open(n.parent()[0]==i.element[0]?n:n.parent("li"))}),this.update(!0),t.domObserve(this.element,function(){i.element.find(this.options.lists).not("[role]").length&&i.update()})},update:function(){var i=this;this.find(this.options.lists).each(function(){var e=t.$(this).attr("role","menu"),n=e.closest("li"),o=n.hasClass("uk-active");n.data("list-container")||(e.wrap('<div style="overflow:hidden;height:0;position:relative;"></div>'),n.data("list-container",e.parent()[o?"removeClass":"addClass"]("uk-hidden"))),n.attr("aria-expanded",n.hasClass("uk-open")),o&&i.open(n,!0)})},open:function(e,n){var o=this,s=this.element,a=t.$(e),r=a.data("list-container");this.options.multiple||s.children(".uk-open").not(e).each(function(){var i=t.$(this);i.data("list-container")&&i.data("list-container").stop().animate({height:0},function(){t.$(this).parent().removeClass("uk-open").end().addClass("uk-hidden")})}),a.toggleClass("uk-open"),a.attr("aria-expanded",a.hasClass("uk-open")),r&&(a.hasClass("uk-open")&&r.removeClass("uk-hidden"),n?(r.stop().height(a.hasClass("uk-open")?"auto":0),a.hasClass("uk-open")||r.addClass("uk-hidden"),this.trigger("display.uk.check")):r.stop().animate({height:a.hasClass("uk-open")?i(r.find("ul:first")):0},function(){a.hasClass("uk-open")?r.css("height",""):r.addClass("uk-hidden"),o.trigger("display.uk.check")}))}})}(UIkit),function(t){"use strict";var i={x:window.scrollX,y:window.scrollY},e=(t.$win,t.$doc,t.$html),n={show:function(n,o){if(n=t.$(n),n.length){o=t.$.extend({mode:"push"},o);var s=t.$("body"),a=n.find(".uk-offcanvas-bar:first"),r="right"==t.langdirection,l=a.hasClass("uk-offcanvas-bar-flip")?-1:1,c=l*(r?-1:1),u=window.innerWidth-s.width();i={x:window.pageXOffset,y:window.pageYOffset},a.attr("mode",o.mode),n.addClass("uk-active"),s.css({width:window.innerWidth-u,height:window.innerHeight}).addClass("uk-offcanvas-page"),("push"==o.mode||"reveal"==o.mode)&&s.css(r?"margin-right":"margin-left",(r?-1:1)*a.outerWidth()*c),"reveal"==o.mode&&a.css("clip","rect(0, "+a.outerWidth()+"px, 100vh, 0)"),e.css("margin-top",-1*i.y).width(),a.addClass("uk-offcanvas-bar-show"),this._initElement(n),a.trigger("show.uk.offcanvas",[n,a]),n.attr("aria-hidden","false")}},hide:function(n){var o=t.$("body"),s=t.$(".uk-offcanvas.uk-active"),a="right"==t.langdirection,r=s.find(".uk-offcanvas-bar:first"),l=function(){o.removeClass("uk-offcanvas-page").css({width:"",height:"","margin-left":"","margin-right":""}),s.removeClass("uk-active"),r.removeClass("uk-offcanvas-bar-show"),e.css("margin-top",""),window.scrollTo(i.x,i.y),r.trigger("hide.uk.offcanvas",[s,r]),s.attr("aria-hidden","true")};s.length&&("none"==r.attr("mode")&&(n=!0),t.support.transition&&!n?(o.one(t.support.transition.end,function(){l()}).css(a?"margin-right":"margin-left",""),"reveal"==r.attr("mode")&&r.css("clip",""),setTimeout(function(){r.removeClass("uk-offcanvas-bar-show")},0)):l())},_initElement:function(i){i.data("OffcanvasInit")||(i.on("click.uk.offcanvas swipeRight.uk.offcanvas swipeLeft.uk.offcanvas",function(i){var e=t.$(i.target);if(!i.type.match(/swipe/)&&!e.hasClass("uk-offcanvas-close")){if(e.hasClass("uk-offcanvas-bar"))return;if(e.parents(".uk-offcanvas-bar:first").length)return}i.stopImmediatePropagation(),n.hide()}),i.on("click","a[href*='#']",function(){var i=t.$(this),e=i.attr("href");"#"!=e&&(t.$doc.one("hide.uk.offcanvas",function(){var n;try{n=t.$(i[0].hash)}catch(o){n=""}n.length||(n=t.$('[name="'+i[0].hash.replace("#","")+'"]')),n.length&&t.Utils.scrollToElement?t.Utils.scrollToElement(n,t.Utils.options(i.attr("data-uk-smooth-scroll")||"{}")):window.location.href=e}),n.hide())}),i.data("OffcanvasInit",!0))}};t.component("offcanvasTrigger",{boot:function(){e.on("click.offcanvas.uikit","[data-uk-offcanvas]",function(i){i.preventDefault();var e=t.$(this);if(!e.data("offcanvasTrigger")){{t.offcanvasTrigger(e,t.Utils.options(e.attr("data-uk-offcanvas")))}e.trigger("click")}}),e.on("keydown.uk.offcanvas",function(t){27===t.keyCode&&n.hide()})},init:function(){var i=this;this.options=t.$.extend({target:i.element.is("a")?i.element.attr("href"):!1,mode:"push"},this.options),this.on("click",function(t){t.preventDefault(),n.show(i.options.target,i.options)})}}),t.offcanvas=n}(UIkit),function(t){"use strict";function i(i,e,n){var o,s=t.$.Deferred(),a=i,r=i;return n[0]===e[0]?(s.resolve(),s.promise()):("object"==typeof i&&(a=i[0],r=i[1]||i[0]),t.$body.css("overflow-x","hidden"),o=function(){e&&e.hide().removeClass("uk-active "+r+" uk-animation-reverse"),n.addClass(a).one(t.support.animation.end,function(){setTimeout(function(){n.removeClass(""+a).css({opacity:"",display:""})},0),s.resolve(),t.$body.css("overflow-x",""),e&&e.css({opacity:"",display:""})}.bind(this)).show()},n.css("animation-duration",this.options.duration+"ms"),e&&e.length?(e.css("animation-duration",this.options.duration+"ms"),e.css("display","none").addClass(r+" uk-animation-reverse").one(t.support.animation.end,function(){o()}.bind(this)).css("display","")):(n.addClass("uk-active"),o()),s.promise())}var e;t.component("switcher",{defaults:{connect:!1,toggle:">*",active:0,animation:!1,duration:200,swiping:!0},animating:!1,boot:function(){t.ready(function(i){t.$("[data-uk-switcher]",i).each(function(){var i=t.$(this);if(!i.data("switcher")){t.switcher(i,t.Utils.options(i.attr("data-uk-switcher")))}})})},init:function(){var i=this;this.on("click.uk.switcher",this.options.toggle,function(t){t.preventDefault(),i.show(this)}),this.options.connect&&(this.connect=t.$(this.options.connect),this.connect.length&&(this.connect.on("click.uk.switcher","[data-uk-switcher-item]",function(e){e.preventDefault();var n=t.$(this).attr("data-uk-switcher-item");if(i.index!=n)switch(n){case"next":case"previous":i.show(i.index+("next"==n?1:-1));break;default:i.show(parseInt(n,10))}}),this.options.swiping&&this.connect.on("swipeRight swipeLeft",function(t){t.preventDefault(),window.getSelection().toString()||i.show(i.index+("swipeLeft"==t.type?1:-1))}),this.update()))},update:function(){this.connect.children().removeClass("uk-active").attr("aria-hidden","true");var t=this.find(this.options.toggle),i=t.filter(".uk-active");if(i.length)this.show(i,!1);else{if(this.options.active===!1)return;i=t.eq(this.options.active),this.show(i.length?i:t.eq(0),!1)}t.not(i).attr("aria-expanded","false"),i.attr("aria-expanded","true")},show:function(n,o){if(!this.animating){if(isNaN(n))n=t.$(n);else{var s=this.find(this.options.toggle);n=0>n?s.length-1:n,n=s.eq(s[n]?n:0)}var a=this,s=this.find(this.options.toggle),r=t.$(n),l=e[this.options.animation]||function(t,n){if(!a.options.animation)return e.none.apply(a);var o=a.options.animation.split(",");return 1==o.length&&(o[1]=o[0]),o[0]=o[0].trim(),o[1]=o[1].trim(),i.apply(a,[o,t,n])};o!==!1&&t.support.animation||(l=e.none),r.hasClass("uk-disabled")||(s.attr("aria-expanded","false"),r.attr("aria-expanded","true"),s.filter(".uk-active").removeClass("uk-active"),r.addClass("uk-active"),this.options.connect&&this.connect.length&&(this.index=this.find(this.options.toggle).index(r),-1==this.index&&(this.index=0),this.connect.each(function(){var i=t.$(this),e=t.$(i.children()),n=t.$(e.filter(".uk-active")),o=t.$(e.eq(a.index));a.animating=!0,l.apply(a,[n,o]).then(function(){n.removeClass("uk-active"),o.addClass("uk-active"),n.attr("aria-hidden","true"),o.attr("aria-hidden","false"),t.Utils.checkDisplay(o,!0),a.animating=!1})})),this.trigger("show.uk.switcher",[r]))}}}),e={none:function(){var i=t.$.Deferred();return i.resolve(),i.promise()},fade:function(t,e){return i.apply(this,["uk-animation-fade",t,e])},"slide-bottom":function(t,e){return i.apply(this,["uk-animation-slide-bottom",t,e])},"slide-top":function(t,e){return i.apply(this,["uk-animation-slide-top",t,e])},"slide-vertical":function(t,e){var n=["uk-animation-slide-top","uk-animation-slide-bottom"];return t&&t.index()>e.index()&&n.reverse(),i.apply(this,[n,t,e])},"slide-left":function(t,e){return i.apply(this,["uk-animation-slide-left",t,e])},"slide-right":function(t,e){return i.apply(this,["uk-animation-slide-right",t,e])},"slide-horizontal":function(t,e){var n=["uk-animation-slide-right","uk-animation-slide-left"];return t&&t.index()>e.index()&&n.reverse(),i.apply(this,[n,t,e])},scale:function(t,e){return i.apply(this,["uk-animation-scale-up",t,e])}},t.switcher.animations=e}(UIkit),function(t){"use strict";t.component("tab",{defaults:{target:">li:not(.uk-tab-responsive, .uk-disabled)",connect:!1,active:0,animation:!1,duration:200,swiping:!0},boot:function(){t.ready(function(i){t.$("[data-uk-tab]",i).each(function(){var i=t.$(this);if(!i.data("tab")){t.tab(i,t.Utils.options(i.attr("data-uk-tab")))}})})},init:function(){var i=this;this.current=!1,this.on("click.uk.tab",this.options.target,function(e){if(e.preventDefault(),!i.switcher||!i.switcher.animating){var n=i.find(i.options.target).not(this);n.removeClass("uk-active").blur(),i.trigger("change.uk.tab",[t.$(this).addClass("uk-active"),i.current]),i.current=t.$(this),i.options.connect||(n.attr("aria-expanded","false"),t.$(this).attr("aria-expanded","true"))}}),this.options.connect&&(this.connect=t.$(this.options.connect)),this.responsivetab=t.$('<li class="uk-tab-responsive uk-active"><a></a></li>').append('<div class="uk-dropdown uk-dropdown-small"><ul class="uk-nav uk-nav-dropdown"></ul><div>'),this.responsivetab.dropdown=this.responsivetab.find(".uk-dropdown"),this.responsivetab.lst=this.responsivetab.dropdown.find("ul"),this.responsivetab.caption=this.responsivetab.find("a:first"),this.element.hasClass("uk-tab-bottom")&&this.responsivetab.dropdown.addClass("uk-dropdown-up"),this.responsivetab.lst.on("click.uk.tab","a",function(e){e.preventDefault(),e.stopPropagation();var n=t.$(this);i.element.children("li:not(.uk-tab-responsive)").eq(n.data("index")).trigger("click")}),this.on("show.uk.switcher change.uk.tab",function(t,e){i.responsivetab.caption.html(e.text())}),this.element.append(this.responsivetab),this.options.connect&&(this.switcher=t.switcher(this.element,{toggle:">li:not(.uk-tab-responsive)",connect:this.options.connect,active:this.options.active,animation:this.options.animation,duration:this.options.duration,swiping:this.options.swiping})),t.dropdown(this.responsivetab,{mode:"click",preventflip:"y"}),i.trigger("change.uk.tab",[this.element.find(this.options.target).not(".uk-tab-responsive").filter(".uk-active")]),this.check(),t.$win.on("resize orientationchange",t.Utils.debounce(function(){i.element.is(":visible")&&i.check()},100)),this.on("display.uk.check",function(){i.element.is(":visible")&&i.check()})},check:function(){var i=this.element.children("li:not(.uk-tab-responsive)").removeClass("uk-hidden");if(!i.length)return this.responsivetab.addClass("uk-hidden"),void 0;var e,n,o,s=i.eq(0).offset().top+Math.ceil(i.eq(0).height()/2),a=!1;if(this.responsivetab.lst.empty(),i.each(function(){t.$(this).offset().top>s&&(a=!0)}),a)for(var r=0;r<i.length;r++)e=t.$(i.eq(r)),n=e.find("a"),"none"==e.css("float")||e.attr("uk-dropdown")||(e.hasClass("uk-disabled")||(o=e[0].outerHTML.replace("<a ",'<a data-index="'+r+'" '),this.responsivetab.lst.append(o)),e.addClass("uk-hidden"));this.responsivetab[this.responsivetab.lst.children("li").length?"removeClass":"addClass"]("uk-hidden")}})}(UIkit),function(t){"use strict";t.component("cover",{defaults:{automute:!0},boot:function(){t.ready(function(i){t.$("[data-uk-cover]",i).each(function(){var i=t.$(this);if(!i.data("cover")){t.cover(i,t.Utils.options(i.attr("data-uk-cover")))}})})},init:function(){if(this.parent=this.element.parent(),t.$win.on("load resize orientationchange",t.Utils.debounce(function(){this.check()}.bind(this),100)),this.on("display.uk.check",function(){this.element.is(":visible")&&this.check()}.bind(this)),this.check(),this.element.is("iframe")&&this.options.automute){var i=this.element.attr("src");this.element.attr("src","").on("load",function(){this.contentWindow.postMessage('{ "event": "command", "func": "mute", "method":"setVolume", "value":0}',"*")}).attr("src",[i,i.indexOf("?")>-1?"&":"?","enablejsapi=1&api=1"].join(""))}},check:function(){this.element.css({width:"",height:""}),this.dimension={w:this.element.width(),h:this.element.height()},this.element.attr("width")&&!isNaN(this.element.attr("width"))&&(this.dimension.w=this.element.attr("width")),this.element.attr("height")&&!isNaN(this.element.attr("height"))&&(this.dimension.h=this.element.attr("height")),this.ratio=this.dimension.w/this.dimension.h;var t,i,e=this.parent.width(),n=this.parent.height();e/this.ratio<n?(t=Math.ceil(n*this.ratio),i=n):(t=e,i=Math.ceil(e/this.ratio)),this.element.css({width:t,height:i})}})}(UIkit);
(function(addon){var component;if(window.UIkit){component=addon(UIkit)}if(typeof define=="function"&&define.amd){define("uikit-nestable",["uikit"],function(){return component||addon(UIkit)})}})(function(UI){"use strict";var hasTouch="ontouchstart"in window,html=UI.$html,touchedlists=[],$win=UI.$win,draggingElement;var eStart=hasTouch?"touchstart":"mousedown",eMove=hasTouch?"touchmove":"mousemove",eEnd=hasTouch?"touchend":"mouseup",eCancel=hasTouch?"touchcancel":"mouseup";UI.component("nestable",{defaults:{listBaseClass:"uk-nestable",listClass:"uk-nestable-list",listItemClass:"uk-nestable-item",dragClass:"uk-nestable-dragged",movingClass:"uk-nestable-moving",noChildrenClass:"uk-nestable-nochildren",emptyClass:"uk-nestable-empty",handleClass:"",collapsedClass:"uk-collapsed",placeholderClass:"uk-nestable-placeholder",noDragClass:"uk-nestable-nodrag",group:false,maxDepth:10,threshold:20,idlethreshold:10},boot:function(){UI.$html.on("mousemove touchmove",function(e){if(draggingElement){var top=draggingElement.offset().top;if(top<UI.$win.scrollTop()){UI.$win.scrollTop(UI.$win.scrollTop()-Math.ceil(draggingElement.height()/2))}else if(top+draggingElement.height()>window.innerHeight+UI.$win.scrollTop()){UI.$win.scrollTop(UI.$win.scrollTop()+Math.ceil(draggingElement.height()/2))}}});UI.ready(function(context){UI.$("[data-uk-nestable]",context).each(function(){var ele=UI.$(this);if(!ele.data("nestable")){UI.nestable(ele,UI.Utils.options(ele.attr("data-uk-nestable")))}})})},init:function(){var $this=this;Object.keys(this.options).forEach(function(key){if(String(key).indexOf("Class")!=-1){$this.options["_"+key]="."+$this.options[key]}});this.find(this.options._listItemClass).find(">ul").addClass(this.options.listClass);this.checkEmptyList();this.reset();this.element.data("nestable-group",this.options.group||UI.Utils.uid("nestable-group"));this.find(this.options._listItemClass).each(function(){$this.setParent(UI.$(this))});this.on("click","[data-nestable-action]",function(e){if($this.dragEl||!hasTouch&&e.button!==0){return}e.preventDefault();var target=UI.$(e.currentTarget),action=target.data("nestableAction"),item=target.closest($this.options._listItemClass);if(action==="collapse"){$this.collapseItem(item)}if(action==="expand"){$this.expandItem(item)}if(action==="toggle"){$this.toggleItem(item)}});var onStartEvent=function(e){var handle=UI.$(e.target),link=handle.is("a[href]")?handle:handle.parents("a[href]");if(e.target===$this.element[0]){return}if(handle.is($this.options._noDragClass)||handle.closest($this.options._noDragClass).length){return}if(handle.is("[data-nestable-action]")||handle.closest("[data-nestable-action]").length){return}if($this.options.handleClass&&!handle.hasClass($this.options.handleClass)){if($this.options.handleClass){handle=handle.closest($this.options._handleClass)}}if(!handle.length||$this.dragEl||!hasTouch&&e.button!==0||hasTouch&&e.touches.length!==1){return}if(e.originalEvent&&e.originalEvent.touches){e=evt.originalEvent.touches[0]}$this.delayMove=function(evt){link=false;evt.preventDefault();$this.dragStart(e);$this.trigger("start.uk.nestable",[$this]);$this.delayMove=false};$this.delayMove.x=parseInt(e.pageX,10);$this.delayMove.y=parseInt(e.pageY,10);$this.delayMove.threshold=$this.options.idlethreshold;if(link.length&&eEnd=="touchend"){$this.one(eEnd,function(){if(link&&link.attr("href").trim()){location.href=link.attr("href")}})}e.preventDefault()};var onMoveEvent=function(e){if(e.originalEvent&&e.originalEvent.touches){e=e.originalEvent.touches[0]}if($this.delayMove&&(Math.abs(e.pageX-$this.delayMove.x)>$this.delayMove.threshold||Math.abs(e.pageY-$this.delayMove.y)>$this.delayMove.threshold)){if(!window.getSelection().toString()){$this.delayMove(e)}else{$this.delayMove=false}}if($this.dragEl){e.preventDefault();$this.dragMove(e);$this.trigger("move.uk.nestable",[$this])}};var onEndEvent=function(e){if($this.dragEl){e.preventDefault();$this.dragStop(hasTouch?e.touches[0]:e)}draggingElement=false;$this.delayMove=false};if(hasTouch){this.element[0].addEventListener(eStart,onStartEvent,false);window.addEventListener(eMove,onMoveEvent,false);window.addEventListener(eEnd,onEndEvent,false);window.addEventListener(eCancel,onEndEvent,false)}else{this.on(eStart,onStartEvent);$win.on(eMove,onMoveEvent);$win.on(eEnd,onEndEvent)}},serialize:function(){var data,depth=0,list=this,step=function(level,depth){var array=[],items=level.children(list.options._listItemClass);items.each(function(){var li=UI.$(this),item={},attribute,sub=li.children(list.options._listClass);for(var i=0,attr,val;i<li[0].attributes.length;i++){attribute=li[0].attributes[i];if(attribute.name.indexOf("data-")===0){attr=attribute.name.substr(5);val=UI.Utils.str2json(attribute.value);item[attr]=val||attribute.value=="false"||attribute.value=="0"?val:attribute.value}}if(sub.length){item.children=step(sub,depth+1)}array.push(item)});return array};data=step(list.element,depth);return data},list:function(options){var data=[],list=this,depth=0,step=function(level,depth,parent){var items=level.children(options._listItemClass);items.each(function(index){var li=UI.$(this),item=UI.$.extend({parent_id:parent?parent:null,depth:depth,order:index},li.data()),sub=li.children(options._listClass);data.push(item);if(sub.length){step(sub,depth+1,li.data(options.idProperty||"id"))}})};options=UI.$.extend({},list.options,options);step(list.element,depth);return data},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0};this.moving=false;this.dragEl=null;this.dragRootEl=null;this.dragDepth=0;this.hasNewRoot=false;this.pointEl=null;for(var i=0;i<touchedlists.length;i++){this.checkEmptyList(touchedlists[i])}touchedlists=[]},toggleItem:function(li){this[li.hasClass(this.options.collapsedClass)?"expandItem":"collapseItem"](li)},expandItem:function(li){li.removeClass(this.options.collapsedClass)},collapseItem:function(li){var lists=li.children(this.options._listClass);if(lists.length){li.addClass(this.options.collapsedClass)}},expandAll:function(){var list=this;this.find(list.options._listItemClass).each(function(){list.expandItem(UI.$(this))})},collapseAll:function(){var list=this;this.find(list.options._listItemClass).each(function(){list.collapseItem(UI.$(this))})},setParent:function(li){if(li.children(this.options._listClass).length){li.addClass("uk-parent")}},unsetParent:function(li){li.removeClass("uk-parent "+this.options.collapsedClass);li.children(this.options._listClass).remove()},dragStart:function(e){var mouse=this.mouse,target=UI.$(e.target),dragItem=target.closest(this.options._listItemClass),offset=dragItem.offset();this.placeEl=dragItem;mouse.offsetX=e.pageX-offset.left;mouse.offsetY=e.pageY-offset.top;mouse.startX=mouse.lastX=offset.left;mouse.startY=mouse.lastY=offset.top;this.dragRootEl=this.element;this.dragEl=UI.$("<ul></ul>").addClass(this.options.listClass+" "+this.options.dragClass).append(dragItem.clone());this.dragEl.css("width",dragItem.width());this.placeEl.addClass(this.options.placeholderClass);draggingElement=this.dragEl;this.tmpDragOnSiblings=[dragItem[0].previousSibling,dragItem[0].nextSibling];UI.$body.append(this.dragEl);this.dragEl.css({left:offset.left,top:offset.top});var i,depth,items=this.dragEl.find(this.options._listItemClass);for(i=0;i<items.length;i++){depth=UI.$(items[i]).parents(this.options._listClass+","+this.options._listBaseClass).length;if(depth>this.dragDepth){this.dragDepth=depth}}html.addClass(this.options.movingClass)},dragStop:function(e){var el=UI.$(this.placeEl),root=this.placeEl.parents(this.options._listBaseClass+":first");this.placeEl.removeClass(this.options.placeholderClass);this.dragEl.remove();if(this.element[0]!==root[0]){root.trigger("change.uk.nestable",[root.data("nestable"),el,"added"]);this.element.trigger("change.uk.nestable",[this,el,"removed"])}else{this.element.trigger("change.uk.nestable",[this,el,"moved"])}this.trigger("stop.uk.nestable",[this,el]);this.reset();html.removeClass(this.options.movingClass)},dragMove:function(e){var list,parent,prev,next,depth,opt=this.options,mouse=this.mouse,maxDepth=this.dragRootEl?this.dragRootEl.data("nestable").options.maxDepth:opt.maxDepth;this.dragEl.css({left:e.pageX-mouse.offsetX,top:e.pageY-mouse.offsetY});mouse.lastX=mouse.nowX;mouse.lastY=mouse.nowY;mouse.nowX=e.pageX;mouse.nowY=e.pageY;mouse.distX=mouse.nowX-mouse.lastX;mouse.distY=mouse.nowY-mouse.lastY;mouse.lastDirX=mouse.dirX;mouse.lastDirY=mouse.dirY;mouse.dirX=mouse.distX===0?0:mouse.distX>0?1:-1;mouse.dirY=mouse.distY===0?0:mouse.distY>0?1:-1;var newAx=Math.abs(mouse.distX)>Math.abs(mouse.distY)?1:0;if(!mouse.moving){mouse.dirAx=newAx;mouse.moving=true;return}if(mouse.dirAx!==newAx){mouse.distAxX=0;mouse.distAxY=0}else{mouse.distAxX+=Math.abs(mouse.distX);if(mouse.dirX!==0&&mouse.dirX!==mouse.lastDirX){mouse.distAxX=0}mouse.distAxY+=Math.abs(mouse.distY);if(mouse.dirY!==0&&mouse.dirY!==mouse.lastDirY){mouse.distAxY=0}}mouse.dirAx=newAx;if(mouse.dirAx&&mouse.distAxX>=opt.threshold){mouse.distAxX=0;prev=this.placeEl.prev("li");if(mouse.distX>0&&prev.length&&!prev.hasClass(opt.collapsedClass)&&!prev.hasClass(opt.noChildrenClass)){list=prev.find(opt._listClass).last();depth=this.placeEl.parents(opt._listClass+","+opt._listBaseClass).length;if(depth+this.dragDepth<=maxDepth){if(!list.length){list=UI.$("<ul/>").addClass(opt.listClass);list.append(this.placeEl);prev.append(list);this.setParent(prev)}else{list=prev.children(opt._listClass).last();list.append(this.placeEl)}}}if(mouse.distX<0){next=this.placeEl.next(opt._listItemClass);if(!next.length){var parentUl=this.placeEl.closest([opt._listBaseClass,opt._listClass].join(","));var surroundingLi=parentUl.closest(opt._listItemClass);if(surroundingLi.length){surroundingLi.after(this.placeEl);if(!parentUl.children().length){this.unsetParent(surroundingLi)}}}}}var isEmpty=false;var pointX=e.pageX-(window.pageXOffset||document.scrollLeft||0),pointY=e.pageY-(window.pageYOffset||document.documentElement.scrollTop);this.pointEl=UI.$(document.elementFromPoint(pointX,pointY));if(opt.handleClass&&this.pointEl.hasClass(opt.handleClass)){this.pointEl=this.pointEl.closest(opt._listItemClass)}else{var nestableitem=this.pointEl.closest(opt._listItemClass);if(nestableitem.length){this.pointEl=nestableitem}}if(this.placeEl.find(this.pointEl).length){return}if(this.pointEl.data("nestable")&&!this.pointEl.children().length){isEmpty=true;this.checkEmptyList(this.pointEl)}else if(!this.pointEl.length||!this.pointEl.hasClass(opt.listItemClass)){return}var pointElRoot=this.element,tmpRoot=this.pointEl.closest(this.options._listBaseClass),isNewRoot=pointElRoot[0]!=tmpRoot[0];if(!mouse.dirAx||isNewRoot||isEmpty){if(isNewRoot&&opt.group!==tmpRoot.data("nestable-group")){return}else{touchedlists.push(pointElRoot)}depth=this.dragDepth-1+this.pointEl.parents(opt._listClass+","+opt._listBaseClass).length;if(depth>maxDepth){return}var before=e.pageY<this.pointEl.offset().top+this.pointEl.height()/2;parent=this.placeEl.parent();if(isEmpty){this.pointEl.append(this.placeEl)}else if(before){this.pointEl.before(this.placeEl)}else{this.pointEl.after(this.placeEl)}if(!parent.children().length){if(!parent.data("nestable"))this.unsetParent(parent.parent())}this.checkEmptyList(this.dragRootEl);this.checkEmptyList(pointElRoot);if(isNewRoot){this.dragRootEl=tmpRoot;this.hasNewRoot=this.element[0]!==this.dragRootEl[0]}}},checkEmptyList:function(list){list=list?UI.$(list):this.element;if(this.options.emptyClass){list[!list.children().length?"addClass":"removeClass"](this.options.emptyClass)}}});return UI.nestable});
(function(factory){"use strict";if(typeof exports==="object"){module.exports=factory(window.jQuery)}else if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(window.jQuery&&!window.jQuery.fn.colorpicker){factory(window.jQuery)}})(function($){"use strict";var Color=function(val,predefinedColors){this.value={h:0,s:0,b:0,a:1};this.origFormat=null;if(predefinedColors){$.extend(this.colors,predefinedColors)}if(val){if(val.toLowerCase!==undefined){val=val+"";this.setColor(val)}else if(val.h!==undefined){this.value=val}}};Color.prototype={constructor:Color,colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"transparent"},_sanitizeNumber:function(val){if(typeof val==="number"){return val}if(isNaN(val)||val===null||val===""||val===undefined){return 1}if(val===""){return 0}if(val.toLowerCase!==undefined){if(val.match(/^\./)){val="0"+val}return Math.ceil(parseFloat(val)*100)/100}return 1},isTransparent:function(strVal){if(!strVal){return false}strVal=strVal.toLowerCase().trim();return strVal==="transparent"||strVal.match(/#?00000000/)||strVal.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/)},rgbaIsTransparent:function(rgba){return rgba.r===0&&rgba.g===0&&rgba.b===0&&rgba.a===0},setColor:function(strVal){strVal=strVal.toLowerCase().trim();if(strVal){if(this.isTransparent(strVal)){this.value={h:0,s:0,b:0,a:0}}else{this.value=this.stringToHSB(strVal)||{h:0,s:0,b:0,a:1}}}},stringToHSB:function(strVal){strVal=strVal.toLowerCase();var alias;if(typeof this.colors[strVal]!=="undefined"){strVal=this.colors[strVal];alias="alias"}var that=this,result=false;$.each(this.stringParsers,function(i,parser){var match=parser.re.exec(strVal),values=match&&parser.parse.apply(that,[match]),format=alias||parser.format||"rgba";if(values){if(format.match(/hsla?/)){result=that.RGBtoHSB.apply(that,that.HSLtoRGB.apply(that,values))}else{result=that.RGBtoHSB.apply(that,values)}that.origFormat=format;return false}return true});return result},setHue:function(h){this.value.h=1-h},setSaturation:function(s){this.value.s=s},setBrightness:function(b){this.value.b=1-b},setAlpha:function(a){this.value.a=Math.round(parseInt((1-a)*100,10)/100*100)/100},toRGB:function(h,s,b,a){if(!h){h=this.value.h;s=this.value.s;b=this.value.b}h*=360;var R,G,B,X,C;h=h%360/60;C=b*s;X=C*(1-Math.abs(h%2-1));R=G=B=b-C;h=~~h;R+=[C,X,0,0,X,C][h];G+=[X,C,C,X,0,0][h];B+=[0,0,X,C,C,X][h];return{r:Math.round(R*255),g:Math.round(G*255),b:Math.round(B*255),a:a||this.value.a}},toHex:function(h,s,b,a){var rgb=this.toRGB(h,s,b,a);if(this.rgbaIsTransparent(rgb)){return"transparent"}return"#"+(1<<24|parseInt(rgb.r)<<16|parseInt(rgb.g)<<8|parseInt(rgb.b)).toString(16).substr(1)},toHSL:function(h,s,b,a){h=h||this.value.h;s=s||this.value.s;b=b||this.value.b;a=a||this.value.a;var H=h,L=(2-s)*b,S=s*b;if(L>0&&L<=1){S/=L}else{S/=2-L}L/=2;if(S>1){S=1}return{h:isNaN(H)?0:H,s:isNaN(S)?0:S,l:isNaN(L)?0:L,a:isNaN(a)?0:a}},toAlias:function(r,g,b,a){var rgb=this.toHex(r,g,b,a);for(var alias in this.colors){if(this.colors[alias]===rgb){return alias}}return false},RGBtoHSB:function(r,g,b,a){r/=255;g/=255;b/=255;var H,S,V,C;V=Math.max(r,g,b);C=V-Math.min(r,g,b);H=C===0?null:V===r?(g-b)/C:V===g?(b-r)/C+2:(r-g)/C+4;H=(H+360)%6*60/360;S=C===0?0:C/V;return{h:this._sanitizeNumber(H),s:S,b:V,a:this._sanitizeNumber(a)}},HueToRGB:function(p,q,h){if(h<0){h+=1}else if(h>1){h-=1}if(h*6<1){return p+(q-p)*h*6}else if(h*2<1){return q}else if(h*3<2){return p+(q-p)*(2/3-h)*6}else{return p}},HSLtoRGB:function(h,s,l,a){if(s<0){s=0}var q;if(l<=.5){q=l*(1+s)}else{q=l+s-l*s}var p=2*l-q;var tr=h+1/3;var tg=h;var tb=h-1/3;var r=Math.round(this.HueToRGB(p,q,tr)*255);var g=Math.round(this.HueToRGB(p,q,tg)*255);var b=Math.round(this.HueToRGB(p,q,tb)*255);return[r,g,b,this._sanitizeNumber(a)]},toString:function(format){format=format||"rgba";var c=false;switch(format){case"rgb":{c=this.toRGB();if(this.rgbaIsTransparent(c)){return"transparent"}return"rgb("+c.r+","+c.g+","+c.b+")"}break;case"rgba":{c=this.toRGB();return"rgba("+c.r+","+c.g+","+c.b+","+c.a+")"}break;case"hsl":{c=this.toHSL();return"hsl("+Math.round(c.h*360)+","+Math.round(c.s*100)+"%,"+Math.round(c.l*100)+"%)"}break;case"hsla":{c=this.toHSL();return"hsla("+Math.round(c.h*360)+","+Math.round(c.s*100)+"%,"+Math.round(c.l*100)+"%,"+c.a+")"}break;case"hex":{return this.toHex()}break;case"alias":return this.toAlias()||this.toHex();default:{return c}break}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(execResult){return[execResult[1],execResult[2],execResult[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(execResult){return[execResult[1]/360,execResult[2]/100,execResult[3]/100,execResult[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(execResult){return[execResult[1]/360,execResult[2]/100,execResult[3]/100,execResult[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16),1]}}],colorNameToHex:function(name){if(typeof this.colors[name.toLowerCase()]!=="undefined"){return this.colors[name.toLowerCase()]}return false}};var defaults={horizontal:false,inline:false,color:false,format:false,input:"input",container:false,component:".add-on, .input-group-addon",sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setAlpha"}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:100,maxTop:0,callLeft:"setHue",callTop:false},alpha:{maxLeft:100,maxTop:0,callLeft:"setAlpha",callTop:false}},template:'<div class="colorpicker dropdown-menu">'+'<div class="colorpicker-saturation"><i><b></b></i></div>'+'<div class="colorpicker-hue"><i></i></div>'+'<div class="colorpicker-alpha"><i></i></div>'+'<div class="colorpicker-color"><div /></div>'+'<div class="colorpicker-selectors"></div>'+"</div>",align:"right",customClass:null,colorSelectors:null};var Colorpicker=function(element,options){this.element=$(element).addClass("colorpicker-element");this.options=$.extend(true,{},defaults,this.element.data(),options);this.component=this.options.component;this.component=this.component!==false?this.element.find(this.component):false;if(this.component&&this.component.length===0){this.component=false}this.container=this.options.container===true?this.element:this.options.container;this.container=this.container!==false?$(this.container):false;this.input=this.element.is("input")?this.element:this.options.input?this.element.find(this.options.input):false;if(this.input&&this.input.length===0){this.input=false}this.color=new Color(this.options.color!==false?this.options.color:this.getValue(),this.options.colorSelectors);this.format=this.options.format!==false?this.options.format:this.color.origFormat;if(this.options.color!==false){this.updateInput(this.color);this.updateData(this.color)}this.picker=$(this.options.template);if(this.options.customClass){this.picker.addClass(this.options.customClass)}if(this.options.inline){this.picker.addClass("colorpicker-inline colorpicker-visible")}else{this.picker.addClass("colorpicker-hidden")}if(this.options.horizontal){this.picker.addClass("colorpicker-horizontal")}if(this.format==="rgba"||this.format==="hsla"||this.options.format===false){this.picker.addClass("colorpicker-with-alpha")}if(this.options.align==="right"){this.picker.addClass("colorpicker-right")}if(this.options.inline===true){this.picker.addClass("colorpicker-no-arrow")}if(this.options.colorSelectors){var colorpicker=this;$.each(this.options.colorSelectors,function(name,color){var $btn=$("<i />").css("background-color",color).data("class",name);$btn.click(function(){colorpicker.setValue($(this).css("background-color"))});colorpicker.picker.find(".colorpicker-selectors").append($btn)});this.picker.find(".colorpicker-selectors").show()}this.picker.on("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.mousedown,this));this.picker.appendTo(this.container?this.container:$("body"));if(this.input!==false){this.input.on({"keyup.colorpicker":$.proxy(this.keyup,this)});this.input.on({"change.colorpicker":$.proxy(this.change,this)});if(this.component===false){this.element.on({"focus.colorpicker":$.proxy(this.show,this)})}if(this.options.inline===false){this.element.on({"focusout.colorpicker":$.proxy(this.hide,this)})}}if(this.component!==false){this.component.on({"click.colorpicker":$.proxy(this.show,this)})}if(this.input===false&&this.component===false){this.element.on({"click.colorpicker":$.proxy(this.show,this)})}if(this.input!==false&&this.component!==false&&this.input.attr("type")==="color"){this.input.on({"click.colorpicker":$.proxy(this.show,this),"focus.colorpicker":$.proxy(this.show,this)})}this.update();$($.proxy(function(){this.element.trigger("create")},this))};Colorpicker.Color=Color;Colorpicker.prototype={constructor:Colorpicker,destroy:function(){this.picker.remove();this.element.removeData("colorpicker","color").off(".colorpicker");if(this.input!==false){this.input.off(".colorpicker")}if(this.component!==false){this.component.off(".colorpicker")}this.element.removeClass("colorpicker-element");this.element.trigger({type:"destroy"})},reposition:function(){if(this.options.inline!==false||this.options.container){return false}var type=this.container&&this.container[0]!==document.body?"position":"offset";var element=this.component||this.element;var offset=element[type]();if(this.options.align==="right"){offset.left-=this.picker.outerWidth()-element.outerWidth()}this.picker.css({top:offset.top+element.outerHeight(),left:offset.left})},show:function(e){if(this.isDisabled()){return false}this.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden");this.reposition();$(window).on("resize.colorpicker",$.proxy(this.reposition,this));if(e&&(!this.hasInput()||this.input.attr("type")==="color")){if(e.stopPropagation&&e.preventDefault){e.stopPropagation();e.preventDefault()}}if((this.component||!this.input)&&this.options.inline===false){$(window.document).on({"mousedown.colorpicker":$.proxy(this.hide,this)})}this.element.trigger({type:"showPicker",color:this.color})},hide:function(){this.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible");$(window).off("resize.colorpicker",this.reposition);$(document).off({"mousedown.colorpicker":this.hide});this.update();this.element.trigger({type:"hidePicker",color:this.color})},updateData:function(val){val=val||this.color.toString(this.format);this.element.data("color",val);return val},updateInput:function(val){val=val||this.color.toString(this.format);if(this.input!==false){if(this.options.colorSelectors){var color=new Color(val,this.options.colorSelectors);var alias=color.toAlias();if(typeof this.options.colorSelectors[alias]!=="undefined"){val=alias}}this.input.prop("value",val)}return val},updatePicker:function(val){if(val!==undefined){this.color=new Color(val,this.options.colorSelectors)}var sl=this.options.horizontal===false?this.options.sliders:this.options.slidersHorz;var icns=this.picker.find("i");if(icns.length===0){return}if(this.options.horizontal===false){sl=this.options.sliders;icns.eq(1).css("top",sl.hue.maxTop*(1-this.color.value.h)).end().eq(2).css("top",sl.alpha.maxTop*(1-this.color.value.a))}else{sl=this.options.slidersHorz;icns.eq(1).css("left",sl.hue.maxLeft*(1-this.color.value.h)).end().eq(2).css("left",sl.alpha.maxLeft*(1-this.color.value.a))}icns.eq(0).css({top:sl.saturation.maxTop-this.color.value.b*sl.saturation.maxTop,left:this.color.value.s*sl.saturation.maxLeft});this.picker.find(".colorpicker-saturation").css("backgroundColor",this.color.toHex(this.color.value.h,1,1,1));this.picker.find(".colorpicker-alpha").css("backgroundColor",this.color.toHex());this.picker.find(".colorpicker-color, .colorpicker-color div").css("backgroundColor",this.color.toString(this.format));return val},updateComponent:function(val){val=val||this.color.toString(this.format);if(this.component!==false){var icn=this.component.find("i").eq(0);if(icn.length>0){icn.css({backgroundColor:val})}else{this.component.css({backgroundColor:val})}}return val},update:function(force){var val;if(this.getValue(false)!==false||force===true){val=this.updateComponent();this.updateInput(val);this.updateData(val);this.updatePicker()}return val},setValue:function(val){this.color=new Color(val,this.options.colorSelectors);this.update(true);this.element.trigger({type:"changeColor",color:this.color,value:val})},getValue:function(defaultValue){defaultValue=defaultValue===undefined?"#000000":defaultValue;var val;if(this.hasInput()){val=this.input.val()}else{val=this.element.data("color")}if(val===undefined||val===""||val===null){val=defaultValue}return val},hasInput:function(){return this.input!==false},isDisabled:function(){if(this.hasInput()){return this.input.prop("disabled")===true}return false},disable:function(){if(this.hasInput()){this.input.prop("disabled",true);this.element.trigger({type:"disable",color:this.color,value:this.getValue()});return true}return false},enable:function(){if(this.hasInput()){this.input.prop("disabled",false);this.element.trigger({type:"enable",color:this.color,value:this.getValue()});return true}return false},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(e){if(!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches){e.pageX=e.originalEvent.touches[0].pageX;e.pageY=e.originalEvent.touches[0].pageY}e.stopPropagation();e.preventDefault();var target=$(e.target);var zone=target.closest("div");var sl=this.options.horizontal?this.options.slidersHorz:this.options.sliders;if(!zone.is(".colorpicker")){if(zone.is(".colorpicker-saturation")){this.currentSlider=$.extend({},sl.saturation)}else if(zone.is(".colorpicker-hue")){this.currentSlider=$.extend({},sl.hue)}else if(zone.is(".colorpicker-alpha")){this.currentSlider=$.extend({},sl.alpha)}else{return false}var offset=zone.offset();this.currentSlider.guide=zone.find("i")[0].style;this.currentSlider.left=e.pageX-offset.left;this.currentSlider.top=e.pageY-offset.top;this.mousePointer={left:e.pageX,top:e.pageY};$(document).on({"mousemove.colorpicker":$.proxy(this.mousemove,this),"touchmove.colorpicker":$.proxy(this.mousemove,this),"mouseup.colorpicker":$.proxy(this.mouseup,this),"touchend.colorpicker":$.proxy(this.mouseup,this)}).trigger("mousemove")}return false},mousemove:function(e){if(!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches){e.pageX=e.originalEvent.touches[0].pageX;e.pageY=e.originalEvent.touches[0].pageY}e.stopPropagation();e.preventDefault();var left=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((e.pageX||this.mousePointer.left)-this.mousePointer.left)));var top=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((e.pageY||this.mousePointer.top)-this.mousePointer.top)));this.currentSlider.guide.left=left+"px";this.currentSlider.guide.top=top+"px";if(this.currentSlider.callLeft){this.color[this.currentSlider.callLeft].call(this.color,left/this.currentSlider.maxLeft)}if(this.currentSlider.callTop){this.color[this.currentSlider.callTop].call(this.color,top/this.currentSlider.maxTop)}if(this.currentSlider.callTop==="setAlpha"&&this.options.format===false){if(this.color.value.a!==1){this.format="rgba";this.color.origFormat="rgba"}else{this.format="hex";this.color.origFormat="hex"}}this.update(true);this.element.trigger({type:"changeColor",color:this.color});return false},mouseup:function(e){e.stopPropagation();e.preventDefault();$(document).off({"mousemove.colorpicker":this.mousemove,"touchmove.colorpicker":this.mousemove,"mouseup.colorpicker":this.mouseup,"touchend.colorpicker":this.mouseup});return false},change:function(e){this.keyup(e)},keyup:function(e){if(e.keyCode===38){if(this.color.value.a<1){this.color.value.a=Math.round((this.color.value.a+.01)*100)/100}this.update(true)}else if(e.keyCode===40){if(this.color.value.a>0){this.color.value.a=Math.round((this.color.value.a-.01)*100)/100}this.update(true)}else{this.color=new Color(this.input.val(),this.options.colorSelectors);if(this.color.origFormat&&this.options.format===false){this.format=this.color.origFormat}if(this.getValue(false)!==false){this.updateData();this.updateComponent();this.updatePicker()}}this.element.trigger({type:"changeColor",color:this.color,value:this.input.val()})}};$.colorpicker=Colorpicker;$.fn.colorpicker=function(option){var apiArgs=Array.prototype.slice.call(arguments,1),isSingleElement=this.length===1,returnValue=null;var $jq=this.each(function(){var $this=$(this),inst=$this.data("colorpicker"),options=typeof option==="object"?option:{};if(!inst){inst=new Colorpicker(this,options);$this.data("colorpicker",inst)}if(typeof option==="string"){if($.isFunction(inst[option])){returnValue=inst[option].apply(inst,apiArgs)}else{if(apiArgs.length){inst[option]=apiArgs[0]}returnValue=inst[option]}}else{returnValue=$this}});return isSingleElement?returnValue:$jq};$.fn.colorpicker.constructor=Colorpicker});
!function(a){"use strict";function b(a,b){return a+".touchspin_"+b}function c(c,d){return a.map(c,function(a){return b(a,d)})}var d=0;a.fn.TouchSpin=function(b){if("destroy"===b)return void this.each(function(){var b=a(this),d=b.data();a(document).off(c(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],d.spinnerid).join(" "))});var e={min:0,max:100,initval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},f={min:"min",max:"max",initval:"init-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function g(){if(!J.data("alreadyinitialized")){if(J.data("alreadyinitialized",!0),d+=1,J.data("spinnerid",d),!J.is("input"))return void console.log("Must be an input.");j(),h(),u(),m(),p(),q(),r(),s(),D.input.css("display","block")}}function h(){""!==B.initval&&""===J.val()&&J.val(B.initval)}function i(a){l(a),u();var b=D.input.val();""!==b&&(b=Number(D.input.val()),D.input.val(b.toFixed(B.decimals)))}function j(){B=a.extend({},e,K,k(),b)}function k(){var b={};return a.each(f,function(a,c){var d="bts-"+c;J.is("[data-"+d+"]")&&(b[a]=J.data(d))}),b}function l(b){B=a.extend({},B,b)}function m(){var a=J.val(),b=J.parent();""!==a&&(a=Number(a).toFixed(B.decimals)),J.data("initvalue",a).val(a),J.addClass("form-control"),b.hasClass("input-group")?n(b):o()}function n(b){b.addClass("bootstrap-touchspin");var c,d,e=J.prev(),f=J.next(),g='<span class="input-group-addon bootstrap-touchspin-prefix">'+B.prefix+"</span>",h='<span class="input-group-addon bootstrap-touchspin-postfix">'+B.postfix+"</span>";e.hasClass("input-group-btn")?(c='<button class="'+B.buttondown_class+' bootstrap-touchspin-down" type="button">'+B.buttondown_txt+"</button>",e.append(c)):(c='<span class="input-group-btn"><button class="'+B.buttondown_class+' bootstrap-touchspin-down" type="button">'+B.buttondown_txt+"</button></span>",a(c).insertBefore(J)),f.hasClass("input-group-btn")?(d='<button class="'+B.buttonup_class+' bootstrap-touchspin-up" type="button">'+B.buttonup_txt+"</button>",f.prepend(d)):(d='<span class="input-group-btn"><button class="'+B.buttonup_class+' bootstrap-touchspin-up" type="button">'+B.buttonup_txt+"</button></span>",a(d).insertAfter(J)),a(g).insertBefore(J),a(h).insertAfter(J),C=b}function o(){var b;b=B.verticalbuttons?'<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+B.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+B.postfix+'</span><span class="input-group-btn-vertical"><button class="'+B.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+B.verticalupclass+'"></i></button><button class="'+B.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+B.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+B.buttondown_class+' bootstrap-touchspin-down" type="button">'+B.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+B.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+B.postfix+'</span><span class="input-group-btn"><button class="'+B.buttonup_class+' bootstrap-touchspin-up" type="button">'+B.buttonup_txt+"</button></span></div>",C=a(b).insertBefore(J),a(".bootstrap-touchspin-prefix",C).after(J),J.hasClass("input-sm")?C.addClass("input-group-sm"):J.hasClass("input-lg")&&C.addClass("input-group-lg")}function p(){D={down:a(".bootstrap-touchspin-down",C),up:a(".bootstrap-touchspin-up",C),input:a("input",C),prefix:a(".bootstrap-touchspin-prefix",C).addClass(B.prefix_extraclass),postfix:a(".bootstrap-touchspin-postfix",C).addClass(B.postfix_extraclass)}}function q(){""===B.prefix&&D.prefix.hide(),""===B.postfix&&D.postfix.hide()}function r(){J.on("keydown",function(a){var b=a.keyCode||a.which;38===b?("up"!==M&&(w(),z()),a.preventDefault()):40===b&&("down"!==M&&(x(),y()),a.preventDefault())}),J.on("keyup",function(a){var b=a.keyCode||a.which;38===b?A():40===b&&A()}),J.on("blur",function(){u()}),D.down.on("keydown",function(a){var b=a.keyCode||a.which;(32===b||13===b)&&("down"!==M&&(x(),y()),a.preventDefault())}),D.down.on("keyup",function(a){var b=a.keyCode||a.which;(32===b||13===b)&&A()}),D.up.on("keydown",function(a){var b=a.keyCode||a.which;(32===b||13===b)&&("up"!==M&&(w(),z()),a.preventDefault())}),D.up.on("keyup",function(a){var b=a.keyCode||a.which;(32===b||13===b)&&A()}),D.down.on("mousedown.touchspin",function(a){D.down.off("touchstart.touchspin"),J.is(":disabled")||(x(),y(),a.preventDefault(),a.stopPropagation())}),D.down.on("touchstart.touchspin",function(a){D.down.off("mousedown.touchspin"),J.is(":disabled")||(x(),y(),a.preventDefault(),a.stopPropagation())}),D.up.on("mousedown.touchspin",function(a){D.up.off("touchstart.touchspin"),J.is(":disabled")||(w(),z(),a.preventDefault(),a.stopPropagation())}),D.up.on("touchstart.touchspin",function(a){D.up.off("mousedown.touchspin"),J.is(":disabled")||(w(),z(),a.preventDefault(),a.stopPropagation())}),D.up.on("mouseout touchleave touchend touchcancel",function(a){M&&(a.stopPropagation(),A())}),D.down.on("mouseout touchleave touchend touchcancel",function(a){M&&(a.stopPropagation(),A())}),D.down.on("mousemove touchmove",function(a){M&&(a.stopPropagation(),a.preventDefault())}),D.up.on("mousemove touchmove",function(a){M&&(a.stopPropagation(),a.preventDefault())}),a(document).on(c(["mouseup","touchend","touchcancel"],d).join(" "),function(a){M&&(a.preventDefault(),A())}),a(document).on(c(["mousemove","touchmove","scroll","scrollstart"],d).join(" "),function(a){M&&(a.preventDefault(),A())}),J.on("mousewheel DOMMouseScroll",function(a){if(B.mousewheel&&J.is(":focus")){var b=a.originalEvent.wheelDelta||-a.originalEvent.deltaY||-a.originalEvent.detail;a.stopPropagation(),a.preventDefault(),0>b?x():w()}})}function s(){J.on("touchspin.uponce",function(){A(),w()}),J.on("touchspin.downonce",function(){A(),x()}),J.on("touchspin.startupspin",function(){z()}),J.on("touchspin.startdownspin",function(){y()}),J.on("touchspin.stopspin",function(){A()}),J.on("touchspin.updatesettings",function(a,b){i(b)})}function t(a){switch(B.forcestepdivisibility){case"round":return(Math.round(a/B.step)*B.step).toFixed(B.decimals);case"floor":return(Math.floor(a/B.step)*B.step).toFixed(B.decimals);case"ceil":return(Math.ceil(a/B.step)*B.step).toFixed(B.decimals);default:return a}}function u(){var a,b,c;a=J.val(),""!==a&&(B.decimals>0&&"."===a||(b=parseFloat(a),isNaN(b)&&(b=0),c=b,b.toString()!==a&&(c=b),b<B.min&&(c=B.min),b>B.max&&(c=B.max),c=t(c),Number(a).toString()!==c.toString()&&(J.val(c),J.trigger("change"))))}function v(){if(B.booster){var a=Math.pow(2,Math.floor(L/B.boostat))*B.step;return B.maxboostedstep&&a>B.maxboostedstep&&(a=B.maxboostedstep,E=Math.round(E/a)*a),Math.max(B.step,a)}return B.step}function w(){u(),E=parseFloat(D.input.val()),isNaN(E)&&(E=0);var a=E,b=v();E+=b,E>B.max&&(E=B.max,J.trigger("touchspin.on.max"),A()),D.input.val(Number(E).toFixed(B.decimals)),a!==E&&J.trigger("change")}function x(){u(),E=parseFloat(D.input.val()),isNaN(E)&&(E=0);var a=E,b=v();E-=b,E<B.min&&(E=B.min,J.trigger("touchspin.on.min"),A()),D.input.val(E.toFixed(B.decimals)),a!==E&&J.trigger("change")}function y(){A(),L=0,M="down",J.trigger("touchspin.on.startspin"),J.trigger("touchspin.on.startdownspin"),H=setTimeout(function(){F=setInterval(function(){L++,x()},B.stepinterval)},B.stepintervaldelay)}function z(){A(),L=0,M="up",J.trigger("touchspin.on.startspin"),J.trigger("touchspin.on.startupspin"),I=setTimeout(function(){G=setInterval(function(){L++,w()},B.stepinterval)},B.stepintervaldelay)}function A(){switch(clearTimeout(H),clearTimeout(I),clearInterval(F),clearInterval(G),M){case"up":J.trigger("touchspin.on.stopupspin"),J.trigger("touchspin.on.stopspin");break;case"down":J.trigger("touchspin.on.stopdownspin"),J.trigger("touchspin.on.stopspin")}L=0,M=!1}var B,C,D,E,F,G,H,I,J=a(this),K=J.data(),L=0,M=!1;g()})}}(jQuery);
(function($){"use strict";var extensionMethods={pips:function(settings){var slider=this,i,j,p,collection="",mousedownHandlers,min=slider._valueMin(),max=slider._valueMax(),pips=(max-min)/slider.options.step,$handles=slider.element.find(".ui-slider-handle"),$pips;var options={first:"label",last:"label",rest:"pip",labels:false,prefix:"",suffix:"",step:pips>100?Math.floor(pips*.05):1,formatLabel:function(value){return this.prefix+value+this.suffix}};if($.type(settings)==="object"||$.type(settings)==="undefined"){$.extend(options,settings);slider.element.data("pips-options",options)}else{if(settings==="destroy"){destroy()}else if(settings==="refresh"){slider.element.slider("pips",slider.element.data("pips-options"))}return}slider.options.pipStep=Math.abs(Math.round(options.step))||1;slider.element.off(".selectPip").addClass("ui-slider-pips").find(".ui-slider-pip").remove();var selectPip={single:function(value){this.resetClasses();$pips.filter(".ui-slider-pip-"+this.classLabel(value)).addClass("ui-slider-pip-selected");if(slider.options.range){$pips.each(function(k,v){var pipVal=$(v).children(".ui-slider-label").data("value");if(slider.options.range==="min"&&pipVal<value||slider.options.range==="max"&&pipVal>value){$(v).addClass("ui-slider-pip-inrange")}})}},range:function(values){this.resetClasses();for(i=0;i<values.length;i++){$pips.filter(".ui-slider-pip-"+this.classLabel(values[i])).addClass("ui-slider-pip-selected-"+(i+1))}if(slider.options.range){$pips.each(function(k,v){var pipVal=$(v).children(".ui-slider-label").data("value");if(pipVal>values[0]&&pipVal<values[1]){$(v).addClass("ui-slider-pip-inrange")}})}},classLabel:function(value){return value.toString().replace(".","-")},resetClasses:function(){var regex=/(^|\s*)(ui-slider-pip-selected|ui-slider-pip-inrange)(-{1,2}\d+|\s|$)/gi;$pips.removeClass(function(index,css){return(css.match(regex)||[]).join(" ")})}};function getClosestHandle(val){var h,k,sliderVals,comparedVals,closestVal,tempHandles=[],closestHandle=0;if(slider.values()&&slider.values().length){sliderVals=slider.values();comparedVals=$.map(sliderVals,function(v){return Math.abs(v-val)});closestVal=Math.min.apply(Math,comparedVals);for(h=0;h<comparedVals.length;h++){if(comparedVals[h]===closestVal){tempHandles.push(h)}}closestHandle=tempHandles[0];for(k=0;k<tempHandles.length;k++){if(slider._lastChangedValue===tempHandles[k]){closestHandle=tempHandles[k]}}if(slider.options.range&&tempHandles.length===2){if(val>sliderVals[1]){closestHandle=tempHandles[1]}else if(val<sliderVals[0]){closestHandle=tempHandles[0]}}}return closestHandle}function destroy(){slider.element.off(".selectPip").on("mousedown.slider",slider.element.data("mousedown-original")).removeClass("ui-slider-pips").find(".ui-slider-pip").remove()}function labelClick(label,e){if(slider.option("disabled")){return}var val=$(label).data("value"),indexToChange=getClosestHandle(val);if(slider.values()&&slider.values().length){slider.options.values[indexToChange]=slider._trimAlignValue(val)}else{slider.options.value=slider._trimAlignValue(val)}slider._refreshValue();slider._change(e,indexToChange)}function createPip(which){var label,percent,number=which,classes="ui-slider-pip",css="",value=slider.value(),values=slider.values(),labelValue,classLabel,labelIndex;if(which==="first"){number=0}else if(which==="last"){number=pips}labelValue=min+slider.options.step*number;classLabel=labelValue.toString().replace(".","-");labelIndex=number+min-min;if($.type(options.labels)==="array"){label=options.labels[labelIndex]||""}else if($.type(options.labels)==="object"){if(which==="first"){label=options.labels.first||""}else if(which==="last"){label=options.labels.last||""}else if($.type(options.labels.rest)==="array"){label=options.labels.rest[labelIndex-1]||""}else{label=labelValue}}else{label=labelValue}if(which==="first"){percent="0%";classes+=" ui-slider-pip-first";classes+=options.first==="label"?" ui-slider-pip-label":"";classes+=options.first===false?" ui-slider-pip-hide":""}else if(which==="last"){percent="100%";classes+=" ui-slider-pip-last";classes+=options.last==="label"?" ui-slider-pip-label":"";classes+=options.last===false?" ui-slider-pip-hide":""}else{percent=(100/pips*which).toFixed(4)+"%";classes+=options.rest==="label"?" ui-slider-pip-label":"";classes+=options.rest===false?" ui-slider-pip-hide":""}classes+=" ui-slider-pip-"+classLabel;if(values&&values.length){for(i=0;i<values.length;i++){if(labelValue===values[i]){classes+=" ui-slider-pip-initial-"+(i+1);classes+=" ui-slider-pip-selected-"+(i+1)}}if(slider.options.range){if(labelValue>values[0]&&labelValue<values[1]){classes+=" ui-slider-pip-inrange"}}}else{if(labelValue===value){classes+=" ui-slider-pip-initial";classes+=" ui-slider-pip-selected"}if(slider.options.range){if(slider.options.range==="min"&&labelValue<value||slider.options.range==="max"&&labelValue>value){classes+=" ui-slider-pip-inrange"}}}css=slider.options.orientation==="horizontal"?"left: "+percent:"bottom: "+percent;return'<span class="'+classes+'" style="'+css+'">'+'<span class="ui-slider-line"></span>'+'<span class="ui-slider-label" data-value="'+labelValue+'">'+options.formatLabel(label)+"</span>"+"</span>"}collection+=createPip("first");for(p=slider.options.pipStep;p<pips;p+=slider.options.pipStep){collection+=createPip(p)}collection+=createPip("last");slider.element.append(collection);$pips=slider.element.find(".ui-slider-pip");if($._data(slider.element.get(0),"events").mousedown&&$._data(slider.element.get(0),"events").mousedown.length){mousedownHandlers=$._data(slider.element.get(0),"events").mousedown}else{mousedownHandlers=slider.element.data("mousedown-handlers")}slider.element.data("mousedown-handlers",mousedownHandlers.slice());for(j=0;j<mousedownHandlers.length;j++){if(mousedownHandlers[j].namespace==="slider"){slider.element.data("mousedown-original",mousedownHandlers[j].handler)}}slider.element.off("mousedown.slider").on("mousedown.selectPip",function(e){var $target=$(e.target),closest=getClosestHandle($target.data("value")),$handle=$handles.eq(closest);$handle.addClass("ui-state-active");if($target.is(".ui-slider-label")){labelClick($target,e);slider.element.one("mouseup.selectPip",function(){$handle.removeClass("ui-state-active").focus()})}else{var originalMousedown=slider.element.data("mousedown-original");originalMousedown(e)}});slider.element.on("slide.selectPip slidechange.selectPip",function(e,ui){var $slider=$(this),value=$slider.slider("value"),values=$slider.slider("values");if(ui){value=ui.value;values=ui.values}if(slider.values()&&slider.values().length){selectPip.range(values)}else{selectPip.single(value)}})},float:function(settings){var i,slider=this,min=slider._valueMin(),max=slider._valueMax(),value=slider._value(),values=slider._values(),tipValues=[],$handles=slider.element.find(".ui-slider-handle");var options={handle:true,pips:false,labels:false,prefix:"",suffix:"",event:"slidechange slide",formatLabel:function(value){return this.prefix+value+this.suffix}};if($.type(settings)==="object"||$.type(settings)==="undefined"){$.extend(options,settings);slider.element.data("float-options",options)}else{if(settings==="destroy"){destroy()}else if(settings==="refresh"){slider.element.slider("float",slider.element.data("float-options"))}return}if(value<min){value=min}if(value>max){value=max}if(values&&values.length){for(i=0;i<values.length;i++){if(values[i]<min){values[i]=min}if(values[i]>max){values[i]=max}}}slider.element.addClass("ui-slider-float").find(".ui-slider-tip, .ui-slider-tip-label").remove();function destroy(){slider.element.off(".sliderFloat").removeClass("ui-slider-float").find(".ui-slider-tip, .ui-slider-tip-label").remove()}function getPipLabels(values){var vals=[],steppedVals=$.map(values,function(v){return Math.ceil((v-min)/slider.options.step)});if($.type(options.labels)==="array"){for(i=0;i<values.length;i++){vals[i]=options.labels[steppedVals[i]]||values[i]}}else if($.type(options.labels)==="object"){for(i=0;i<values.length;i++){if(values[i]===min){vals[i]=options.labels.first||min}else if(values[i]===max){vals[i]=options.labels.last||max}else if($.type(options.labels.rest)==="array"){vals[i]=options.labels.rest[steppedVals[i]-1]||values[i]}else{vals[i]=values[i]}}}else{for(i=0;i<values.length;i++){vals[i]=values[i]}}return vals}if(options.handle){tipValues=slider.values()&&slider.values().length?getPipLabels(values):getPipLabels([value]);for(i=0;i<tipValues.length;i++){$handles.eq(i).append($('<span class="ui-slider-tip">'+options.formatLabel(tipValues[i])+"</span>"))}}if(options.pips){slider.element.find(".ui-slider-label").each(function(k,v){var $this=$(v),val=[$this.data("value")],label,$tip;label=options.formatLabel(getPipLabels(val)[0]);$tip=$('<span class="ui-slider-tip-label">'+label+"</span>").insertAfter($this)})}if(options.event!=="slide"&&options.event!=="slidechange"&&options.event!=="slide slidechange"&&options.event!=="slidechange slide"){options.event="slidechange slide"}slider.element.off(".sliderFloat").on(options.event+".sliderFloat",function(e,ui){var uiValue=$.type(ui.value)==="array"?ui.value:[ui.value],val=options.formatLabel(getPipLabels(uiValue)[0]);$(ui.handle).find(".ui-slider-tip").html(val)})}};$.extend(true,$.ui.slider.prototype,extensionMethods)})(jQuery);
var chartJSLineStyle=[];chartJSLineStyle["solid"]=[];chartJSLineStyle["dotted"]=[1,4];chartJSLineStyle["shortDash"]=[2,1];chartJSLineStyle["dashed"]=[4,2];chartJSLineStyle["dashSpace"]=[4,6];chartJSLineStyle["longDashDot"]=[7,2,1,2];chartJSLineStyle["longDashShortDash"]=[10,4,4,4];chartJSLineStyle["gradient"]=[1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,9,9,8,8,7,7,6,6,5,5,4,4,3,3,2,2,1];function lineStyleFn(data){if(typeof chartJSLineStyle[data]==="object")return chartJSLineStyle[data];else return chartJSLineStyle["solid"]}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement){"use strict";if(this==null){throw new TypeError}var t=Object(this);var len=t.length>>>0;if(len===0){return-1}var n=0;if(arguments.length>0){n=Number(arguments[1]);if(n!=n){n=0}else if(n!=0&&n!=Infinity&&n!=-Infinity){n=(n>0||-1)*Math.floor(Math.abs(n))}}if(n>=len){return-1}var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++){if(k in t&&t[k]===searchElement){return k}}return-1}}var charJSPersonalDefaultOptions={};var charJSPersonalDefaultOptionsLine={};var charJSPersonalDefaultOptionsRadar={};var charJSPersonalDefaultOptionsPolarArea={};var charJSPersonalDefaultOptionsPie={};var charJSPersonalDefaultOptionsDoughnut={};var charJSPersonalDefaultOptionsBar={};var charJSPersonalDefaultOptionsStackedBar={};var charJSPersonalDefaultOptionsHorizontalBar={};var charJSPersonalDefaultOptionsHorizontalStackedBar={};function roundToWithThousands(config,num,place){var newval=1*unFormat(config,num);if(typeof newval=="number"&&place!="none"){var roundVal;if(place<=0){roundVal=-place;newval=+(Math.round(newval+"e+"+roundVal)+"e-"+roundVal)}else{roundVal=place;var divval="1e+"+roundVal;newval=+Math.round(newval/divval)*divval}}newval=fmtChartJS(config,newval,"none");return newval}function unFormat(config,num){if((config.decimalSeparator!="."||config.thousandSeparator!="")&&typeof num=="string"){var v1=""+num;if(config.thousandSeparator!=""){while(v1.indexOf(config.thousandSeparator)>=0)v1=""+v1.replace(config.thousandSeparator,"")}if(config.decimalSeparator!=".")v1=""+v1.replace(config.decimalSeparator,".");return 1*v1}else{return num}}var cachebis={};function fmtChartJSPerso(config,value,fmt){switch(fmt){case"SampleJS_Format":if(typeof value=="number")return_value="My Format : "+value.toString()+" $";else return_value=value+"XX";break;case"Change_Month":if(typeof value=="string")return_value=value.toString()+" 2014";else return_value=value.toString()+"YY";break;default:return_value=value;break}return return_value}function fmtChartJS(config,value,fmt){var return_value;if(fmt=="notformatted"){return_value=value}else if((fmt=="none"||fmt=="money")&&typeof value=="number"){if(config.roundNumber!="none"){var roundVal;if(config.roundNumber<=0){roundVal=-config.roundNumber;value=+(Math.round(value+"e+"+roundVal)+"e-"+roundVal)}else{roundVal=config.roundNumber;var divval="1e+"+roundVal;value=+Math.round(value/divval)*divval}}if(config.decimalSeparator!="."||config.thousandSeparator!=""){return_value=value.toString().replace(/\./g,config.decimalSeparator);if(config.thousandSeparator!=""){var part1=return_value;var part2="";var posdec=part1.indexOf(config.decimalSeparator);if(posdec>=0){part2=part1.substring(posdec+1,part1.length);part2=part2.split("").reverse().join("");part1=part1.substring(0,posdec)}part1=part1.toString().replace(/\B(?=(\d{3})+(?!\d))/g,config.thousandSeparator);part2=part2.split("").reverse().join("");return_value=part1;if(part2!="")return_value=return_value+config.decimalSeparator+part2}}else return_value=value;if(fmt=="money"){if(config.currencyPosition=="before")return_value=config.currency+return_value;else return_value=return_value+config.currency}}else if(fmt!="none"&&fmt!="notformatted"){return_value=fmtChartJSPerso(config,value,fmt)}else{return_value=value}return return_value}function addParameters2Function(data,fctName,fctList){var mathFunctions={mean:{data:data.data,datasetNr:data.v11},varianz:{data:data.data,datasetNr:data.v11},stddev:{data:data.data,datasetNr:data.v11},cv:{data:data.data,datasetNr:data.v11},median:{data:data.data,datasetNr:data.v11}};dif=false;if(fctName.substr(-3)=="Dif"){fctName=fctName.substr(0,fctName.length-3);dif=true}if(typeof eval(fctName)=="function"){var parameter=eval(fctList+"."+fctName);if(dif){return data.v3-window[fctName](parameter)}return window[fctName](parameter)}return null}function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function tmplbis(str,data,config){newstr=str;if(newstr.substr(0,config.templatesOpenTag.length)==config.templatesOpenTag)newstr="<%="+newstr.substr(config.templatesOpenTag.length,newstr.length-config.templatesOpenTag.length);if(newstr.substr(newstr.length-config.templatesCloseTag.length,config.templatesCloseTag.length)==config.templatesCloseTag)newstr=newstr.substr(0,newstr.length-config.templatesCloseTag.length)+"%>";return tmplter(newstr,data)}function tmplter(str,data){var mathFunctionList=["mean","varianz","stddev","cv","median"];var regexMath=new RegExp("<%=((?:(?:.*?)\\W)??)((?:"+mathFunctionList.join("|")+")(?:Dif)?)\\(([0-9]*?)\\)(.*?)%>","g");while(regexMath.test(str)){str=str.replace(regexMath,function($0,$1,$2,$3,$4){var rndFac;if($3)rndFac=$3;else rndFac=2;var value=addParameters2Function(data,$2,"mathFunctions");if(isNumber(value))return"<%="+$1+""+Math.round(Math.pow(10,rndFac)*value)/Math.pow(10,rndFac)+""+$4+"%>";return"<%= %>"})}var fn=/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(str)?cachebis[str]=cachebis[str]||tmplter(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\n]/g,"\\n").replace(/[\t]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn}if(typeof CanvasRenderingContext2D!=="undefined"){CanvasRenderingContext2D.prototype.fillTextMultiLine=function(text,x,y,yLevel,lineHeight,horizontal,detectMouseOnText,ctx,idText,rotate,x_decal,y_decal,posi,posj){var lines=(""+text).split("\n");if(yLevel=="middle"){if(horizontal)y-=(lines.length-1)/2*lineHeight}else if(yLevel=="bottom"){if(horizontal)y-=(lines.length-1)*lineHeight}var y_pos=y-lineHeight;for(var i=0;i<lines.length;i++){this.fillText(lines[i],x,y);y+=lineHeight}if(detectMouseOnText){var txtSize=ctx.measureTextMultiLine(text,lineHeight);var x_pos=[];var y_pos=[];x_pos.p1=x_decal+x;y_pos.p1=y_decal+y-lineHeight;var rotateRV=Math.PI/2+rotate;if(ctx.textAlign=="left"&&yLevel=="top"){x_pos.p1+=lineHeight*Math.cos(rotateRV);y_pos.p1+=lineHeight*Math.sin(rotateRV)}else if(ctx.textAlign=="left"&&yLevel=="middle"){x_pos.p1+=lineHeight/2*Math.cos(rotateRV);y_pos.p1+=lineHeight/2*Math.sin(rotateRV)}else if(ctx.textAlign=="left"&&yLevel=="bottom"){}else if(ctx.textAlign=="center"&&yLevel=="top"){x_pos.p1+=lineHeight*Math.cos(rotateRV)-txtSize.textWidth/2*Math.cos(rotate);y_pos.p1+=lineHeight*Math.sin(rotateRV)-txtSize.textWidth/2*Math.sin(rotate)}else if(ctx.textAlign=="center"&&yLevel=="middle"){x_pos.p1+=lineHeight/2*Math.cos(rotateRV)-txtSize.textWidth/2*Math.cos(rotate);y_pos.p1+=lineHeight/2*Math.sin(rotateRV)-txtSize.textWidth/2*Math.sin(rotate)}else if(ctx.textAlign=="center"&&yLevel=="bottom"){x_pos.p1-=txtSize.textWidth/2*Math.cos(rotate);y_pos.p1-=txtSize.textWidth/2*Math.sin(rotate)}else if(ctx.textAlign=="right"&&yLevel=="top"){x_pos.p1+=lineHeight*Math.cos(rotateRV)-txtSize.textWidth*Math.cos(rotate);y_pos.p1+=lineHeight*Math.sin(rotateRV)-txtSize.textWidth*Math.sin(rotate)}else if(ctx.textAlign=="right"&&yLevel=="middle"){x_pos.p1+=lineHeight/2*Math.cos(rotateRV)-txtSize.textWidth*Math.cos(rotate);y_pos.p1+=lineHeight/2*Math.sin(rotateRV)-txtSize.textWidth*Math.sin(rotate)}else if(ctx.textAlign=="right"&&yLevel=="bottom"){x_pos.p1-=txtSize.textWidth*Math.cos(rotate);y_pos.p1-=txtSize.textWidth*Math.sin(rotate)}x_pos.p2=x_pos.p1+txtSize.textWidth*Math.cos(rotate);y_pos.p2=y_pos.p1+txtSize.textWidth*Math.sin(rotate);x_pos.p3=x_pos.p1-lineHeight*Math.cos(rotateRV);y_pos.p3=y_pos.p1-lineHeight*Math.sin(rotateRV);x_pos.p4=x_pos.p3+txtSize.textWidth*Math.cos(rotate);y_pos.p4=y_pos.p3+txtSize.textWidth*Math.sin(rotate);jsTextMousePos[ctx.ChartNewId][jsTextMousePos[ctx.ChartNewId].length]=[idText,text,x_pos,y_pos,rotate,txtSize.textWidth,txtSize.textHeight,posi,posj]}};CanvasRenderingContext2D.prototype.measureTextMultiLine=function(text,lineHeight){var textWidth=0;var textHeight=0;var lg;var lines=(""+text).replace(/<BR>/gi,"\n").split("\n");if(lines.length>0)textHeight=lineHeight+1.5*(lines.length-1)*textHeight;var textHeight=lines.length*lineHeight;for(var i=0;i<lines.length;i++){lg=this.measureText(lines[i]).width;if(lg>textWidth)textWidth=lg}return{textWidth:textWidth,textHeight:textHeight}};if(typeof CanvasRenderingContext2D.prototype.setLineDash!=="function"){CanvasRenderingContext2D.prototype.setLineDash=function(listdash){return 0}}CanvasRenderingContext2D.prototype.drawRectangle=function(TheRectangle){var originalfillStyle=this.fillStyle;if(typeof TheRectangle.x=="undefined"){TheRectangle.x=0}if(TheRectangle.width<0){TheRectangle.x+=TheRectangle.width;TheRectangle.width*=-1}if(TheRectangle.height<0){TheRectangle.y+=TheRectangle.height;TheRectangle.height*=-1}if(typeof TheRectangle.y=="undefined"){TheRectangle.y=0}if(typeof TheRectangle.y=="undefined"){TheRectangle.y=0}if(typeof TheRectangle.backgroundColor!="undefined"){this.fillStyle=TheRectangle.backgroundColor}if(typeof TheRectangle.borderRadius=="undefined"){TheRectangle.borderRadius=0}if(typeof TheRectangle.borderSelection=="undefined"){TheRectangle.borderSelection=15}var rectangleRadius=parseInt(TheRectangle.borderRadius);if(TheRectangle.borders&&TheRectangle.bordersWidth>5&&this.fillStyle!="rgba(0,0,0,0)")rectangleRadius=0;if(TheRectangle.borders&&TheRectangle.fill&&TheRectangle.borderSelection==15&&rectangleRadius>0)return this;if(rectangleRadius==0&&TheRectangle.fill==true){this.fillRect(TheRectangle.x,TheRectangle.y,TheRectangle.width,TheRectangle.height)}if(rectangleRadius==0&&TheRectangle.borderSelection>=15&&TheRectangle.stroke==true){this.strokeRect(TheRectangle.x,TheRectangle.y,TheRectangle.width,TheRectangle.height)}if(rectangleRadius!=0||TheRectangle.borderSelection<15&&TheRectangle.stroke==true){if(rectangleRadius>TheRectangle.width/2){rectangleRadius=TheRectangle.width/2}if(TheRectangle.height<TheRectangle.width&&rectangleRadius>TheRectangle.height/2){rectangleRadius=TheRectangle.height/2}if(TheRectangle.fill){this.beginPath();this.lineWidth=0;this.strokeStyle="rgba(0,0,0,0)";this.moveTo(TheRectangle.x+rectangleRadius,TheRectangle.y);this.lineTo(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y);this.arc(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+rectangleRadius,rectangleRadius,1.5*Math.PI,0);this.lineTo(TheRectangle.x+TheRectangle.width,TheRectangle.y+TheRectangle.height-rectangleRadius);this.arc(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+TheRectangle.height-rectangleRadius,rectangleRadius,0,.5*Math.PI);this.lineTo(TheRectangle.x+rectangleRadius,TheRectangle.y+TheRectangle.height);this.arc(TheRectangle.x+rectangleRadius,TheRectangle.y+TheRectangle.height-rectangleRadius,rectangleRadius,.5*Math.PI,1*Math.PI);this.lineTo(TheRectangle.x,TheRectangle.y+rectangleRadius);this.arc(TheRectangle.x+rectangleRadius,TheRectangle.y+rectangleRadius,rectangleRadius,1*Math.PI,1.5*Math.PI);this.closePath();this.fill();this.stroke()}if(TheRectangle.stroke==true){var dleft=isBorder(TheRectangle.borderSelection,"LEFT")==false;var dright=isBorder(TheRectangle.borderSelection,"RIGHT")==false;var dtop=isBorder(TheRectangle.borderSelection,"TOP")==false;var dbottom=isBorder(TheRectangle.borderSelection,"BOTTOM")==false;if(dtop==false&&(dleft==true||TheRectangle.borderSelection==15)){dtop=true;this.beginPath();this.moveTo(TheRectangle.x+rectangleRadius,TheRectangle.y);this.lineTo(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y);if(isBorder(TheRectangle.borderSelection,"RIGHT"))this.arc(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+rectangleRadius,rectangleRadius,1.5*Math.PI,0);else this.stroke()}if(dright==false&&(dtop==true||TheRectangle.borderSelection==15)){dright=true;if(isBorder(TheRectangle.borderSelection,"TOP")==false){this.beginPath();this.moveTo(TheRectangle.x+TheRectangle.width,TheRectangle.y+rectangleRadius)}this.lineTo(TheRectangle.x+TheRectangle.width,TheRectangle.y+TheRectangle.height-rectangleRadius);if(isBorder(TheRectangle.borderSelection,"BOTTOM"))this.arc(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+TheRectangle.height-rectangleRadius,rectangleRadius,0,.5*Math.PI);else this.stroke()}if(dbottom==false&&(dright==true||TheRectangle.borderSelection==15)){dbottom=true;if(isBorder(TheRectangle.borderSelection,"RIGHT")==false){this.beginPath();this.moveTo(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+TheRectangle.height)}this.lineTo(TheRectangle.x+rectangleRadius,TheRectangle.y+TheRectangle.height);if(isBorder(TheRectangle.borderSelection,"LEFT"))this.arc(TheRectangle.x+rectangleRadius,TheRectangle.y+TheRectangle.height-rectangleRadius,rectangleRadius,.5*Math.PI,1*Math.PI);else this.stroke()}if(dleft==false&&(dbottom==true||TheRectangle.borderSelection==15)){dleft=true;if(isBorder(TheRectangle.borderSelection,"BOTTOM")==false){this.beginPath();this.moveTo(TheRectangle.x,TheRectangle.y+TheRectangle.height-rectangleRadius)}this.lineTo(TheRectangle.x,TheRectangle.y+rectangleRadius);if(isBorder(TheRectangle.borderSelection,"TOP")){this.arc(TheRectangle.x+rectangleRadius,TheRectangle.y+rectangleRadius,rectangleRadius,1*Math.PI,1.5*Math.PI);if(TheRectangle.borderSelection==15){this.closePath();this.stroke()}}else this.stroke()}if(dtop==false&&(dleft==true||TheRectangle.borderSelection==15)){dtop=true;if(isBorder(TheRectangle.borderSelection,"LEFT")==false){this.beginPath();this.moveTo(TheRectangle.x+rectangleRadius,TheRectangle.y)}this.lineTo(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y);if(isBorder(TheRectangle.borderSelection,"RIGHT"))this.arc(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+rectangleRadius,rectangleRadius,1.5*Math.PI,0);else this.stroke()}if(dright==false&&(dtop==true||TheRectangle.borderSelection==15)){dright=true;if(isBorder(TheRectangle.borderSelection,"TOP")==false){this.beginPath();this.moveTo(TheRectangle.x+TheRectangle.width,TheRectangle.y+rectangleRadius)}this.lineTo(TheRectangle.x+TheRectangle.width,TheRectangle.y+TheRectangle.height-rectangleRadius);if(isBorder(TheRectangle.borderSelection,"BOTTOM"))this.arc(TheRectangle.x+TheRectangle.width-rectangleRadius,TheRectangle.y+TheRectangle.height-rectangleRadius,rectangleRadius,0,.5*Math.PI);else this.stroke()}if(this.fillStyle!="rgba(0,0,0,0)"&&TheRectangle.borderSelection==15)this.fill()}}this.fillStyle=originalfillStyle;return this}}cursorDivCreated=false;function createCursorDiv(){if(cursorDivCreated==false){var div=document.createElement("divCursor");div.id="divCursor";div.style.position="absolute";document.body.appendChild(div);cursorDivCreated=true}}initChartJsResize=false;var jsGraphResize=new Array;function addResponsiveChart(id,ctx,data,config){if(initChartJsResize==false){if(window.addEventListener){window.addEventListener("resize",chartJsResize)}else{window.attachEvent("resize",chartJsResize)}}jsGraphResize[jsGraphResize.length]=[id,ctx.tpchart,ctx,data,config]}var container;function getMaximumWidth(domNode){if(domNode.parentNode!=null)if(domNode.parentNode!=undefined)container=domNode.parentNode;return container.clientWidth}function getMaximumHeight(domNode){if(domNode.parentNode!=null)if(domNode.parentNode!=undefined)container=domNode.parentNode;return container.clientHeight}function resizeCtx(ctx,config){if(isIE()<9&&isIE()!=false)return true;if(config.responsive){if(typeof config.maintainAspectRatio=="undefined")config.maintainAspectRatio=true;if(typeof config.responsiveMinWidth=="undefined")config.responsiveMinWidth=0;if(typeof config.responsiveMinHeight=="undefined")config.responsiveMinHeight=0;if(typeof config.responsiveMaxWidth=="undefined")config.responsiveMaxWidth=9999999;if(typeof config.responsiveMaxHeight=="undefined")config.responsiveMaxHeight=9999999;var canvas=ctx.canvas;if(typeof ctx.aspectRatio=="undefined"){ctx.aspectRatio=canvas.width/canvas.height}var newWidth=getMaximumWidth(canvas);var newHeight=config.maintainAspectRatio?newWidth/ctx.aspectRatio:getMaximumHeight(canvas);newWidth=Math.min(config.responsiveMaxWidth,Math.max(config.responsiveMinWidth,newWidth));newHeight=Math.min(config.responsiveMaxHeight,Math.max(config.responsiveMinHeight,newHeight));if(typeof ctx.DefaultchartTextScale=="undefined")ctx.DefaultchartTextScale=config.chartTextScale;if(typeof ctx.DefaultchartLineScale=="undefined")ctx.DefaultchartLineScale=config.chartLineScale;if(typeof ctx.DefaultchartSpaceScale=="undefined")ctx.DefaultchartSpaceScale=config.chartSpaceScale;if(typeof ctx.chartTextScale!="undefined"&&config.responsiveScaleContent){ctx.chartTextScale=ctx.DefaultchartTextScale*(newWidth/ctx.initialWidth);ctx.chartLineScale=ctx.DefaultchartLineScale*(newWidth/ctx.initialWidth);ctx.chartSpaceScale=ctx.DefaultchartSpaceScale*(newWidth/ctx.initialWidth)}if(window.devicePixelRatio>1){ctx.canvas.style.width=newWidth+"px";ctx.canvas.style.height=newHeight+"px"}ctx.canvas.height=newHeight*Math.max(1,window.devicePixelRatio);ctx.canvas.width=newWidth*Math.max(1,window.devicePixelRatio);ctx.scale(Math.max(1,window.devicePixelRatio),Math.max(1,window.devicePixelRatio))}else if(window.devicePixelRatio>1){if(typeof ctx.original_width=="undefined"){ctx.original_width=ctx.canvas.width;ctx.original_height=ctx.canvas.height}ctx.canvas.style.width=ctx.original_width+"px";ctx.canvas.style.height=ctx.original_height+"px";ctx.canvas.height=ctx.original_height*window.devicePixelRatio;ctx.canvas.width=ctx.original_width*window.devicePixelRatio;ctx.scale(window.devicePixelRatio,window.devicePixelRatio)}}function chartJsResize(){for(var i=0;i<jsGraphResize.length;i++){if(jsGraphResize[i][2].firstPass==0){}else if(jsGraphResize[i][2].firstPass==9){jsGraphResize[i][2].firstPass=2;redrawGraph(jsGraphResize[i][2],jsGraphResize[i][3],jsGraphResize[i][4])}else if(jsGraphResize[i][2].firstPass<10){jsGraphResize[i][2].firstPass+=10}}}function testRedraw(ctx,data,config){if(ctx.firstPass>10){ctx.firstPass=2;redrawGraph(ctx,data,config);return true}else{return false}}function updateChart(ctx,data,config,animation,runanimationcompletefunction){if(ctx.firstPass==9){ctx.runanimationcompletefunction=runanimationcompletefunction;if(animation)ctx.firstPass=1;else ctx.firstPass=2;if(config.responsive){for(var i=0;i<jsGraphResize.length;i++){if(jsGraphResize[i][2].ChartNewId==ctx.ChartNewId){jsGraphResize[i][3]=data;jsGraphResize[i][4]=config}}}redrawGraph(ctx,data,config)}}function redrawGraph(ctx,data,config){var myGraph=new Chart(ctx);eval("myGraph."+ctx.tpchart+"(data,config);")}function checkBrowser(){this.ver=navigator.appVersion;this.dom=document.getElementById?1:0;this.ie5=this.ver.indexOf("MSIE 5")>-1&&this.dom?1:0;this.ie4=document.all&&!this.dom?1:0;this.ns5=this.dom&&parseInt(this.ver)>=5?1:0;this.ns4=document.layers&&!this.dom?1:0;this.bw=this.ie5||this.ie4||this.ns4||this.ns5;return this}bw=new checkBrowser;fromLeft=10;fromTop=10;function cursorInit(){scrolled=bw.ns4||bw.ns5?"window.pageYOffset":"document.body.scrollTop";if(bw.ns4)document.captureEvents(Event.MOUSEMOVE)}function makeCursorObj(obj,nest){createCursorDiv();nest=!nest?"":"document."+nest+".";this.css=bw.dom?document.getElementById(obj).style:bw.ie4?document.all[obj].style:bw.ns4?eval(nest+"document.layers."+obj):0;this.moveIt=b_moveIt;cursorInit();return this}function b_moveIt(x,y){this.x=x;this.y=y;this.css.left=this.x+"px";this.css.top=this.y+"px"}function isIE(){var myNav=navigator.userAgent.toLowerCase();return myNav.indexOf("msie")!=-1?parseInt(myNav.split("msie")[1]):false}function mergeChartConfig(defaults,userDefined){var returnObj={};for(var attrname in defaults){returnObj[attrname]=defaults[attrname]}for(var attrnameBis in userDefined){returnObj[attrnameBis]=userDefined[attrnameBis]}return returnObj}function sleep(ms){var dt=new Date;dt.setTime(dt.getTime()+ms);while((new Date).getTime()<dt.getTime()){}}function saveCanvas(ctx,data,config){cvSave=ctx.getImageData(0,0,ctx.canvas.width,ctx.canvas.height);var saveCanvasConfig1={savePng:false,annotateDisplay:false,animation:false,dynamicDisplay:false};savePngConfig1=mergeChartConfig(config,saveCanvasConfig1);savePngConfig1.clearRect=false;redrawGraph(ctx,data,savePngConfig1);var image;if(config.savePngOutput=="NewWindow"){image=ctx.canvas.toDataURL();ctx.putImageData(cvSave,0,0);window.open(image,"_blank")}if(config.savePngOutput=="CurrentWindow"){image=ctx.canvas.toDataURL();ctx.putImageData(cvSave,0,0);window.location.href=image}if(config.savePngOutput=="Save"){image=ctx.canvas.toDataURL();var downloadLink=document.createElement("a");downloadLink.href=image;downloadLink.download=config.savePngName+".png";document.body.appendChild(downloadLink);downloadLink.click();document.body.removeChild(downloadLink)}}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var dynamicDisplay=new Array;var dynamicDisplayList=new Array;function dynamicFunction(data,config,ctx){if(isIE()<9&&isIE()!=false)return true;if(config.dynamicDisplay&&ctx.firstPass==0){if(ctx.canvas.id==""){var cvdate=new Date;var cvmillsec=cvdate.getTime();ctx.canvas.id="Canvas_"+cvmillsec}if(typeof dynamicDisplay[ctx.canvas.id]=="undefined"){dynamicDisplayList[dynamicDisplayList["length"]]=ctx.canvas.id;dynamicDisplay[ctx.canvas.id]=[ctx,data,config];window.onscroll=scrollFunction}if(!isScrolledIntoView(ctx.canvas,config))return false}return true}function isScrolledIntoView(element,config){var xPosition=0;var yPosition=0;var eltWidth,eltHeight;if(typeof element.recomputedHeight=="undefined"){if(window.devicePixelRatio){element.recomputedHeight=element.height/window.devicePixelRatio;element.recomputedWidth=element.width/window.devicePixelRatio}else{element.recomputedHeight=element.height;element.recomputedWidth=element.width}}eltWidth=element.recomputedWidth;eltHeight=element.recomputedHeight;elem=element;while(elem){xPosition+=elem.offsetLeft+elem.clientLeft;yPosition+=elem.offsetTop+elem.clientTop;elem=elem.offsetParent}if(xPosition+eltWidth*config.dynamicDisplayXPartOfChart>=window.pageXOffset&&xPosition+eltWidth*config.dynamicDisplayXPartOfChart<=window.pageXOffset+window.innerWidth&&yPosition+eltHeight*config.dynamicDisplayYPartOfChart>=window.pageYOffset&&yPosition+eltHeight*config.dynamicDisplayYPartOfChart<=window.pageYOffset+window.innerHeight){return true}else{return false}}function scrollFunction(){for(var i=0;i<dynamicDisplayList["length"];i++){if(dynamicDisplay[dynamicDisplayList[i]][0].firstPass==0){redrawGraph(dynamicDisplay[dynamicDisplayList[i]][0],dynamicDisplay[dynamicDisplayList[i]][1],dynamicDisplay[dynamicDisplayList[i]][2])}}}var jsGraphAnnotate=new Array;var jsTextMousePos=new Array;var mouseActionData=new Array;function clearAnnotate(ctxid){jsGraphAnnotate[ctxid]=[];jsTextMousePos[ctxid]=[]}function getMousePos(canvas,evt){var rect=canvas.getBoundingClientRect();return{x:evt.clientX-rect.left,y:evt.clientY-rect.top}}function isHighLighted(reference,ctx,data,statData,posi,posj,othervars){var i;if(typeof data.special=="object"){for(i=data.special.length-1;i>=0;i--){if(data.special[i].typespecial=="highLight"&&data.special[i].posi==posi&&data.special[i].posj==posj)return true}}return false}function isNotHighLighted(reference,ctx,data,statData,posi,posj,othervars){return!isHighLighted(reference,ctx,data,statData,posi,posj,othervars)}function deleteHighLight(ctx,data){var i;if(typeof data.special=="object"){for(i=data.special.length-1;i>=0;i--){if(data.special[i].typespecial=="highLight")data.special.splice(i,1)}}}function highLightAction(action,ctx,data,config,v1,v2){if(ctx.firstPass!=9)return;var currentlyDisplayed=[-1,-1];var redisplay=false;var i,j;if(typeof data.special=="object"){for(i=0;i<data.special.length&&currentlyDisplayed[0]==-1;i++){if(data.special[i].typespecial=="highLight")currentlyDisplayed=[data.special[i].posi,data.special[i].posj]}}var deleteOld=false;var addNew=false;var property;var output;if(action=="HIDE"&&currentlyDisplayed[0]!=-1)deleteOld=true;else if(action!="HIDE"&&config.highLightFullLine=="group"&&currentlyDisplayed[1]!=v2){if(currentlyDisplayed[0]!=-1)deleteOld=true;addNew=true}else if(action!="HIDE"&&config.highLightFullLine==false&&(currentlyDisplayed[0]!=v1||currentlyDisplayed[1]!=v2)){if(currentlyDisplayed[0]!=-1)deleteOld=true;addNew=true}else if(action!="HIDE"&&config.highLightFullLine==true&&currentlyDisplayed[0]!=v1){if(currentlyDisplayed[0]!=-1)deleteOld=true;addNew=true}if(deleteOld){redisplay=true;for(i=data.special.length-1;i>=0;i--){if(data.special[i].typespecial=="highLight")data.special.splice(i,1)}}if(addNew){redisplay=true;if(typeof data.special=="undefined")data.special=[];if(config.highLightFullLine=="group"){for(j=0;j<data.datasets.length;j++){if(!(data.datasets[j].mouseDetection==false)){output="";for(property in config.highLightSet){if(output!="")output=output+",";if(typeof config.highLightSet[property]=="string")output+=property+': "'+config.highLightSet[property]+'"';else output+=property+": "+config.highLightSet[property]}eval("data.special[data.special.length]={"+output+"};");data.special[data.special.length-1].posi=j;data.special[data.special.length-1].posj=v2;data.special[data.special.length-1].typespecial="highLight"}}}else if(config.highLightFullLine==true){if(!(data.datasets[v1].mouseDetection==false)){for(j=0;j<data.datasets[v1].data.length;j++){output="";for(property in config.highLightSet){if(output!="")output=output+",";if(typeof config.highLightSet[property]=="string")output+=property+': "'+config.highLightSet[property]+'"';else output+=property+": "+config.highLightSet[property]}eval("data.special[data.special.length]={"+output+"};");data.special[data.special.length-1].posi=v1;data.special[data.special.length-1].posj=j;data.special[data.special.length-1].typespecial="highLight"}}}else if(!(data.datasets[v1].mouseDetection==false)){output="";for(property in config.highLightSet){if(output!="")output=output+",";if(typeof config.highLightSet[property]=="string")output+=property+': "'+config.highLightSet[property]+'"';else output+=property+": "+config.highLightSet[property]}eval("data.special[data.special.length]={"+output+"};");data.special[data.special.length-1].posi=v1;data.special[data.special.length-1].posj=v2;data.special[data.special.length-1].typespecial="highLight"}}if(redisplay==true){updateChart(ctx,data,config,false,config.highLightRerunEndFunction)}}var inMouseAction=new Array;function doMouseAction(event,ctx,action){if(ctx.firstPass!=9)return;if(action=="mousedown")action=action+" "+event.which;if(ctx.mouseAction.indexOf(action)<0){return}var config=mouseActionData[ctx.ChartNewId].config;var data=mouseActionData[ctx.ChartNewId].data;var i,prevShown,prevShowSaved;var inRect,P12,D12,D34,P13,D13,D24,y1,y2,y3,y4;var pieceOfChartFound=[];var textOnChartFound=[];var distance,angle,topY,bottomY,leftX,rightX;var mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";var canvas_pos=getMousePos(ctx.canvas,event);var realAction;var annotateDIV,showDiv;if(action=="mousedown 1")realAction="mousedown left";else if(action=="mousedown 2")realAction="mousedown middle";else if(action=="mousedown 3")realAction="mousedown right";else if(action==mousewheelevt)realAction="mousewheel";else realAction=action;for(i=0;i<jsGraphAnnotate[ctx.ChartNewId]["length"];i++){if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="ARC"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]];distance=Math.sqrt((canvas_pos.x-myStatData.midPosX)*(canvas_pos.x-myStatData.midPosX)+(canvas_pos.y-myStatData.midPosY)*(canvas_pos.y-myStatData.midPosY));if(distance>myStatData.int_radius&&distance<myStatData.radiusOffset){angle=(Math.acos((canvas_pos.x-myStatData.midPosX)/distance)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(canvas_pos.y<myStatData.midPosY)angle=-angle;angle=((angle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);myStatData.startAngle=((myStatData.startAngle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);myStatData.endAngle=((myStatData.endAngle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(myStatData.endAngle<myStatData.startAngle)myStatData.endAngle+=2*Math.PI;if(angle>myStatData.startAngle&&angle<myStatData.endAngle||angle>myStatData.startAngle-2*Math.PI&&angle<myStatData.endAngle-2*Math.PI||angle>myStatData.startAngle+2*Math.PI&&angle<myStatData.endAngle+2*Math.PI){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;pieceOfChartFound[pieceOfChartFound.length]={piece:i,myStatData:myStatData}}}}else if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="MARC"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]][jsGraphAnnotate[ctx.ChartNewId][i][2]];distance=Math.sqrt((canvas_pos.x-myStatData.midPosX)*(canvas_pos.x-myStatData.midPosX)+(canvas_pos.y-myStatData.midPosY)*(canvas_pos.y-myStatData.midPosY));if(distance>myStatData.int_radius&&distance<myStatData.radiusOffset){angle=(Math.acos((canvas_pos.x-myStatData.midPosX)/distance)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(canvas_pos.y<myStatData.midPosY)angle=-angle;angle=((angle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);myStatData.startAngle=((myStatData.startAngle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);myStatData.endAngle=((myStatData.endAngle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(myStatData.endAngle<myStatData.startAngle)myStatData.endAngle+=2*Math.PI;if(angle>myStatData.startAngle&&angle<myStatData.endAngle||angle>myStatData.startAngle-2*Math.PI&&angle<myStatData.endAngle-2*Math.PI||angle>myStatData.startAngle+2*Math.PI&&angle<myStatData.endAngle+2*Math.PI){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;pieceOfChartFound[pieceOfChartFound.length]={piece:i,myStatData:myStatData}}}}else if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="RECT"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]][jsGraphAnnotate[ctx.ChartNewId][i][2]];topY=Math.max(myStatData.yPosBottom,myStatData.yPosTop);bottomY=Math.min(myStatData.yPosBottom,myStatData.yPosTop);if(topY-bottomY<config.annotateBarMinimumDetectionHeight){topY=(topY+bottomY+config.annotateBarMinimumDetectionHeight)/2;bottomY=topY-config.annotateBarMinimumDetectionHeight}leftX=Math.min(myStatData.xPosLeft,myStatData.xPosRight);rightX=Math.max(myStatData.xPosLeft,myStatData.xPosRight);if(rightX-leftX<config.annotateBarMinimumDetectionHeight){rightX=(rightX+leftX+config.annotateBarMinimumDetectionHeight)/2;leftX=rightX-config.annotateBarMinimumDetectionHeight}if(canvas_pos.x>leftX&&canvas_pos.x<rightX&&canvas_pos.y<topY&&canvas_pos.y>bottomY){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;pieceOfChartFound[pieceOfChartFound.length]={piece:i,myStatData:myStatData}}}else if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="POINT"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]][jsGraphAnnotate[ctx.ChartNewId][i][2]];if(config.detectAnnotateOnFullLine){if(canvas_pos.x<Math.min(myStatData.annotateStartPosX,myStatData.annotateEndPosX)-Math.ceil(ctx.chartSpaceScale*config.pointHitDetectionRadius)||canvas_pos.x>Math.max(myStatData.annotateStartPosX,myStatData.annotateEndPosX)+Math.ceil(ctx.chartSpaceScale*config.pointHitDetectionRadius)||canvas_pos.y<Math.min(myStatData.annotateStartPosY,myStatData.annotateEndPosY)-Math.ceil(ctx.chartSpaceScale*config.pointHitDetectionRadius)||canvas_pos.y>Math.max(myStatData.annotateStartPosY,myStatData.annotateEndPosY)+Math.ceil(ctx.chartSpaceScale*config.pointHitDetectionRadius)){distance=Math.ceil(ctx.chartSpaceScale*config.pointHitDetectionRadius)+1}else{if(typeof myStatData.D1A=="undefined"){distance=Math.abs(canvas_pos.x-myStatData.posX)}else if(typeof myStatData.D2A=="undefined"){distance=Math.abs(canvas_pos.y-myStatData.posY)}else{var D2B=-myStatData.D2A*canvas_pos.x+canvas_pos.y;var g=-(myStatData.D1B-D2B)/(myStatData.D1A-myStatData.D2A);var h=myStatData.D2A*g+D2B;distance=Math.sqrt((canvas_pos.x-g)*(canvas_pos.x-g)+(canvas_pos.y-h)*(canvas_pos.y-h))}}}else{distance=Math.sqrt((canvas_pos.x-myStatData.posX)*(canvas_pos.x-myStatData.posX)+(canvas_pos.y-myStatData.posY)*(canvas_pos.y-myStatData.posY))}if(distance<Math.ceil(ctx.chartSpaceScale*config.pointHitDetectionRadius)){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;pieceOfChartFound[pieceOfChartFound.length]={piece:i,myStatData:myStatData}}}}if(config.detectMouseOnText){for(i=0;i<jsTextMousePos[ctx.ChartNewId]["length"];i++){inRect=true;if(Math.abs(jsTextMousePos[ctx.ChartNewId][i][3].p1-jsTextMousePos[ctx.ChartNewId][i][3].p2)<config.zeroValue){if(canvas_pos.x<Math.min(jsTextMousePos[ctx.ChartNewId][i][2].p1,jsTextMousePos[ctx.ChartNewId][i][2].p2))inRect=false;if(canvas_pos.x>Math.max(jsTextMousePos[ctx.ChartNewId][i][2].p1,jsTextMousePos[ctx.ChartNewId][i][2].p2))inRect=false;if(canvas_pos.y<Math.min(jsTextMousePos[ctx.ChartNewId][i][3].p1,jsTextMousePos[ctx.ChartNewId][i][3].p3))inRect=false;if(canvas_pos.y>Math.max(jsTextMousePos[ctx.ChartNewId][i][3].p1,jsTextMousePos[ctx.ChartNewId][i][3].p3))inRect=false}else if(Math.abs(jsTextMousePos[ctx.ChartNewId][i][2].p1-jsTextMousePos[ctx.ChartNewId][i][2].p2)<config.zeroValue){if(canvas_pos.x<Math.min(jsTextMousePos[ctx.ChartNewId][i][2].p1,jsTextMousePos[ctx.ChartNewId][i][2].p3))inRect=false;if(canvas_pos.x>Math.max(jsTextMousePos[ctx.ChartNewId][i][2].p1,jsTextMousePos[ctx.ChartNewId][i][2].p3))inRect=false;if(canvas_pos.y<Math.min(jsTextMousePos[ctx.ChartNewId][i][3].p1,jsTextMousePos[ctx.ChartNewId][i][3].p2))inRect=false;if(canvas_pos.y>Math.max(jsTextMousePos[ctx.ChartNewId][i][3].p1,jsTextMousePos[ctx.ChartNewId][i][3].p2))inRect=false}else{P12=Math.tan(jsTextMousePos[ctx.ChartNewId][i][4]);D12=jsTextMousePos[ctx.ChartNewId][i][3].p1-P12*jsTextMousePos[ctx.ChartNewId][i][2].p1;D34=jsTextMousePos[ctx.ChartNewId][i][3].p3-P12*jsTextMousePos[ctx.ChartNewId][i][2].p3;P13=-1/P12;D13=jsTextMousePos[ctx.ChartNewId][i][3].p1-P13*jsTextMousePos[ctx.ChartNewId][i][2].p1;D24=jsTextMousePos[ctx.ChartNewId][i][3].p4-P13*jsTextMousePos[ctx.ChartNewId][i][2].p4;y1=P12*canvas_pos.x+D12;y2=P12*canvas_pos.x+D34;y3=P13*canvas_pos.x+D13;y4=P13*canvas_pos.x+D24;if(canvas_pos.y<Math.min(y1,y2))inRect=false;if(canvas_pos.y>Math.max(y1,y2))inRect=false;if(canvas_pos.y<Math.min(y3,y4))inRect=false;if(canvas_pos.y>Math.max(y3,y4))inRect=false}if(inRect)textOnChartFound[textOnChartFound.length]=i}}function isAction(option,action){return option==action||option=="mousemove"&&(action=="mousewheel"||action=="mouseout")}if(config.savePng&&isAction(config.savePngFunction,realAction)){saveCanvas(ctx,data,config)}var whoToReferAnnotate=-1;var whoToReferHighLight=-1;var referAnnotateIsPoint=false;var referHighLightIsPoint=false;for(i=pieceOfChartFound.length-1;i>=0;i--){if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[i].piece][4]){if(referAnnotateIsPoint==false){if(whoToReferAnnotate==-1)whoToReferAnnotate=i;if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[i].piece][0]=="POINT"){whoToReferAnnotate=i;referAnnotateIsPoint=true}}}if(referHighLightIsPoint==false){if(whoToReferHighLight==-1)whoToReferHighLight=i;if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[i].piece][0]=="POINT"){whoToReferHighLight=i;referHighLightIsPoint=true}}}if(config.annotateDisplay&&isAction(config.annotateFunction,realAction)){annotateDIV=document.getElementById("divCursor");annotateDIV.style.display=false?"":"none";if(pieceOfChartFound.length>0){annotateDIV.className=config.annotateClassName?config.annotateClassName:"";annotateDIV.style.border=config.annotateClassName?"":config.annotateBorder;annotateDIV.style.padding=config.annotateClassName?"":config.annotatePadding;annotateDIV.style.borderRadius=config.annotateClassName?"":config.annotateBorderRadius;annotateDIV.style.backgroundColor=config.annotateClassName?"":config.annotateBackgroundColor;annotateDIV.style.color=config.annotateClassName?"":config.annotateFontColor;annotateDIV.style.fontFamily=config.annotateClassName?"":config.annotateFontFamily;annotateDIV.style.fontSize=config.annotateClassName?"":Math.ceil(ctx.chartTextScale*config.annotateFontSize).toString()+"pt";annotateDIV.style.fontStyle=config.annotateClassName?"":config.annotateFontStyle;annotateDIV.style.zIndex=999;ctx.save();ctx.font=annotateDIV.style.fontStyle+" "+annotateDIV.style.fontSize+" "+annotateDIV.style.fontFamily;var rect=ctx.canvas.getBoundingClientRect();showDiv=false;if(whoToReferAnnotate!=-1){if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][4]){if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][0]=="ARC")dispString=tmplbis(setOptionValue(true,true,1,"ANNOTATELABEL",ctx,data,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][3],undefined,config.annotateLabel,"annotateLabel",jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][1],-1,{otherVal:true}),pieceOfChartFound[whoToReferAnnotate].myStatData,config);else dispString=tmplbis(setOptionValue(true,true,1,"ANNOTATELABEL",ctx,data,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][3],undefined,config.annotateLabel,"annotateLabel",jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][1],jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferAnnotate].piece][2],{otherVal:true}),pieceOfChartFound[whoToReferAnnotate].myStatData,config);textMsr=ctx.measureTextMultiLine(dispString,1*annotateDIV.style.fontSize.replace("pt",""));ctx.restore();annotateDIV.innerHTML=dispString;x=bw.ns4||bw.ns5?event.pageX:event.x;y=bw.ns4||bw.ns5?event.pageY:event.y;if(bw.ie4||bw.ie5)y=y+eval(scrolled);if(config.annotateRelocate===true){var relocateX,relocateY;relocateX=0;relocateY=0;if(x+fromLeft+textMsr.textWidth>window.innerWidth-rect.left-fromLeft)relocateX=-textMsr.textWidth;if(y+fromTop+textMsr.textHeight>1*window.innerHeight-1*rect.top+fromTop)relocateY-=textMsr.textHeight+2*fromTop;oCursor.moveIt(Math.max(8-rect.left,x+fromLeft+relocateX),Math.max(8-rect.top,y+fromTop+relocateY))}else oCursor.moveIt(x+fromLeft,y+fromTop);annotateDIV.style.display=true?"":"none";showDiv=true}}}}if(inMouseAction[ctx.ChartNewId]==false&&mouseActionData[ctx.ChartNewId].prevShow>=0&&isAction("mousemove",realAction)&&(pieceOfChartFound.length==0||mouseActionData[ctx.ChartNewId].prevShow!=pieceOfChartFound[pieceOfChartFound.length-1].piece)){inMouseAction[ctx.ChartNewId]=true;prevShow=mouseActionData[ctx.ChartNewId].prevShow;mouseActionData[ctx.ChartNewId].prevShow=-1;if(config.highLight&&isAction(config.highLightMouseFunction,realAction)&&pieceOfChartFound.length==0){highLightAction("HIDE",ctx,data,config,null,null)}if(typeof config.annotateFunctionOut=="function"){if(jsGraphAnnotate[ctx.ChartNewId][prevShow][0]=="ARC")config.annotateFunctionOut("OUTANNOTATE",ctx,data,jsGraphAnnotate[ctx.ChartNewId][prevShow][3],jsGraphAnnotate[ctx.ChartNewId][prevShow][1],-1,null);else config.annotateFunctionOut("OUTANNOTATE",ctx,data,jsGraphAnnotate[ctx.ChartNewId][prevShow][3],jsGraphAnnotate[ctx.ChartNewId][prevShow][1],jsGraphAnnotate[ctx.ChartNewId][prevShow][2],null)}inMouseAction[ctx.ChartNewId]=false}if(pieceOfChartFound.length>0&&inMouseAction[ctx.ChartNewId]==false&&mouseActionData[ctx.ChartNewId].prevShow!=pieceOfChartFound[whoToReferHighLight].piece&&isAction("mousemove",realAction)){inMouseAction[ctx.ChartNewId]=true;prevShow=mouseActionData[ctx.ChartNewId].prevShow;if(config.highLight&&isAction(config.highLightMouseFunction,realAction)){if(whoToReferHighLight!=-1){if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][0]=="ARC")highLightAction("ARC",ctx,data,config,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][1],-1);else highLightAction(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][0],ctx,data,config,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][1],jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][2])}}if(typeof config.annotateFunctionIn=="function"){if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[pieceOfChartFound.length-1].piece][0]=="ARC")config.annotateFunctionIn("INANNOTATE",ctx,data,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[pieceOfChartFound.length-1].piece][3],jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[pieceOfChartFound.length-1].piece][1],-1,null);else config.annotateFunctionIn("INANNOTATE",ctx,data,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[pieceOfChartFound.length-1].piece][3],jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[pieceOfChartFound.length-1].piece][1],jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[pieceOfChartFound.length-1].piece][2],null)}inMouseAction[ctx.ChartNewId]=false;mouseActionData[ctx.ChartNewId].prevShow=pieceOfChartFound[whoToReferHighLight].piece}if(config.highLight&&isAction(config.highLightMouseFunction,realAction)&&isAction("mousemove",realAction)==false){if(pieceOfChartFound.length==0)highLightAction("HIDE",ctx,data,config,null,null);else{if(whoToReferHighLight!=-1){if(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][0]=="ARC")highLightAction("ARC",ctx,data,config,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][1],-1);else highLightAction(jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][0],ctx,data,config,jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][1],jsGraphAnnotate[ctx.ChartNewId][pieceOfChartFound[whoToReferHighLight].piece][2])}}}function runFunction(toBeRun){var i;for(i=0;i<pieceOfChartFound.length;i++){toBeRun(event,ctx,config,data,pieceOfChartFound[i].myStatData)}for(i=0;i<textOnChartFound.length;i++){toBeRun(event,ctx,config,data,{type:"CLICKONTEXT",values:jsTextMousePos[ctx.ChartNewId][textOnChartFound[i]]})}if(pieceOfChartFound.length==0&&textOnChartFound.length==0){toBeRun(event,ctx,config,data,null)}}if(typeof config.mouseMove=="function"&&isAction("mousemove",realAction))runFunction(config.mouseMove);if(typeof config.mouseDownLeft=="function"&&isAction("mousedown left",realAction))runFunction(config.mouseDownLeft);if(typeof config.mouseDownRight=="function"&&isAction("mousedown right",realAction))runFunction(config.mouseDownRight);if(typeof config.mouseDownMiddle=="function"&&isAction("mousedown middle",realAction))runFunction(config.mouseDownMiddle);if(typeof config.mouseWheel=="function"&&isAction("mousewheel",realAction))runFunction(config.mouseWheel);if(typeof config.mouseOut=="function"&&isAction("mouseout",realAction))runFunction(config.mouseOut);if(typeof config.mouseDblClick=="function"&&isAction("dblclick",realAction))runFunction(config.mouseDblClick)}window.Chart=function(context){var chart=this;var animationOptions={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){if((t/=1/2)<1)return 1/2*t*t;return-1/2*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){if((t/=1/2)<1)return 1/2*t*t*t;return 1/2*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){if((t/=1/2)<1)return 1/2*t*t*t*t;return-1/2*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){if((t/=1/2)<1)return 1/2*t*t*t*t*t;return 1/2*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-1/2*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return t==0?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return t==1?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){if(t==0)return 0;if(t==1)return 1;if((t/=1/2)<1)return 1/2*Math.pow(2,10*(t-1));return 1/2*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){if(t>=1)return t;return-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){if((t/=1/2)<1)return-1/2*(Math.sqrt(1-t*t)-1);return 1/2*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1)==1)return 1;if(!p)p=1*.3;if(a<Math.abs(1)){a=1;s=p/4}else s=p/(2*Math.PI)*Math.asin(1/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*1-s)*(2*Math.PI)/p))},easeOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1)==1)return 1;if(!p)p=1*.3;if(a<Math.abs(1)){a=1;s=p/4}else s=p/(2*Math.PI)*Math.asin(1/a);return a*Math.pow(2,-10*t)*Math.sin((t*1-s)*(2*Math.PI)/p)+1},easeInOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t==0)return 0;if((t/=1/2)==2)return 1;if(!p)p=1*(.3*1.5);if(a<Math.abs(1)){a=1;s=p/4}else s=p/(2*Math.PI)*Math.asin(1/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*1-s)*(2*Math.PI)/p));return a*Math.pow(2,-10*(t-=1))*Math.sin((t*1-s)*(2*Math.PI)/p)*.5+1},easeInBack:function(t){var s=1.70158;return 1*(t/=1)*t*((s+1)*t-s)},easeOutBack:function(t){var s=1.70158;return 1*((t=t/1-1)*t*((s+1)*t+s)+1)},easeInOutBack:function(t){var s=1.70158;if((t/=1/2)<1)return 1/2*(t*t*(((s*=1.525)+1)*t-s));return 1/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)},easeInBounce:function(t){return 1-animationOptions.easeOutBounce(1-t)},easeOutBounce:function(t){if((t/=1)<1/2.75){return 1*(7.5625*t*t)}else if(t<2/2.75){return 1*(7.5625*(t-=1.5/2.75)*t+.75)}else if(t<2.5/2.75){return 1*(7.5625*(t-=2.25/2.75)*t+.9375)}else{return 1*(7.5625*(t-=2.625/2.75)*t+.984375)}},easeInOutBounce:function(t){if(t<1/2)return animationOptions.easeInBounce(t*2)*.5;return animationOptions.easeOutBounce(t*2-1)*.5+1*.5}};var width=context.canvas.width;var height=context.canvas.height;this.Doughnut=function(data,options){chart.Doughnut.defaults=chart.defaults.PieAndDoughnutV2;chart.Doughnut.defaults=mergeChartConfig(chart.defaults.PieAndDoughnut,chart.Doughnut.defaults);if(isIE()<9&&isIE()!=false)chart.Doughnut.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.Doughnut.defaults);chart.Doughnut.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Doughnut.defaults);chart.Doughnut.defaults=mergeChartConfig(chart.Doughnut.defaults,charJSPersonalDefaultOptions);chart.Doughnut.defaults=mergeChartConfig(chart.Doughnut.defaults,charJSPersonalDefaultOptionsDoughnut);var config=options?mergeChartConfig(chart.Doughnut.defaults,options):chart.Doughnut.defaults;return new Doughnut(data,config,context)};this.PolarArea=function(data,options){chart.PolarArea.defaults=chart.defaults.PolarAreaV2;chart.PolarArea.defaults=mergeChartConfig(chart.defaults.PolarArea,chart.PolarArea.defaults);if(isIE()<9&&isIE()!=false)chart.PolarArea.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.PolarArea.defaults);chart.PolarArea.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.PolarArea.defaults);chart.PolarArea.defaults=mergeChartConfig(chart.PolarArea.defaults,charJSPersonalDefaultOptions);chart.PolarArea.defaults=mergeChartConfig(chart.PolarArea.defaults,charJSPersonalDefaultOptionsPolarArea);var config=options?mergeChartConfig(chart.PolarArea.defaults,options):chart.PolarArea.defaults;return new PolarArea(data,config,context)};this.PolarArea=function(data,options){chart.PolarArea.defaults=chart.defaults.PolarAreaV2;chart.PolarArea.defaults=mergeChartConfig(chart.defaults.PolarArea,chart.PolarArea.defaults);if(isIE()<9&&isIE()!=false)chart.PolarArea.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.PolarArea.defaults);chart.PolarArea.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.PolarArea.defaults);chart.PolarArea.defaults=mergeChartConfig(chart.PolarArea.defaults,charJSPersonalDefaultOptions);chart.PolarArea.defaults=mergeChartConfig(chart.PolarArea.defaults,charJSPersonalDefaultOptionsPolarArea);var config=options?mergeChartConfig(chart.PolarArea.defaults,options):chart.PolarArea.defaults;return new PolarArea(data,config,context)};this.Radar=function(data,options){chart.Radar.defaults={highLightSet:{pointDotRadius:15,pointDot:true},inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,yAxisMinimumInterval:"none",scaleGridLinesStep:1,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleShowLine:true,scaleLineColor:"rgba(0,0,0,.1)",scaleLineStyle:"solid",scaleLineWidth:1,scaleShowLabels:false,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,angleShowLineOut:true,angleLineColor:"rgba(0,0,0,.1)",angleLineStyle:"solid",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:12,pointLabelFontColor:"#666",pointDot:true,pointDotRadius:3,pointDotStrokeWidth:1,pointDotStrokeStyle:"solid",datasetFill:true,datasetStrokeWidth:2,datasetStrokeStyle:"solid",animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3%>",pointHitDetectionRadius:10,startAngle:90};if(isIE()<9&&isIE()!=false)chart.Radar.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.Radar.defaults);chart.Radar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Radar.defaults);chart.Radar.defaults=mergeChartConfig(chart.Radar.defaults,charJSPersonalDefaultOptions);chart.Radar.defaults=mergeChartConfig(chart.Radar.defaults,charJSPersonalDefaultOptionsRadar);var config=options?mergeChartConfig(chart.Radar.defaults,options):chart.Radar.defaults;return new Radar(data,config,context)};this.Pie=function(data,options){chart.Pie.defaults=chart.defaults.PieAndDoughnutV2;chart.Pie.defaults=mergeChartConfig(chart.defaults.PieAndDoughnut,chart.Pie.defaults);if(isIE()<9&&isIE()!=false)chart.Pie.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.Pie.defaults);chart.Pie.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Pie.defaults);chart.Pie.defaults=mergeChartConfig(chart.Pie.defaults,charJSPersonalDefaultOptions);chart.Pie.defaults=mergeChartConfig(chart.Pie.defaults,charJSPersonalDefaultOptionsPie);var config=options?mergeChartConfig(chart.Pie.defaults,options):chart.Pie.defaults;return new Pie(data,config,context)};this.Doughnut=function(data,options){chart.Doughnut.defaults=chart.defaults.PieAndDoughnutV2;chart.Doughnut.defaults=mergeChartConfig(chart.defaults.PieAndDoughnut,chart.Doughnut.defaults);if(isIE()<9&&isIE()!=false)chart.Doughnut.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.Doughnut.defaults);chart.Doughnut.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Doughnut.defaults);chart.Doughnut.defaults=mergeChartConfig(chart.Doughnut.defaults,charJSPersonalDefaultOptions);chart.Doughnut.defaults=mergeChartConfig(chart.Doughnut.defaults,charJSPersonalDefaultOptionsDoughnut);var config=options?mergeChartConfig(chart.Doughnut.defaults,options):chart.Doughnut.defaults;return new Doughnut(data,config,context)};this.Line=function(data,options){chart.Line.defaults={inGraphDataShow:false,highLightSet:{pointDotRadius:15,pointDot:true},inGraphDataPaddingX:3,inGraphDataPaddingY:3,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"left",inGraphDataVAlign:"bottom",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",scaleOverlay:false,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleSteps2:null,scaleStepWidth2:null,scaleStartValue2:null,scaleLabel2:"<%=value%>",scaleLineColor:"rgba(0,0,0,.1)",scaleLineStyle:"solid",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineStyle:"solid",scaleGridLineWidth:1,showYAxisMin:true,rotateLabels:"smart",rotateTLabels:"smart",logarithmic:false,logarithmic2:false,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,bezierCurve:true,linkType:0,bezierCurveTension:.4,pointDot:true,pointDotRadius:4,pointDotStrokeStyle:"solid",pointDotStrokeWidth:2,datasetStrokeStyle:"solid",datasetStrokeWidth:2,datasetFill:true,animation:true,animationSteps:60,animationEasing:"easeOutQuart",extrapolateMissingData:true,onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3%>",pointHitDetectionRadius:10,xAxisMiddle:false};if(isIE()<9&&isIE()!=false)chart.Line.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.Line.defaults);chart.Line.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Line.defaults);chart.Line.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.Line.defaults);chart.Line.defaults=mergeChartConfig(chart.Line.defaults,charJSPersonalDefaultOptions);chart.Line.defaults=mergeChartConfig(chart.Line.defaults,charJSPersonalDefaultOptionsLine);var config=options?mergeChartConfig(chart.Line.defaults,options):chart.Line.defaults;return new Line(data,config,context)};this.StackedBar=function(data,options){chart.StackedBar.defaults={annotateBarMinimumDetectionHeight:0,highLightSet:{pointDotRadius:15,barStrokeWidth:5,pointDot:true},inGraphDataShow:false,inGraphDataPaddingX:0,inGraphDataPaddingY:-3,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"center",inGraphDataVAlign:"top",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:2,inGraphDataYPosition:3,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleSteps2:null,scaleStepWidth2:null,scaleStartValue2:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineStyle:"solid",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleLabel2:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineStyle:"solid",scaleGridLineWidth:1,showYAxisMin:true,rotateLabels:"smart",rotateTLabels:"smart",scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,pointDot:true,pointDotRadius:4,pointDotStrokeStyle:"solid",pointDotStrokeWidth:2,barShowStroke:true,barValueSpacing:5,barDatasetSpacing:1,spaceBetweenBar:0,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,bezierCurve:true,linkType:0,bezierCurveTension:.4,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>",pointHitDetectionRadius:10};if(isIE()<9&&isIE()!=false)chart.StackedBar.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.StackedBar.defaults);chart.StackedBar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.StackedBar.defaults);chart.StackedBar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.StackedBar.defaults);chart.StackedBar.defaults=mergeChartConfig(chart.StackedBar.defaults,charJSPersonalDefaultOptions);chart.StackedBar.defaults=mergeChartConfig(chart.StackedBar.defaults,charJSPersonalDefaultOptionsStackedBar);var config=options?mergeChartConfig(chart.StackedBar.defaults,options):chart.StackedBar.defaults;return new StackedBar(data,config,context)};this.HorizontalStackedBar=function(data,options){chart.HorizontalStackedBar.defaults={annotateBarMinimumDetectionHeight:0,highLightSet:{pointDotRadius:15,barStrokeWidth:5,pointDot:true},inGraphDataShow:false,inGraphDataPaddingX:-3,inGraphDataPaddingY:0,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"right",inGraphDataVAlign:"middle",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:3,inGraphDataYPosition:2,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineStyle:"solid",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineStyle:"solid",scaleGridLineWidth:1,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,showYAxisMin:true,rotateLabels:"smart",rotateTLabels:"smart",barShowStroke:true,barValueSpacing:5,barDatasetSpacing:1,spaceBetweenBar:0,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>",reverseOrder:false};if(isIE()<9&&isIE()!=false)chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.HorizontalStackedBar.defaults);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.HorizontalStackedBar.defaults);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.HorizontalStackedBar.defaults);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.HorizontalStackedBar.defaults,charJSPersonalDefaultOptions);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.HorizontalStackedBar.defaults,charJSPersonalDefaultOptionsHorizontalStackedBar);var config=options?mergeChartConfig(chart.HorizontalStackedBar.defaults,options):chart.HorizontalStackedBar.defaults;return new HorizontalStackedBar(data,config,context)};this.Bar=function(data,options){chart.Bar.defaults={annotateBarMinimumDetectionHeight:0,highLightSet:{pointDotRadius:15,barStrokeWidth:5,pointDot:true},inGraphDataShow:false,inGraphDataPaddingX:0,inGraphDataPaddingY:3,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"center",inGraphDataVAlign:"bottom",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:2,inGraphDataYPosition:3,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleSteps2:null,scaleStepWidth2:null,scaleStartValue2:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineStyle:"solid",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleLabel2:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleGridLineStyle:"solid",showYAxisMin:true,rotateLabels:"smart",rotateTLabels:"smart",logarithmic:false,logarithmic2:false,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,barShowStroke:true,barValueSpacing:5,barDatasetSpacing:1,barBorderRadius:0,complementaryBar:false,complementaryBarFullHeight:false,complementaryColor:"rgba(100,100,100,0.3)",complementaryStrokeColor:"rgba(100,100,100,0.1)",pointDot:true,pointDotRadius:4,pointDotStrokeStyle:"solid",pointDotStrokeWidth:2,extrapolateMissingData:true,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,bezierCurve:true,linkType:0,bezierCurveTension:.4,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>",pointHitDetectionRadius:10};if(isIE()<9&&isIE()!=false)chart.Bar.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.Bar.defaults);chart.Bar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Bar.defaults);chart.Bar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.Bar.defaults);chart.Bar.defaults=mergeChartConfig(chart.Bar.defaults,charJSPersonalDefaultOptions);chart.Bar.defaults=mergeChartConfig(chart.Bar.defaults,charJSPersonalDefaultOptionsBar);var config=options?mergeChartConfig(chart.Bar.defaults,options):chart.Bar.defaults;return new Bar(data,config,context)};this.HorizontalBar=function(data,options){chart.HorizontalBar.defaults={annotateBarMinimumDetectionHeight:0,highLightSet:{pointDotRadius:15,barStrokeWidth:5,pointDot:true},inGraphDataShow:false,inGraphDataPaddingX:3,inGraphDataPaddingY:0,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"left",inGraphDataVAlign:"middle",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:3,inGraphDataYPosition:2,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineStyle:"solid",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineStyle:"solid",scaleGridLineWidth:1,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,showYAxisMin:true,rotateLabels:"smart",rotateTLabels:"smart",barShowStroke:true,barValueSpacing:5,barDatasetSpacing:1,barBorderRadius:0,complementaryBar:false,complementaryColor:"rgba(100,100,100,0.3)",complementaryStrokeColor:"rgba(100,100,100,0.1)",animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>",reverseOrder:false};if(isIE()<9&&isIE()!=false)chart.HorizontalBar.defaults=mergeChartConfig(chart.defaults.IExplorer8,chart.HorizontalBar.defaults);chart.HorizontalBar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.HorizontalBar.defaults);chart.HorizontalBar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.HorizontalBar.defaults);chart.HorizontalBar.defaults=mergeChartConfig(chart.HorizontalBar.defaults,charJSPersonalDefaultOptions);chart.HorizontalBar.defaults=mergeChartConfig(chart.HorizontalBar.defaults,charJSPersonalDefaultOptionsHorizontalBar);var config=options?mergeChartConfig(chart.HorizontalBar.defaults,options):chart.HorizontalBar.defaults;return new HorizontalBar(data,config,context)};chart.defaults={};chart.defaults.IExplorer8={annotateBackgroundColor:"black",annotateFontColor:"white"};chart.defaults.commonOptions={generateConvertedData:false,displayData:true,showZeroValue:true,chartTextScale:1,chartLineScale:1,chartSpaceScale:1,multiGraph:false,clearRect:true,dynamicDisplay:false,dynamicDisplayXPartOfChart:.5,dynamicDisplayYPartOfChart:.5,animationForceSetTimeOut:false,graphSpaceBefore:5,graphSpaceAfter:5,canvasBorders:false,canvasBackgroundColor:"none",canvasBordersRadius:0,canvasBordersSelection:15,canvasBordersWidth:3,canvasBordersStyle:"solid",canvasBordersColor:"black",zeroValue:1e-10,graphTitle:"",graphTitleAlign:"center",graphTitleShift:10,graphTitleFontFamily:"'Arial'",graphTitleFontSize:24,graphTitleFontStyle:"bold",graphTitleFontColor:"#666",graphTitleSpaceBefore:5,graphTitleSpaceAfter:5,graphTitleBorders:false,graphTitleBordersRadius:0,graphTitleBordersColor:"black",graphTitleBordersXSpace:3,graphTitleBordersYSpace:3,graphTitleBordersSelection:15,graphTitleBordersWidth:1,graphTitleBordersStyle:"solid",graphTitleBackgroundColor:"none",graphSubTitle:"",graphSubTitleAlign:"center",graphSubTitleShift:10,graphSubTitleFontFamily:"'Arial'",graphSubTitleFontSize:18,graphSubTitleFontStyle:"normal",graphSubTitleFontColor:"#666",graphSubTitleSpaceBefore:5,graphSubTitleSpaceAfter:5,graphSubTitleBorders:false,graphSubTitleBordersColor:"black",graphSubTitleBordersRadius:0,graphSubTitleBordersXSpace:3,graphSubTitleBordersYSpace:3,graphSubTitleBordersSelection:15,graphSubTitleBordersWidth:1,graphSubTitleBordersStyle:"solid",graphSubTitleBackgroundColor:"none",footNote:"footNote",footNoteAlign:"left",footNoteShift:10,footNoteFontFamily:"'Arial'",footNoteFontSize:8,footNoteFontStyle:"bold",footNoteFontColor:"#666",footNoteSpaceBefore:5,footNoteSpaceAfter:5,footNoteBorders:false,footNoteBordersColor:"black",footNoteBordersRadius:0,footNoteBordersXSpace:3,footNoteBordersYSpace:3,footNoteBordersSelection:15,footNoteBordersWidth:1,footNoteBordersStyle:"solid",footNoteBackgroundColor:"none",legend:false,legendWhenToDraw:"all",showSingleLegend:false,maxLegendCols:999,maxLegendLines:999,legendPosY:4,legendPosX:-2,legendFontFamily:"'Arial'",legendFontSize:12,legendFontStyle:"normal",legendFontColor:"#666",legendBlockSize:15,legendBlockRadius:0,legendBorders:true,legendBordersStyle:"solid",legendBordersWidth:1,legendBordersSelection:15,legendBordersColors:"#666",legendBordersRadius:0,legendBordersSpaceBefore:5,legendBordersSpaceAfter:5,legendBordersSpaceLeft:5,legendBordersSpaceRight:5,legendSpaceBeforeText:5,legendSpaceAfterText:5,legendSpaceLeftText:5,legendSpaceRightText:5,legendSpaceBetweenTextVertical:5,legendSpaceBetweenTextHorizontal:5,legendSpaceBetweenBoxAndText:5,legendFillColor:"rgba(0,0,0,0)",legendXPadding:0,legendYPadding:0,inGraphDataBorders:false,inGraphDataBordersRadius:0,inGraphDataBordersColor:"black",inGraphDataBordersXSpace:3,inGraphDataBordersYSpace:3,inGraphDataBordersSelection:15,inGraphDataBordersWidth:1,inGraphDataBordersStyle:"solid",inGraphDataBackgroundColor:"none",annotateDisplay:false,annotateRelocate:false,savePng:false,savePngOutput:"NewWindow",savePngFunction:"mousedown right",savePngBackgroundColor:"WHITE",annotateFunction:"mousemove",annotateFontFamily:"'Arial'",annotateBorder:"none",annotateBorderRadius:"2px",annotateBackgroundColor:"rgba(0,0,0,0.8)",annotateFontSize:12,annotateFontColor:"white",annotateFontStyle:"normal",annotatePadding:"3px",annotateClassName:"",annotateFunctionIn:null,annotateFunctionOut:null,detectMouseOnText:false,crossText:[""],crossTextIter:["all"],crossTextOverlay:[true],crossTextFontFamily:["'Arial'"],crossTextFontSize:[12],crossTextFontStyle:["normal"],crossTextFontColor:["rgba(220,220,220,1)"],crossTextRelativePosX:[2],crossTextRelativePosY:[2],crossTextBaseline:["middle"],crossTextAlign:["center"],crossTextPosX:[0],crossTextPosY:[0],crossTextAngle:[0],crossTextFunction:null,crossTextBorders:[false],crossTextBordersColor:["black"],crossTextBordersRadius:[0],crossTextBordersXSpace:[3],crossTextBordersYSpace:[3],crossTextBordersSelection:[15],crossTextBordersWidth:[1],crossTextBordersStyle:["solid"],crossTextBackgroundColor:["none"],crossImage:[undefined],crossImageIter:["all"],crossImageOverlay:[true],crossImageRelativePosX:[2],crossImageRelativePosY:[2],crossImageBaseline:["middle"],crossImageAlign:["center"],crossImagePosX:[0],crossImagePosY:[0],crossImageAngle:[0],spaceTop:0,spaceBottom:0,spaceRight:0,spaceLeft:0,decimalSeparator:".",thousandSeparator:"",currency:"",currencyPosition:"after",roundNumber:"none",roundPct:-1,templatesOpenTag:"<%=",templatesCloseTag:"%>",fmtV1:"none",fmtV2:"none",fmtV3:"none",fmtV4:"none",fmtV5:"none",fmtV6:"none",fmtV6T:"none",fmtV7:"none",fmtV8:"none",fmtV8T:"none",fmtV9:"none",fmtV10:"none",fmtV11:"none",fmtV12:"none",fmtV13:"none",fmtV14:"none",fmtV15:"none",fmtXLabel:"none",fmtTopXLabel:"none",fmtYLabel:"none",fmtYLabel2:"none",fmtLegend:"none",animationStartValue:0,animationStopValue:1,animationCount:1,animationPauseTime:5,animationBackward:false,animationStartWithDataset:1,animationStartWithData:1,animationLeftToRight:false,animationByDataset:false,defaultStrokeColor:"rgba(220,220,220,1)",defaultFillColor:"rgba(220,220,220,0.5)",defaultLineWidth:2,graphMaximized:false,contextMenu:true,mouseDownRight:null,mouseDownLeft:null,mouseDownMiddle:null,mouseMove:null,mouseOut:null,mouseDblClick:null,mouseWheel:null,highLight:false,highLightMouseFunction:"mousemove",highLightFullLine:false,highLightRerunEndFunction:false,savePngName:"canvas",responsive:false,responsiveMinWidth:0,responsiveMinHeight:0,responsiveMaxWidth:9999999,responsiveMaxHeight:9999999,maintainAspectRatio:true,responsiveScaleContent:false,responsiveWindowInitialWidth:false,markerShape:"circle",barStrokeWidth:2,initFunction:null,beforeDrawFunction:null,endDrawDataFunction:null,endDrawScaleFunction:null};chart.defaults.PolarAreaV1={highLightSet:{color:"red"},inGraphDataTmpl:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",annotateLabel:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>"};chart.defaults.PolarAreaV2={highLightSet:{fillColor:"red"},inGraphDataTmpl:"<%=(data.labels.length == 1 ? (v1 == '' ? '' : v1+':') + v3 + ' (' + v6 + ' %)' : (i==0 ? v2 : '') )%>",annotateLabel:"<%=(v2 == '' ? '' : v2) + (v2!='' && v1 !='' ? ' - ' : '')+(v1 == '' ? '' : v1)+(v2!='' || v1 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>"};chart.defaults.PolarArea={inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataPaddingAngle:0,inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,inGraphDataAnglePosition:2,scaleOverlay:true,scaleOverride:false,scaleOverride2:false,forceSecondScale:false,scaleGridLinesStep:1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleShowLine:true,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleLineStyle:"solid",scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeStyle:"solid",segmentStrokeWidth:2,animation:true,animationByData:"ByArc",animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,onAnimationComplete:null,startAngle:90,totalAmplitude:360,radiusScale:1};chart.defaults.PieAndDoughnutV1={inGraphDataTmpl:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",annotateLabel:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>"};chart.defaults.PieAndDoughnutV2={inGraphDataTmpl:"<%=(data.labels.length == 1 ? (v1 == '' ? '' : v1+':') + v3 + ' (' + v6 + ' %)' : (i==0 ? v2 : '') )%>",annotateLabel:"<%=(v2 == '' ? '' : v2) + (v2!='' && v1 !='' ? ' - ' : '')+(v1 == '' ? '' : v1)+(v2!='' || v1 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>"};chart.defaults.PieAndDoughnut={highLightSet:{expandOutRadius:.1,expandInRadius:-.1},inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataPaddingAngle:0,inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,inGraphDataAnglePosition:2,inGraphDataMinimumAngle:0,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeStyle:"solid",segmentStrokeWidth:2,percentageInnerCutout:50,animation:true,animationByData:false,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,onAnimationComplete:null,startAngle:90,totalAmplitude:360,radiusScale:1,radiusDataWeight:1,radiusSpaceWeight:.3};chart.defaults.xyAxisCommonOptions={maxBarWidth:-1,drawXScaleLine:[{position:"bottom"}],yAxisMinimumInterval:"none",yAxisMinimumInterval2:"none",yScaleLabelsMinimumWidth:0,xScaleLabelsMinimumWidth:0,yAxisLeft:true,yAxisRight:false,xAxisBottom:true,xAxisTop:false,xAxisSpaceBetweenLabels:5,fullWidthGraph:false,yAxisLabel:"",yAxisLabel2:"",yAxisFontFamily:"'Arial'",yAxisFontSize:16,yAxisFontStyle:"normal",yAxisFontColor:"#666",yAxisLabelSpaceRight:5,yAxisLabelSpaceLeft:5,yAxisSpaceRight:5,yAxisSpaceLeft:5,yAxisLabelBorders:false,yAxisLabelBordersColor:"black",yAxisLabelBordersRadius:0,yAxisLabelBordersXSpace:3,yAxisLabelBordersYSpace:3,yAxisLabelBordersSelection:15,yAxisLabelBordersWidth:1,yAxisLabelBordersStyle:"solid",yAxisLabelBackgroundColor:"none",xAxisLabel:"",xAxisLabel2:"",xTAxisLabel:"",xAxisFontFamily:"'Arial'",xAxisFontSize:16,xAxisFontStyle:"normal",xAxisFontColor:"#666",xAxisLabelSpaceBefore:5,xAxisLabelSpaceAfter:5,xAxisSpaceBefore:5,xAxisSpaceAfter:5,xAxisLabelBorders:false,xAxisLabelBordersColor:"black",xAxisLabelBordersRadius:0,xAxisLabelBordersXSpace:3,xAxisLabelBordersYSpace:3,xAxisLabelBordersSelection:15,xAxisLabelBordersWidth:1,xAxisLabelBordersStyle:"solid",xAxisLabelBackgroundColor:"none",showXLabels:1,firstLabelToShow:1,showYLabels:1,firstYLabelToShow:1,yAxisUnit:"",yAxisUnit2:"",yAxisUnitFontFamily:"'Arial'",yAxisUnitFontSize:8,yAxisUnitFontStyle:"normal",yAxisUnitFontColor:"#666",yAxisUnitSpaceBefore:5,yAxisUnitSpaceAfter:5,yAxisUnitBorders:false,yAxisUnitBordersColor:"black",yAxisUnitBordersradius:0,yAxisUnitBordersXSpace:3,yAxisUnitBordersYSpace:3,yAxisUnitBordersSelection:15,yAxisUnitBordersWidth:1,yAxisUnitBordersStyle:"solid",yAxisUnitBackgroundColor:"none",scaleMinorTickWidth:1,scaleMinorTickColor:"rgba(0,0,0,.05)",scaleMinorTickStyle:"solid",scaleMinorTickSizeTop:3,scaleMinorTickSizeBottom:3,scaleMinorTickSizeRight:3,scaleMinorTickSizeLeft:3,scaleMinorTickHorizontalCount:0,scaleMinorTickVerticalCount:0,scaleMinorTickVerticalLines:true,scaleMinorTickHorizontalLines:true,tickColor:"gridLine",minorTickColor:"gridLine"};var clear=function(c){c.clearRect(0,0,width,height)};function init_and_start(ctx,data,config){var i;if(typeof ctx.initialWidth=="undefined")ctx.initialWidth=ctx.canvas.width;if(typeof ctx.chartTextScale=="undefined")ctx.chartTextScale=config.chartTextScale;if(typeof ctx.chartLineScale=="undefined")ctx.chartLineScale=config.chartLineScale;if(typeof ctx.chartSpaceScale=="undefined")ctx.chartSpaceScale=config.chartSpaceScale;if(typeof ctx.firstPass=="undefined"){ctx.firstPass=0;if(config.responsive&&!config.multiGraph){addResponsiveChart(ctx.ChartNewId,ctx,data,config)}if(typeof data.labels=="undefined")data.labels=[];if(data.labels.length==0){var mxlgt=0;for(i=0;i<data.datasets.length;i++){mxlgt=Max([mxlgt,data.datasets[i].data.length])}for(i=0;i<mxlgt;i++)data.labels[i]=""}}if(typeof ctx.ChartNewId=="undefined"){ctx.runanimationcompletefunction=true;var cvdate=new Date;var cvmillsec=cvdate.getTime();ctx.ChartNewId=ctx.tpchart+"_"+cvmillsec;ctx._eventListeners={}}resizeCtx(ctx,config);if(!dynamicFunction(data,config,ctx))return false;if(!config.multiGraph&&ctx.firstPass!=0){clearAnnotate(ctx.ChartNewId)}if(typeof jsGraphAnnotate[ctx.ChartNewId]=="undefined"){jsGraphAnnotate[ctx.ChartNewId]=new Array;jsTextMousePos[ctx.ChartNewId]=new Array}for(i=0;i<data.datasets.length;i++){if(typeof data.datasets[i].title=="undefined"&&typeof data.datasets[i].label!="undefined"){data.datasets[i].title=data.datasets[i].label}}defMouse(ctx,data,config);if(ctx.firstPass==0){if(config.animation)ctx.firstPass=1;else ctx.firstPass=2}setRect(ctx,config);return true}var MPolarArea=function(data,config,ctx){var maxSize,scaleHop,calculatedScale,labelHeight,scaleHeight,valueBounds,labelTemplateString,msr,midPosX,midPosY;ctx.tpchart="PolarArea";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);var realCumulativeAngle=((config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);config.logarithmic=false;config.logarithmic2=false;var realAmplitude=((config.totalAmplitude*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(realAmplitude<=config.zeroValue)realAmplitude=2*Math.PI;var debAngle=(realCumulativeAngle-realAmplitude+4*Math.PI)%(2*Math.PI);var finAngle=debAngle+realAmplitude;valueBounds=getValueBounds();labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,null,true,false,false,true,"PolarArea")}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,null,true,false,false,true,"PolarArea")}var outerVal=calculatedScale.graphMin+calculatedScale.steps*calculatedScale.stepValue;var drwSize=calculatePieDrawingSize(ctx,msr,config,data,statData);midPosX=drwSize.midPieX;midPosY=drwSize.midPieY;scaleHop=Math.floor(drwSize.radius/calculatedScale.steps);if(scaleHop>0){initPassVariableData_part2(statData,data,config,ctx,{midPosX:midPosX,midPosY:midPosY,int_radius:0,ext_radius:scaleHop*calculatedScale.steps,calculatedScale:calculatedScale,scaleHop:scaleHop,outerVal:outerVal});animationLoop(config,msr.legendMsr,drawScale,drawAllSegments,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,midPosX,midPosY,midPosX-(Min([msr.availableHeight,msr.availableWidth])/2-5),midPosY+(Min([msr.availableHeight,msr.availableWidth])/2-5),data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function drawAllSegments(animationDecimal){var fixAngle=0;var firstAngle=statData[0][0].firstAngle;if(1*config.animationStartWithData>1&&1*config.animationStartWithData-1<data.length){fixAngle=statData[config.animationStartWithData-1].startAngle-statData[0][0].firstAngle;firstAngle=statData[config.animationStartWithData-1].startAngle}prevAngle=statData[0][0].firstAngle;for(var j=0;j<data.labels.length;j++){var scaleAnimation=1,rotateAnimation=1;if(config.animation){if(config.animateScale){scaleAnimation=animationDecimal}if(config.animateRotate){rotateAnimation=animationDecimal}}for(var i=0;i<data.datasets.length;i++){correctedRotateAnimation=animationCorrection(rotateAnimation,data,config,i,-1,false).mainVal;if(!(typeof data.datasets[i].data[j]=="undefined")){ctx.beginPath();if(config.animationByData=="ByArc"){endAngle=statData[i][j].startAngle+correctedRotateAnimation*statData[i][j].segmentAngle;ctx.arc(midPosX,midPosY,scaleAnimation*statData[i][j].radiusOffset,statData[i][j].startAngle,endAngle,false)}else if(config.animationByData){if(i<1*config.animationStartWithData-1){ctx.arc(midPieX,midPieY,scaleAnimation*statData[i][j].radiusOffset,statData[i][j].startAngle,statData[i][j].endAngle,false)}else if(statData[i][j].startAngle<=firstAngle+correctedRotateAnimation*(2*Math.PI-fixAngle)){endAngle=statData[i][j].endAngle;if(statData[i][j].endAngle>firstAngle+correctedRotateAnimation*(2*Math.PI-fixAngle)){endAngle=firstAngle+correctedRotateAnimation*(2*Math.PI-fixAngle)}ctx.arc(midPieX,midPieY,scaleAnimation*statData[i][j].radiusOffset,statData[i][j].startAngle,endAngle,false)}else{continue}}else{ctx.arc(midPieX,midPieY,scaleAnimation*statData[i][j].radiusOffset,prevAngle,prevAngle+correctedRotateAnimation*(statData[i][j].endAngle-statData[i][j].startAngle),false);prevAngle=prevAngle+correctedRotateAnimation*(statData[i][j].endAngle-statData[i][j].startAngle)}ctx.lineTo(midPosX,midPosY);ctx.closePath();ctx.fillStyle=setOptionValue(true,true,1,"FILLCOLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});ctx.fill();if(config.segmentShowStroke=="merge"){ctx.lineWidth=0;ctx.strokeStyle=setOptionValue(true,true,1,"FILLCOLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});ctx.setLineDash([]);ctx.stroke()}else if(config.segmentShowStroke){ctx.strokeStyle=config.segmentStrokeColor;ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.segmentStrokeWidth);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"SEGMENTSTROKESTYLE",ctx,data,statData,data.datasets[i].segmentStrokeStyle,config.segmentStrokeStyle,"segmentStrokeStyle",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation})));ctx.stroke();ctx.setLineDash([])}}}}if(animationDecimal>=config.animationStopValue){for(i=0;i<data.datasets.length;i++){for(j=0;j<data.labels.length;j++){if(typeof data.datasets[i].data[j]=="undefined")continue;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["MARC",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){if(setOptionValue(true,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==1)posAngle=statData[i][j].realStartAngle+setOptionValue(true,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);else if(setOptionValue(true,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==2)posAngle=(2*statData[i][j].realStartAngle-statData[i][j].segmentAngle)/2+setOptionValue(true,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);else if(setOptionValue(true,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==3)posAngle=statData[i][j].realStartAngle-statData[i][j].segmentAngle+setOptionValue(true,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==1)labelRadius=0+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==2)labelRadius=statData[i][j].radiusOffset/2+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==3)labelRadius=statData[i][j].radiusOffset+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==4)labelRadius=scaleHop*calculatedScale.steps+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});ctx.save();if(setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true})=="off-center"){if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>=3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<=Math.PI/2)ctx.textAlign="left";else ctx.textAlign="right"}else if(setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true})=="to-center"){if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>=3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<=Math.PI/2)ctx.textAlign="right";else ctx.textAlign="left"}else ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});if(setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true})=="off-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)ctx.textBaseline="top";else ctx.textBaseline="bottom"}else if(setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true})=="to-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)ctx.textBaseline="bottom";else ctx.textBaseline="top"}else ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);ctx.translate(midPosX+labelRadius*Math.cos(posAngle),midPosY-labelRadius*Math.sin(posAngle));var rotateVal=0;if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis")rotateVal=2*Math.PI-posAngle;else if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxisRotateLabels"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(posAngle+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)rotateVal=3*Math.PI-posAngle;else rotateVal=2*Math.PI-posAngle}else rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,midPosX+labelRadius*Math.cos(posAngle),midPosY-labelRadius*Math.sin(posAngle),i,j);ctx.restore()}}}}}function drawScale(){for(var i=0;i<calculatedScale.steps;i++){if(config.scaleShowLine&&(i+1)%config.scaleGridLinesStep==0){ctx.beginPath();ctx.arc(midPosX,midPosY,scaleHop*(i+1),4*Math.PI-debAngle,4*Math.PI-finAngle,true);ctx.strokeStyle=config.scaleLineColor;ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.scaleLineWidth);ctx.setLineDash(lineStyleFn(config.scaleLineStyle));ctx.stroke();ctx.setLineDash([])}if(config.scaleShowLabels){if(Math.abs(config.totalAmplitude-360)<config.zeroValue)scaleAngle=Math.PI/2;else scaleAngle=(debAngle+finAngle)/2;ctx.textAlign="center";ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;var label=calculatedScale.labels[i+1];if(config.scaleShowLabelBackdrop){var textWidth=ctx.measureTextMultiLine(label,Math.ceil(ctx.chartTextScale*config.scaleFontSize));ctx.fillStyle=config.scaleBackdropColor;ctx.beginPath();ctx.rect(Math.round(midPosX+Math.cos(scaleAngle)*(scaleHop*(i+1))-textWidth/2-Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingX)),Math.round(midPosY-Math.sin(scaleAngle)*(scaleHop*(i+1))-Math.ceil(ctx.chartTextScale*config.scaleFontSize)*.5-Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingY)),Math.round(textWidth+Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingX)*2),Math.round(Math.ceil(ctx.chartTextScale*config.scaleFontSize)+Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingY)*2));ctx.fill()}ctx.textBaseline="middle";ctx.fillStyle=config.scaleFontColor;ctx.fillTextMultiLine(label,midPosX+Math.cos(scaleAngle)*(scaleHop*(i+1)),midPosY-Math.sin(scaleAngle)*(scaleHop*(i+1)),ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"SCALE_TEXTMOUSE",0,0,0,i,-1)}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;for(var i=0;i<data.datasets.length;i++){for(j=0;j<data.labels.length;j++){if(typeof data.datasets[i].data[j]=="undefined")continue;if(1*data.datasets[i].data[j]>upperValue)upperValue=1*data.datasets[i].data[j];if(1*data.datasets[i].data[j]<lowerValue)lowerValue=1*data.datasets[i].data[j]}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}return{maxValue:upperValue,minValue:lowerValue,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};var PolarArea=function(data,config,ctx){if(typeof data.length!="undefined")return MPolarArea(convertData(data,config.generateConvertedData),config,ctx);else return MPolarArea(data,config,ctx)};var Radar=function(data,config,ctx){var maxSize,scaleHop,calculatedScale,labelHeight,scaleHeight,valueBounds,labelTemplateString,msr,midPosX,midPosY;ctx.tpchart="Radar";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);valueBounds=getValueBounds();config.logarithmic=false;config.logarithmic2=false;if(!data.labels)data.labels=[];labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,null,true,false,false,config.datasetFill,"Radar")}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,null,true,false,false,config.datasetFill,"Radar")}calculateDrawingSizes();midPosY=msr.topNotUsableHeight+msr.availableHeight/2;scaleHop=maxSize/calculatedScale.steps;initPassVariableData_part2(statData,data,config,ctx,{midPosX:midPosX,midPosY:midPosY,calculatedScale:calculatedScale,scaleHop:scaleHop,maxSize:maxSize,outerVal:-1});animationLoop(config,msr.legendMsr,drawScale,drawAllDataPoints,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,midPosX,midPosY,midPosX-maxSize,midPosY+maxSize,data,statData);function drawAllDataPoints(animationDecimal){var rotationDegree=2*Math.PI/data.datasets[0].data.length;ctx.save();for(var i=0;i<data.datasets.length;i++){var fPt=-1;for(var j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;var currentAnimPc=animationCorrection(animationDecimal,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(!(typeof data.datasets[i].data[j]=="undefined")){if(fPt==-1){ctx.beginPath();ctx.moveTo(midPosX+currentAnimPc*statData[i][j].offsetX,midPosY-currentAnimPc*statData[i][j].offsetY);fPt=j}else{ctx.lineTo(midPosX+currentAnimPc*statData[i][j].offsetX,midPosY-currentAnimPc*statData[i][j].offsetY)}}}ctx.closePath();if(config.datasetFill){ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,-1,{animationValue:currentAnimPc,midPosX:statData[i][0].midPosX,midPosY:statData[i][0].midPosY,ext_radius:(config.animationLeftToRight?1:currentAnimPc)*statData[i][0].calculated_offset_max})}else ctx.fillStyle="rgba(0,0,0,0)";ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,-1,{nullvalue:null});ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"LINEWIDTH",ctx,data,statData,data.datasets[i].datasetStrokeWidth,config.datasetStrokeWidth,"datasetStrokeWidth",i,-1,{nullvalue:null}));ctx.fill();ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);if(animationDecimal>=config.animationStopValue){ctx.beginPath();for(var k=0;k<data.datasets[i].data.length;k++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,k,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",k,-1,{nullvalue:null})==false)continue;if(!(typeof data.datasets[i].data[k]=="undefined")){if(setOptionValue(true,true,1,"POINTDOT",ctx,data,statData,undefined,config.pointDot,"pointDot",i,k,{nullvalue:null})){ctx.beginPath();ctx.fillStyle=setOptionValue(true,true,1,"MARKERFILLCOLOR",ctx,data,statData,data.datasets[i].pointColor,config.defaultStrokeColor,"pointColor",i,k,{nullvalue:true});ctx.strokeStyle=setOptionValue(true,true,1,"MARKERSTROKESTYLE",ctx,data,statData,data.datasets[i].pointStrokeColor,config.defaultStrokeColor,"pointStrokeColor",i,k,{nullvalue:true});ctx.lineWidth=setOptionValue(true,true,ctx.chartLineScale,"MARKERLINEWIDTH",ctx,data,statData,data.datasets[i].pointDotStrokeWidth,config.pointDotStrokeWidth,"pointDotStrokeWidth",i,k,{nullvalue:true});var markerShape=setOptionValue(true,true,1,"MARKERSHAPE",ctx,data,statData,data.datasets[i].markerShape,config.markerShape,"markerShape",i,k,{nullvalue:true});var markerRadius=setOptionValue(true,true,ctx.chartSpaceScale,"MARKERRADIUS",ctx,data,statData,data.datasets[i].pointDotRadius,config.pointDotRadius,"pointDotRadius",i,k,{nullvalue:true});var markerStrokeStyle=setOptionValue(true,true,1,"MARKERSTROKESTYLE",ctx,data,statData,data.datasets[i].pointDotStrokeStyle,config.pointDotStrokeStyle,"pointDotStrokeStyle",i,k,{nullvalue:true});drawMarker(ctx,midPosX+currentAnimPc*statData[i][k].offsetX,midPosY-currentAnimPc*statData[i][k].offsetY,markerShape,markerRadius,markerStrokeStyle)}}}}}ctx.restore();if(animationDecimal>=config.animationStopValue){for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined")continue;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["POINT",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){ctx.save();ctx.beginPath();ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});if(setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true})=="off-center"){if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis"||(config.startAngle*Math.PI/180-j*rotationDegree+4*Math.PI)%(2*Math.PI)>3*Math.PI/2||(config.startAngle*Math.PI/180-j*rotationDegree+4*Math.PI)%(2*Math.PI)<=Math.PI/2)ctx.textAlign="left";else ctx.textAlign="right"}else if(setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true})=="to-center"){if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis"||(config.startAngle*Math.PI/180-j*rotationDegree+4*Math.PI)%(2*Math.PI)>3*Math.PI/2||(config.startAngle*Math.PI/180-j*rotationDegree+4*Math.PI)%(2*Math.PI)<Math.PI/2)ctx.textAlign="right";else ctx.textAlign="left"}else ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});if(setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true})=="off-center"){if((config.startAngle*Math.PI/180-j*rotationDegree+4*Math.PI)%(2*Math.PI)>Math.PI)ctx.textBaseline="bottom";else ctx.textBaseline="top"}else if(setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true})=="to-center"){if((config.startAngle*Math.PI/180-j*rotationDegree+4*Math.PI)%(2*Math.PI)>Math.PI)ctx.textBaseline="top";else ctx.textBaseline="bottom"}else ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});var radiusPrt;if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==1)radiusPrt=0+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==2)radiusPrt=statData[i][j].calculated_offset/2+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(true,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==3)radiusPrt=statData[i][j].calculated_offset+setOptionValue(true,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});var x_pos,y_pos;if(statData[i][j].calculated_offset>0){x_pos=midPosX+statData[i][j].offsetX*(radiusPrt/statData[i][j].calculated_offset);y_pos=midPosY-statData[i][j].offsetY*(radiusPrt/statData[i][j].calculated_offset)}else{x_pos=midPosX;y_pos=midPosY}ctx.translate(x_pos,y_pos);var rotateVal=0;if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis")rotateVal=j*rotationDegree;else if(setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxisRotateLabels"){if((j*rotationDegree+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(j*rotationDegree+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)rotateVal=3*Math.PI+j*rotationDegree;else rotateVal=2*Math.PI+j*rotationDegree}else rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,x_pos,y_pos,i,j);ctx.restore()}}}}}function drawScale(){var rotationDegree=2*Math.PI/data.datasets[0].data.length;ctx.save();ctx.translate(midPosX,midPosY);ctx.rotate((90-config.startAngle)*Math.PI/180);if(config.angleShowLineOut){ctx.strokeStyle=config.angleLineColor;ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.angleLineWidth);for(var h=0;h<data.datasets[0].data.length;h++){ctx.rotate(rotationDegree);ctx.beginPath();ctx.moveTo(0,0);ctx.lineTo(0,-maxSize);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"ANGLELINESTYLE",ctx,data,statData,undefined,config.angleLineStyle,"angleLineStyle",h,-1,{nullValue:true})));ctx.stroke();ctx.setLineDash([])}}for(var i=0;i<calculatedScale.steps;i++){ctx.beginPath();if(config.scaleShowLine&&(i+1)%config.scaleGridLinesStep==0){ctx.strokeStyle=config.scaleLineColor;ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.scaleLineWidth);ctx.moveTo(0,-scaleHop*(i+1));for(var j=0;j<data.datasets[0].data.length;j++){ctx.rotate(rotationDegree);ctx.lineTo(0,-scaleHop*(i+1))}ctx.closePath();ctx.setLineDash(lineStyleFn(config.scaleLineStyle));ctx.stroke();ctx.setLineDash([])}}ctx.rotate(-(90-config.startAngle)*Math.PI/180);if(config.scaleShowLabels){for(i=0;i<calculatedScale.steps;i++){ctx.textAlign="center";ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;ctx.textBaseline="middle";if(config.scaleShowLabelBackdrop){var textWidth=ctx.measureTextMultiLine(calculatedScale.labels[i+1],Math.ceil(ctx.chartTextScale*config.scaleFontSize)).textWidth;ctx.fillStyle=config.scaleBackdropColor;ctx.beginPath();ctx.rect(Math.round(Math.cos(config.startAngle*Math.PI/180)*(scaleHop*(i+1))-textWidth/2-Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingX)),Math.round(-Math.sin(config.startAngle*Math.PI/180)*scaleHop*(i+1)-Math.ceil(ctx.chartTextScale*config.scaleFontSize)*.5-Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingY)),Math.round(textWidth+Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingX)*2),Math.round(Math.ceil(ctx.chartTextScale*config.scaleFontSize)+Math.ceil(ctx.chartSpaceScale*config.scaleBackdropPaddingY)*2));ctx.fill()}ctx.fillStyle=config.scaleFontColor;ctx.fillTextMultiLine(calculatedScale.labels[i+1],Math.cos(config.startAngle*Math.PI/180)*(scaleHop*(i+1)),-Math.sin(config.startAngle*Math.PI/180)*scaleHop*(i+1),ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"SCALE_TEXTMOUSE",0,midPosX,midPosY,i,-1)}}for(var k=0;k<data.labels.length;k++){ctx.font=config.pointLabelFontStyle+" "+Math.ceil(ctx.chartTextScale*config.pointLabelFontSize).toString()+"px "+config.pointLabelFontFamily;ctx.fillStyle=config.pointLabelFontColor;var opposite=Math.sin((90-config.startAngle)*Math.PI/180+rotationDegree*k)*(maxSize+Math.ceil(ctx.chartTextScale*config.pointLabelFontSize));var adjacent=Math.cos((90-config.startAngle)*Math.PI/180+rotationDegree*k)*(maxSize+Math.ceil(ctx.chartTextScale*config.pointLabelFontSize));var vangle=(90-config.startAngle)*Math.PI/180+rotationDegree*k;while(vangle<0)vangle=vangle+2*Math.PI;while(vangle>2*Math.PI)vangle=vangle-2*Math.PI;if(vangle==Math.PI||vangle==0){ctx.textAlign="center"}else if(vangle>Math.PI){ctx.textAlign="right"}else{ctx.textAlign="left"}ctx.textBaseline="middle";ctx.fillTextMultiLine(data.labels[k],opposite,-adjacent,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.pointLabelFontSize),true,config.detectMouseOnText,ctx,"LABEL_TEXTMOUSE",0,midPosX,midPosY,k,-1)}ctx.restore()}function calculateDrawingSizes(){var midX,mxlb,maxL,maxR,iter,nbiter,prevMaxSize,prevMidX,i,textMeasurement;var rotationDegree=2*Math.PI/data.datasets[0].data.length;var rotateAngle=config.startAngle*Math.PI/180;ctx.font=config.pointLabelFontStyle+" "+Math.ceil(ctx.chartTextScale*config.pointLabelFontSize).toString()+"px "+config.pointLabelFontFamily;if(!config.graphMaximized){maxR=msr.availableWidth/2;maxL=msr.availableWidth/2;nbiter=1}else{maxR=msr.availableWidth/2;maxL=msr.availableWidth/2;nbiter=40;for(i=0;i<data.labels.length;i++){textMeasurement=ctx.measureTextMultiLine(data.labels[i],Math.ceil(ctx.chartTextScale*config.scaleFontSize)).textWidth+ctx.measureTextMultiLine(data.labels[i],Math.ceil(ctx.chartTextScale*config.scaleFontSize)).textHeight;mxlb=(msr.availableWidth-textMeasurement)/(1+Math.abs(Math.cos(rotateAngle)));if(rotateAngle<Math.PI/2&&rotateAngle>-Math.PI/2||rotateAngle>3*Math.PI/2){if(mxlb<maxR)maxR=mxlb}else if(Math.cos(rotateAngle)!=0){if(mxlb<maxL)maxL=mxlb}rotateAngle-=rotationDegree}}prevMaxSize=0;prevMidX=0;midPosX=maxR+msr.leftNotUsableWidth;for(midX=maxR,iter=0;iter<nbiter;++iter,midX+=(msr.availableWidth-maxL-maxR)/nbiter){maxSize=Max([midX,msr.availableWidth-midX]);rotateAngle=config.startAngle*Math.PI/180;mxlb=msr.available;for(i=0;i<data.labels.length;i++){textMeasurement=ctx.measureTextMultiLine(data.labels[i],Math.ceil(ctx.chartTextScale*config.scaleFontSize)).textWidth+ctx.measureTextMultiLine(data.labels[i],Math.ceil(ctx.chartTextScale*config.scaleFontSize)).textHeight;if(rotateAngle<Math.PI/2&&rotateAngle>-Math.PI/2||rotateAngle>3*Math.PI/2){mxlb=(msr.availableWidth-midX-textMeasurement)/Math.abs(Math.cos(rotateAngle))}else if(Math.cos(rotateAngle!=0)){mxlb=(midX-textMeasurement)/Math.abs(Math.cos(rotateAngle))}if(mxlb<maxSize)maxSize=mxlb;if(Math.sin(rotateAngle)*msr.availableHeight/2>msr.availableHeight/2-Math.ceil(ctx.chartTextScale*config.scaleFontSize)*2){mxlb=Math.sin(rotateAngle)*msr.availableHeight/2-1.5*Math.ceil(ctx.chartTextScale*config.scaleFontSize);if(mxlb<maxSize)maxSize=mxlb}rotateAngle-=rotationDegree}if(maxSize>prevMaxSize){prevMaxSize=maxSize;midPosX=midX+msr.leftNotUsableWidth}}maxSize=prevMaxSize-Math.ceil(ctx.chartTextScale*config.scaleFontSize)/2;labelHeight=Default(labelHeight,5)}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;for(var i=0;i<data.datasets.length;i++){for(var j=0;j<data.datasets[i].data.length;j++){if(typeof data.datasets[i].data[j]=="undefined")continue;if(1*data.datasets[i].data[j]>upperValue){upperValue=1*data.datasets[i].data[j]}if(1*data.datasets[i].data[j]<lowerValue){lowerValue=1*data.datasets[i].data[j]}}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue){upperValue=.9;lowerValue=-.9}if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}return{maxValue:upperValue,minValue:lowerValue,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};var Pie=function(data,config,ctx){ctx.tpchart="Pie";if(typeof data.length!="undefined")return PieDoughnut(convertData(data,config.generateConvertedData),config,ctx,"Pie");else return PieDoughnut(data,config,ctx,"Pie")};var Doughnut=function(data,config,ctx){ctx.tpchart="Doughnut";if(typeof data.length!="undefined")return PieDoughnut(convertData(data,config.generateConvertedData),config,ctx,"Doughnut");else return PieDoughnut(data,config,ctx,"Doughnut")};var PieDoughnut=function(data,config,ctx,chartType){var msr,midPieX,midPieY,doughnutRadius,cutoutRadius;ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);var realCumulativeAngle=((config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);config.logarithmic=false;config.logarithmic2=false;msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,"none","none",true,false,false,true,"Doughnut");var drwSize=calculatePieDrawingSize(ctx,msr,config,data,statData);midPieX=drwSize.midPieX;midPieY=drwSize.midPieY;doughnutRadius=drwSize.radius;if(chartType=="Pie")cutoutRadius=0;else cutoutRadius=doughnutRadius*(config.percentageInnerCutout/100);if(doughnutRadius>0){initPassVariableData_part2(statData,data,config,ctx,{midPosX:midPieX,midPosY:midPieY,int_radius:cutoutRadius,ext_radius:doughnutRadius,outerVal:-1});animationLoop(config,msr.legendMsr,null,drawPieSegments,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,midPieX,midPieY,midPieX-doughnutRadius,midPieY+doughnutRadius,data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function drawPieSegments(animationDecimal){var dataCutoutRadius,dataDoughnutRadius;var rdataCutoutRadius,rdataDoughnutRadius;var prevAngle,fixAngle,firstAngle,cumulativeAngle;prevAngle=[];fixAngle=[];firstAngle=[];cumulativeAngle=[];for(var i=0;i<data.datasets.length;i++){var scaleAnimation=1,rotateAnimation=1;for(j=0;j<data.labels.length;j++){if(typeof prevAngle[j]=="undefined"&&typeof statData[i][j].firstAngle!="undefined"){prevAngle[j]=statData[i][j].firstAngle;fixAngle[j]=0;firstAngle[j]=statData[i][j].firstAngle;cumulativeAngle[j]=((-config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(1*config.animationStartWithData>1&&1*config.animationStartWithData-1<data.datasets.length){}}if(setOptionValue(false,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(false,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",-1,j,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined"||1*data.datasets[i].data[j]<=0)continue;if(chartType=="Pie")dataCutoutRadius=cutoutRadius;else dataCutoutRadius=cutoutRadius;dataDoughnutRadius=doughnutRadius;rdataCutoutRadius=dataCutoutRadius+(dataDoughnutRadius-dataCutoutRadius)*statData[i][j].startRadius;rdataDoughnutRadius=dataCutoutRadius+(dataDoughnutRadius-dataCutoutRadius)*statData[i][j].stopRadius;dataCutoutRadius=rdataCutoutRadius;dataDoughnutRadius=rdataDoughnutRadius;if(chartType!="Pie"||j>0)rdataCutoutRadius=dataCutoutRadius-(dataDoughnutRadius-dataCutoutRadius)*setOptionValue(false,true,1,"EXPANDINRADIUS",ctx,data,statData,data.datasets[i].expandInRadius,0,"expandInRadius",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});rdataDoughnutRadius=dataDoughnutRadius+(dataDoughnutRadius-dataCutoutRadius)*setOptionValue(false,true,1,"EXPANDOUTRADIUS",ctx,data,statData,data.datasets[i].expandOutRadius,0,"expandOutRadius",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});dataCutoutRadius=rdataCutoutRadius;dataDoughnutRadius=rdataDoughnutRadius;if(config.animation){if(config.animateScale){scaleAnimation=animationDecimal}if(config.animateRotate){rotateAnimation=animationDecimal}}correctedRotateAnimation=animationCorrection(rotateAnimation,data,config,i,-1,false).mainVal;ctx.beginPath();ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.segmentStrokeWidth);ctx.strokeStyle="rgba(0,0,0,0)";if(config.animationByData=="ByArc"){endAngle=statData[i][j].startAngle+correctedRotateAnimation*statData[i][j].segmentAngle;ctx.arc(midPieX,midPieY,scaleAnimation*dataDoughnutRadius,statData[i][j].startAngle,endAngle,false);ctx.arc(midPieX,midPieY,scaleAnimation*dataCutoutRadius,endAngle,statData[i][j].startAngle,true)}else if(config.animationByData){if(i<0){ctx.arc(midPieX,midPieY,scaleAnimation*dataDoughnutRadius,statData[i][j].startAngle,statData[i].endAngle,false);ctx.arc(midPieX,midPieY,scaleAnimation*dataCutoutRadius,statData[i][j].endAngle,statData[i][j].startAngle,true)}else if(statData[i][j].startAngle<=firstAngle[j]+correctedRotateAnimation*(2*Math.PI-fixAngle[j])){endAngle=statData[i][j].endAngle;if(statData[i][j].endAngle>firstAngle[j]+correctedRotateAnimation*(2*Math.PI-fixAngle[j])){endAngle=firstAngle[j]+correctedRotateAnimation*(2*Math.PI-fixAngle[j])}ctx.arc(midPieX,midPieY,scaleAnimation*dataDoughnutRadius,statData[i][j].startAngle,endAngle,false);ctx.arc(midPieX,midPieY,scaleAnimation*dataCutoutRadius,endAngle,statData[i][j].startAngle,true)}else{continue}}else{ctx.arc(midPieX,midPieY,scaleAnimation*dataDoughnutRadius,prevAngle[j],prevAngle[j]+correctedRotateAnimation*(statData[i][j].endAngle-statData[i][j].startAngle),false);ctx.arc(midPieX,midPieY,scaleAnimation*dataCutoutRadius,prevAngle[j]+correctedRotateAnimation*(statData[i][j].endAngle-statData[i][j].startAngle),prevAngle[j],true);prevAngle[j]=prevAngle[j]+correctedRotateAnimation*(statData[i][j].endAngle-statData[i][j].startAngle)}ctx.closePath();ctx.fillStyle=setOptionValue(false,true,1,"FILLCOLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});ctx.fill();if(config.segmentShowStroke=="merge"){ctx.lineWidth=1.5;ctx.strokeStyle=setOptionValue(false,true,1,"FILLCOLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});ctx.setLineDash([]);ctx.stroke()}else if(config.segmentShowStroke){ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.segmentStrokeWidth);ctx.strokeStyle=config.segmentStrokeColor;ctx.setLineDash(lineStyleFn(setOptionValue(false,true,1,"SEGMENTSTROKESTYLE",ctx,data,statData,data.datasets[i].segmentStrokeStyle,config.segmentStrokeStyle,"segmentStrokeStyle",i,-1,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation})));ctx.stroke();ctx.setLineDash([])}}}if(animationDecimal>=config.animationStopValue){for(var i=0;i<data.datasets.length;i++){for(j=0;j<data.labels.length;j++){if(setOptionValue(false,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(false,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",-1,j,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined"||1*data.datasets[i].data[j]<=0)continue;if(chartType=="Pie")dataCutoutRadius=cutoutRadius;else dataCutoutRadius=cutoutRadius-(doughnutRadius-cutoutRadius)*setOptionValue(false,true,1,"EXPANDINRADIUS",ctx,data,statData,data.datasets[i].expandInRadius,0,"expandInRadius",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});dataDoughnutRadius=doughnutRadius+(doughnutRadius-cutoutRadius)*setOptionValue(false,true,1,"EXPANDOUTRADIUS",ctx,data,statData,data.datasets[i].expandOutRadius,0,"expandOutRadius",i,j,{animationDecimal:animationDecimal,scaleAnimation:scaleAnimation});rdataCutoutRadius=dataCutoutRadius+(dataDoughnutRadius-dataCutoutRadius)*statData[i][j].startRadius;rdataDoughnutRadius=dataCutoutRadius+(dataDoughnutRadius-dataCutoutRadius)*statData[i][j].stopRadius;dataCutoutRadius=rdataCutoutRadius;dataDoughnutRadius=rdataDoughnutRadius;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["MARC",i,j,statData,setOptionValue(false,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(false,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})&&statData[i][j].segmentAngle>=Math.PI/180*setOptionValue(false,true,1,"INGRAPHDATAMINIMUMANGLE",ctx,data,statData,undefined,config.inGraphDataMinimumAngle,"inGraphDataMinimumAngle",i,j,{nullValue:true})){if(setOptionValue(false,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==1)posAngle=statData[i][j].realStartAngle+setOptionValue(false,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);else if(setOptionValue(false,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==2)posAngle=statData[i][j].realStartAngle-statData[i][j].segmentAngle/2+setOptionValue(false,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);else if(setOptionValue(false,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==3)posAngle=statData[i][j].realStartAngle-statData[i][j].segmentAngle+setOptionValue(false,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);if(setOptionValue(false,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==1)labelRadius=dataCutoutRadius+setOptionValue(false,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(false,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==2)labelRadius=dataCutoutRadius+(dataDoughnutRadius-dataCutoutRadius)/2+setOptionValue(false,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});else if(setOptionValue(false,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",i,j,{nullValue:true})==3)labelRadius=dataDoughnutRadius+setOptionValue(false,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true});ctx.save();if(setOptionValue(false,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true})=="off-center"){if(setOptionValue(false,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>=3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<=Math.PI/2)ctx.textAlign="left";else ctx.textAlign="right"}else if(setOptionValue(false,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true})=="to-center"){if(setOptionValue(false,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>=3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<=Math.PI/2)ctx.textAlign="right";else ctx.textAlign="left"}else ctx.textAlign=setOptionValue(false,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});if(setOptionValue(false,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true})=="off-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)ctx.textBaseline="top";else ctx.textBaseline="bottom"}else if(setOptionValue(false,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true})=="to-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)ctx.textBaseline="bottom";else ctx.textBaseline="top"}else ctx.textBaseline=setOptionValue(false,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(false,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(false,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(false,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(false,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});var dispString=tmplbis(setOptionValue(false,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);ctx.translate(midPieX+labelRadius*Math.cos(posAngle),midPieY-labelRadius*Math.sin(posAngle));var rotateVal=0;if(setOptionValue(false,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxis")rotateVal=2*Math.PI-posAngle;else if(setOptionValue(false,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})=="inRadiusAxisRotateLabels"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(posAngle+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)rotateVal=3*Math.PI-posAngle;else rotateVal=2*Math.PI-posAngle}else rotateVal=setOptionValue(false,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(false,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(false,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(false,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(false,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(false,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(false,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(false,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(false,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(false,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,midPieX+labelRadius*Math.cos(posAngle),midPieY-labelRadius*Math.sin(posAngle),i,j);ctx.restore()}}}}}return{data:data,config:config,ctx:ctx}};var Line=function(data,config,ctx){var maxSize,scaleHop,scaleHop2,calculatedScale,calculatedScale2,labelHeight,scaleHeight,valueBounds,labelTemplateString,labelTemplateString2;var valueHop,xAxisLength,yAxisPosX,xAxisPosY,rotateLabels=0,msr;var zeroY=0;var zeroY2=0;ctx.tpchart="Line";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var mxlgt=0;for(var i=0;i<data.datasets.length;i++){mxlgt=Max([mxlgt,data.datasets[i].data.length])}if(mxlgt==1){if(typeof data.labels[0]=="string")data.labels=["",data.labels[0],""];for(i=0;i<data.datasets.length;i++){if(typeof(data.datasets[i].data[0]!="undefined"))data.datasets[i].data=[undefined,data.datasets[i].data[0],undefined]}mxlgt=3}var statData=initPassVariableData_part1(data,config,ctx);for(i=0;i<data.datasets.length;i++)statData[i][0].tpchart="Line";msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,"nihil","nihil",false,false,true,config.datasetFill,"Line");valueBounds=getValueBounds();if(config.logarithmic!==false){if(valueBounds.minValue<=0){config.logarithmic=false}}if(config.logarithmic2!==false){if(valueBounds.minValue2<=0){config.logarithmic2=false}}var OrderOfMagnitude=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue)));if(config.logarithmic=="fuzzy"&&OrderOfMagnitude<4||config.scaleOverride){config.logarithmic=false}var OrderOfMagnitude2=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue2)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue2)));if(config.logarithmic2=="fuzzy"&&OrderOfMagnitude2<4||config.scaleOverride2){config.logarithmic2=false}labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";labelTemplateString2=config.scaleShowLabels2?config.scaleLabel2:"";if(!config.scaleOverride){if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString)}}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth)}if(valueBounds.dbAxis||config.forceSecondScale){if(!config.scaleOverride2){if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){calculatedScale2=calculateScale(2,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue2,valueBounds.minValue2,labelTemplateString2)}}else{var scaleStartValue2=setOptionValue(true,true,1,"SCALESTARTVALUE2",ctx,data,statData,undefined,config.scaleStartValue2,"scaleStartValue2",-1,-1,{nullValue:true});var scaleSteps2=setOptionValue(true,true,1,"SCALESTEPS2",ctx,data,statData,undefined,config.scaleSteps2,"scaleSteps2",-1,-1,{nullValue:true});var scaleStepWidth2=setOptionValue(true,true,1,"SCALESTEPWIDTH2",ctx,data,statData,undefined,config.scaleStepWidth2,"scaleStepWidth2",-1,-1,{nullValue:true});calculatedScale2={steps:scaleSteps2,stepValue:scaleStepWidth2,graphMin:scaleStartValue2,graphMax:scaleStartValue2+scaleSteps2*scaleStepWidth2,labels:[]};populateLabels(2,config,labelTemplateString2,calculatedScale2.labels,calculatedScale2.steps,scaleStartValue2,calculatedScale2.graphMax,scaleStepWidth2)}}else{calculatedScale2={steps:0,stepValue:0,graphMin:0,graphMax:0,labels:null}}if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,calculatedScale2.labels,false,false,true,config.datasetFill,"Line");var prevHeight=msr.availableHeight;msr.availableHeight=msr.availableHeight-Math.ceil(ctx.chartLineScale*Math.max(config.scaleTickSizeBottom,config.scaleMinorTickSizeBottom*(config.scaleMinorTickHorizontalCount>0)))-Math.ceil(ctx.chartLineScale*Math.max(config.scaleTickSizeTop,config.scaleMinorTickSizeTop*(config.scaleMinorTickHorizontalCount>0)));msr.availableWidth=msr.availableWidth-Math.ceil(ctx.chartLineScale*Math.max(config.scaleTickSizeLeft,config.scaleMinorTickSizeLeft*(config.scaleMinorTickVerticalCount>0)))-Math.ceil(ctx.chartLineScale*Math.max(config.scaleTickSizeRight,config.scaleMinorTickSizeRight*(config.scaleMinorTickVerticalCount>0)));scaleHop=Math.floor(msr.availableHeight/calculatedScale.steps);scaleHop2=Math.floor(msr.availableHeight/calculatedScale2.steps);valueHop=Math.floor(msr.availableWidth/(data.labels.length-1));if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/(data.labels.length-1);msr.clrwidth=msr.clrwidth-(msr.availableWidth-(data.labels.length-1)*valueHop);msr.topNotUsableHeight+=msr.availableHeight-calculatedScale.steps*scaleHop;msr.rightNotUsableWidth+=msr.availableWidth-(data.labels.length-1)*valueHop;msr.availableWidth=(data.labels.length-1)*valueHop;msr.availableHeight=calculatedScale.steps*scaleHop;yAxisPosX=msr.leftNotUsableWidth+Math.ceil(ctx.chartLineScale*Math.max(config.scaleTickSizeLeft,config.scaleMinorTickSizeLeft*(config.scaleMinorTickVerticalCount>0)));xAxisPosY=msr.topNotUsableHeight+msr.availableHeight+Math.ceil(ctx.chartLineScale*Math.max(config.scaleTickSizeTop,config.scaleMinorTickSizeTop*(config.scaleMinorTickHorizontalCount>0)));drawLabels();zeroY=calculateOffset(config.logarithmic,0,calculatedScale,scaleHop);if(typeof calculatedScale2==="object")zeroY2=calculateOffset(config.logarithmic2,0,calculatedScale2,scaleHop2);initPassVariableData_part2(statData,data,config,ctx,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length-1,scaleHop:scaleHop,zeroY:zeroY,calculatedScale:calculatedScale,logarithmic:config.logarithmic,scaleHop2:scaleHop2,zeroY2:zeroY2,msr:msr,calculatedScale2:calculatedScale2,logarithmic2:config.logarithmic2});animationLoop(config,msr.legendMsr,drawScale,drawLines,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function drawLines(animPc){drawLinesDataset(animPc,data,config,ctx,statData,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length-1});if(animPc>=1){if(typeof drawMath=="function"){drawMath(ctx,config,data,msr,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,scaleHop:scaleHop,zeroY:zeroY,calculatedScale:calculatedScale,calculateOffset:calculateOffset,statData:statData})}}}function drawScale(){drawGridScale(ctx,data,config,msr,yAxisPosX,xAxisPosY,zeroY,valueHop,scaleHop,calculatedScale.steps,data.labels.length+0)}function drawLabels(){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;if(config.xAxisTop||config.xAxisBottom){ctx.textBaseline="top";ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}var decal=0;var subloop=0;if(config.xAxisMiddle==true){decal=valueHop/2;subloop=1}for(var i=0;i<data.labels.length-subloop;i++){if(showLabels(ctx,data,config,i)){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+i*valueHop-msr.highestXLabel/2+decal,msr.xLabelPos);ctx.rotate(-((msr.rotateLabels+180*(msr.rotateLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XSCALE_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+i*valueHop-msr.highestXLabel/2+decal,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),yAxisPosX+i*valueHop+decal,msr.xLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XSCALE_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}if(config.xAxisTop){if(msr.rotateTLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateTLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}var label;if(typeof data.labels2=="object")label=data.labels2;else label=data.labels;for(var i=0;i<label.length;i++){if(showLabels(ctx,data,config,i)){ctx.save();if(msr.rotateTLabels>0){ctx.translate(yAxisPosX+i*valueHop-msr.highestXLabel/2,msr.xTLabelPos);ctx.rotate(-((msr.rotateTLabels+180*(msr.rotateTLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,label[i],config.fmtXLabel),0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XSCALE_TEXTMOUSE",-(msr.rotateTLabels*(Math.PI/180)),yAxisPosX+i*valueHop-msr.highestXLabel/2,msr.xTLabelPos,i,-1)}else{ctx.fillTextMultiLine(fmtChartJS(config,label[i],config.fmtXLabel),yAxisPosX+i*valueHop,msr.xTLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XSCALE_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var j=config.showYAxisMin?-1:0;j<calculatedScale.steps;j++){if(config.scaleShowLabels){if(showYLabels(ctx,data,config,j+1,calculatedScale.labels[j+1])){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(calculatedScale.labels[j+1],yAxisPosX-(Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YLEFTAXIS_TEXTMOUSE",0,0,0,-1,j)}if(config.yAxisRight&&!(valueBounds.dbAxis||config.forceSecondScale)){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale.labels[j+1],yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}if(config.yAxisRight&&(valueBounds.dbAxis||config.forceSecondScale)){for(j=config.showYAxisMin?-1:0;j<calculatedScale2.steps;j++){if(config.scaleShowLabels){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale2.labels[j+1],yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;var upperValue2=-Number.MAX_VALUE;var lowerValue2=Number.MAX_VALUE;var secondAxis=false;var firstAxis=false;var mathValueHeight;for(var i=0;i<data.datasets.length;i++){var mathFctName=data.datasets[i].drawMathDeviation;var mathValueHeight=0;if(typeof eval(mathFctName)=="function"){var parameter={data:data,datasetNr:i};mathValueHeightVal=window[mathFctName](parameter)}else mathValueHeightVal=0;for(var j=0;j<data.datasets[i].data.length;j++){if(typeof mathValueHeightVal=="object")mathValueHeight=mathValueHeightVal[Math.min(mathValueHeightVal.length,j)];else mathValueHeight=mathValueHeightVal;if(typeof data.datasets[i].data[j]=="undefined")continue;if(data.datasets[i].axis==2){secondAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue2){upperValue2=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue2){lowerValue2=1*data.datasets[i].data[j]-mathValueHeight}}else{firstAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue){upperValue=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue){lowerValue=1*data.datasets[i].data[j]-mathValueHeight}}}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;if(secondAxis){if(upperValue2<lowerValue2){upperValue2=0;lowerValue2=0}if(Math.abs(upperValue2-lowerValue2)<config.zeroValue){if(Math.abs(upperValue2)<config.zeroValue)upperValue2=.9;if(upperValue2>0){upperValue2=upperValue2*1.1;lowerValue2=lowerValue2*.9}else{upperValue2=upperValue2*.9;lowerValue2=lowerValue2*1.1}}if(typeof config.graphMin2=="function")lowerValue2=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin2,"graphMin2",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin2))lowerValue2=config.graphMin2;if(typeof config.graphMax2=="function")upperValue2=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax2,"graphMax2",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax2))upperValue2=config.graphMax2}if(!firstAxis&&secondAxis){upperValue=upperValue2;lowerValue=lowerValue2}labelHeight=Math.ceil(ctx.chartTextScale*config.scaleFontSize);scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}if(upperValue2<lowerValue2){lowerValue2=upperValue2-1}return{maxValue:upperValue,minValue:lowerValue,maxValue2:upperValue2,minValue2:lowerValue2,dbAxis:secondAxis,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};var StackedBar=function(data,config,ctx){var maxSize,scaleHop,scaleHop2,calculatedScale,calculatedScale2,labelHeight,scaleHeight,valueBounds,labelTemplateString,valueHop,xAxisLength,yAxisPosX,xAxisPosY,barWidth,rotateLabels=0,msr;ctx.tpchart="StackedBar";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);var nrOfBars=data.datasets.length;for(var i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line"){statData[i][0].tpchart="Line";nrOfBars--}else statData[i][0].tpchart="Bar"}config.logarithmic=false;msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,"nihil","nihil",true,false,true,true,"StackedBar");valueBounds=getValueBounds();if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";labelTemplateString2=config.scaleShowLabels2?config.scaleLabel2:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString)}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,labels:[]};for(var i=0;i<=calculatedScale.steps;i++){if(labelTemplateString){calculatedScale.labels.push(tmpl(labelTemplateString,{value:fmtChartJS(config,1*(scaleStartValue+scaleStepWidth*i).toFixed(getDecimalPlaces(scaleStepWidth)),config.fmtYLabel)},config))}}}if(valueBounds.dbAxis||config.forceSecondScale){if(!config.scaleOverride2){calculatedScale2=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue2,valueBounds.minValue2,labelTemplateString2)}else{var scaleStartValue2=setOptionValue(true,true,1,"SCALESTARTVALUE2",ctx,data,statData,undefined,config.scaleStartValue2,"scaleStartValue2",-1,-1,{nullValue:true});var scaleSteps2=setOptionValue(true,true,1,"SCALESTEPS2",ctx,data,statData,undefined,config.scaleSteps2,"scaleSteps2",-1,-1,{nullValue:true});var scaleStepWidth2=setOptionValue(true,true,1,"SCALESTEPWIDTH2",ctx,data,statData,undefined,config.scaleStepWidth2,"scaleStepWidth2",-1,-1,{nullValue:true});calculatedScale2={steps:scaleSteps2,stepValue:scaleStepWidth2,graphMin:scaleStartValue2,labels:[]};for(var i=0;i<=calculatedScale2.steps;i++){if(labelTemplateString2){calculatedScale2.labels.push(tmpl(labelTemplateString2,{value:fmtChartJS(config,1*(scaleStartValue2+scaleStepWidth2*i).toFixed(getDecimalPlaces(scaleStepWidth2)),config.fmtYLabel)},config))}}}}else{calculatedScale2={steps:0,stepValue:0,graphMin:0,graphMax:0,labels:null}}msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,calculatedScale2.labels,true,false,true,true,"StackedBar");var prevHeight=msr.availableHeight;msr.availableHeight=msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleTickSizeBottom)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);msr.availableWidth=msr.availableWidth-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight);scaleHop=Math.floor(msr.availableHeight/calculatedScale.steps);scaleHop2=Math.floor(msr.availableHeight/calculatedScale2.steps);valueHop=Math.floor(msr.availableWidth/data.labels.length);if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/data.labels.length;msr.topNotUsableHeight+=msr.availableHeight-calculatedScale.steps*scaleHop;msr.rightNotUsableWidth+=msr.availableWidth-data.labels.length*valueHop;msr.clrwidth=msr.clrwidth-(msr.availableWidth-data.labels.length*valueHop);msr.availableWidth=data.labels.length*valueHop;msr.availableHeight=calculatedScale.steps*scaleHop;yAxisPosX=msr.leftNotUsableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft);xAxisPosY=msr.topNotUsableHeight+msr.availableHeight+Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);barWidth=valueHop-Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth)*2-Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)*2-(Math.ceil(ctx.chartSpaceScale*config.barDatasetSpacing)*1-1)-Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2-1;if(barWidth>=0&&barWidth<=1)barWidth=1;if(barWidth<0&&barWidth>=-1)barWidth=-1;var additionalSpaceBetweenBars;if(1*config.maxBarWidth>0&&barWidth>1*config.maxBarWidth){additionalSpaceBetweenBars=(barWidth-1*config.maxBarWidth)/2;barWidth=1*config.maxBarWidth}else additionalSpaceBetweenBars=0;var zeroY=0;var zeroY2=0;zeroY=calculateOffset(false,0,calculatedScale,scaleHop);if(typeof calculatedScale2==="object")zeroY2=calculateOffset(config.logarithmic2,0,calculatedScale2,scaleHop2);drawLabels();initPassVariableData_part2(statData,data,config,ctx,{msr:msr,zeroY:zeroY,zeroY2:zeroY2,logarithmic:false,logarithmic2:false,calculatedScale:calculatedScale,calculatedScale2:calculatedScale2,additionalSpaceBetweenBars:additionalSpaceBetweenBars,scaleHop:scaleHop,scaleHop2:scaleHop2,valueHop:valueHop,yAxisPosX:yAxisPosX,xAxisPosY:xAxisPosY,barWidth:barWidth});animationLoop(config,msr.legendMsr,drawScale,drawBars,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function drawBars(animPc){var prevTopPos=new Array;var prevTopNeg=new Array;for(var i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line")continue;for(var j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;var currentAnimPc=animationCorrection(animPc,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(typeof data.datasets[i].data[j]=="undefined"||1*data.datasets[i].data[j]==0)continue;if(Math.abs(data.datasets[i].data[j])<config.zeroValue&&config.showZeroValue==false)continue;if(typeof prevTopPos[j]=="undefined"){prevTopPos[j]=statData[statData[i][j].firstNotMissing][j].yPosBottom;prevTopNeg[j]=statData[statData[i][j].firstNotMissing][j].yPosBottom}var botBar,topBar;if(1*data.datasets[i].data[j]>0)botBar=prevTopPos[j];else botBar=prevTopNeg[j];topBar=botBar+currentAnimPc*(statData[i][j].yPosTop-statData[i][j].yPosBottom);if(1*data.datasets[i].data[j]>0)prevTopPos[j]=topBar;else prevTopNeg[j]=topBar;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;ctx.save();ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"BARSTROKEWIDTH",ctx,data,statData,data.datasets[i].barStrokeWidth,config.barStrokeWidth,"barStrokeWidth",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:botBar,xPosRight:statData[i][j].xPosRight,yPosTop:topBar}));ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:botBar,xPosRight:statData[i][j].xPosRight,yPosTop:topBar});ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,j,{nullvalue:null});if(currentAnimPc!=0&&botBar!=topBar){ctx.beginPath();ctx.moveTo(statData[i][j].xPosLeft,botBar+(topBar-botBar)/2);ctx.lineTo(statData[i][j].xPosLeft,topBar);ctx.lineTo(statData[i][j].xPosRight,topBar);ctx.lineTo(statData[i][j].xPosRight,botBar);ctx.lineTo(statData[i][j].xPosLeft,botBar);ctx.lineTo(statData[i][j].xPosLeft,botBar+(topBar-botBar)/2);if(config.barShowStroke){ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"STROKESTYLE",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([])}ctx.closePath();ctx.fill()}ctx.restore()}}drawLinesDataset(animPc,data,config,ctx,statData,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length});if(animPc>=config.animationStopValue){var yPos=0,xPos=0;for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined")continue;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["RECT",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){ctx.save();ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);ctx.beginPath();ctx.beginPath();yPos=0;xPos=0;if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==1){xPos=statData[i][j].xPosLeft+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==2){xPos=statData[i][j].xPosLeft+barWidth/2+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==3){xPos=statData[i][j].xPosLeft+barWidth+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==1){yPos=statData[i][j].yPosBottom-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==2){yPos=(statData[i][j].yPosTop+statData[i][j].yPosBottom)/2-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==3){yPos=statData[i][j].yPosTop-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}if(yPos>msr.topNotUsableHeight){ctx.translate(xPos,yPos);var rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,xPos,yPos,i,j)}ctx.restore()}}}}}function drawScale(){drawGridScale(ctx,data,config,msr,yAxisPosX,xAxisPosY,zeroY,valueHop,scaleHop,calculatedScale.steps,data.labels.length+1)}function drawLabels(){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;if(config.xAxisTop||config.xAxisBottom){ctx.textBaseline="top";ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}for(var i=0;i<data.labels.length;i++){if(showLabels(ctx,data,config,i)){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+i*valueHop+additionalSpaceBetweenBars+barWidth/2-msr.highestXLabel/2,msr.xLabelPos);ctx.rotate(-((msr.rotateLabels+180*(msr.rotateLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+i*valueHop+additionalSpaceBetweenBars+barWidth/2-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+i*valueHop+additionalSpaceBetweenBars+barWidth/2,msr.xLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}if(config.xAxisTop){if(msr.rotateTLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateTLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}var label;if(typeof data.labels2=="object")label=data.labels2;else label=data.labels;for(var i=0;i<label.length;i++){if(showLabels(ctx,data,config,i)){ctx.save();if(msr.rotateTLabels>0){ctx.translate(yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+i*valueHop+additionalSpaceBetweenBars+barWidth/2-msr.highestTXLabel/2,msr.xTLabelPos);ctx.rotate(-((msr.rotateTLabels+180*(msr.rotateTLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,label[i],config.fmtXLabel),0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+i*valueHop+additionalSpaceBetweenBars+barWidth/2-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(fmtChartJS(config,label[i],config.fmtXLabel),yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+i*valueHop+additionalSpaceBetweenBars+barWidth/2,msr.xTLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var j=config.showYAxisMin?-1:0;j<calculatedScale.steps;j++){if(config.scaleShowLabels){if(showYLabels(ctx,data,config,j+1,calculatedScale.labels[j+1])){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(calculatedScale.labels[j+1],yAxisPosX-(Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YLEFTAXIS_TEXTMOUSE",0,0,0,-1,j)}if(config.yAxisRight&&!(valueBounds.dbAxis||config.forceSecondScale)){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale.labels[j+1],yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}if(config.yAxisRight&&(valueBounds.dbAxis||config.forceSecondScale)){for(j=config.showYAxisMin?-1:0;j<calculatedScale2.steps;j++){if(config.scaleShowLabels){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale2.labels[j+1],yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}function getValueBounds(){var maxValp=-Number.MAX_VALUE;var minValp=Number.MAX_VALUE;var maxValn=-Number.MAX_VALUE;var minValn=Number.MAX_VALUE;var maxValp2=-Number.MAX_VALUE;var minValp2=Number.MAX_VALUE;var maxValn2=-Number.MAX_VALUE;var minValn2=Number.MAX_VALUE;var secondAxis=false;var firstAxis=false;var tempp=[];var tempn=[];var tempp2=[];var tempn2=[];var inp=0;var inn=0;var inp2=0;var inn2=0;for(var i=0;i<data.datasets.length;i++){for(var j=0;j<data.datasets[i].data.length;j++){if(data.datasets[i].axis==2&&statData[i][0].tpchart=="Line"){secondAxis=true;if(1*data.datasets[i].data[j]>0){if(statData[i][0].tpchart=="Bar"){if(typeof tempp[j]=="undefined")tempp2[j]=0;tempp2[j]+=1*data.datasets[i].data[j];maxValp2=Math.max(maxValp2,tempp2[j])}else maxValp2=Math.max(maxValp2,1*data.datasets[i].data[j]);minValp2=Math.min(minValp2,1*data.datasets[i].data[j]);inp2=1}else if(typeof(1*data.datasets[i].data[j])==="number"&&typeof data.datasets[i].data[j]!="undefined"){if(statData[i][0].tpchart=="Bar"){if(typeof tempn2[j]=="undefined")tempn2[j]=0;tempn2[j]+=1*data.datasets[i].data[j];minValn2=Math.min(minValn2,tempn2[j])}else minValn2=Math.min(minValn2,1*data.datasets[i].data[j]);maxValn2=Math.max(maxValn2,1*data.datasets[i].data[j]);inn2=1}}else{firstAxis=true;if(1*data.datasets[i].data[j]>0){if(statData[i][0].tpchart=="Bar"){if(typeof tempp[j]=="undefined")tempp[j]=0;tempp[j]+=1*data.datasets[i].data[j];maxValp=Math.max(maxValp,tempp[j])}else maxValp=Math.max(maxValp,1*data.datasets[i].data[j]);minValp=Math.min(minValp,1*data.datasets[i].data[j]);inp=1}else if(typeof(1*data.datasets[i].data[j])==="number"&&typeof data.datasets[i].data[j]!="undefined"){if(statData[i][0].tpchart=="Bar"){if(typeof tempn[j]=="undefined")tempn[j]=0;tempn[j]+=1*data.datasets[i].data[j];minValn=Math.min(minValn,tempn[j])}else minValn=Math.min(minValn,1*data.datasets[i].data[j]);maxValn=Math.max(maxValn,1*data.datasets[i].data[j]);inn=1}}}}if(!firstAxis&&secondAxis){upperValue=upperValue2;lowerValue=lowerValue2}var upperValue,lowerValue;if(inp==0){upperValue=maxValn;lowerValue=minValn}else if(inn==0){upperValue=maxValp;lowerValue=minValp}else{upperValue=maxValp;lowerValue=minValn}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}var upperValue2,lowerValue2;if(secondAxis){if(inp2==0){upperValue2=maxValn2;lowerValue2=minValn2}else if(inn2==0){upperValue2=maxValp2;lowerValue2=minValp2}else{upperValue2=maxValp2;lowerValue2=minValn2}if(typeof config.graphMin2=="function")lowerValue2=setOptionValue(true,true,1,"GRAPHMIN2",ctx,data,statData,undefined,config.graphMin2,"graphMin2",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin2))lowerValue2=config.graphMin2;if(typeof config.graphMax2=="function")upperValue2=setOptionValue(true,true,1,"GRAPHMAX2",ctx,data,statData,undefined,config.graphMax2,"graphMax2",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax2))upperValue2=config.graphMax2;if(upperValue2<lowerValue2){upperValue2=0;lowerValue2=0}if(Math.abs(upperValue2-lowerValue2)<config.zeroValue){if(Math.abs(upperValue2)<config.zeroValue)upperValue2=.9;if(upperValue2>0){upperValue2=upperValue2*1.1;lowerValue2=lowerValue2*.9}else{upperValue2=upperValue2*.9;lowerValue2=lowerValue2*1.1}}}labelHeight=Math.ceil(ctx.chartTextScale*config.scaleFontSize);scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}if(upperValue2<lowerValue2){lowerValue2=upperValue2-1}return{maxValue:upperValue,minValue:lowerValue,maxValue2:upperValue2,minValue2:lowerValue2,dbAxis:secondAxis,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};function reverseData(data){data.labels=data.labels.reverse();for(var i=0;i<data.datasets.length;i++){for(var key in data.datasets[i]){if(Array.isArray(data.datasets[i][key])){data.datasets[i][key]=data.datasets[i][key].reverse()}}}return data}var HorizontalStackedBar=function(data,config,ctx){var maxSize,scaleHop,calculatedScale,labelHeight,scaleHeight,valueBounds,labelTemplateString,valueHop,xAxisLength,yAxisPosX,xAxisPosY,barWidth,rotateLabels=0,msr;if(config.reverseOrder&&typeof ctx.reversed=="undefined"){ctx.reversed=true;data=reverseData(data)}ctx.tpchart="HorizontalStackedBar";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);config.logarithmic=false;msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,"nihil","nihil",true,true,true,true,"HorizontalStackedBar");valueBounds=getValueBounds();if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,calculatedScale.labels,true,true,true,true,"HorizontalStackedBar")}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,labels:[]};for(var i=0;i<=calculatedScale.steps;i++){if(labelTemplateString){calculatedScale.labels.push(tmpl(labelTemplateString,{value:fmtChartJS(config,1*(scaleStartValue+scaleStepWidth*i).toFixed(getDecimalPlaces(scaleStepWidth)),config.fmtYLabel)},config))}}msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,null,true,true,true,true,"HorizontalStackedBar")}msr.availableHeight=msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleTickSizeBottom)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);msr.availableWidth=msr.availableWidth-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight);scaleHop=Math.floor(msr.availableHeight/data.labels.length);valueHop=Math.floor(msr.availableWidth/calculatedScale.steps);if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/calculatedScale.steps;msr.clrwidth=msr.clrwidth-(msr.availableWidth-calculatedScale.steps*valueHop);msr.topNotUsableHeight+=msr.availableHeight-data.labels.length*scaleHop;msr.rightNotUsableWidth+=msr.availableWidth-calculatedScale.steps*valueHop;msr.availableWidth=calculatedScale.steps*valueHop;msr.availableHeight=data.labels.length*scaleHop;yAxisPosX=msr.leftNotUsableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft);xAxisPosY=msr.topNotUsableHeight+msr.availableHeight+Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);barWidth=scaleHop-Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth)*2-Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)*2-(Math.ceil(ctx.chartSpaceScale*config.barDatasetSpacing)*1-1)-Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2-1;if(barWidth>=0&&barWidth<=1)barWidth=1;if(barWidth<0&&barWidth>=-1)barWidth=-1;var additionalSpaceBetweenBars;if(1*config.maxBarWidth>0&&barWidth>1*config.maxBarWidth){additionalSpaceBetweenBars=(barWidth-1*config.maxBarWidth)/2;barWidth=1*config.maxBarWidth}else additionalSpaceBetweenBars=0;drawLabels();var zeroY=HorizontalCalculateOffset(0,calculatedScale,scaleHop);initPassVariableData_part2(statData,data,config,ctx,{yAxisPosX:yAxisPosX,additionalSpaceBetweenBars:additionalSpaceBetweenBars,xAxisPosY:xAxisPosY,barWidth:barWidth,zeroY:zeroY,scaleHop:scaleHop,valueHop:valueHop,calculatedScale:calculatedScale});animationLoop(config,msr.legendMsr,drawScale,drawBars,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function HorizontalCalculateOffset(val,calculatedScale,scaleHop){var outerValue=calculatedScale.steps*calculatedScale.stepValue;var adjustedValue=val-calculatedScale.graphMin;var scalingFactor=CapValue(adjustedValue/outerValue,1,0);return scaleHop*calculatedScale.steps*scalingFactor}function drawBars(animPc){var prevLeftPos=new Array;var prevLeftNeg=new Array;for(var i=0;i<data.datasets.length;i++){for(var j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"BARSTROKEWIDTH",ctx,data,statData,data.datasets[i].barStrokeWidth,config.barStrokeWidth,"barStrokeWidth",i,j,{animationValue:currentAnimPc,xPosLeft:leftBar,yPosBottom:statData[i][j].yPosBottom,xPosRight:rightBar,yPosTop:statData[i][j].yPosBottom}));var currentAnimPc=animationCorrection(animPc,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(typeof data.datasets[i].data[j]=="undefined"||1*data.datasets[i].data[j]==0)continue;if(Math.abs(data.datasets[i].data[j])<config.zeroValue&&config.showZeroValue==false)continue;if(typeof prevLeftPos[j]=="undefined"){prevLeftPos[j]=statData[statData[i][j].firstNotMissing][j].xPosLeft;prevLeftNeg[j]=statData[statData[i][j].firstNotMissing][j].xPosLeft}var leftBar,rightBar;if(1*data.datasets[i].data[j]>0)leftBar=prevLeftPos[j];else leftBar=prevLeftNeg[j];rightBar=leftBar+currentAnimPc*(statData[i][j].xPosRight-statData[i][j].xPosLeft);if(1*data.datasets[i].data[j]>0)prevLeftPos[j]=rightBar;else prevLeftNeg[j]=rightBar;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc,xPosLeft:leftBar,yPosBottom:statData[i][j].yPosBottom,xPosRight:rightBar,yPosTop:statData[i][j].yPosBottom});ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,j,{nullvalue:null});if(currentAnimPc!=0&&statData[i][j].xPosLeft!=statData[i][j].xPosRight){ctx.beginPath();ctx.moveTo(leftBar+(rightBar-leftBar)/2,statData[i][j].yPosTop);ctx.lineTo(rightBar,statData[i][j].yPosTop);ctx.lineTo(rightBar,statData[i][j].yPosBottom);ctx.lineTo(leftBar,statData[i][j].yPosBottom);ctx.lineTo(leftBar,statData[i][j].yPosTop);ctx.lineTo(leftBar+(rightBar-leftBar)/2,statData[i][j].yPosTop);if(config.barShowStroke){ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"STROKESTYLE",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([])}ctx.closePath();ctx.fill()}}}if(animPc>=config.animationStopValue){var yPos=0,xPos=0;for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined")continue;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["RECT",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){ctx.save();ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);ctx.beginPath();yPos=0;xPos=0;if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==1){xPos=statData[i][j].xPosLeft+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==2){xPos=statData[i][j].xPosLeft+(statData[i][j].xPosRight-statData[i][j].xPosLeft)/2+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==3){xPos=statData[i][j].xPosRight+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==1){yPos=statData[i][j].yPosBottom-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==2){yPos=statData[i][j].yPosBottom-barWidth/2-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==3){yPos=statData[i][j].yPosTop-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}ctx.translate(xPos,yPos);rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,xPos,yPos,i,j);ctx.restore()}}}}}function drawScale(){drawGridScale(ctx,data,config,msr,yAxisPosX,xAxisPosY,zeroY,valueHop,scaleHop,data.labels.length+0,calculatedScale.steps+1)}function drawLabels(){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;if(config.scaleShowLabels&&(config.xAxisTop||config.xAxisBottom)){ctx.textBaseline="top";ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}for(var i=config.showYAxisMin?-1:0;i<calculatedScale.steps;i++){if(showYLabels(ctx,data,config,i+1,calculatedScale.labels[i+1])){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+(i+1)*valueHop-msr.highestXLabel/2,msr.xLabelPos);ctx.rotate(-((msr.rotateLabels+180*(msr.rotateLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(calculatedScale.labels[i+1],0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+(i+1)*valueHop-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(calculatedScale.labels[i+1],yAxisPosX+(i+1)*valueHop,msr.xLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}if(config.xAxisTop){if(msr.rotateTLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateTLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}for(var i=config.showYAxisMin?-1:0;i<calculatedScale.steps;i++){if(showYLabels(ctx,data,config,i+1,calculatedScale.labels[i+1])){ctx.save();if(msr.rotateTLabels>0){ctx.translate(yAxisPosX+(i+1)*valueHop-msr.highestTXLabel/2,msr.xTLabelPos);ctx.rotate(-((msr.rotateTLabels+180*(msr.rotateTLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(calculatedScale.labels[i+1],0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+(i+1)*valueHop-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(calculatedScale.labels[i+1],yAxisPosX+(i+1)*valueHop,msr.xTLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var j=0;j<data.labels.length;j++){if(showLabels(ctx,data,config,j)){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(fmtChartJS(config,data.labels[j],config.fmtXLabel),yAxisPosX-(Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+additionalSpaceBetweenBars+barWidth/2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YLEFTAXIS_TEXTMOUSE",0,0,0,-1,j)}if(config.yAxisRight){ctx.textAlign="left";ctx.fillTextMultiLine(fmtChartJS(config,data.labels[j],config.fmtXLabel),yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop+additionalSpaceBetweenBars+barWidth/2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;var minvl=new Array(data.datasets.length);var maxvl=new Array(data.datasets.length);for(var i=0;i<data.datasets.length;i++){for(var j=0;j<data.datasets[i].data.length;j++){var k=i;var tempp=0;var tempn=0;if(!(typeof data.datasets[0].data[j]=="undefined")){if(1*data.datasets[0].data[j]>0){tempp+=1*data.datasets[0].data[j];if(tempp>upperValue){upperValue=tempp}if(tempp<lowerValue){lowerValue=tempp}}else{tempn+=1*data.datasets[0].data[j];if(tempn>upperValue){upperValue=tempn}if(tempn<lowerValue){lowerValue=tempn}}}while(k>0){if(!(typeof data.datasets[k].data[j]=="undefined")){if(1*data.datasets[k].data[j]>0){tempp+=1*data.datasets[k].data[j];if(tempp>upperValue){upperValue=tempp}if(tempp<lowerValue){lowerValue=tempp}}else{tempn+=1*data.datasets[k].data[j];if(tempn>upperValue){upperValue=tempn}if(tempn<lowerValue){lowerValue=tempn}}}k--}}}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}labelHeight=Math.ceil(ctx.chartTextScale*config.scaleFontSize);scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}return{maxValue:upperValue,minValue:lowerValue,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};var Bar=function(data,config,ctx){var maxSize,scaleHop,scaleHop2,calculatedScale,calculatedScale2,labelHeight,scaleHeight,valueBounds,labelTemplateString,labelTemplateString2,valueHop,xAxisLength,yAxisPosX,xAxisPosY,barWidth,rotateLabels=0,msr;ctx.tpchart="Bar";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);var nrOfBars=data.datasets.length;for(var i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line"){statData[i][0].tpchart="Line";nrOfBars--}else statData[i][0].tpchart="Bar"}var bufferDataset,l=0;msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,"nihil","nihil",true,false,true,true,"Bar");valueBounds=getValueBounds();if(valueBounds.minValue<=0)config.logarithmic=false;if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){if(config.logarithmic!==false){if(valueBounds.minValue<=0){config.logarithmic=false}}if(config.logarithmic2!==false){if(valueBounds.minValue2<=0){config.logarithmic2=false}}var OrderOfMagnitude=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue)));if(config.logarithmic=="fuzzy"&&OrderOfMagnitude<4||config.scaleOverride){config.logarithmic=false}var OrderOfMagnitude2=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue2)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue2)));if(config.logarithmic2=="fuzzy"&&OrderOfMagnitude2<4||config.scaleOverride2){config.logarithmic2=false}labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";labelTemplateString2=config.scaleShowLabels2?config.scaleLabel2:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString)}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth)}if(valueBounds.dbAxis||config.forceSecondScale){if(!config.scaleOverride2){calculatedScale2=calculateScale(2,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue2,valueBounds.minValue2,labelTemplateString2)}else{var scaleStartValue2=setOptionValue(true,true,1,"SCALESTARTVALUE2",ctx,data,statData,undefined,config.scaleStartValue2,"scaleStartValue2",-1,-1,{nullValue:true});var scaleSteps2=setOptionValue(true,true,1,"SCALESTEPS2",ctx,data,statData,undefined,config.scaleSteps2,"scaleSteps2",-1,-1,{nullValue:true});var scaleStepWidth2=setOptionValue(true,true,1,"SCALESTEPWIDTH2",ctx,data,statData,undefined,config.scaleStepWidth2,"scaleStepWidth2",-1,-1,{nullValue:true});calculatedScale2={steps:scaleSteps2,stepValue:scaleStepWidth2,graphMin:scaleStartValue2,graphMax:scaleStartValue2+scaleSteps2*scaleStepWidth2,labels:[]};populateLabels(2,config,labelTemplateString2,calculatedScale2.labels,calculatedScale2.steps,scaleStartValue2,calculatedScale2.graphMax,scaleStepWidth2)}}else{calculatedScale2={steps:0,stepValue:0,graphMin:0,graphMax:0,labels:null}}msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,calculatedScale2.labels,true,false,true,true,"Bar");var prevHeight=msr.availableHeight;msr.availableHeight=msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleTickSizeBottom)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);msr.availableWidth=msr.availableWidth-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight);scaleHop=Math.floor(msr.availableHeight/calculatedScale.steps);scaleHop2=Math.floor(msr.availableHeight/calculatedScale2.steps);valueHop=Math.floor(msr.availableWidth/data.labels.length);if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/data.labels.length;msr.topNotUsableHeight+=msr.availableHeight-calculatedScale.steps*scaleHop;msr.rightNotUsableWidth+=msr.availableWidth-data.labels.length*valueHop;msr.clrwidth=msr.clrwidth-(msr.availableWidth-data.labels.length*valueHop);msr.availableWidth=data.labels.length*valueHop;msr.availableHeight=calculatedScale.steps*scaleHop;yAxisPosX=msr.leftNotUsableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft);xAxisPosY=msr.topNotUsableHeight+msr.availableHeight+Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);barWidth=(valueHop-Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth)*2-Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)*2-(Math.ceil(ctx.chartSpaceScale*config.barDatasetSpacing)*nrOfBars-1)-(Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2*nrOfBars-1))/nrOfBars;if(barWidth>=0&&barWidth<=1)barWidth=1;if(barWidth<0&&barWidth>=-1)barWidth=-1;var additionalSpaceBetweenBars;if(1*config.maxBarWidth>0&&barWidth>1*config.maxBarWidth){additionalSpaceBetweenBars=nrOfBars*(barWidth-1*config.maxBarWidth)/2;barWidth=1*config.maxBarWidth}else additionalSpaceBetweenBars=0;var zeroY2=0;var zeroY=calculateOffset(config.logarithmic,0,calculatedScale,scaleHop);if(typeof calculatedScale2==="object")zeroY2=calculateOffset(config.logarithmic2,0,calculatedScale2,scaleHop2);initPassVariableData_part2(statData,data,config,ctx,{msr:msr,yAxisPosX:yAxisPosX,xAxisPosY:xAxisPosY,valueHop:valueHop,nbValueHop:data.labels.length-1,barWidth:barWidth,additionalSpaceBetweenBars:additionalSpaceBetweenBars,zeroY:zeroY,zeroY2:zeroY2,calculatedScale:calculatedScale,calculatedScale2:calculatedScale2,scaleHop:scaleHop,scaleHop2:scaleHop2});drawLabels();animationLoop(config,msr.legendMsr,drawScale,drawBars,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function drawBars(animPc){var t1,t2,t3,complementaryBar,otherBarHeight,barHeight,i,j,currentAnimPc,fullHeight,sizeTop,sizeBottom,decal;for(i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line")continue;for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;ctx.save();ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"BARSTROKEWIDTH",ctx,data,statData,data.datasets[i].barStrokeWidth,config.barStrokeWidth,"barStrokeWidth",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barWidth,yPosTop:statData[i][j].yPosBottom-barHeight}));if(!(typeof data.datasets[i].data[j]=="undefined")){if(Math.abs(data.datasets[i].data[j])>=config.zeroValue||config.showZeroValue==true){currentAnimPc=animationCorrection(animPc,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(1*data.datasets[i].data[j]>=0)barHeight=currentAnimPc*statData[i][j].barHeight-Math.ceil(ctx.chartLineScale*ctx.lineWidth)/2;else barHeight=currentAnimPc*statData[i][j].barHeight+Math.ceil(ctx.chartLineScale*ctx.lineWidth)/2;ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barWidth,yPosTop:statData[i][j].yPosBottom-barHeight});ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,j,{nullvalue:null});roundRect(ctx,statData[i][j].xPosLeft,statData[i][j].yPosBottom,barWidth,barHeight,config.barShowStroke,config.barBorderRadius,i,j,data.datasets[i].data[j]<0?-1:1)}}ctx.restore()}}for(i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line")continue;for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;complementaryBar=setOptionValue(true,true,1,"COMPLEMENTARYBAR",ctx,data,statData,data.datasets[i].complementaryBar,config.complementaryBar,"complementaryBar",i,j,{nullvalue:null});if(complementaryBar==false)continue;ctx.save();ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"BARSTROKEWIDTH",ctx,data,statData,data.datasets[i].barStrokeWidth,config.barStrokeWidth,"barStrokeWidth",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barWidth,yPosTop:statData[i][j].yPosBottom-barHeight}));currentAnimPc=animationCorrection(animPc,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(!(typeof data.datasets[i].data[j]=="undefined")){if(1*data.datasets[i].data[j]>=0)barHeight=currentAnimPc*statData[i][j].barHeight-Math.ceil(ctx.chartLineScale*ctx.lineWidth)/2;else barHeight=currentAnimPc*statData[i][j].barHeight+Math.ceil(ctx.chartLineScale*ctx.lineWidth)/2}else barHeight=0;fullHeight=msr.clrheight-Math.ceil(ctx.chartLineScale*(config.scaleTickSizeTop+config.scaleTickSizeBottom));sizeTop=statData[i][j].yPosBottom-msr.clry-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);sizeBottom=fullHeight-sizeTop;if(1*data.datasets[i].data[j]<0){otherBarHeight=-(sizeBottom+barHeight)+3*(ctx.lineWidth/2);otherBarHeight2=sizeTop-3*(ctx.lineWidth/2);decal=-(ctx.lineWidth/2)}else{otherBarHeight=sizeTop-barHeight-3*(ctx.lineWidth/2);otherBarHeight2=-(sizeBottom-3*(ctx.lineWidth/2));decal=+(ctx.lineWidth/2)}ctx.fillStyle=setOptionValue(true,true,1,"COMPLEMENTARYCOLOR",ctx,data,statData,data.datasets[i].complementaryColor,config.complementaryColor,"complementaryColor",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom-barHeight,xPosRight:statData[i][j].xPosLeft+barWidth,yPosTop:statData[i][j].yPosBottom-barHeight-otherBarHeight});ctx.strokeStyle=setOptionValue(true,true,1,"COMPLEMENTARYSTROKECOLOR",ctx,data,statData,data.datasets[i].complementaryStrokeColor,config.complementaryStrokeColor,"strokeColor",i,j,{nullvalue:null});roundRect(ctx,statData[i][j].xPosLeft,statData[i][j].yPosBottom-barHeight-2*decal,barWidth,otherBarHeight,config.barShowStroke,config.barBorderRadius,i,j,data.datasets[i].data[j]<0?-1:1);if(config.complementaryBarFullHeight){roundRect(ctx,statData[i][j].xPosLeft,statData[i][j].yPosBottom+2*decal,barWidth,otherBarHeight2,config.barShowStroke,config.barBorderRadius,i,j,data.datasets[i].data[j]<0?-1:1)}ctx.restore()}}drawLinesDataset(animPc,data,config,ctx,statData,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length});if(animPc>=config.animationStopValue){for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined")continue;if(data.datasets[i].type=="Line")continue;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["RECT",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){ctx.save();ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});t1=statData[i][j].yPosBottom;t2=statData[i][j].yPosTop;ctx.beginPath();var yPos=0,xPos=0;if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==1){xPos=statData[i][j].xPosLeft+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==2){xPos=statData[i][j].xPosLeft+barWidth/2+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==3){xPos=statData[i][j].xPosLeft+barWidth+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==1){yPos=statData[i][j].yPosBottom-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==2){yPos=(statData[i][j].yPosBottom+statData[i][j].yPosTop)/2-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==3){yPos=statData[i][j].yPosTop-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}ctx.translate(xPos,yPos);var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,xPos,yPos,i,j);ctx.restore()}}}}if(animPc>=1&&typeof drawMath=="function"){drawMath(ctx,config,data,msr,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,scaleHop:scaleHop,zeroY:zeroY,calculatedScale:calculatedScale,calculateOffset:calculateOffset,additionalSpaceBetweenBars:additionalSpaceBetweenBars,barWidth:barWidth})}}function roundRect(ctx,x,y,w,h,stroke,radius,i,j,fact){ctx.beginPath();ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"STROKESTYLE",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.moveTo(x+w/2,y);ctx.lineTo(x+w,y);ctx.lineTo(x+w,y-h+fact*radius);ctx.quadraticCurveTo(x+w,y-h,x+w-radius,y-h);ctx.lineTo(x+radius,y-h);ctx.quadraticCurveTo(x,y-h,x,y-h+fact*radius);ctx.lineTo(x,y);ctx.lineTo(x+w/2,y);if(stroke)ctx.stroke();ctx.closePath();ctx.fill();ctx.setLineDash([])}function drawScale(){drawGridScale(ctx,data,config,msr,yAxisPosX,xAxisPosY,zeroY,valueHop,scaleHop,calculatedScale.steps,data.labels.length+1)}function drawLabels(){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;if(config.xAxisTop||config.xAxisBottom){ctx.textBaseline="top";ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}for(var i=0;i<data.labels.length;i++){if(showLabels(ctx,data,config,i)){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+i*valueHop+valueHop/2-msr.highestXLabel/2,msr.xLabelPos);ctx.rotate(-((msr.rotateLabels+180*(msr.rotateLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+i*valueHop+valueHop/2-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),yAxisPosX+i*valueHop+valueHop/2,msr.xLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}if(config.xAxisTop){if(msr.rotateTLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateTLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}var label;if(typeof data.labels2=="object")label=data.labels2;else label=data.labels;for(var i=0;i<label.length;i++){if(showLabels(ctx,data,config,i)){ctx.save();if(msr.rotateTLabels>0){ctx.translate(yAxisPosX+i*valueHop+valueHop/2-msr.highestTXLabel/2,msr.xTLabelPos);ctx.rotate(-((msr.rotateTLabels+180*(msr.rotateTLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,label[i],config.fmtXLabel),0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+i*valueHop+valueHop/2-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(fmtChartJS(config,label[i],config.fmtXLabel),yAxisPosX+i*valueHop+valueHop/2,msr.xTLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var j=config.showYAxisMin?-1:0;j<calculatedScale.steps;j++){if(config.scaleShowLabels){if(showYLabels(ctx,data,config,j+1,calculatedScale.labels[j+1])){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(calculatedScale.labels[j+1],yAxisPosX-(Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YLEFTAXIS_TEXTMOUSE",0,0,0,-1,j)}if(config.yAxisRight&&!(valueBounds.dbAxis||config.forceSecondScale)){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale.labels[j+1],yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}if(config.yAxisRight&&(valueBounds.dbAxis||config.forceSecondScale)){for(j=config.showYAxisMin?-1:0;j<calculatedScale2.steps;j++){if(config.scaleShowLabels){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale2.labels[j+1],yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-(j+1)*scaleHop2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;var upperValue2=-Number.MAX_VALUE;var lowerValue2=Number.MAX_VALUE;var secondAxis=false;var firstAxis=false;var mathValueHeight;for(var i=0;i<data.datasets.length;i++){var mathFctName=data.datasets[i].drawMathDeviation;var mathValueHeight=0;if(typeof eval(mathFctName)=="function"){var parameter={data:data,datasetNr:i};mathValueHeightVal=window[mathFctName](parameter)}else mathValueHeightVal=0;for(var j=0;j<data.datasets[i].data.length;j++){if(typeof mathValueHeightVal=="object")mathValueHeight=mathValueHeightVal[Math.min(mathValueHeightVal.length,j)];else mathValueHeight=mathValueHeightVal;if(typeof data.datasets[i].data[j]=="undefined")continue;if(data.datasets[i].axis==2){secondAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue2){upperValue2=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue2){lowerValue2=1*data.datasets[i].data[j]-mathValueHeight}}else{firstAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue){upperValue=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue){lowerValue=1*data.datasets[i].data[j]-mathValueHeight}}}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;if(secondAxis){if(upperValue2<lowerValue2){upperValue2=0;lowerValue2=0}if(Math.abs(upperValue2-lowerValue2)<config.zeroValue){if(Math.abs(upperValue2)<config.zeroValue)upperValue2=.9;if(upperValue2>0){upperValue2=upperValue2*1.1;lowerValue2=lowerValue2*.9}else{upperValue2=upperValue2*.9;lowerValue2=lowerValue2*1.1}}if(typeof config.graphMin2=="function")lowerValue2=setOptionValue(true,true,1,"GRAPHMIN2",ctx,data,statData,undefined,config.graphMin2,"graphMin2",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin2))lowerValue2=config.graphMin2;if(typeof config.graphMax2=="function")upperValue2=setOptionValue(true,true,1,"GRAPHMAX2",ctx,data,statData,undefined,config.graphMax2,"graphMax2",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax2))upperValue2=config.graphMax2}if(!firstAxis&&secondAxis){upperValue=upperValue2;lowerValue=lowerValue2}labelHeight=Math.ceil(ctx.chartTextScale*config.scaleFontSize);scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}if(upperValue2<lowerValue2){lowerValue2=upperValue2-1}return{maxValue:upperValue,minValue:lowerValue,maxValue2:upperValue2,minValue2:lowerValue2,dbAxis:secondAxis,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};var HorizontalBar=function(data,config,ctx){var maxSize,scaleHop,calculatedScale,labelHeight,scaleHeight,valueBounds,labelTemplateString,valueHop,xAxisLength,yAxisPosX,xAxisPosY,barWidth,rotateLabels=0,msr;ctx.tpchart="HorizontalBar";ctx.tpdata=0;if(!init_and_start(ctx,data,config))return;if(config.reverseOrder&&typeof ctx.reversed=="undefined"){ctx.reversed=true;data=reverseData(data)}var statData=initPassVariableData_part1(data,config,ctx);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,"nihil","nihil",true,true,true,true,"StackedBar");valueBounds=getValueBounds();if(valueBounds.minValue<=0)config.logarithmic=false;if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){if(config.logarithmic!==false){if(valueBounds.minValue<=0){config.logarithmic=false}}labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,calculatedScale.labels,true,true,true,true,"HorizontalBar")}else{var scaleStartValue=setOptionValue(true,true,1,"SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,"scaleStartValue",-1,-1,{nullValue:true});var scaleSteps=setOptionValue(true,true,1,"SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,"scaleSteps",-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue(true,true,1,"SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,"scaleStepWidth",-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth);msr=setMeasures(data,config,ctx,ctx.canvas.height,ctx.canvas.width,calculatedScale.labels,null,true,true,true,true,"HorizontalBar")}msr.availableHeight=msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleTickSizeBottom)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);msr.availableWidth=msr.availableWidth-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)-Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight);scaleHop=Math.floor(msr.availableHeight/data.labels.length);valueHop=Math.floor(msr.availableWidth/calculatedScale.steps);if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/calculatedScale.steps;msr.clrwidth=msr.clrwidth-(msr.availableWidth-calculatedScale.steps*valueHop);msr.topNotUsableHeight+=msr.availableHeight-data.labels.length*scaleHop;msr.rightNotUsableWidth+=msr.availableWidth-calculatedScale.steps*valueHop;msr.availableWidth=calculatedScale.steps*valueHop;msr.availableHeight=data.labels.length*scaleHop;yAxisPosX=msr.leftNotUsableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft);xAxisPosY=msr.topNotUsableHeight+msr.availableHeight+Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop);barWidth=(scaleHop-Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth)*2-Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)*2-(Math.ceil(ctx.chartSpaceScale*config.barDatasetSpacing)*data.datasets.length-1)-(Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2*data.datasets.length-1))/data.datasets.length;if(barWidth>=0&&barWidth<=1)barWidth=1;if(barWidth<0&&barWidth>=-1)barWidth=-1;var additionalSpaceBetweenBars;if(1*config.maxBarWidth>0&&barWidth>1*config.maxBarWidth){additionalSpaceBetweenBars=data.datasets.length*(barWidth-1*config.maxBarWidth)/2;barWidth=1*config.maxBarWidth}else additionalSpaceBetweenBars=0;var zeroY=0;zeroY=calculateOffset(config.logarithmic,0,calculatedScale,valueHop);drawLabels();initPassVariableData_part2(statData,data,config,ctx,{yAxisPosX:yAxisPosX,xAxisPosY:xAxisPosY,barWidth:barWidth,additionalSpaceBetweenBars:additionalSpaceBetweenBars,zeroY:zeroY,scaleHop:scaleHop,valueHop:valueHop,calculatedScale:calculatedScale});animationLoop(config,msr.legendMsr,drawScale,drawBars,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data,statData)}else{testRedraw(ctx,data,config);ctx.firstPass=9}function drawBars(animPc){var i,j,currentAnimPc,barHeight,fullHeight,sizeTop,sizeBottom,otherBarHeight,otherBarHeight2,decal;for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;ctx.save();ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"BARSTROKEWIDTH",ctx,data,statData,data.datasets[i].barStrokeWidth,config.barStrokeWidth,"barStrokeWidth",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barWidth,yPosTop:statData[i][j].yPosBottom}));currentAnimPc=animationCorrection(animPc,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(1*data.datasets[i].data[j]>=0)barHeight=currentAnimPc*statData[i][j].barWidth-Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2;else barHeight=currentAnimPc*statData[i][j].barWidth+Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2;ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barHeight,yPosTop:statData[i][j].yPosBottom});ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,j,{nullvalue:null});if(!(typeof data.datasets[i].data[j]=="undefined")){if(Math.abs(data.datasets[i].data[j])>=config.zeroValue||config.showZeroValue==true){roundRect(ctx,statData[i][j].yPosTop,statData[i][j].xPosLeft,barWidth,barHeight,config.barShowStroke,config.barBorderRadius,0,i,j,data.datasets[i].data[j]<0?-1:1)}}ctx.restore()}}for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;complementaryBar=setOptionValue(true,true,1,"COMPLEMENTARYBAR",ctx,data,statData,data.datasets[i].complementaryBar,config.complementaryBar,"complementaryBar",i,j,{nullvalue:null});if(complementaryBar==false)continue;ctx.save();ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"BARSTROKEWIDTH",ctx,data,statData,data.datasets[i].barStrokeWidth,config.barStrokeWidth,"barStrokeWidth",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barWidth,yPosTop:statData[i][j].yPosBottom-barHeight}));currentAnimPc=animationCorrection(animPc,data,config,i,j,false).animVal;if(currentAnimPc>1)currentAnimPc=currentAnimPc-1;if(1*data.datasets[i].data[j]>=0)barHeight=currentAnimPc*statData[i][j].barWidth-Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2;else barHeight=currentAnimPc*statData[i][j].barWidth+Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2;fullHeight=msr.clrwidth-Math.ceil(ctx.chartLineScale*(config.scaleTickSizeLeft+config.scaleTickSizeRight));sizeTop=statData[i][j].xPosLeft-msr.clrx-Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight);sizeBottom=fullHeight-sizeTop;if(1*data.datasets[i].data[j]<0){otherBarHeight=-(msr.clrwidth-(statData[i][j].xPosLeft-msr.clrx-barHeight))+Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft);otherBarHeight=-(sizeBottom+barHeight)+3*(ctx.lineWidth/2);otherBarHeight2=sizeTop-3*(ctx.lineWidth/2);decal=-(ctx.lineWidth/2)}else{otherBarHeight=msr.clrwidth-(statData[i][j].xPosLeft-msr.clrx+barHeight+ctx.lineWidth);otherBarHeight=sizeTop-barHeight-3*(ctx.lineWidth/2);otherBarHeight2=-(sizeBottom-3*(ctx.lineWidth/2));decal=+(ctx.lineWidth/2)}ctx.fillStyle=setOptionValue(true,true,1,"COMPLEMENTARYCOLOR",ctx,data,statData,data.datasets[i].complementaryColor,config.complementaryColor,"complementaryColor",i,j,{animationValue:currentAnimPc,xPosLeft:statData[i][j].xPosLeft+barHeight,yPosBottom:statData[i][j].yPosBottom,xPosRight:statData[i][j].xPosLeft+barHeight+otherBarHeight,yPosTop:statData[i][j].yPosBottom});ctx.strokeStyle=setOptionValue(true,true,1,"COMPLEMENTARYSTROKECOLOR",ctx,data,statData,data.datasets[i].complementaryStrokeColor,config.complementaryStrokeColor,"strokeColor",i,j,{nullvalue:null});roundRect(ctx,statData[i][j].yPosTop,statData[i][j].xPosLeft+barHeight+2*decal,barWidth,otherBarHeight,config.barShowStroke,config.barBorderRadius,0,i,j,data.datasets[i].data[j]<0?-1:1);if(config.complementaryBarFullHeight){roundRect(ctx,statData[i][j].yPosTop,statData[i][j].xPosLeft-2*decal,barWidth,otherBarHeight2,config.barShowStroke,config.barBorderRadius,0,i,j,data.datasets[i].data[j]<0?-1:1)}ctx.restore()}}if(animPc>=config.animationStopValue){for(i=0;i<data.datasets.length;i++){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined")continue;jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["RECT",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){ctx.save();ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});ctx.beginPath();var yPos=0,xPos=0;if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==1){yPos=statData[i][j].yPosTop-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})+barWidth}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==2){yPos=statData[i][j].yPosTop+barWidth/2-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,"inGraphDataYPosition",i,j,{nullValue:true})==3){yPos=statData[i][j].yPosTop-setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true})}if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==1){xPos=statData[i][j].xPosLeft+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==2){xPos=(statData[i][j].xPosLeft+statData[i][j].xPosRight)/2+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}else if(setOptionValue(true,true,1,"INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,"inGraphDataXPosition",i,j,{nullValue:true})==3){xPos=statData[i][j].xPosRight+setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true})}ctx.translate(xPos,yPos);var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);var rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,xPos,yPos,i,j);ctx.restore()}}}}}function roundRect(ctx,x,y,w,h,stroke,radius,zeroY,i,j,fact){ctx.beginPath();ctx.moveTo(y+zeroY,x);ctx.lineTo(y+zeroY,x+w);ctx.lineTo(y+h-fact*radius,x+w);ctx.quadraticCurveTo(y+h,x+w,y+h,x+w-radius);ctx.lineTo(y+h,x+radius);ctx.quadraticCurveTo(y+h,x,y+h-fact*radius,x);ctx.lineTo(y+zeroY,x);ctx.quadraticCurveTo(y+zeroY,x,y+zeroY,x+w);if(stroke){ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"STROKESTYLE",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([])}ctx.closePath();ctx.fill()}function drawScale(){drawGridScale(ctx,data,config,msr,yAxisPosX,xAxisPosY,zeroY,valueHop,scaleHop,data.labels.length+0,calculatedScale.steps+1)}function drawLabels(){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;if(config.scaleShowLabels&&(config.xAxisTop||config.xAxisBottom)){ctx.textBaseline="top";ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}for(var i=config.showYAxisMin?-1:0;i<calculatedScale.steps;i++){if(showYLabels(ctx,data,config,i+1,calculatedScale.labels[i+1])){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+(i+1)*valueHop-msr.highestXLabel/2,msr.xLabelPos);ctx.rotate(-((msr.rotateLabels+180*(msr.rotateLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(calculatedScale.labels[i+1],0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+(i+1)*valueHop-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(calculatedScale.labels[i+1],yAxisPosX+(i+1)*valueHop,msr.xLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}if(config.xAxisTop){if(msr.rotateTLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateTLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}for(var i=config.showYAxisMin?-1:0;i<calculatedScale.steps;i++){if(showYLabels(ctx,data,config,i+1,calculatedScale.labels[i+1])){ctx.save();if(msr.rotateTLabels>0){ctx.translate(yAxisPosX+(i+1)*valueHop-msr.highestTXLabel/2,msr.xTLabelPos);ctx.rotate(-((msr.rotateTLabels+180*(msr.rotateTLabels>90))*(Math.PI/180)));ctx.fillTextMultiLine(calculatedScale.labels[i+1],0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",-(msr.rotateLabels*(Math.PI/180)),yAxisPosX+(i+1)*valueHop-msr.highestXLabel/2,msr.xLabelPos,i,-1)}else{ctx.fillTextMultiLine(calculatedScale.labels[i+1],yAxisPosX+(i+1)*valueHop,msr.xTLabelPos,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"XAXIS_TEXTMOUSE",0,0,0,i,-1)}ctx.restore()}}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var j=0;j<data.labels.length;j++){if(showLabels(ctx,data,config,j)){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(fmtChartJS(config,data.labels[j],config.fmtXLabel),yAxisPosX-(Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-j*scaleHop-scaleHop/2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YLEFTAXIS_TEXTMOUSE",0,0,0,-1,j)}if(config.yAxisRight){ctx.textAlign="left";ctx.fillTextMultiLine(fmtChartJS(config,data.labels[j],config.fmtXLabel),yAxisPosX+msr.availableWidth+(Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)),xAxisPosY-j*scaleHop-scaleHop/2,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.scaleFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXIS_TEXTMOUSE",0,0,0,-1,j)}}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;for(var i=0;i<data.datasets.length;i++){for(var j=0;j<data.datasets[i].data.length;j++){if(typeof data.datasets[i].data[j]=="undefined")continue;if(1*data.datasets[i].data[j]>upperValue){upperValue=1*data.datasets[i].data[j]}if(1*data.datasets[i].data[j]<lowerValue){lowerValue=1*data.datasets[i].data[j]}}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue(true,true,1,"GRAPHMIN",ctx,data,statData,undefined,config.graphMin,"graphMin",-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue(true,true,1,"GRAPHMAX",ctx,data,statData,undefined,config.graphMax,"graphMax",-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;labelHeight=Math.ceil(ctx.chartTextScale*config.scaleFontSize);scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);if(upperValue<lowerValue){lowerValue=upperValue-1}return{maxValue:upperValue,minValue:lowerValue,maxSteps:maxSteps,minSteps:minSteps}}return{data:data,config:config,ctx:ctx}};function calculateOffset(logarithmic,val,calculatedScale,scaleHop){if(!logarithmic){var outerValue=calculatedScale.steps*calculatedScale.stepValue;var adjustedValue=val-calculatedScale.graphMin;var scalingFactor=CapValue(adjustedValue/outerValue,1,0);return scaleHop*calculatedScale.steps*scalingFactor}else{return CapValue(log10(val)*scaleHop-log10(calculatedScale.graphMin)*scaleHop,undefined,0)}}function animationLoop(config,legendMsr,drawScale,drawData,ctx,clrx,clry,clrwidth,clrheight,midPosX,midPosY,borderX,borderY,data,statData){var cntiter=0;var animationCount=1;var multAnim=1;if(config.animationStartValue<0||config.animationStartValue>1)config.animation.StartValue=0;if(config.animationStopValue<0||config.animationStopValue>1)config.animation.StopValue=1;if(config.animationStopValue<config.animationStartValue)config.animationStopValue=config.animationStartValue;if(isIE()<9&&isIE()!=false)config.animation=false;var animFrameAmount=config.animation?1/CapValue(config.animationSteps,Number.MAX_VALUE,1):1,easingFunction=animationOptions[config.animationEasing],percentAnimComplete=config.animation?0:1;if(config.animation&&config.animationStartValue>0&&config.animationStartValue<=1){while(percentAnimComplete<config.animationStartValue){cntiter++;percentAnimComplete+=animFrameAmount}}var beginAnim=cntiter;var beginAnimPct=percentAnimComplete;if(typeof drawScale!=="function")drawScale=function(){};if(config.clearRect){if(config.animationForceSetTimeOut)requestAnimFrameSetTimeOut(animLoop);else requestAnimFrame(animLoop)}else animLoop();function animateFrame(){var easeAdjustedAnimationPercent=config.animation?CapValue(easingFunction(percentAnimComplete),null,0):1;if(1*cntiter>=1*CapValue(config.animationSteps,Number.MAX_VALUE,1)||config.animation==false||ctx.firstPass%10!=1)easeAdjustedAnimationPercent=1;else if(easeAdjustedAnimationPercent>=1)easeAdjustedAnimationPercent=.9999;if(config.animation&&!(isIE()<9&&isIE()!=false)&&config.clearRect){ctx.clearRect(clrx,clry,clrwidth,clrheight)}dispCrossImage(ctx,config,midPosX,midPosY,borderX,borderY,false,data,easeAdjustedAnimationPercent,cntiter);dispCrossText(ctx,config,midPosX,midPosY,borderX,borderY,false,data,easeAdjustedAnimationPercent,cntiter);if(typeof config.beforeDrawFunction=="function")config.beforeDrawFunction("BEFOREDRAWFUNCTION",ctx,data,statData,-1,-1,{animationValue:easeAdjustedAnimationPercent,cntiter:cntiter,config:config,borderX:borderX,borderY:borderY,midPosX:midPosX,midPosY:midPosY});if(config.scaleOverlay){drawData(easeAdjustedAnimationPercent);if(typeof config.endDrawDataFunction=="function")config.endDrawDataFunction("ENDDATAFUNCTION",ctx,data,statData,-1,-1,{animationValue:easeAdjustedAnimationPercent,cntiter:cntiter,config:config,borderX:borderX,borderY:borderY,midPosX:midPosX,midPosY:midPosY});drawScale();if(typeof config.endDrawScaleFunction=="function")config.endDrawScaleFunction("ENDSCALEFUNCTION",ctx,data,statData,-1,-1,{animationValue:easeAdjustedAnimationPercent,cntiter:cntiter,config:config,borderX:borderX,borderY:borderY,midPosX:midPosX,midPosY:midPosY})}else{drawScale();if(typeof config.endDrawScaleFunction=="function")config.endDrawScaleFunction("ENDSCALEFUNCTION",ctx,data,statData,-1,-1,{animationValue:easeAdjustedAnimationPercent,cntiter:cntiter,config:config,borderX:borderX,borderY:borderY,midPosX:midPosX,midPosY:midPosY});drawData(easeAdjustedAnimationPercent);if(typeof config.endDrawDataFunction=="function")config.endDrawDataFunction("ENDDATAFUNCTION",ctx,data,statData,-1,-1,{animationValue:easeAdjustedAnimationPercent,cntiter:cntiter,config:config,borderX:borderX,borderY:borderY,midPosX:midPosX,midPosY:midPosY})}dispCrossImage(ctx,config,midPosX,midPosY,borderX,borderY,true,data,easeAdjustedAnimationPercent,cntiter);dispCrossText(ctx,config,midPosX,midPosY,borderX,borderY,true,data,easeAdjustedAnimationPercent,cntiter);drawLegend(legendMsr,data,config,ctx,ctx.tpchart,cntiter)}function animLoop(){cntiter+=multAnim;percentAnimComplete+=multAnim*animFrameAmount;if(cntiter==config.animationSteps||config.animation==false||ctx.firstPass%10!=1)percentAnimComplete=1;else if(percentAnimComplete>=1)percentAnimComplete=.999;animateFrame();if(multAnim==-1&&cntiter<=beginAnim){if(typeof config.onAnimationComplete=="function"&&ctx.runanimationcompletefunction==true)config.onAnimationComplete(ctx,config,data,0,animationCount+1,statData);multAnim=1;if(config.animationForceSetTimeOut)requestAnimFrameSetTimeOut(animLoop);else requestAnimFrame(animLoop)}else if(percentAnimComplete<config.animationStopValue){if(config.animationForceSetTimeOut)requestAnimFrameSetTimeOut(animLoop);else requestAnimFrame(animLoop)}else{if((animationCount<config.animationCount||config.animationCount==0)&&ctx.firstPass%10==1){animationCount++;if(config.animationBackward&&multAnim==1){percentAnimComplete-=animFrameAmount;multAnim=-1}else{multAnim=1;cntiter=beginAnim-1;percentAnimComplete=beginAnimPct-animFrameAmount}window.setTimeout(animLoop,config.animationPauseTime*1e3)}else{if(!testRedraw(ctx,data,config)){if(typeof config.onAnimationComplete=="function"&&ctx.runanimationcompletefunction==true){config.onAnimationComplete(ctx,config,data,1,animationCount+1,statData);ctx.runanimationcompletefunction=false}}ctx.firstPass=9}}}}var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}();var requestAnimFrameSetTimeOut=function(){return function(callback){window.setTimeout(callback,1e3/60)}}();function calculateScale(axis,config,maxSteps,minSteps,maxValue,minValue,labelTemplateString){var graphMin,graphMax,graphRange,stepValue,numberOfSteps,valueRange,rangeOrderOfMagnitude,decimalNum;var logarithmic,yAxisMinimumInterval;if(axis==2){logarithmic=config.logarithmic2;yAxisMinimumInterval=config.yAxisMinimumInterval2}else{logarithmic=config.logarithmic;yAxisMinimumInterval=config.yAxisMinimumInterval}if(!logarithmic){valueRange=maxValue-minValue;rangeOrderOfMagnitude=calculateOrderOfMagnitude(valueRange);if(Math.abs(minValue)>config.zeroValue)graphMin=Math.floor(minValue/(1*Math.pow(10,rangeOrderOfMagnitude)))*Math.pow(10,rangeOrderOfMagnitude);else graphMin=0;if(Math.abs(maxValue)>config.zeroValue)graphMax=Math.ceil(maxValue/(1*Math.pow(10,rangeOrderOfMagnitude)))*Math.pow(10,rangeOrderOfMagnitude);else graphMax=0;if(typeof yAxisMinimumInterval=="number"){if(graphMax>=0){graphMin=graphMin-graphMin%yAxisMinimumInterval;while(graphMin>minValue)graphMin=graphMin-yAxisMinimumInterval;if(graphMax%yAxisMinimumInterval>config.zeroValue&&graphMax%yAxisMinimumInterval<yAxisMinimumInterval-config.zeroValue){graphMax=roundScale(config,(1+Math.floor(graphMax/yAxisMinimumInterval))*yAxisMinimumInterval)}while(graphMax<maxValue)graphMax=graphMax+yAxisMinimumInterval}}}else{if(minValue==maxValue)maxValue=maxValue+1;if(minValue==0)minValue=.01;var minMag=calculateOrderOfMagnitude(minValue);var maxMag=calculateOrderOfMagnitude(maxValue)+1;graphMin=Math.pow(10,minMag);graphMax=Math.pow(10,maxMag);rangeOrderOfMagnitude=maxMag-minMag}graphRange=graphMax-graphMin;stepValue=Math.pow(10,rangeOrderOfMagnitude);numberOfSteps=Math.round(graphRange/stepValue);if(!logarithmic){var stopLoop=false;while(!stopLoop&&(numberOfSteps<minSteps||numberOfSteps>maxSteps)){if(numberOfSteps<minSteps){if(typeof yAxisMinimumInterval=="number"){if(stepValue/2<yAxisMinimumInterval){stopLoop=true;stepValue=yAxisMinimumInterval;numberOfSteps=Math.ceil(graphRange/stepValue)}}if(!stopLoop){stepValue/=2;numberOfSteps=Math.round(graphRange/stepValue)}}else{stepValue*=2;numberOfSteps=Math.round(graphRange/stepValue)}}if(typeof yAxisMinimumInterval=="number"){if(stepValue<yAxisMinimumInterval){stepValue=yAxisMinimumInterval;numberOfSteps=Math.ceil(graphRange/stepValue)}if(stepValue%yAxisMinimumInterval>config.zeroValue&&stepValue%yAxisMinimumInterval<yAxisMinimumInterval-config.zeroValue){if(2*stepValue%yAxisMinimumInterval<config.zeroValue||2*stepValue%yAxisMinimumInterval>yAxisMinimumInterval-config.zeroValue){stepValue=2*stepValue;numberOfSteps=Math.ceil(graphRange/stepValue)}else{stepValue=roundScale(config,(1+Math.floor(stepValue/yAxisMinimumInterval))*yAxisMinimumInterval);numberOfSteps=Math.ceil(graphRange/stepValue)}}}if(config.graphMaximized==true||config.graphMaximized=="bottom"||typeof config.graphMin!=="undefined"){while(graphMin+stepValue<minValue&&numberOfSteps>=3){graphMin+=stepValue;numberOfSteps--}}if(config.graphMaximized==true||config.graphMaximized=="top"||typeof config.graphMax!=="undefined"){while(graphMin+(numberOfSteps-1)*stepValue>=maxValue&&numberOfSteps>=3)numberOfSteps--}}else{numberOfSteps=rangeOrderOfMagnitude}var labels=[];populateLabels(1,config,labelTemplateString,labels,numberOfSteps,graphMin,graphMax,stepValue);return{steps:numberOfSteps,stepValue:stepValue,graphMin:graphMin,labels:labels,maxValue:maxValue}}function roundScale(config,value){var scldec=0;var sscl=""+config.yAxisMinimumInterval;if(sscl.indexOf(".")>0){scldec=sscl.substr(sscl.indexOf(".")).length}return Math.round(value*Math.pow(10,scldec))/Math.pow(10,scldec)}function calculateOrderOfMagnitude(val){if(val==0)return 0;return Math.floor(Math.log(val)/Math.LN10)}function populateLabels(axis,config,labelTemplateString,labels,numberOfSteps,graphMin,graphMax,stepValue){var logarithmic;if(axis==2){logarithmic=config.logarithmic2;fmtYLabel=config.fmtYLabel2}else{logarithmic=config.logarithmic;fmtYLabel=config.fmtYLabel}if(labelTemplateString){var i;if(!logarithmic){for(i=0;i<numberOfSteps+1;i++){labels.push(tmpl(labelTemplateString,{value:fmtChartJS(config,1*(graphMin+stepValue*i).toFixed(getDecimalPlaces(stepValue)),fmtYLabel)},config))}}else{var value=graphMin;for(i=0;i<numberOfSteps+1;i++){labels.push(tmpl(labelTemplateString,{value:fmtChartJS(config,1*value.toFixed(getDecimalPlaces(value)),fmtYLabel)},config));value*=10}}}}function Max(array){return Math.max.apply(Math,array)}function Min(array){return Math.min.apply(Math,array)}function Default(userDeclared,valueIfFalse){if(!userDeclared){return valueIfFalse}else{return userDeclared}}function CapValue(valueToCap,maxValue,minValue){if(isNumber(maxValue)){if(valueToCap>maxValue){return maxValue}}if(isNumber(minValue)){if(valueToCap<minValue){return minValue}}return valueToCap}function getDecimalPlaces(num){var match=(""+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!match){return 0}return Math.max(0,(match[1]?match[1].length:0)-(match[2]?+match[2]:0))}function mergeChartConfig(defaults,userDefined){var returnObj={};for(var attrname in defaults){returnObj[attrname]=defaults[attrname]}for(var attrnameBis in userDefined){returnObj[attrnameBis]=userDefined[attrnameBis]}return returnObj}var cache={};function tmpl(str,data,config){newstr=str;if(newstr.substr(0,config.templatesOpenTag.length)==config.templatesOpenTag)newstr="<%="+newstr.substr(config.templatesOpenTag.length,newstr.length-config.templatesOpenTag.length);if(newstr.substr(newstr.length-config.templatesCloseTag.length,config.templatesCloseTag.length)==config.templatesCloseTag)newstr=newstr.substr(0,newstr.length-config.templatesCloseTag.length)+"%>";return tmplpart2(newstr,data)}function tmplpart2(str,data){var fn=!/\W/.test(str)?cache[str]=cache[str]||tmplpart2(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn}function dispCrossText(ctx,config,posX,posY,borderX,borderY,overlay,data,animPC,cntiter){var i,disptxt,txtposx,txtposy,textAlign,textBaseline;for(i=0;i<config.crossText.length;i++){if(config.crossText[i]!=""&&config.crossTextOverlay[Min([i,config.crossTextOverlay.length-1])]==overlay&&(cntiter==1&&config.crossTextIter[Min([i,config.crossTextIter.length-1])]=="first"||config.crossTextIter[Min([i,config.crossTextIter.length-1])]==cntiter||config.crossTextIter[Min([i,config.crossTextIter.length-1])]=="all"||animPC==1&&config.crossTextIter[Min([i,config.crossTextIter.length-1])]=="last")){ctx.save();ctx.beginPath();ctx.font=config.crossTextFontStyle[Min([i,config.crossTextFontStyle.length-1])]+" "+Math.ceil(ctx.chartTextScale*config.crossTextFontSize[Min([i,config.crossTextFontSize.length-1])]).toString()+"px "+config.crossTextFontFamily[Min([i,config.crossTextFontFamily.length-1])];ctx.fillStyle=config.crossTextFontColor[Min([i,config.crossTextFontColor.length-1])];textAlign=config.crossTextAlign[Min([i,config.crossTextAlign.length-1])];textBaseline=config.crossTextBaseline[Min([i,config.crossTextBaseline.length-1])];txtposx=1*Math.ceil(ctx.chartSpaceScale*config.crossTextPosX[Min([i,config.crossTextPosX.length-1])]);txtposy=1*Math.ceil(ctx.chartSpaceScale*config.crossTextPosY[Min([i,config.crossTextPosY.length-1])]);switch(1*config.crossTextRelativePosX[Min([i,config.crossTextRelativePosX.length-1])]){case 0:if(textAlign=="default")textAlign="left";break;case 1:txtposx+=borderX;if(textAlign=="default")textAlign="right";break;case 2:txtposx+=posX;if(textAlign=="default")textAlign="center";break;case-2:txtposx+=context.canvas.width/2;if(textAlign=="default")textAlign="center";break;case 3:txtposx+=txtposx+2*posX-borderX;if(textAlign=="default")textAlign="left";break;case 4:txtposx+=context.canvas.width;if(textAlign=="default")textAlign="right";break;default:txtposx+=posX;if(textAlign=="default")textAlign="center";break}switch(1*config.crossTextRelativePosY[Min([i,config.crossTextRelativePosY.length-1])]){case 0:if(textBaseline=="default")textBaseline="top";break;case 3:txtposy+=borderY;if(textBaseline=="default")textBaseline="top";break;case 2:txtposy+=posY;if(textBaseline=="default")textBaseline="middle";break;case-2:txtposy+=context.canvas.height/2;if(textBaseline=="default")textBaseline="middle";break;case 1:txtposy+=txtposy+2*posY-borderY;if(textBaseline=="default")textBaseline="bottom";break;case 4:txtposy+=context.canvas.height;if(textBaseline=="default")textBaseline="bottom";break;default:txtposy+=posY;if(textBaseline=="default")textBaseline="middle";break}ctx.textAlign=textAlign;ctx.textBaseline=textBaseline;ctx.translate(1*txtposx,1*txtposy);var rotateVal=Math.PI*config.crossTextAngle[Min([i,config.crossTextAngle.length-1])]/180;ctx.rotate(rotateVal);if(config.crossText[i].substring(0,1)=="%"){if(typeof config.crossTextFunction=="function")disptxt=config.crossTextFunction(i,config.crossText[i],ctx,config,posX,posY,borderX,borderY,overlay,data,animPC)}else disptxt=config.crossText[i];setTextBordersAndBackground(ctx,disptxt,Math.ceil(ctx.chartTextScale*config.crossTextFontSize[Min([i,config.crossTextFontSize.length-1])]),0,0,config.crossTextBorders[Min([i,config.crossTextBorders.length-1])],config.crossTextBordersSelection[Min([i,config.crossTextBorders.length-1])],config.crossTextBordersColor[Min([i,config.crossTextBordersColor.length-1])],Math.ceil(ctx.chartLineScale*config.crossTextBordersWidth[Min([i,config.crossTextBordersWidth.length-1])]),Math.ceil(ctx.chartSpaceScale*config.crossTextBordersXSpace[Min([i,config.crossTextBordersXSpace.length-1])]),Math.ceil(ctx.chartSpaceScale*config.crossTextBordersYSpace[Min([i,config.crossTextBordersYSpace.length-1])]),config.crossTextBordersStyle[Min([i,config.crossTextBordersStyle.length-1])],config.crossTextBackgroundColor[Min([i,config.crossTextBackgroundColor.length-1])],"CROSSTEXT",config.crossTextBordersRadius);if(animPC==1&&config.crossTextIter[Min([i,config.crossTextIter.length-1])]=="all"||config.crossTextIter[Min([i,config.crossTextIter.length-1])]!="last"){ctx.fillTextMultiLine(disptxt,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.crossTextFontSize[Min([i,config.crossTextFontSize.length-1])]),true,config.detectMouseOnText,ctx,"CROSSTEXT_TEXTMOUSE",rotateVal,1*txtposx,1*txtposy,i,-1)}else ctx.fillTextMultiLine(disptxt,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.crossTextFontSize[Min([i,config.crossTextFontSize.length-1])]),true,false,ctx,"CROSSTEXT_TEXTMOUSE",rotateVal,1*txtposx,1*txtposy,i,-1);ctx.restore()}}}function dispCrossImage(ctx,config,posX,posY,borderX,borderY,overlay,data,animPC,cntiter){var i,disptxt,imageposx,imageposy,imageAlign,imageBaseline;for(i=0;i<config.crossImage.length;i++){if(typeof config.crossImage[i]!="undefined"&&config.crossImageOverlay[Min([i,config.crossImageOverlay.length-1])]==overlay&&(cntiter==-1&&config.crossImageIter[Min([i,config.crossImageIter.length-1])]=="background"||cntiter==1&&config.crossImageIter[Min([i,config.crossImageIter.length-1])]=="first"||config.crossImageIter[Min([i,config.crossImageIter.length-1])]==cntiter||cntiter!=-1&&config.crossImageIter[Min([i,config.crossImageIter.length-1])]=="all"||animPC==1&&config.crossImageIter[Min([i,config.crossImageIter.length-1])]=="last")){ctx.save();ctx.beginPath();imageAlign=config.crossImageAlign[Min([i,config.crossImageAlign.length-1])];imageBaseline=config.crossImageBaseline[Min([i,config.crossImageBaseline.length-1])];imageposx=1*Math.ceil(ctx.chartSpaceScale*config.crossImagePosX[Min([i,config.crossImagePosX.length-1])]);imageposy=1*Math.ceil(ctx.chartSpaceScale*config.crossImagePosY[Min([i,config.crossImagePosY.length-1])]);switch(1*config.crossImageRelativePosX[Min([i,config.crossImageRelativePosX.length-1])]){case 0:if(imageAlign=="default")imageAlign="left";break;case 1:imageposx+=borderX;if(imageAlign=="default")imageAlign="right";break;case 2:imageposx+=posX;if(imageAlign=="default")imageAlign="center";break;case-2:imageposx+=context.canvas.width/2;if(imageAlign=="default")imageAlign="center";break;case 3:imageposx+=imageposx+2*posX-borderX;if(imageAlign=="default")imageAlign="left";break;case 4:imageposx+=context.canvas.width;if(imageAlign=="default")imageAlign="right";break;default:imageposx+=posX;if(imageAlign=="default")imageAlign="center";break}switch(1*config.crossImageRelativePosY[Min([i,config.crossImageRelativePosY.length-1])]){case 0:if(imageBaseline=="default")imageBaseline="top";break;case 3:imageposy+=borderY;if(imageBaseline=="default")imageBaseline="top";break;case 2:imageposy+=posY;if(imageBaseline=="default")imageBaseline="middle";break;case-2:imageposy+=context.canvas.height/2;if(imageBaseline=="default")imageBaseline="middle";break;case 1:imageposy+=imageposy+2*posY-borderY;if(imageBaseline=="default")imageBaseline="bottom";break;case 4:imageposy+=context.canvas.height;if(imageBaseline=="default")imageBaseline="bottom";break;default:imageposy+=posY;if(imageBaseline=="default")imageBaseline="middle";break}var imageWidth=config.crossImage[i].width;switch(imageAlign){case"left":break;case"right":imageposx-=imageWidth;break;case"center":imageposx-=imageWidth/2;break;default:break}var imageHeight=config.crossImage[i].height;switch(imageBaseline){case"top":break;case"bottom":imageposy-=imageHeight;break;case"middle":imageposy-=imageHeight/2;break;default:break}ctx.translate(1*imageposx,1*imageposy);ctx.rotate(Math.PI*config.crossImageAngle[Min([i,config.crossImageAngle.length-1])]/180);ctx.drawImage(config.crossImage[i],0,0);ctx.restore()}}}function setMeasures(data,config,ctx,canvasheight,canvaswidth,ylabels,ylabels2,reverseLegend,reverseAxis,drawAxis,legendBox,typegraph){var height=canvasheight;var width=canvaswidth;if(window.devicePixelRatio>1){height=height/window.devicePixelRatio;width=width/window.devicePixelRatio}if(config.canvasBackgroundColor!="none")ctx.canvas.style.background=config.canvasBackgroundColor;var i,j,k;var borderHeight=0;var borderTHeight=0;var borderBHeight=0;var borderRHeight=0;var borderLHeight=0;var graphTitleHeight=0;var graphTitlePosY=0;var graphSubTitleHeight=0;var graphSubTitlePosY=0;var footNoteHeight=0;var footNotePosY=0;ctx.widthAtSetMeasures=width;ctx.heightAtSetMeasures=height;var currentPosition,topNotUsableHeight,bottomNotUsableHeight,leftNotUsableWidth,rightNotUsableWidth,availableWidth,availableHeight;availableWidth=width;availableHeight=height;if(config.canvasBorders&&config.canvasBordersSelection>0){borderHeight=Math.ceil(ctx.chartLineScale*config.canvasBordersWidth);if(isBorder(config.canvasBordersSelection,"TOP"))borderTHeight=borderHeight;if(isBorder(config.canvasBordersSelection,"BOTTOM"))borderBHeight=borderHeight;if(isBorder(config.canvasBordersSelection,"RIGHT"))borderRHeight=borderHeight;if(isBorder(config.canvasBordersSelection,"LEFT"))borderLHeight=borderHeight}currentPosition=0+borderTHeight+Math.ceil(ctx.chartSpaceScale*config.spaceTop);if(config.graphTitle.trim()!=""){graphTitleHeight=Math.ceil(ctx.chartTextScale*config.graphTitleFontSize)*(config.graphTitle.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.graphTitleSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.graphTitleSpaceAfter);graphTitlePosY=currentPosition+Math.ceil(ctx.chartSpaceScale*config.graphTitleSpaceBefore);if(config.graphTitleBackgroundColor!="none"||config.graphTitleBorders){graphTitleHeight+=(isBorder(config.graphTitleBordersSelection,"TOP")+isBorder(config.graphTitleBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartSpaceScale*config.graphTitleBordersYSpace);graphTitlePosY+=isBorder(config.graphTitleBordersSelection,"TOP")*Math.ceil(ctx.chartSpaceScale*config.graphTitleBordersYSpace)}if(config.graphTitleBorders){graphTitleHeight+=(isBorder(config.graphTitleBordersSelection,"TOP")+isBorder(config.graphTitleBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.graphTitleBordersWidth);graphTitlePosY+=isBorder(config.graphTitleBordersSelection,"TOP")*Math.ceil(ctx.chartLineScale*config.graphTitleBordersWidth)}currentPosition+=graphTitleHeight}if(config.graphSubTitle.trim()!=""){graphSubTitleHeight=Math.ceil(ctx.chartTextScale*config.graphSubTitleFontSize)*(config.graphSubTitle.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.graphSubTitleSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.graphSubTitleSpaceAfter);graphSubTitlePosY=currentPosition+Math.ceil(ctx.chartSpaceScale*config.graphSubTitleSpaceBefore);if(config.graphSubTitleBackgroundColor!="none"||config.graphSubTitleBorders){graphSubTitleHeight+=2*Math.ceil(ctx.chartSpaceScale*config.graphSubTitleBordersYSpace);graphSubTitlePosY+=Math.ceil(ctx.chartSpaceScale*config.graphSubTitleBordersYSpace)}if(config.graphSubTitleBorders){graphSubTitleHeight+=(isBorder(config.graphTitleBordersSelection,"TOP")+isBorder(config.graphTitleBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.graphSubTitleBordersWidth);graphSubTitlePosY+=isBorder(config.graphTitleBordersSelection,"TOP")*Math.ceil(ctx.chartLineScale*config.graphSubTitleBordersWidth)}currentPosition+=graphSubTitleHeight}topNotUsableHeight=currentPosition;availableHeight-=topNotUsableHeight;currentPosition=height-borderBHeight-Math.ceil(ctx.chartSpaceScale*config.spaceBottom);if(typeof config.footNote!="undefined"){if(config.footNote.trim()!=""){footNoteHeight=Math.ceil(ctx.chartTextScale*config.footNoteFontSize)*(config.footNote.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.footNoteSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.footNoteSpaceAfter);footNotePosY=currentPosition-Math.ceil(ctx.chartSpaceScale*config.footNoteSpaceAfter);if(config.footNoteBackgroundColor!="none"||config.footNoteBorders){footNoteHeight+=2*Math.ceil(ctx.chartSpaceScale*config.footNoteBordersYSpace);footNotePosY-=Math.ceil(ctx.chartSpaceScale*config.footNoteBordersYSpace)}if(config.footNoteBorders){footNoteHeight+=(isBorder(config.footNoteBordersSelection,"TOP")+isBorder(config.footNoteBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.footNoteBordersWidth);footNotePosY-=isBorder(config.footNoteBordersSelection,"BOTTOM")*Math.ceil(ctx.chartLineScale*config.footNoteBordersWidth)}currentPosition-=footNoteHeight}}bottomNotUsableHeight=height-currentPosition;availableHeight-=bottomNotUsableHeight;currentPosition=0+borderLHeight+Math.ceil(ctx.chartSpaceScale*config.spaceLeft);leftNotUsableWidth=currentPosition;availableWidth-=leftNotUsableWidth;currentPosition=width-borderRHeight-Math.ceil(ctx.chartSpaceScale*config.spaceRight);rightNotUsableWidth=width-currentPosition;availableWidth-=rightNotUsableWidth;topNotUsableHeight+=Math.ceil(ctx.chartSpaceScale*config.graphSpaceBefore);bottomNotUsableHeight+=Math.ceil(ctx.chartSpaceScale*config.graphSpaceAfter);availableHeight-=Math.ceil(ctx.chartSpaceScale*config.graphSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.graphSpaceAfter);var nbeltLegend=0;var widestLegend=-99999999;var highestLegend=0;if(typeof config.legend!="undefined"){if(config.legend==true){ctx.font=config.legendFontStyle+" "+Math.ceil(ctx.chartTextScale*config.legendFontSize).toString()+"px "+config.legendFontFamily;var textLength;for(i=0;i<data.datasets.length;i++){if(typeof data.datasets[i].title=="string"){if(data.datasets[i].title.trim()!=""){nbeltLegend++;textLength=ctx.measureTextMultiLine(fmtChartJS(config,data.datasets[i].title,config.fmtLegend),Math.ceil(ctx.chartTextScale*config.legendFontSize));widestLegend=Math.max(textLength.textWidth,widestLegend);highestLegend=Math.max(Math.ceil(ctx.chartTextScale*config.legendFontSize),highestLegend)}}}widestLegend+=Math.ceil(ctx.chartTextScale*config.legendBlockSize)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenBoxAndText);if(nbeltLegend==0||nbeltLegend==1&&!config.showSingleLegend)widestLegend=0}}var legendBorderHeight=0;var legendBorderWidth=0;var spaceLegendHeight=0;var xLegendPos=0;var yLegendPos=0;var nbLegendLines=0;var nbLegendCols=0;var legendHeight=0;var legendWidth=0;var msrLegend;if(widestLegend>-99999998){if(config.legendPosY==0||config.legendPosY==4){var availableLegendWidth,maxLegendOnLine;if(config.legendPosX==1||config.legendPosX==2||config.legendPosX==3){availableLegendWidth=availableWidth-Math.ceil(ctx.chartSpaceScale*Math.ceil(ctx.chartSpaceScale*config.legendSpaceLeftText))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceRightText)}else{availableLegendWidth=width-borderRHeight-borderLHeight-Math.ceil(ctx.chartSpaceScale*config.spaceLeft)-Math.ceil(ctx.chartSpaceScale*config.spaceRight)-Math.ceil(ctx.chartSpaceScale*Math.ceil(ctx.chartSpaceScale*config.legendSpaceLeftText))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceRightText)}if(config.legendBorders==true||config.legendFillColor!="rgba(0,0,0,0)")availableLegendWidth-=config.legendBorders*(isBorder(config.legendBordersSelection,"RIGHT")+isBorder(config.legendBordersSelection,"LEFT"))*Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceRight);maxLegendOnLine=Min([Math.floor((availableLegendWidth+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal))/(widestLegend+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal))),config.maxLegendCols]);nbLegendLines=Math.ceil(nbeltLegend/maxLegendOnLine);nbLegendCols=Math.ceil(nbeltLegend/nbLegendLines);msrLegend=measureLegend(data,ctx,config,widestLegend,highestLegend,nbLegendLines,nbLegendCols,availableLegendWidth);legendHeight=msrLegend.legendHeight;if(config.legendPosY==0){yLegendPos=topNotUsableHeight-Math.ceil(ctx.chartSpaceScale*config.graphSpaceBefore);topNotUsableHeight+=legendHeight}else{yLegendPos=height-bottomNotUsableHeight-legendHeight;bottomNotUsableHeight+=legendHeight}availableHeight-=legendHeight}else if(config.legendPosX==0||config.legendPosX==4){var availableLegendHeight,maxLegendOnCols;availableLegendHeight=availableHeight-Math.ceil(ctx.chartSpaceScale*Math.ceil(ctx.chartSpaceScale*config.legendSpaceBeforeText))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceAfterText);availableLegendWidth=availableWidth-Math.ceil(ctx.chartSpaceScale*Math.ceil(ctx.chartSpaceScale*config.legendSpaceLeftText))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceRightText);if(config.legendBorders==true||config.legendFillColor!="rgba(0,0,0,0)")availableLegendHeight-=config.legendBorders*(isBorder(config.legendBordersSelection,"BOTTOM")+isBorder(config.legendBordersSelection,"TOP"))*Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceAfter);maxLegendOnCols=Min([Math.floor((availableLegendHeight+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextVertical))/(highestLegend+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextVertical))),config.maxLegendLines]);nbLegendCols=Math.ceil(nbeltLegend/maxLegendOnCols);nbLegendLines=Math.ceil(nbeltLegend/nbLegendCols);msrLegend=measureLegend(data,ctx,config,widestLegend,highestLegend,nbLegendLines,nbLegendCols,availableLegendWidth);legendWidth=msrLegend.legendWidth;if(config.legendPosX==0){xLegendPos=leftNotUsableWidth;leftNotUsableWidth+=legendWidth}else{xLegendPos=width-rightNotUsableWidth-legendWidth;rightNotUsableWidth+=legendWidth}availableWidth-=legendWidth}}var yAxisUnitPosY=0;var yAxisUnitHeight=0;var yAxisUnitWidth=0;if(drawAxis&&config.yAxisUnit.trim()!=""){yAxisUnitHeight=Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize)*(config.yAxisUnit.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.yAxisUnitSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.yAxisUnitSpaceAfter);ctx.font=config.yAxisUnitFontStyle+" "+Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize).toString()+"px "+config.yAxisUnitFontFamily;var yAxisUnitSize=ctx.measureTextMultiLine(config.yAxisUnit,Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize));yAxisUnitWidth=yAxisUnitSize.textWidth;yAxisUnitPosY=topNotUsableHeight+Math.ceil(ctx.chartSpaceScale*config.yAxisUnitSpaceBefore)+yAxisUnitSize.textHeight;if(config.yAxisUnitBackgroundColor!="none"||config.yAxisUnitBorders){yAxisUnitHeight+=2*Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersYSpace);yAxisUnitPosY+=Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersYSpace)}if(config.yAxisUnitBorders){yAxisUnitHeight+=(isBorder(config.yAxisUnitBordersSelection,"TOP")+isBorder(config.yAxisUnitBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.yAxisUnitBordersWidth);yAxisUnitPosY+=isBorder(config.yAxisUnitBordersSelection,"TOP")*Math.ceil(ctx.chartLineScale*config.yAxisUnitBordersWidth)}topNotUsableHeight+=yAxisUnitHeight;availableHeight-=yAxisUnitHeight}var widestXLabel=0;var highestXLabel=1;var widestTXLabel=0;var highestTXLabel=1;var xAxisLabelHeight=0;var xTAxisLabelHeight=0;var xAxisLabelPos=0;var xTAxisLabelPos=0;var widestYLabel=0;var highestYLabel=1;var widestYLabel2=0;var highestYLabel2=1;var yAxisLabelWidth=0;var yAxisLabelPosLeft=0;var yAxisLabelPosRight=0;if(drawAxis){var textMsr;ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;widestXLabel=Math.max(1,Math.ceil(ctx.chartTextScale*config.xScaleLabelsMinimumWidth));widestTXLabel=widestXLabel;for(i=0;i<data.labels.length;i++){if(showLabels(ctx,data,config,i)===true){textMsr=ctx.measureTextMultiLine(fmtChartJS(config,data.labels[i],config.fmtXLabel),Math.ceil(ctx.chartTextScale*config.scaleFontSize));widestXLabel=Math.max(textMsr.textWidth,widestXLabel);highestXLabel=Math.max(textMsr.textHeight,highestXLabel)}}if(typeof data.Labels2=="object"&&config.xAxisBottom&&config.xAxisTop){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;for(i=0;i<data.Labels2.length;i++){if(showLabels(ctx,data,config,i)===true){textMsr=ctx.measureTextMultiLine(fmtChartJS(config,data.Labels2[i],config.fmtTopXLabel),Math.ceil(ctx.chartTextScale*config.scaleFontSize));widestTXLabel=Math.max(textMsr.textWidth,widestTXLabel);highestTXLabel=Math.max(textMsr.textHeight,highestTXLabel)}}}else{widestTXLabel=widestXLabel;highestTXLabel=highestXLabel}if(typeof config.xAxisLabel!="undefined"&&config.xAxisBottom){if(config.xAxisLabel.trim()!=""){xAxisLabelHeight=Math.ceil(ctx.chartTextScale*config.xAxisFontSize)*(config.xAxisLabel.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.xAxisLabelSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.xAxisLabelSpaceAfter);xAxisLabelPos=height-bottomNotUsableHeight-Math.ceil(ctx.chartSpaceScale*config.xAxisLabelSpaceAfter);if(config.xAxisLabelBackgroundColor!="none"||config.footNoteBorders){xAxisLabelHeight+=2*Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersYSpace);xAxisLabelPos-=Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersYSpace)}if(config.xAxisLabelBorders){xAxisLabelHeight+=(isBorder(config.xAxisLabelBordersSelection,"TOP")+isBorder(config.xAxisLabelBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.xAxisLabelBordersWidth);xAxisLabelPos-=isBorder(config.xAxisLabelBordersSelection,"BOTTOM")*Math.ceil(ctx.chartLineScale*config.xAxisLabelBordersWidth)}}}var tLabelT;tLabelT=config.xAxisLabel;if(typeof config.xTAxisLabel!="undefined"&&config.xAxisTop){if(config.xTAxisLabel.trim()!="")tLabelT=config.xTAxisLabel}if(typeof tLabelT!="undefined"&&config.xAxisTop){if(tLabelT.trim()!=""){xTAxisLabelHeight=Math.ceil(ctx.chartTextScale*config.xAxisFontSize)*(tLabelT.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.xAxisLabelSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.xAxisLabelSpaceAfter);xTAxisLabelPos=topNotUsableHeight+Math.ceil(ctx.chartSpaceScale*config.xAxisLabelSpaceBefore);if(config.xAxisLabelBackgroundColor!="none"){xTAxisLabelHeight+=2*Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersYSpace);xTAxisLabelPos+=Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersYSpace)}if(config.xAxisLabelBorders){xTAxisLabelHeight+=(isBorder(config.xAxisLabelBordersSelection,"TOP")+isBorder(config.xAxisLabelBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.xAxisLabelBordersWidth);xTAxisLabelPos+=isBorder(config.xAxisLabelBordersSelection,"TOP")*Math.ceil(ctx.chartLineScale*config.xAxisLabelBordersWidth)}}}widestYLabel=Math.max(1,Math.ceil(ctx.chartTextScale*config.yScaleLabelsMinimumWidth));widestYLabel2=widestYLabel;if(ylabels!=null&&ylabels!="nihil"){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;for(i=ylabels.length-1;i>=0;i--){if(typeof ylabels[i]=="string"){if(showYLabels(ctx,data,config,i,ylabels[i])){if(ylabels[i].trim()!=""){textMsr=ctx.measureTextMultiLine(fmtChartJS(config,ylabels[i],config.fmtYLabel),Math.ceil(ctx.chartTextScale*config.scaleFontSize));widestYLabel=Math.max(widestYLabel,textMsr.textWidth);highestYLabel=Math.max(highestYLabel,textMsr.textHeight)}}}}}if(ylabels2!=null&&config.yAxisRight){ctx.font=config.scaleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.scaleFontSize).toString()+"px "+config.scaleFontFamily;for(i=ylabels2.length-1;i>=0;i--){if(typeof ylabels2[i]=="string"){if(showYLabels(ctx,data,config,i,ylabels2[i])){textMsr=ctx.measureTextMultiLine(fmtChartJS(config,ylabels2[i],config.fmtYLabel2),Math.ceil(ctx.chartTextScale*config.scaleFontSize));widestYLabel2=Math.max(textMsr.textWidth,widestYLabel2);highestYLabel2=Math.max(textMsr.textHeight,highestYLabel2)}}}}else{widestYLabel2=widestYLabel;highestYLabel2=highestYLabel}if(typeof config.yAxisLabel!="undefined"&&(config.yAxisRight||config.yAxisLeft)){if(config.yAxisLabel.trim()!=""){yAxisLabelWidth=Math.ceil(ctx.chartTextScale*config.yAxisFontSize)*(config.yAxisLabel.split("\n").length||1)+Math.ceil(ctx.chartSpaceScale*config.yAxisLabelSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisLabelSpaceRight);yAxisLabelPosLeft=leftNotUsableWidth+Math.ceil(ctx.chartSpaceScale*config.yAxisLabelSpaceLeft)+Math.ceil(ctx.chartTextScale*config.yAxisFontSize);yAxisLabelPosRight=width-rightNotUsableWidth-Math.ceil(ctx.chartSpaceScale*config.yAxisLabelSpaceLeft)-Math.ceil(ctx.chartTextScale*config.yAxisFontSize);if(config.yAxisLabelBackgroundColor!="none"||config.yAxisLabelBorders){yAxisLabelWidth+=2*Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersYSpace);yAxisLabelPosLeft+=Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersYSpace);yAxisLabelPosRight-=Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersYSpace)}if(config.yAxisLabelBorders){yAxisLabelWidth+=(isBorder(config.yAxisLabelBordersSelection,"TOP")+isBorder(config.yAxisLabelBordersSelection,"BOTTOM"))*Math.ceil(ctx.chartLineScale*config.yAxisLabelBordersWidth);yAxisLabelPosLeft+=isBorder(config.yAxisLabelBordersSelection,"TOP")*Math.ceil(ctx.chartLineScale*config.yAxisLabelBordersWidth);yAxisLabelPosRight-=isBorder(config.yAxisLabelBordersSelection,"TOP")*Math.ceil(ctx.chartLineScale*config.yAxisLabelBordersWidth)}}}}var rotateLabels=0;var rotateTLabels=0;var xLabelWidth=0;var xTLabelWidth=0;var xLabelHeight=0;var xTLabelHeight=0;var xLabelPos=0;var xTLabelPos=0;var widestLabel,highestLabel,nblab,labelAvailableWidth;if(drawAxis&&config.xAxisBottom){labelAvailableWidth=availableWidth;if(reverseAxis==false){widestLabel=widestXLabel;highestLabel=highestXLabel;nblab=data.labels.length;if(config.yAxisLeft==true)labelAvailableWidth-=widestYLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight);if(config.yAxisRight==true)labelAvailableWidth-=widestYLabel2+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)}else{widestLabel=widestYLabel;highestLabel=highestYLabel;nblab=ylabels.length;if(config.yAxisLeft==true)labelAvailableWidth-=widestXLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight);if(config.yAxisRight==true)labelAvailableWidth-=widestTXLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)}if(typeof config.yAxisLabel!="undefined"){if(config.yAxisLabel.trim()!=""){if(config.yAxisRight)labelAvailableWidth-=yAxisLabelWidth;if(config.yAxisLeft)labelAvailableWidth-=yAxisLabelWidth}}if(config.rotateLabels=="smart"){rotateLabels=0;if((labelAvailableWidth+Math.ceil(ctx.chartTextScale*config.xAxisSpaceBetweenLabels))/nblab<widestLabel+Math.ceil(ctx.chartTextScale*config.xAxisSpaceBetweenLabels)){rotateLabels=45;if(labelAvailableWidth/nblab<Math.abs(Math.cos(rotateLabels*Math.PI/180)*widestLabel)){rotateLabels=90}}}else{rotateLabels=config.rotateLabels;if(rotateLabels<0)rotateLabels=0;if(rotateLabels>180)rotateLabels=180}if(rotateLabels>90)rotateLabels+=180;xLabelHeight=Math.abs(Math.sin(rotateLabels*Math.PI/180)*widestLabel)+Math.abs(Math.sin((rotateLabels+90)*Math.PI/180)*highestLabel);xLabelWidth=Math.abs(Math.cos(rotateLabels*Math.PI/180)*widestLabel)+Math.abs(Math.cos((rotateLabels+90)*Math.PI/180)*highestLabel);xLabelPos=height-bottomNotUsableHeight-xAxisLabelHeight-xLabelHeight-Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceAfter)}if(drawAxis&&config.xAxisTop){labelAvailableWidth=availableWidth;if(reverseAxis==false){widestLabel=widestTXLabel;highestLabel=highestTXLabel;nblab=data.labels.length;if(config.yAxisLeft==true)labelAvailableWidth-=widestYLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight);if(config.yAxisRight==true)labelAvailableWidth-=widestYLabel2+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)}else{widestLabel=widestYLabel2;highestLabel=highestYLabel2;nblab=ylabels2.length;if(config.yAxisLeft==true)labelAvailableWidth-=widestXLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight);if(config.yAxisRight==true)labelAvailableWidth-=widestTXLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)}if(typeof config.yAxisLabel!="undefined"){if(config.yAxisLabel.trim()!=""){if(config.yAxisRight)labelAvailableWidth-=yAxisLabelWidth;if(config.yAxisLeft)labelAvailableWidth-=yAxisLabelWidth}}if(config.rotateTLabels=="smart"){rotateTLabels=0;if((labelAvailableWidth+Math.ceil(ctx.chartTextScale*config.xAxisSpaceBetweenLabels))/nblab<widestLabel+Math.ceil(ctx.chartTextScale*config.xAxisSpaceBetweenLabels)){rotateTLabels=45;if(labelAvailableWidth/nblab<Math.abs(Math.cos(rotateTLabels*Math.PI/180)*widestLabel)){rotateTLabels=90}}}else{rotateTLabels=config.rotateTLabels;if(rotateTLabels<0)rotateTLabels=0;if(rotateTLabels>180)rotateTLabels=180}if(rotateLabels>90)rotateLabels+=180;xTLabelHeight=Math.abs(Math.sin(rotateTLabels*Math.PI/180)*widestLabel)+Math.abs(Math.sin((rotateTLabels+90)*Math.PI/180)*highestLabel);xTLabelWidth=Math.abs(Math.cos(rotateTLabels*Math.PI/180)*widestLabel)+Math.abs(Math.cos((rotateTLabels+90)*Math.PI/180)*highestLabel);xTLabelPos=topNotUsableHeight+xTAxisLabelHeight+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceBefore)}var prevLeftNotUsableWidth=leftNotUsableWidth;var prevRightNotUsableWidth=rightNotUsableWidth;if(drawAxis&&config.yAxisLeft){if(reverseAxis==false)leftNotUsableWidth+=yAxisLabelWidth+widestYLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight);else leftNotUsableWidth+=yAxisLabelWidth+widestXLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)}if(drawAxis&&config.yAxisRight){if(reverseAxis==false)rightNotUsableWidth+=yAxisLabelWidth+widestYLabel2+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight);else rightNotUsableWidth+=yAxisLabelWidth+widestTXLabel+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceLeft)+Math.ceil(ctx.chartSpaceScale*config.yAxisSpaceRight)}availableWidth=width-leftNotUsableWidth-rightNotUsableWidth;if(drawAxis&&config.xAxisTop){if(reverseAxis==false)topNotUsableHeight+=xTAxisLabelHeight+xTLabelHeight+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceAfter);else{var yTLabelHeight=Math.abs(Math.sin(rotateTLabels*Math.PI/180)*widestYLabel2)+Math.abs(Math.sin((rotateTLabels+90)*Math.PI/180)*highestYLabel2);topNotUsableHeight+=xAxisLabelHeight+yTLabelHeight+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceAfter)}}if(drawAxis&&config.xAxisBottom){if(reverseAxis==false)bottomNotUsableHeight+=xAxisLabelHeight+xLabelHeight+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceAfter);else{var yTLabelHeight=Math.abs(Math.sin(rotateLabels*Math.PI/180)*widestYLabel)+Math.abs(Math.sin((rotateLabels+90)*Math.PI/180)*highestYLabel);bottomNotUsableHeight+=xAxisLabelHeight+yTLabelHeight+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceBefore)+Math.ceil(ctx.chartSpaceScale*config.xAxisSpaceAfter)}}availableHeight=height-topNotUsableHeight-bottomNotUsableHeight;if(widestLegend>-99999998){if(nbLegendLines==0){availableLegendWidth=availableWidth-Math.ceil(ctx.chartSpaceScale*Math.ceil(ctx.chartSpaceScale*config.legendSpaceLeftText))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceRightText);maxLegendOnLine=Min([Math.floor((availableLegendWidth+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal))/(widestLegend+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal))),config.maxLegendCols]);nbLegendLines=Math.ceil(nbeltLegend/maxLegendOnLine);nbLegendCols=Math.ceil(nbeltLegend/nbLegendLines);msrLegend=measureLegend(data,ctx,config,widestLegend,highestLegend,nbLegendLines,nbLegendCols,availableLegendWidth)}legendHeight=msrLegend.legendHeight;legendWidth=msrLegend.legendWidth;switch(config.legendPosY){case 0:break;case 1:yLegendPos=topNotUsableHeight;break;case 2:yLegendPos=topNotUsableHeight+availableHeight/2-legendHeight/2;break;case-2:yLegendPos=height/2-legendHeight/2;break;case 3:yLegendPos=height-bottomNotUsableHeight-legendHeight;break;case 4:break;default:yLegendPos=topNotUsableHeight;break}switch(config.legendPosX){case 0:if(config.legendPosY==0||config.legendPosY==4)xLegendPos=prevLeftNotUsableWidth;break;case 1:xLegendPos=leftNotUsableWidth;break;case 2:xLegendPos=leftNotUsableWidth+availableWidth/2-legendWidth/2;break;case-2:xLegendPos=width/2-legendWidth/2;break;case 3:xLegendPos=width-rightNotUsableWidth-legendWidth;break;case 4:if(config.legendPosY==0||config.legendPosY==4)xLegendPos=width-prevRightNotUsableWidth-legendWidth;break;default:xLegendPos=width-rightNotUsableWidth;break}}if(typegraph=="Line"||typegraph=="HorizontalBar"||typegraph=="HorizontalStackedBar"){if(config.inGraphDataShow){rightNotUsableWidth=Math.max(rightNotUsableWidth,Math.max(widestYLabel,widestYLabel2)+1+borderRHeight);leftNotUsableWidth=Math.max(leftNotUsableWidth,Math.max(widestYLabel,widestYLabel2)+1+borderLHeight)}if(config.xAxisTop||config.xAxisBottom){rightNotUsableWidth=Math.max(rightNotUsableWidth,Math.max(widestXLabel/2,widestTXLabel/2)+1+borderRHeight);leftNotUsableWidth=Math.max(leftNotUsableWidth,Math.max(widestXLabel/2,widestTXLabel/2)+1+borderLHeight)}availableWidth=width-rightNotUsableWidth-leftNotUsableWidth}if(drawAxis&&config.yAxisLeft&&(config.yAxisUnitBorders||config.yAxisUnitBackgroundColor!="none")){if(config.yAxisLeft)leftNotUsableWidth=Math.max(leftNotUsableWidth,borderLHeight+config.spaceLeft+(config.yAxisUnitBorders&&isBorder(config.yAxisUnitBordersSelection,"LEFT"))*config.yAxisUnitBordersWidth+(config.yAxisUnitBackgroundColor!="none"||config.yAxisUnitBorders)*Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersYSpace)+1+yAxisUnitWidth/2);if(config.yAxisRight)rightNotUsableWidth=Math.max(rightNotUsableWidth,borderRHeight+config.spaceRight+(config.yAxisUnitBorders&&isBorder(config.yAxisUnitBordersSelection,"RIGHT"))*config.yAxisUnitBordersWidth+(config.yAxisUnitBackgroundColor!="none"||config.yAxisUnitBorders)*Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersYSpace)+1+yAxisUnitWidth/2);availableWidth=width-rightNotUsableWidth-leftNotUsableWidth}if(typegraph=="Line"||typegraph=="Bar"||typegraph=="StackedBar"){if(config.inGraphDataShow){topNotUsableHeight=Math.max(topNotUsableHeight,Math.max(highestYLabel,highestYLabel2)+1+borderTHeight)}availableHeight=height-topNotUsableHeight-bottomNotUsableHeight}dispCrossImage(ctx,config,width/2,height/2,width/2,height/2,false,data,-1,-1);if(typeof config.initFunction=="function")config.initFunction("INITFUNCTION",ctx,data,null,-1,-1,{animationValue:0,cntiter:0,config:config,borderX:0,borderY:0,midPosX:0,midPosY:0});if(ylabels!="nihil"){if(borderHeight>0){ctx.save();ctx.beginPath();ctx.setLineDash(lineStyleFn(config.canvasBordersStyle));ctx.strokeStyle=config.canvasBordersColor;ctx.lineWidth=borderHeight;ctx.setLineDash(lineStyleFn(config.canvasBordersStyle));ctx.strokeStyle=config.canvasBordersColor;ctx.fillStyle="rgba(0,0,0,0)";ctx.drawRectangle({x:0+borderLHeight/2,y:0+borderTHeight/2,width:width-borderRHeight/2-borderLHeight/2,height:height-borderTHeight/2-borderBHeight/2,borders:true,bordersWidth:borderHeight,borderSelection:config.canvasBordersSelection,borderRadius:config.canvasBordersRadius,fill:false,stroke:true});ctx.setLineDash([]);ctx.restore()}if(graphTitleHeight>0){ctx.save();ctx.beginPath();ctx.font=config.graphTitleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.graphTitleFontSize).toString()+"px "+config.graphTitleFontFamily;ctx.fillStyle=config.graphTitleFontColor;ctx.textBaseline="top";var textPos;switch(config.graphTitleAlign){case"right":ctx.textAlign="right";textPos=Math.ceil(ctx.chartSpaceScale*config.spaceLeft)+(width-Math.ceil(ctx.chartSpaceScale*config.spaceLeft)-Math.ceil(ctx.chartSpaceScale*config.spaceRight))/2;textPos=width-Math.ceil(ctx.chartSpaceScale*(config.spaceRight+config.graphTitleShift))-borderRHeight;break;case"left":ctx.textAlign="left";textPos=borderLHeight+Math.ceil(ctx.chartSpaceScale*(config.spaceLeft+config.graphTitleShift));break;default:ctx.textAlign="center";textPos=borderLHeight+Math.ceil(ctx.chartSpaceScale*config.spaceLeft)+(width-borderRHeight-borderLHeight-Math.ceil(ctx.chartSpaceScale*config.spaceLeft)-Math.ceil(ctx.chartSpaceScale*config.spaceRight))/2;break}setTextBordersAndBackground(ctx,config.graphTitle,Math.ceil(ctx.chartTextScale*config.graphTitleFontSize),textPos,graphTitlePosY,config.graphTitleBorders,config.graphTitleBordersSelection,config.graphTitleBordersColor,Math.ceil(ctx.chartLineScale*config.graphTitleBordersWidth),Math.ceil(ctx.chartSpaceScale*config.graphTitleBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.graphTitleBordersYSpace),config.graphTitleBordersStyle,config.graphTitleBackgroundColor,"GRAPHTITLE",config.graphTitleBordersRadius);ctx.translate(textPos,graphTitlePosY);ctx.fillTextMultiLine(config.graphTitle,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.graphTitleFontSize),true,config.detectMouseOnText,ctx,"TITLE_TEXTMOUSE",0,textPos,graphTitlePosY,-1,-1);ctx.stroke();ctx.restore()}if(graphSubTitleHeight>0){ctx.save();ctx.beginPath();ctx.font=config.graphSubTitleFontStyle+" "+Math.ceil(ctx.chartTextScale*config.graphSubTitleFontSize).toString()+"px "+config.graphSubTitleFontFamily;ctx.fillStyle=config.graphSubTitleFontColor;switch(config.graphSubTitleAlign){case"right":ctx.textAlign="right";textPos=width-Math.ceil(ctx.chartSpaceScale*(config.spaceRight+config.graphSubTitleShift))-borderRHeight;break;case"left":ctx.textAlign="left";textPos=borderLHeight+Math.ceil(ctx.chartSpaceScale*(config.spaceLeft+config.graphSubTitleShift));break;default:ctx.textAlign="center";textPos=borderLHeight+Math.ceil(ctx.chartSpaceScale*config.spaceLeft)+(width-borderRHeight-borderLHeight-Math.ceil(ctx.chartSpaceScale*config.spaceLeft)-Math.ceil(ctx.chartSpaceScale*config.spaceRight))/2;break}ctx.textBaseline="top";setTextBordersAndBackground(ctx,config.graphSubTitle,Math.ceil(ctx.chartTextScale*config.graphSubTitleFontSize),textPos,graphSubTitlePosY,config.graphSubTitleBorders,config.graphSubTitleBordersSelection,config.graphSubTitleBordersColor,Math.ceil(ctx.chartLineScale*config.graphSubTitleBordersWidth),Math.ceil(ctx.chartSpaceScale*config.graphSubTitleBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.graphSubTitleBordersYSpace),config.graphSubTitleBordersStyle,config.graphSubTitleBackgroundColor,"GRAPHSUBTITLE",config.graphSubTitleBordersRadius);ctx.translate(textPos,graphSubTitlePosY);ctx.fillTextMultiLine(config.graphSubTitle,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.graphSubTitleFontSize),true,config.detectMouseOnText,ctx,"SUBTITLE_TEXTMOUSE",0,textPos,graphSubTitlePosY,-1,-1);ctx.stroke();ctx.restore()}if(config.footNote.trim()!=""){ctx.save();ctx.font=config.footNoteFontStyle+" "+Math.ceil(ctx.chartTextScale*config.footNoteFontSize).toString()+"px "+config.footNoteFontFamily;ctx.fillStyle=config.footNoteFontColor;switch(config.footNoteAlign){case"right":ctx.textAlign="right";textPos=width-Math.ceil(ctx.chartSpaceScale*(config.spaceRight+config.footNoteShift))-borderRHeight;break;case"left":ctx.textAlign="left";textPos=borderLHeight+Math.ceil(ctx.chartSpaceScale*(config.spaceLeft+config.footNoteShift));break;default:ctx.textAlign="center";textPos=leftNotUsableWidth+availableWidth/2;break}ctx.textBaseline="bottom";setTextBordersAndBackground(ctx,config.footNote,Math.ceil(ctx.chartTextScale*config.footNoteFontSize),textPos,footNotePosY,config.footNoteBorders,config.footNoteBordersSelection,config.footNoteBordersColor,Math.ceil(ctx.chartLineScale*config.footNoteBordersWidth),Math.ceil(ctx.chartSpaceScale*config.footNoteBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.footNoteBordersYSpace),config.footNoteBordersStyle,config.footNoteBackgroundColor,"FOOTNOTE",config.footNoteBordersRadius);ctx.translate(textPos,footNotePosY);ctx.fillTextMultiLine(config.footNote,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.footNoteFontSize),true,config.detectMouseOnText,ctx,"FOOTNOTE_TEXTMOUSE",0,textPos,footNotePosY,-1,-1);ctx.stroke();ctx.restore()}if(yAxisUnitHeight>0){if(config.yAxisLeft){ctx.save();ctx.beginPath();ctx.font=config.yAxisUnitFontStyle+" "+Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize).toString()+"px "+config.yAxisUnitFontFamily;ctx.fillStyle=config.yAxisUnitFontColor;ctx.textAlign="center";ctx.textBaseline="bottom";setTextBordersAndBackground(ctx,config.yAxisUnit,Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize),leftNotUsableWidth,yAxisUnitPosY,config.yAxisUnitBorders,config.yAxisUnitBordersSelection,config.yAxisUnitBordersColor,Math.ceil(ctx.chartLineScale*config.yAxisUnitBordersWidth),Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersYSpace),config.yAxisUnitBordersStyle,config.yAxisUnitBackgroundColor,"YAXISUNIT",config.yAxisUnitBordersRadius);ctx.translate(leftNotUsableWidth,yAxisUnitPosY);ctx.fillTextMultiLine(config.yAxisUnit,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize),true,config.detectMouseOnText,ctx,"YLEFTAXISUNIT_TEXTMOUSE",0,leftNotUsableWidth,yAxisUnitPosY,-1,-1);ctx.stroke();ctx.restore()}if(config.yAxisRight){if(config.yAxisUnit2=="")config.yAxisUnit2=config.yAxisUnit;ctx.save();ctx.beginPath();ctx.font=config.yAxisUnitFontStyle+" "+Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize).toString()+"px "+config.yAxisUnitFontFamily;ctx.fillStyle=config.yAxisUnitFontColor;ctx.textAlign="center";ctx.textBaseline="bottom";setTextBordersAndBackground(ctx,config.yAxisUnit2,Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize),width-rightNotUsableWidth,yAxisUnitPosY,config.yAxisUnitBorders,config.yAxisUnitBordersSelection,config.yAxisUnitBordersColor,Math.ceil(ctx.chartLineScale*config.yAxisUnitBordersWidth),Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.yAxisUnitBordersYSpace),config.yAxisUnitBordersStyle,config.yAxisUnitBackgroundColor,"YAXISUNIT",config.yAxisUnitBordersRadius);ctx.translate(width-rightNotUsableWidth,yAxisUnitPosY);ctx.fillTextMultiLine(config.yAxisUnit2,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.yAxisUnitFontSize),true,config.detectMouseOnText,ctx,"YRIGHTAXISUNIT_TEXTMOUSE",0,width-rightNotUsableWidth,yAxisUnitPosY,-1,-1);ctx.stroke();ctx.restore()}}if(yAxisLabelWidth>0){if(config.yAxisLeft){ctx.save();ctx.beginPath();ctx.font=config.yAxisFontStyle+" "+Math.ceil(ctx.chartTextScale*config.yAxisFontSize).toString()+"px "+config.yAxisFontFamily;ctx.fillStyle=config.yAxisFontColor;ctx.textAlign="center";ctx.textBaseline="bottom";ctx.translate(yAxisLabelPosLeft,topNotUsableHeight+availableHeight/2);ctx.rotate(-(90*(Math.PI/180)));setTextBordersAndBackground(ctx,config.yAxisLabel,Math.ceil(ctx.chartTextScale*config.yAxisFontSize),0,0,config.yAxisLabelBorders,config.yAxisLabelBordersSelection,config.yAxisLabelBordersColor,Math.ceil(ctx.chartLineScale*config.yAxisLabelBordersWidth),Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersYSpace),config.yAxisLabelBordersStyle,config.yAxisLabelBackgroundColor,"YAXISLABELLEFT",config.yAxisLabelBordersRadius);ctx.fillTextMultiLine(config.yAxisLabel,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.yAxisFontSize),false,config.detectMouseOnText,ctx,"YLEFTAXISLABEL_TEXTMOUSE",-(90*(Math.PI/180)),yAxisLabelPosLeft,topNotUsableHeight+availableHeight/2,-1,-1);ctx.stroke();ctx.restore()}if(config.yAxisRight){var yAxisLabel2=config.yAxisLabel2;if(yAxisLabel2=="")yAxisLabel2=config.yAxisLabel;ctx.save();ctx.beginPath();ctx.font=config.yAxisFontStyle+" "+Math.ceil(ctx.chartTextScale*config.yAxisFontSize).toString()+"px "+config.yAxisFontFamily;ctx.fillStyle=config.yAxisFontColor;ctx.textAlign="center";ctx.textBaseline="bottom";ctx.translate(yAxisLabelPosRight,topNotUsableHeight+availableHeight/2);ctx.rotate(+(90*(Math.PI/180)));setTextBordersAndBackground(ctx,yAxisLabel2,Math.ceil(ctx.chartTextScale*config.yAxisFontSize),0,0,config.yAxisLabelBorders,config.yAxisLabelBordersSelection,config.yAxisLabelBordersColor,Math.ceil(ctx.chartLineScale*config.yAxisLabelBordersWidth),Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.yAxisLabelBordersYSpace),config.yAxisLabelBordersStyle,config.yAxisLabelBackgroundColor,"YAXISLABELLEFT",config.yAxisLabelBordersRadius);ctx.fillTextMultiLine(yAxisLabel2,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.yAxisFontSize),false,config.detectMouseOnText,ctx,"YRIGHTAXISLABEL_TEXTMOUSE",+(90*(Math.PI/180)),yAxisLabelPosRight,topNotUsableHeight+availableHeight/2,-1,-1);ctx.stroke();ctx.restore()}}if(xAxisLabelHeight>0){if(config.xAxisBottom){ctx.save();ctx.beginPath();ctx.font=config.xAxisFontStyle+" "+Math.ceil(ctx.chartTextScale*config.xAxisFontSize).toString()+"px "+config.xAxisFontFamily;ctx.fillStyle=config.xAxisFontColor;ctx.textAlign="center";ctx.textBaseline="bottom";setTextBordersAndBackground(ctx,config.xAxisLabel,Math.ceil(ctx.chartTextScale*config.xAxisFontSize),leftNotUsableWidth+availableWidth/2,xAxisLabelPos,config.xAxisLabelBorders,config.xAxisLabelBordersSelection,config.xAxisLabelBordersColor,Math.ceil(ctx.chartLineScale*config.xAxisLabelBordersWidth),Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersYSpace),config.xAxisLabelBordersStyle,config.xAxisLabelBackgroundColor,"XAXISLABEL",config.xAxisLabelBordersRadius);ctx.translate(leftNotUsableWidth+availableWidth/2,xAxisLabelPos);ctx.fillTextMultiLine(config.xAxisLabel,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.xAxisFontSize),true,config.detectMouseOnText,ctx,"XAXISLABEL_TEXTMOUSE",0,leftNotUsableWidth+availableWidth/2,xAxisLabelPos,-1,-1);ctx.stroke();ctx.restore()}if(config.xAxisTop){var xAxisLabel2=config.xAxisLabel2;if(xAxisLabel2=="")xAxisLabel2=config.xAxisLabel;ctx.save();ctx.beginPath();ctx.font=config.xAxisFontStyle+" "+Math.ceil(ctx.chartTextScale*config.xAxisFontSize).toString()+"px "+config.xAxisFontFamily;ctx.fillStyle=config.xAxisFontColor;ctx.textAlign="center";ctx.textBaseline="top";setTextBordersAndBackground(ctx,xAxisLabel2,Math.ceil(ctx.chartTextScale*config.xAxisFontSize),leftNotUsableWidth+availableWidth/2,xTAxisLabelPos,config.xAxisLabelBorders,config.xAxisLabelBordersSelection,config.xAxisLabelBordersColor,Math.ceil(ctx.chartLineScale*config.xAxisLabelBordersWidth),Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersXSpace),Math.ceil(ctx.chartSpaceScale*config.xAxisLabelBordersYSpace),config.xAxisLabelBordersStyle,config.xAxisLabelBackgroundColor,"XAXISLABEL",config.xAxisLabelBordersRadius);ctx.translate(leftNotUsableWidth+availableWidth/2,xTAxisLabelPos);ctx.fillTextMultiLine(xAxisLabel2,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.xAxisFontSize),true,config.detectMouseOnText,ctx,"XAXISLABEL_TEXTMOUSE",0,leftNotUsableWidth+availableWidth/2,xAxisLabelPos,-1,-1);ctx.stroke();ctx.restore()}}var legendMsr;if(nbeltLegend>1||nbeltLegend==1&&config.showSingleLegend){legendMsr={dispLegend:true,xLegendPos:xLegendPos,yLegendPos:yLegendPos,nbLegendLines:nbLegendLines,nbLegendCols:nbLegendCols,reverseLegend:reverseLegend,legendBox:legendBox,widestLegend:widestLegend,highestLegend:highestLegend,legendWidth:msrLegend.legendWidth,legendHeight:msrLegend.legendHeight,legendBackgroundColorWidth:msrLegend.legendBackgroundColorWidth,legendBackgroundColorHeight:msrLegend.legendBackgroundColorHeight,legendBorderWidth:msrLegend.legendBorderWidth,legendBorderHeight:msrLegend.legendBorderHeight,legendFirstTextXPos:msrLegend.legendFirstTextXPos,legendFirstTextYPos:msrLegend.legendFirstTextYPos,legendBackgroundColorXPos:msrLegend.legendBackgroundColorXPos,legendBackgroundColorYPos:msrLegend.legendBackgroundColorYPos,legendBorderXPos:msrLegend.legendBorderXPos,legendBorderYPos:msrLegend.legendBorderYPos,elementMsr:msrLegend.elementMsr};if(config.legendPosY==0||config.legendPosY==4||config.legendPosX==0||config.legendPosX==4){drawLegend(legendMsr,data,config,ctx,typegraph,-1);legendMsr={dispLegend:false}}}else{legendMsr={dispLegend:false}}}clrx=leftNotUsableWidth;clrwidth=availableWidth;clry=topNotUsableHeight;clrheight=availableHeight;return{leftNotUsableWidth:leftNotUsableWidth,rightNotUsableWidth:rightNotUsableWidth,availableWidth:availableWidth,topNotUsableHeight:topNotUsableHeight,bottomNotUsableHeight:bottomNotUsableHeight,availableHeight:availableHeight,widestXLabel:widestXLabel,widestTXLabel:widestTXLabel,highestXLabel:highestXLabel,highestTXLabel:highestTXLabel,widestYLabel:widestYLabel,widestYLabel2:widestYLabel2,highestYLabel:highestYLabel,rotateLabels:rotateLabels,rotateTLabels:rotateTLabels,xLabelPos:xLabelPos,xTLabelPos:xTLabelPos,clrx:clrx,clry:clry,clrwidth:clrwidth,clrheight:clrheight,legendMsr:legendMsr}}function drawLinesDataset(animPc,data,config,ctx,statData,vars){var y1,y2,y3,diffnb,diffnbj,fact,currentAnimPc;var prevypos;var pts=[];for(var i=0;i<data.datasets.length;i++){if(setOptionValue(true,true,1,"ANIMATION",ctx,data,statData,data.datasets[i].animation,config.animation,"animation",i,-1,{nullvalue:null})==true||animPc>=1){prevypos="undefined";if(statData[i][0].tpchart!="Line")continue;if(statData[i].length==0)continue;if(statData[i][0].firstNotMissing==-1)continue;ctx.save();ctx.beginPath();prevAnimPc={mainVal:0,subVal:0,animVal:0};var firstpt=-1;var lastxPos=-1;for(var j=statData[i][0].firstNotMissing;j<=statData[i][0].lastNotMissing;j++){todisplay=true;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)todisplay=false;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)todisplay=false;if(typeof data.datasets[i].data[j]=="undefined")todisplay=false;if(prevAnimPc.animVal==0&&j>statData[i][0].firstNotMissing)continue;currentAnimPc=animationCorrection(animPc,data,config,i,j,true);if(currentAnimPc.mainVal==0&&(prevAnimPc.mainVal>0&&firstpt!=-1)){ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);if(config.extrapolateMissingData){y1=statData[i][statData[i][j].prevNotMissing].yAxisPos-prevAnimPc.mainVal*statData[i][statData[i][j].prevNotMissing].yPosOffset;y2=statData[i][j].yAxisPos-prevAnimPc.mainVal*statData[i][statData[i][j-1].nextNotMissing].yPosOffset;diffnb=statData[i][j-1].nextNotMissing-statData[i][j].prevNotMissing;diffnbj=j-1-statData[i][j].prevNotMissing;fact=(diffnbj+prevAnimPc.subVal)/diffnb;y3=y1+fact*(y2-y1);traceLine(pts,ctx,statData[i][statData[i][j].prevNotMissing].xPos+fact*(statData[i][statData[i][j-1].nextNotMissing].xPos-statData[i][statData[i][j].prevNotMissing].xPos),y3,config,data,statData,i,setYposOrigin(i,j,data,statData));closebz(pts,ctx,config,i);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);ctx.strokeStyle="rgba(0,0,0,0)";if(config.datasetFill&&setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})!=1){ctx.lineTo(statData[i][statData[i][j].prevNotMissing].xPos+fact*(statData[i][statData[i][j-1].nextNotMissing].xPos-statData[i][statData[i][j].prevNotMissing].xPos),statData[i][j].yAxisPos);ctx.lineTo(statData[i][firstpt].xPos,statData[i][firstpt].xAxisPosY-statData[i][0].zeroY);ctx.closePath();ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc.mainVal,xPosLeft:statData[i][0].xPos,yPosBottom:Math.max(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lminvalue_offset),xPosRight:statData[i][data.datasets[i].data.length-1].xPos,yPosTop:Math.min(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lmaxvalue_offset)});ctx.fill();firstpt=-1}}else if(todisplay==true){traceLine(pts,ctx,statData[i][j-1].xPos+prevAnimPc.subVal*(statData[i][j].xPos-statData[i][j-1].xPos),statData[i][j].yAxisPos-prevAnimPc.mainVal*statData[i][statData[i][j-1].nextNotMissing].yPosOffset,config,data,statData,i,setYposOrigin(i,j,data,statData));closebz(pts,ctx,config,i);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);ctx.strokeStyle="rgba(0,0,0,0)";if(config.datasetFill&&setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})!=1){ctx.lineTo(statData[i][j-1].xPos+prevAnimPc.subVal*(statData[i][j].xPos-statData[i][j-1].xPos),statData[i][j].yAxisPos);ctx.lineTo(statData[i][firstpt].xPos,statData[i][firstpt].xAxisPosY-statData[i][0].zeroY);ctx.closePath();ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc.mainVal,xPosLeft:statData[i][0].xPos,yPosBottom:Math.max(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lminvalue_offset),xPosRight:statData[i][data.datasets[i].data.length-1].xPos,yPosTop:Math.min(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lmaxvalue_offset)});ctx.fill()}}prevAnimPc=currentAnimPc;continue}else if(currentAnimPc.totVal==0){ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);ctx.strokeStyle="rgba(0,0,0,0)"}else{ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,j,{nullvalue:null})}prevAnimPc=currentAnimPc;switch(todisplay){case false:if(!config.extrapolateMissingData){if(firstpt==-1)continue;closebz(pts,ctx,config,i);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);if(config.datasetFill&&firstpt!=-1&&setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})!=1){lastxPos=-1;ctx.strokeStyle="rgba(0,0,0,0)";ctx.lineTo(statData[i][j-1].xPos,statData[i][j-1].yAxisPos);ctx.lineTo(statData[i][firstpt].xPos,statData[i][firstpt].yAxisPos);ctx.closePath();ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,j,{animationValue:currentAnimPc.mainVal,xPosLeft:statData[i][0].xPos,yPosBottom:Math.max(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lminvalue_offset),xPosRight:statData[i][data.datasets[i].data.length-1].xPos,yPosTop:Math.min(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lmaxvalue_offset)});ctx.fill()}ctx.beginPath();prevAnimPc={mainVal:0,subVal:0};firstpt=-1}else if(currentAnimPc.subVal>0){lastxPos=statData[i][j].xPos+currentAnimPc.subVal*(statData[i][j+1].xPos-statData[i][j].xPos);y1=statData[i][statData[i][j+1].prevNotMissing].yAxisPos-statData[i][statData[i][j+1].prevNotMissing].yPosOffset;y2=statData[i][statData[i][j].nextNotMissing].yAxisPos-statData[i][statData[i][j].nextNotMissing].yPosOffset;diffnb=statData[i][j].nextNotMissing-statData[i][j+1].prevNotMissing;diffnbj=j-statData[i][j+1].prevNotMissing;fact=(diffnbj+prevAnimPc.subVal)/diffnb;y3=y1+fact*(y2-y1);traceLine(pts,ctx,statData[i][statData[i][j].prevNotMissing].xPos+fact*(statData[i][statData[i][j-1].nextNotMissing].xPos-statData[i][statData[i][j].prevNotMissing].xPos),y3,config,data,statData,i,setYposOrigin(i,j,data,statData))}break;default:ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"LINEWIDTH",ctx,data,statData,data.datasets[i].datasetStrokeWidth,config.datasetStrokeWidth,"datasetStrokeWidth",i,j,{nullvalue:null}));if(firstpt==-1){firstpt=j;ctx.beginPath();if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==1){if(typeof statData[i][j].yPosOffsetOrigin!="undefined")ctx.moveTo(statData[i][j].xPos,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffsetOrigin);else ctx.moveTo(statData[i][firstpt].xPos,statData[i][firstpt].xAxisPosY-statData[i][0].zeroY);ctx.lineTo(statData[i][j].xPos,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset)}else ctx.moveTo(statData[i][j].xPos,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset);initbz(pts,statData[i][j].xPos,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset,i);lastxPos=statData[i][j].xPos}else{lastxPos=statData[i][j].xPos;traceLine(pts,ctx,statData[i][j].xPos,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset,config,data,statData,i,setYposOrigin(i,j,data,statData))}if(currentAnimPc.subVal>0&&statData[i][j].nextNotMissing!=-1&&(config.extrapolateMissing||statData[i][j].nextNotMissing==j+1)){lastxPos=statData[i][j].xPos+currentAnimPc.subVal*(statData[i][j+1].xPos-statData[i][j].xPos);y1=statData[i][statData[i][j+1].prevNotMissing].yAxisPos-statData[i][statData[i][j+1].prevNotMissing].yPosOffset;y2=statData[i][statData[i][j].nextNotMissing].yAxisPos-statData[i][statData[i][j].nextNotMissing].yPosOffset;y3=y1+currentAnimPc.subVal*(y2-y1);traceLine(pts,ctx,statData[i][j].xPos+currentAnimPc.subVal*(statData[i][statData[i][j].nextNotMissing].xPos-statData[i][j].xPos),y3,config,data,statData,i,setYposOrigin(i,j,data,statData))}break}}closebz(pts,ctx,config,i);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));ctx.stroke();ctx.setLineDash([]);if(config.datasetFill&&setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})!=1){if(firstpt>=0){ctx.strokeStyle="rgba(0,0,0,0)";ctx.lineTo(lastxPos,statData[i][0].xAxisPosY-statData[i][0].zeroY);ctx.lineTo(statData[i][firstpt].xPos,statData[i][firstpt].xAxisPosY-statData[i][0].zeroY);ctx.closePath();ctx.fillStyle=setOptionValue(true,true,1,"COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,"fillColor",i,-1,{animationValue:currentAnimPc.mainVal,xPosLeft:statData[i][0].xPos,yPosBottom:Math.max(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lminvalue_offset),xPosRight:statData[i][data.datasets[i].data.length-1].xPos,yPosTop:Math.min(statData[i][0].yAxisPos,statData[i][0].yAxisPos-(config.animationLeftToRight?1:1*currentAnimPc.mainVal)*statData[i][0].lmaxvalue_offset)});ctx.fill()}}ctx.restore();if(animPc>=1){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(!(typeof data.datasets[i].data[j]=="undefined")){currentAnimPc=animationCorrection(animPc,data,config,i,j,true);if(currentAnimPc.mainVal>0||!config.animationLeftToRight){if(setOptionValue(true,true,1,"POINTDOT",ctx,data,statData,undefined,config.pointDot,"pointDot",i,j,{nullvalue:null})){ctx.beginPath();ctx.fillStyle=setOptionValue(true,true,1,"MARKERFILLCOLOR",ctx,data,statData,data.datasets[i].pointColor,config.defaultStrokeColor,"pointColor",i,j,{nullvalue:true});ctx.strokeStyle=setOptionValue(true,true,1,"MARKERSTROKESTYLE",ctx,data,statData,data.datasets[i].pointStrokeColor,config.defaultStrokeColor,"pointStrokeColor",i,j,{nullvalue:true});ctx.lineWidth=setOptionValue(true,true,ctx.chartLineScale,"MARKERLINEWIDTH",ctx,data,statData,data.datasets[i].pointDotStrokeWidth,config.pointDotStrokeWidth,"pointDotStrokeWidth",i,j,{nullvalue:true});var markerShape=setOptionValue(true,true,1,"MARKERSHAPE",ctx,data,statData,data.datasets[i].markerShape,config.markerShape,"markerShape",i,j,{nullvalue:true});var markerRadius=setOptionValue(true,true,ctx.chartSpaceScale,"MARKERRADIUS",ctx,data,statData,data.datasets[i].pointDotRadius,config.pointDotRadius,"pointDotRadius",i,j,{nullvalue:true});var markerStrokeStyle=setOptionValue(true,true,1,"MARKERSTROKESTYLE",ctx,data,statData,data.datasets[i].pointDotStrokeStyle,config.pointDotStrokeStyle,"pointDotStrokeStyle",i,j,{nullvalue:true});drawMarker(ctx,statData[i][j].xPos,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset,markerShape,markerRadius,markerStrokeStyle)}}}}}if(animPc>=config.animationStopValue){for(j=0;j<data.datasets[i].data.length;j++){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)continue;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,statData,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)continue;if(typeof data.datasets[i].data[j]=="undefined")continue;if(!(data.datasets[i].mouseDetection==false))jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["POINT",i,j,statData,setOptionValue(true,true,1,"ANNOTATEDISPLAY",ctx,data,statData,data.datasets[i].annotateDisplay,config.annotateDisplay,"annotateDisplay",i,j,{nullValue:true})];if(setOptionValue(true,true,1,"INGRAPHDATASHOW",ctx,data,statData,data.datasets[i].inGraphDataShow,config.inGraphDataShow,"inGraphDataShow",i,j,{nullValue:true})){ctx.save();ctx.textAlign=setOptionValue(true,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",i,j,{nullValue:true});ctx.textBaseline=setOptionValue(true,true,1,"INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,"inGraphDataVAlign",i,j,{nullValue:true});ctx.font=setOptionValue(true,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(true,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});ctx.fillStyle=setOptionValue(true,true,1,"INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,"inGraphDataFontColor",i,j,{nullValue:true});var paddingTextX=setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,"inGraphDataPaddingX",i,j,{nullValue:true}),paddingTextY=setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,"inGraphDataPaddingY",i,j,{nullValue:true});var dispString=tmplbis(setOptionValue(true,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);ctx.translate(statData[i][j].xPos+paddingTextX,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset-paddingTextY);var rotateVal=setOptionValue(true,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",i,j,{nullValue:true})*(Math.PI/180);ctx.rotate(rotateVal);setTextBordersAndBackground(ctx,dispString,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),0,0,setOptionValue(true,true,1,"INGRAPHDATABORDERS",ctx,data,statData,undefined,config.inGraphDataBorders,"inGraphDataBorders",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSELECTION",ctx,data,statData,undefined,config.inGraphDataBordersSelection,"inGraphDataBordersSelection",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSCOLOR",ctx,data,statData,undefined,config.inGraphDataBordersColor,"inGraphDataBordersColor",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartLineScale,"INGRAPHDATABORDERSWIDTH",ctx,data,statData,undefined,config.inGraphDataBordersWidth,"inGraphDataBordersWidth",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSXSPACE",ctx,data,statData,undefined,config.inGraphDataBordersXSpace,"inGraphDataBordersXSpace",i,j,{nullValue:true}),setOptionValue(true,true,ctx.chartSpaceScale,"INGRAPHDATABORDERSYSPACE",ctx,data,statData,undefined,config.inGraphDataBordersYSpace,"inGraphDataBordersYSpace",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABORDERSSTYLE",ctx,data,statData,undefined,config.inGraphDataBordersStyle,"inGraphDataBordersStyle",i,j,{nullValue:true}),setOptionValue(true,true,1,"INGRAPHDATABACKGROUNDCOLOR",ctx,data,statData,undefined,config.inGraphDataBackgroundColor,"inGraphDataBackgroundColor",i,j,{nullValue:true}),"INGRAPHDATA",config.inGraphDataBordersRadius);ctx.fillTextMultiLine(dispString,0,0,ctx.textBaseline,setOptionValue(true,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true}),true,config.detectMouseOnText,ctx,"INGRAPHDATA_TEXTMOUSE",rotateVal,statData[i][j].xPos+paddingTextX,statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffset-paddingTextY,i,j);ctx.restore()}}}}}function initbz(pts,xpos,ypos,i){if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==0&&setOptionValue(true,true,1,"BEZIERCURVE",ctx,data,statData,undefined,config.bezierCurve,"bezierCurve",i,-1,{nullValue:true})){pts.length=0;pts.push(xpos);pts.push(ypos)}prevypos=ypos}function setYposOrigin(i,j,data,statData){yposOrigin="undefined";if(typeof statData[i][j].yPosOffsetOrigin!="undefined")yposOrigin=statData[i][j].yAxisPos-currentAnimPc.mainVal*statData[i][j].yPosOffsetOrigin;return yposOrigin}function traceLine(pts,ctx,xpos,ypos,config,data,statData,i,yposOrigin){if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==0&&setOptionValue(true,true,1,"BEZIERCURVE",ctx,data,statData,undefined,config.bezierCurve,"bezierCurve",i,-1,{nullValue:true})){pts.push(xpos);pts.push(ypos)}else{if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==0)ctx.lineTo(xpos,ypos);else if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==1){if(yposOrigin!="undefined")ctx.moveTo(xpos,yposOrigin);else ctx.moveTo(xpos,statData[i][0].xAxisPosY-statData[i][0].zeroY);ctx.lineTo(xpos,ypos)}else if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==2&&typeof prevypos!="undefined"){ctx.lineTo(xpos,prevypos);ctx.lineTo(xpos,ypos);prevypos=ypos}}}function closebz(pts,ctx,config,i){if(setOptionValue(true,true,1,"LINKTYPE",ctx,data,statData,data.datasets[i].linkType,config.linkType,"linkType",i,j,{nullvalue:null})==0&&setOptionValue(true,true,1,"BEZIERCURVE",ctx,data,statData,undefined,config.bezierCurve,"bezierCurve",i,-1,{nullValue:true})){minimumpos=statData[i][0].xAxisPosY;maximumpos=statData[i][0].xAxisPosY-statData[i][0].calculatedScale.steps*statData[i][0].scaleHop;drawSpline(ctx,pts,setOptionValue(true,true,1,"BEZIERCURVETENSION",ctx,data,statData,undefined,config.bezierCurveTension,"bezierCurveTension",i,-1,{nullValue:true}),minimumpos,maximumpos);pts.length=0}prevypos=undefined}function getControlPoints(x0,y0,x1,y1,x2,y2,t){var d01=Math.sqrt(Math.pow(x1-x0,2)+Math.pow(y1-y0,2));var d12=Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2));var fa=t*d01/(d01+d12);var fb=t-fa;var p1x=x1+fa*(x0-x2);var p1y=y1+fa*(y0-y2);var p2x=x1-fb*(x0-x2);var p2y=y1-fb*(y0-y2);return[p1x,p1y,p2x,p2y]}function drawSpline(ctx,pts,t,minimumpos,maximumpos){var cp=[];var n=pts.length;pts.push(2*pts[n-2]-pts[n-4]);pts.push(2*pts[n-1]-pts[n-3]);if(n==4){ctx.moveTo(pts[0],pts[1]);ctx.lineTo(pts[2],pts[3]);return}for(var ti=0;ti<n-2;ti+=2){cp=cp.concat(getControlPoints(pts[ti],pts[ti+1],pts[ti+2],pts[ti+3],pts[ti+4],pts[ti+5],t))}ctx.beginPath();ctx.strokeStyle=setOptionValue(true,true,1,"STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,"strokeColor",i,j,{nullvalue:null});ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,true,1,"LINEWIDTH",ctx,data,statData,data.datasets[i].datasetStrokeWidth,config.datasetStrokeWidth,"datasetStrokeWidth",i,j,{nullvalue:null}));ctx.moveTo(pts[0],pts[1]);ctx.quadraticCurveTo(cp[0],Math.max(Math.min(cp[1],minimumpos),maximumpos),pts[2],pts[3]);ctx.setLineDash(lineStyleFn(setOptionValue(true,true,1,"LINEDASH",ctx,data,statData,data.datasets[i].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",i,j,{nullvalue:null})));for(ti=2;ti<pts.length-4;ti+=2){y1=Math.max(Math.min(cp[2*ti-1],minimumpos),maximumpos);y2=Math.max(Math.min(cp[2*ti+1],minimumpos),maximumpos);ctx.bezierCurveTo(cp[2*ti-2],y1,cp[2*ti],y2,pts[ti+2],pts[ti+3])}ctx.stroke()}ctx.setLineDash([])}function log10(val){return Math.log(val)/Math.LN10}function setRect(ctx,config){if(config.clearRect){if(!config.multiGraph){clear(ctx);ctx.clearRect(0,0,width,height)}}else{clear(ctx);ctx.clearRect(0,0,width,height);ctx.fillStyle=config.savePngBackgroundColor;ctx.strokeStyle=config.savePngBackgroundColor;ctx.beginPath();ctx.moveTo(0,0);ctx.lineTo(0,ctx.canvas.height);ctx.lineTo(ctx.canvas.width,ctx.canvas.height);ctx.lineTo(ctx.canvas.width,0);ctx.lineTo(0,0);ctx.stroke();ctx.fill()}}function defMouse(ctx,data,config){var mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";if(typeof ctx.mouseAction=="undefined"){ctx.mouseAction=[]}else{for(var i=0;i<ctx.mouseAction;i++){if(ctx.mouseAction.substring(0,1)!="/")ctx.mouseAction[i]="/"+ctx.mouseAction[i]}}function setAction(ctx,action){if(ctx.mouseAction.indexOf("/"+action)>=0)ctx.mouseAction[ctx.mouseAction.indexOf("/"+action)]=action;else if(ctx.mouseAction.indexOf(action)<0)ctx.mouseAction[ctx.mouseAction.length]=action}function add_listener(ctx,action){if(isIE()<9&&isIE()!=false)ctx.canvas.attachEvent("on"+action.split(" ")[0],function(event){doMouseAction(event,ctx.ChartNewId,action.split(" ")[0])});else ctx.canvas.addEventListener(action.split(" ")[0],function(event){doMouseAction(event,ctx,action.split(" ")[0])},false)}if(config.savePng==true){if(config.savePngFunction=="mousedown left")setAction(ctx,"mousedown 1");else if(config.savePngFunction=="mousedown middle")setAction(ctx,"mousedown 2");else if(config.savePngFunction=="mousedown right")setAction(ctx,"mousedown 3")}if(config.annotateDisplay==true){if(cursorDivCreated==false)oCursor=new makeCursorObj("divCursor");if(config.annotateFunction=="mousedown left")setAction(ctx,"mousedown 1");else if(config.annotateFunction=="mousedown middle")setAction(ctx,"mousedown 2");else if(config.annotateFunction=="mousedown right")setAction(ctx,"mousedown 3");else if(config.annotateFunction=="mousemove")setAction(ctx,"mousemove")}if(config.highLight==true){if(config.highLightMouseFunction=="mousedown left")setAction(ctx,"mousedown 1");else if(config.highLightMouseFunction=="mousedown middle")setAction(ctx,"mousedown 2");else if(config.highLightMouseFunction=="mousedown right")setAction(ctx,"mousedown 3");else if(config.highLightMouseFunction=="mousemove")setAction(ctx,"mousemove")}if(typeof config.mouseMove=="function")setAction(ctx,"mousemove");if(typeof config.mouseDownLeft=="function")setAction(ctx,"mousedown 1");if(typeof config.mouseDownMiddle=="function")setAction(ctx,"mousedown 2");if(typeof config.mouseDownRight=="function")setAction(ctx,"mousedown 3");if(typeof config.mouseWheel=="function")setAction(ctx,mousewheelevt);if(typeof config.mouseOut=="function")setAction(ctx,"mouseout");if(typeof config.mouseDblClick=="function")setAction(ctx,"dblclick");var mouseAction=false;if(ctx.mouseAction.indexOf("mousemove")>=0&&ctx.mouseAction.indexOf("/mousemove")<0||ctx.mouseAction.indexOf("mouseout")>=0&&ctx.mouseAction.indexOf("/mouseout")<0){setAction(ctx,"mouseout");mouseAction=true;add_listener(ctx,"mouseout")}if(ctx.mouseAction.indexOf("mousemove")>=0&&ctx.mouseAction.indexOf("/mousemove")<0||ctx.mouseAction.indexOf(mousewheelevt)>=0&&ctx.mouseAction.indexOf("/"+mousewheelevt)<0){setAction(ctx,mousewheelevt);mouseAction=true;add_listener(ctx,mousewheelevt)}if(ctx.mouseAction.indexOf("mousemove")>=0&&ctx.mouseAction.indexOf("/mousemove")<0){mouseAction=true;add_listener(ctx,"mousemove")}if(ctx.mouseAction.indexOf("dblclick")>=0&&ctx.mouseAction.indexOf("/dblclick")<0){mouseAction=true;add_listener(ctx,"dblclick")}if(ctx.mouseAction.indexOf("mousedown 1")>=0&&ctx.mouseAction.indexOf("/mousedown 1")<0||ctx.mouseAction.indexOf("mousedown 2")>=0&&ctx.mouseAction.indexOf("/mousedown 2")<0||ctx.mouseAction.indexOf("mousedown 3")>=0&&ctx.mouseAction.indexOf("/mousedown 3")<0){mouseAction=true;add_listener(ctx,"mousedown")}if((config.contextMenu==false||ctx.mouseAction.indexOf("mousedown 3")>=0)&&ctx.mouseAction.indexOf("/removeContextMenu")<0){ctx.mouseAction[ctx.mouseAction.length]="removeContextMenu";ctx.canvas.oncontextmenu=function(e){e.preventDefault()}}inMouseAction[ctx.ChartNewId]=false;mouseActionData[ctx.ChartNewId]={data:data,config:config,prevShow:-1}}};function animationCorrection(animationValue,data,config,vdata,vsubdata,isline){var animValue=animationValue;var animSubValue=0;if(vsubdata<0){if(vdata<1*config.animationStartWithData-1)animValue=1;else{switch(config.animationByDataset){case"ByArc":animValue=animationValue;break;case true:animValue=animationValue;break;case false:default:animValue=animationValue;break}}}else{var startVal=Math.max(1,config.animationStartWithDataset);var startSubVal=Math.max(1,config.animationStartWithData);if(vdata<1*config.animationStartWithDataset-1)animValue=1;else if(vsubdata<1*config.animationStartWithData-1)animValue=1;else{var maxData=0;if(config.animationLeftToRight){for(var i=0;i<data.datasets.length;i++)maxData=Math.max(maxData,data.datasets[i].data.length)}switch(config.animationByDataset){case true:switch(config.animationLeftToRight){case true:var curpos=(vdata-(startVal-1))*(maxData-(startSubVal-1))+(vsubdata-(startSubVal-1));maxData=(maxData-(startSubVal-1))*(data.datasets.length-(startVal-1));if(animationValue<curpos/maxData){animValue=0;if(isline&&vsubdata+1==startSubVal)animValue=1}else if(animationValue<(curpos+1)/maxData){animValue=(animationValue-curpos/maxData)*maxData;if(isline){animSubValue=animValue;animValue=1}}else animValue=1;break;case false:default:if(animationValue<(vdata-(startVal-1))/(data.datasets.length-(startVal-1))){animValue=.001}else if(animationValue<(vdata-(startVal-1)+1)/(data.datasets.length-(startVal-1))){animValue=(data.datasets.length-(startVal-1))*(animationValue-(vdata-(startVal-1))/(data.datasets.length-(startVal-1)))}else animValue=1;break}break;case false:default:switch(config.animationLeftToRight){case true:var curpos=vsubdata-(startSubVal-1);maxData=maxData-(startSubVal-1);if(animationValue<curpos/maxData)animValue=0;else if(animationValue<(curpos+1)/maxData){animValue=(animationValue-curpos/maxData)*maxData;if(isline){animSubValue=animValue;animValue=1}}else animValue=1;break;case false:default:animValue=animationValue;break}break}}}return{mainVal:animValue,subVal:animSubValue,animVal:animValue+animSubValue}}function showLabels(ctx,data,config,i){var doShowLabels=setOptionValue(true,true,1,"SHOWLABEL",ctx,data,undefined,undefined,config.showXLabels,"showXLabels",i,-1,undefined,{labelValue:fmtChartJS(config,data.labels[i],config.fmtXLabel),unformatedLabelValue:data.labels[i]});if(typeof doShowLabels=="number"){if(i>=config.firstLabelToShow-1)doShowLabels=(i+config.firstLabelToShow-1)%parseInt(doShowLabels)==0?true:false;else doShowLabels=false}return doShowLabels}function showYLabels(ctx,data,config,i,text){var doShowLabels=setOptionValue(true,true,1,"SHOWYLABEL",ctx,data,undefined,undefined,config.showYLabels,"showYLabels",-1,i,undefined,{labelValue:text});if(typeof doShowLabels=="number"){if(i>=config.firstYLabelToShow-1)doShowLabels=(i+config.firstYLabelToShow-1)%parseInt(doShowLabels)==0?true:false;else doShowLabels=false}return doShowLabels}function drawLegend(legendMsr,data,config,ctx,typegraph,cntiter){if(config.legendPosY==0||config.legendPosY==4||config.legendPosX==0||config.legendPosX==4){if(cntiter!=-1)return}else{if(cntiter==-1)return;else if(config.animation==true){if(typeof config.legendWhenToDraw=="number"){if(cntiter!=config.legendWhenToDraw)return}else if(cntiter!=1&&config.legendWhenToDraw=="first")return;else if(cntiter!=config.animationSteps&&config.legendWhenToDraw=="last")return}}ctx.save();if(config.legendFillColor!="rgba(0,0,0,0)"){ctx.setLineDash([]);ctx.lineWidth=0;ctx.fillStyle=config.legendFillColor;ctx.drawRectangle({x:legendMsr.xLegendPos+legendMsr.legendBackgroundColorXPos,y:legendMsr.yLegendPos+legendMsr.legendBackgroundColorYPos,width:legendMsr.legendBackgroundColorWidth,height:legendMsr.legendBackgroundColorHeight,borders:config.legendBorders,bordersWidth:Math.ceil(ctx.chartLineScale*config.legendBordersWidth),borderSelection:config.legendBordersSelection,borderRadius:config.legendBordersRadius,fill:true,stroke:false})}if(config.legendBorders){ctx.fillStyle=config.legendFillColor;ctx.setLineDash(lineStyleFn(config.legendBordersStyle));ctx.lineWidth=Math.ceil(ctx.chartLineScale*config.legendBordersWidth);ctx.strokeStyle=config.legendBordersColors;ctx.drawRectangle({x:legendMsr.xLegendPos+legendMsr.legendBorderXPos,y:legendMsr.yLegendPos+legendMsr.legendBorderYPos,width:legendMsr.legendBorderWidth,height:legendMsr.legendBorderHeight,borders:true,bordersWidth:Math.ceil(ctx.chartLineScale*config.legendBordersWidth),borderSelection:config.legendBordersSelection,borderRadius:config.legendBordersRadius,fill:false,stroke:true})}ctx.setLineDash([]);ctx.restore();var xpos,ypos,fromi,orderi,i,tpof,lgtxt,nbcols;var lgdbox=legendMsr.legendBox;nbcols=legendMsr.nbLegendCols-1;var yFirstLegendTextPos=legendMsr.yLegendPos+legendMsr.legendFirstTextYPos+legendMsr.highestLegend;var xFirstLegendTextPos=legendMsr.xLegendPos+legendMsr.legendFirstTextXPos;ypos=yFirstLegendTextPos-(Math.ceil(ctx.chartTextScale*config.legendFontSize)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextVertical));xpos=0;fromi=data.datasets.length;for(i=fromi-1;i>=0;i--){orderi=i;if(legendMsr.reverseLegend){orderi=data.datasets.length-i-1}tpof=typeof data.datasets[orderi].title;if(tpof=="string"){lgtxt=fmtChartJS(config,data.datasets[orderi].title,config.fmtLegend).trim();if(lgtxt!=""){nbcols++;if(nbcols==legendMsr.nbLegendCols){nbcols=0;xpos=xFirstLegendTextPos;ypos+=Math.ceil(ctx.chartTextScale*config.legendFontSize)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextVertical)}else{xpos+=legendMsr.widestLegend+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal)}ctx.save();ctx.beginPath();if(ctx.tpchart=="Bar"||ctx.tpchart=="StackedBar")if(data.datasets[orderi].type=="Line"&&(!config.datasetFill||setOptionValue(true,false,1,"LINKTYPE",ctx,data,undefined,data.datasets[orderi].linkType,config.linkType,"linkType",orderi,-1,{nullvalue:null})==1))lgdbox=false;if(lgdbox){ctx.lineWidth=Math.ceil(ctx.chartLineScale*setOptionValue(true,false,1,"LINEWIDTH",ctx,data,undefined,data.datasets[orderi].datasetStrokeWidth,config.datasetStrokeWidth,"datasetStrokeWidth",orderi,-1,{nullvalue:null}));ctx.beginPath();ctx.strokeStyle=setOptionValue(true,false,1,"LEGENDSTROKECOLOR",ctx,data,undefined,data.datasets[orderi].strokeColor,config.defaultFillColor,"strokeColor",orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),yPosTop:ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)});ctx.setLineDash(lineStyleFn(setOptionValue(true,false,1,"LEGENDLINEDASH",ctx,data,undefined,data.datasets[orderi].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),yPosTop:ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)})));ctx.moveTo(xpos,ypos);ctx.lineTo(xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),ypos);ctx.lineTo(xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize));ctx.lineTo(xpos,ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize));ctx.lineTo(xpos,ypos);ctx.stroke();ctx.closePath();ctx.fillStyle=setOptionValue(true,false,1,"LEGENDFILLCOLOR",ctx,data,undefined,data.datasets[orderi].fillColor,config.defaultFillColor,"fillColor",orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),yPosTop:ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)});ctx.fill()}else{ctx.lineWidth=config.legendColorIndicatorStrokeWidth?config.legendColorIndicatorStrokeWidth:Math.ceil(ctx.chartLineScale*setOptionValue(true,false,1,"LINEWIDTH",ctx,data,undefined,data.datasets[orderi].datasetStrokeWidth,config.datasetStrokeWidth,"datasetStrokeWidth",orderi,-1,{nullvalue:null}));if(config.legendColorIndicatorStrokeWidth&&config.legendColorIndicatorStrokeWidth>Math.ceil(ctx.chartTextScale*config.legendFontSize)){ctx.lineWidth=Math.ceil(ctx.chartTextScale*config.legendFontSize)}ctx.strokeStyle=setOptionValue(true,false,1,"LEGENDSTROKECOLOR",ctx,data,undefined,data.datasets[orderi].strokeColor,config.defaultFillColor,"strokeColor",orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),yPosTop:ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)});ctx.setLineDash(lineStyleFn(setOptionValue(true,false,1,"LEGENDLINEDASH",ctx,data,undefined,data.datasets[orderi].datasetStrokeStyle,config.datasetStrokeStyle,"datasetStrokeStyle",orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize),yPosTop:ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)})));ctx.moveTo(xpos+2,ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)/2);ctx.lineTo(xpos+2+Math.ceil(ctx.chartTextScale*config.legendBlockSize),ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)/2);ctx.stroke();ctx.fill();if(config.pointDot){ctx.beginPath();ctx.fillStyle=setOptionValue(true,false,1,"LEGENDMARKERFILLCOLOR",ctx,data,undefined,data.datasets[orderi].pointColor,config.defaultStrokeColor,"pointColor",orderi,-1,{nullvalue:true});ctx.strokeStyle=setOptionValue(true,false,1,"LEGENDMARKERSTROKESTYLE",ctx,data,undefined,data.datasets[orderi].pointStrokeColor,config.defaultStrokeColor,"pointStrokeColor",orderi,-1,{nullvalue:true});ctx.lineWidth=setOptionValue(true,false,ctx.chartLineScale,"LEGENDMARKERLINEWIDTH",ctx,data,undefined,data.datasets[orderi].pointDotStrokeWidth,config.pointDotStrokeWidth,"pointDotStrokeWidth",orderi,-1,{nullvalue:true});var markerShape=setOptionValue(true,false,1,"LEGENDMARKERSHAPE",ctx,data,undefined,data.datasets[orderi].markerShape,config.markerShape,"markerShape",orderi,-1,{nullvalue:true});var markerRadius=setOptionValue(true,false,ctx.chartSpaceScale,"LEGENDMARKERRADIUS",ctx,data,undefined,data.datasets[orderi].pointDotRadius,config.pointDotRadius,"pointDotRadius",orderi,-1,{nullvalue:true});var markerStrokeStyle=setOptionValue(true,false,1,"LEGENDMARKERSTROKESTYLE",ctx,data,undefined,data.datasets[orderi].pointDotStrokeStyle,config.pointDotStrokeStyle,"pointDotStrokeStyle",orderi,-1,{nullvalue:true});drawMarker(ctx,xpos+2+Math.ceil(ctx.chartTextScale*config.legendBlockSize)/2,ypos-Math.ceil(ctx.chartTextScale*config.legendFontSize)/2,markerShape,markerRadius,markerStrokeStyle)}ctx.fill()}ctx.restore();ctx.save();ctx.beginPath();ctx.font=config.legendFontStyle+" "+Math.ceil(ctx.chartTextScale*config.legendFontSize).toString()+"px "+config.legendFontFamily;ctx.fillStyle=setOptionValue(true,false,1,"LEGENDFONTCOLOR",ctx,data,undefined,undefined,config.legendFontColor,"legendFontColor",orderi,-1,{nullvalue:true});ctx.textAlign="left";ctx.textBaseline="bottom";ctx.translate(xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenBoxAndText),ypos);ctx.fillTextMultiLine(lgtxt,0,0,ctx.textBaseline,Math.ceil(ctx.chartTextScale*config.legendFontSize),true,config.detectMouseOnText,ctx,"LEGEND_TEXTMOUSE",0,xpos+Math.ceil(ctx.chartTextScale*config.legendBlockSize)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenBoxAndText),ypos,orderi,-1);ctx.restore()}}}}function measureLegend(data,ctx,config,widestLegend,highestLegend,nbLegendLines,nbLegendCols,availableLegendWidth){var legendWidth=0;var legendHeight=0;var legendBackgroundColorWidth=0;var legendBackgroundColorHeight=0;var legendBorderWidth=0;var legendBorderHeight=0;var legendFirstTextXPos=0;var legendFirstTextYPos=0;var legendBackgroundColorXPos=0;var legendBackgroundColorYPos=0;var legendBorderXPos=0;var legendBorderYPos=0;legendBackgroundColorHeight=nbLegendLines*(highestLegend+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextVertical))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextVertical)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBeforeText)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceAfterText);legendBackgroundColorWidth=nbLegendCols*(widestLegend+Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal))-Math.ceil(ctx.chartSpaceScale*config.legendSpaceBetweenTextHorizontal)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceLeftText)+Math.ceil(ctx.chartSpaceScale*config.legendSpaceRightText);legendHeight=legendBackgroundColorHeight;legendWidth=legendBackgroundColorWidth;legendFirstTextXPos=Math.ceil(ctx.chartSpaceScale*config.legendSpaceLeftText);legendFirstTextYPos=Math.ceil(ctx.chartSpaceScale*config.legendSpaceBeforeText);if(config.legendBorders==true){legendBorderWidth=legendWidth;legendBorderHeight=legendHeight;if(isBorder(config.legendBordersSelection,"LEFT")){legendBorderWidth+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)/2;legendWidth+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendFirstTextXPos+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendBorderXPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft)+Math.ceil(ctx.chartLineScale*config.legendBordersWidth)/2;legendBackgroundColorXPos+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft)}else if(config.legendFillColor!="rgba(0,0,0,0)"){legendWidth+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendFirstTextXPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendBackgroundColorXPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendBorderXPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft)}if(isBorder(config.legendBordersSelection,"RIGHT")){legendBorderWidth+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)/2;legendWidth+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceRight)}else if(config.legendFillColor!="rgba(0,0,0,0)"){legendWidth+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceRight)}if(isBorder(config.legendBordersSelection,"TOP")){legendBorderHeight+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)/2;legendHeight+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendFirstTextYPos+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendBackgroundColorYPos+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendBorderYPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore)+Math.ceil(ctx.chartLineScale*config.legendBordersWidth)/2}else if(config.legendFillColor!="rgba(0,0,0,0)"){legendHeight+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendFirstTextYPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendBackgroundColorYPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendBorderYPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore)}if(isBorder(config.legendBordersSelection,"BOTTOM")){legendBorderHeight+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)/2;legendHeight+=Math.ceil(ctx.chartLineScale*config.legendBordersWidth)+Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceAfter)}else if(config.legendFillColor!="rgba(0,0,0,0)"){legendHeight+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceAfter)}}else if(config.legendFillColor!="rgba(0,0,0,0)"){legendWidth+=Math.ceil(ctx.chartSpaceScale*(config.legendBordersSpaceRight+config.legendBordersSpaceLeft));legendHeight+=Math.ceil(ctx.chartSpaceScale*(config.legendBordersSpaceBefore+config.legendBordersSpaceAfter));legendBackgroundColorXPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendBackgroundColorYPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore);legendFirstTextXPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceLeft);legendFirstTextYPos+=Math.ceil(ctx.chartSpaceScale*config.legendBordersSpaceBefore)}return{legendWidth:legendWidth,legendHeight:legendHeight,legendBackgroundColorWidth:legendBackgroundColorWidth,legendBackgroundColorHeight:legendBackgroundColorHeight,legendBorderWidth:legendBorderWidth,legendBorderHeight:legendBorderHeight,legendFirstTextXPos:legendFirstTextXPos,legendFirstTextYPos:legendFirstTextYPos,legendBackgroundColorXPos:legendBackgroundColorXPos,legendBackgroundColorYPos:legendBackgroundColorYPos,legendBorderXPos:legendBorderXPos,legendBorderYPos:legendBorderYPos,elementMsr:null}}function drawMarker(ctx,xpos,ypos,marker,markersize,markerStrokeStyle){ctx.setLineDash(lineStyleFn(markerStrokeStyle));switch(marker){case"square":ctx.rect(xpos-markersize,ypos-markersize,2*markersize,2*markersize);ctx.stroke();ctx.fill();ctx.setLineDash([]);break;case"triangle":pointA_x=0;pointA_y=2/3*markersize;ctx.moveTo(xpos,ypos-pointA_y);ctx.lineTo(xpos+pointA_y*Math.sin(4/3),ypos+pointA_y*Math.cos(4/3));ctx.lineTo(xpos-pointA_y*Math.sin(4/3),ypos+pointA_y*Math.cos(4/3));ctx.lineTo(xpos,ypos-pointA_y);ctx.stroke();ctx.fill();ctx.setLineDash([]);break;case"diamond":ctx.moveTo(xpos,ypos+markersize);ctx.lineTo(xpos+markersize,ypos);ctx.lineTo(xpos,ypos-markersize);ctx.lineTo(xpos-markersize,ypos);ctx.lineTo(xpos,ypos+markersize);ctx.stroke();ctx.fill();ctx.setLineDash([]);break;case"plus":ctx.moveTo(xpos,ypos-markersize);ctx.lineTo(xpos,ypos+markersize);ctx.moveTo(xpos-markersize,ypos);ctx.lineTo(xpos+markersize,ypos);ctx.stroke();ctx.setLineDash([]);break;case"cross":ctx.moveTo(xpos-markersize,ypos-markersize);ctx.lineTo(xpos+markersize,ypos+markersize);ctx.moveTo(xpos-markersize,ypos+markersize);ctx.lineTo(xpos+markersize,ypos-markersize);ctx.stroke();ctx.setLineDash([]);break;case"circle":default:ctx.arc(xpos,ypos,markersize,0,2*Math.PI*1,true);ctx.stroke();ctx.fill();ctx.setLineDash([]);break}}function initPassVariableData_part1(data,config,ctx){var i,j,result,mxvalue,mnvalue,cumvalue,totvalue,lmaxvalue,lminvalue,lgtxt,lgtxt2,tp,prevpos,firstNotMissingi,lastNotMissingi,firstNotMissingj,lastNotMissingj,grandtotal;var startAngle,segmentAngle,cumulativeAngle,realCumulativeAngle;var MstartAngle,McumulativeAngle,MrealCumulativeAngle;var startRadius,stopRadius;var axis;result=[];mxvalue=[];mxvalue[0]=[];mxvalue[1]=[];mnvalue=[];mnvalue[0]=[];mnvalue[1]=[];cumvalue=[];cumvalue[0]=[];cumvalue[1]=[];totvalue=[];totvalue[0]=[];totvalue[1]=[];lmaxvalue=[];lmaxvalue[0]=[];lmaxvalue[1]=[];lminvalue=[];lminvalue[0]=[];lminvalue[1]=[];prevpos=[];firstNotMissingi=[];lastNotMissingi=[];firstNotMissingj=[];lastNotMissingj=[];prevpos[0]=[];prevpos[1]=[];grandtotal=0;MstartAngle=[];McumulativeAngle=[];MrealCumulativeAngle=[];startRadius=[];stopRadius=[];switch(ctx.tpchart){case"PolarArea":var notemptyval,prevnotemptyval;notemptyval=[];prevnotemptyval=[];for(i=0;i<data.datasets.length;i++){for(j=0;j<data.labels.length;j++){if(i==0)notemptyval[j]=0;if(typeof data.datasets[i].data[j]!="undefined")notemptyval[j]++}}var maxnotemptyval=0;var nbnotemptyval=0;for(j=0;j<data.labels.length;j++){prevnotemptyval[j]=nbnotemptyval;maxnotemptyval=Math.max(notemptyval[j],maxnotemptyval);if(notemptyval[j]>0)nbnotemptyval++;startRadius[j]=0;stopRadius[j]=1}var totWeight=1;break;case"Doughnut":case"Pie":var totWeight=0;var debPos=0;var vl1,vl2;for(j=0;j<data.labels.length;j++){vl1=setOptionValue(true,true,1,"RADIUSSPACEWEIGHT",ctx,data,null,data.radiusSpaceWeight,config.radiusSpaceWeight,"radiusSpaceWeight",j,-1,{nullvalue:null});vl2=setOptionValue(true,true,1,"RADIUSDATAWEIGHT",ctx,data,null,data.radiusDataWeight,config.radiusDataWeight,"radiusDataWeight",j,-1,{nullvalue:null});if(j!=0){debPos+=vl1;totWeight+=vl1}startRadius[j]=debPos;totWeight+=vl2;stopRadius[j]=totWeight;debPos+=vl2}break;default:break}for(i=0;i<data.datasets.length;i++){if(typeof data.datasets[i].xPos!="undefined"&&tpdraw(ctx,data.datasets[i])=="Line"){for(j=data.datasets[i].data.length;j<data.datasets[i].xPos.length;j++)data.datasets[i].data.push(undefined)}else{for(j=data.datasets[i].data.length;j<data.labels.length;j++)data.datasets[i].data.push(undefined)}if(data.datasets[i].axis==2)axis=0;else axis=1;result[i]=[];lmaxvalue[0][i]=-Number.MAX_VALUE;lmaxvalue[1][i]=-Number.MAX_VALUE;lminvalue[0][i]=Number.MAX_VALUE;lminvalue[1][i]=Number.MAX_VALUE;firstNotMissingi[i]=-1;lastNotMissingi[i]=-1;for(j=0;j<data.datasets[i].data.length;j++){if(typeof firstNotMissingj[j]=="undefined"){firstNotMissingj[j]=-1;lastNotMissingj[j]=-1;totvalue[0][j]=0;mxvalue[0][j]=-Number.MAX_VALUE;mnvalue[0][j]=Number.MAX_VALUE;totvalue[1][j]=0;mxvalue[1][j]=-Number.MAX_VALUE;mnvalue[1][j]=Number.MAX_VALUE}var todisplay=true;if(ctx.tpchart=="Doughnut"){if(setOptionValue(false,true,1,"DISPLAYDATA",ctx,data,null,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)todisplay=false;if(setOptionValue(false,true,1,"DISPLAYDATA",ctx,data,null,data.displayData,config.displayData,"displayData",-1,j,{nullvalue:null})==false)todisplay=false}else{if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,null,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)todisplay=false;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,null,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)todisplay=false}if(typeof data.datasets[i].data[j]=="undefined")todisplay=false;if(todisplay==true){grandtotal+=1*data.datasets[i].data[j];if(firstNotMissingi[i]==-1)firstNotMissingi[i]=j;lastNotMissingi[i]=j;if(firstNotMissingj[j]==-1)firstNotMissingj[j]=i;lastNotMissingj[j]=i;totvalue[axis][j]+=1*data.datasets[i].data[j];mxvalue[axis][j]=Math.max(mxvalue[axis][j],1*data.datasets[i].data[j]);mnvalue[axis][j]=Math.min(mnvalue[axis][j],1*data.datasets[i].data[j]);lmaxvalue[axis][i]=Math.max(lmaxvalue[axis][i],1*data.datasets[i].data[j]);lminvalue[axis][i]=Math.min(lminvalue[axis][i],1*data.datasets[i].data[j])}}}for(i=0;i<data.datasets.length;i++){if(data.datasets[i].axis==2)axis=0;else axis=1;if(typeof data.datasets[i].title=="string")lgtxt=data.datasets[i].title.trim();else lgtxt="";var prevnotemptyj=-1;var prevemptyj=-1;for(j=0;j<data.datasets[i].data.length;j++){if(typeof cumvalue[0][j]=="undefined"){cumvalue[0][j]=0;prevpos[0][j]=-1;cumvalue[1][j]=0;prevpos[1][j]=-1}lgtxt2="";if(typeof data.datasets[i].xPos!="undefined"){if(!(typeof data.datasets[i].xPos[j]=="undefined"))lgtxt2=data.datasets[i].xPos[j]}if(lgtxt2==""&&!(typeof data.labels[j]=="undefined"))lgtxt2=data.labels[j];if(typeof lgtxt2=="string")lgtxt2=lgtxt2.trim();var todisplay=true;if(tpdraw(ctx,data.datasets[i])=="Line"){if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,null,data.datasets[i].displayData,config.displayData,"displayData",i,j,{nullvalue:null})==false)todisplay=false;if(setOptionValue(true,true,1,"DISPLAYDATA",ctx,data,null,data.displayData,config.displayData,"displayData",j,-1,{nullvalue:null})==false)todisplay=false}if(typeof data.datasets[i].data[j]=="undefined")todisplay=false;if(todisplay){cumvalue[axis][j]+=1*data.datasets[i].data[j];switch(tpdraw(ctx,data.datasets[i])){case"PolarArea":case"Doughnut":case"Pie":if(i==0){if(j==0){var realAmplitude=((config.totalAmplitude*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(realAmplitude<=config.zeroValue)realAmplitude=2*Math.PI}McumulativeAngle[j]=((-config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);MrealCumulativeAngle[j]=((config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(ctx.tpchart=="PolarArea"){McumulativeAngle[j]+=prevnotemptyval[j]*(realAmplitude/nbnotemptyval);MrealCumulativeAngle[j]-=prevnotemptyval[j]*(realAmplitude/nbnotemptyval)}MstartAngle[j]=McumulativeAngle[j]}if(ctx.tpchart=="PolarArea"){if(notemptyval[j]>0)segmentAngle=realAmplitude/nbnotemptyval/notemptyval[j];else segmentAngle=0}else segmentAngle=1*data.datasets[i].data[j]/totvalue[axis][j]*realAmplitude;if(segmentAngle>=Math.PI*2)segmentAngle=Math.PI*2-.001;result[i][j]={config:config,v1:fmtChartJS(config,lgtxt,config.fmtV1),v2:fmtChartJS(config,lgtxt2,config.fmtV2),v3:fmtChartJS(config,1*data.datasets[i].data[j],config.fmtV3),v4:fmtChartJS(config,cumvalue[axis][j],config.fmtV4),v5:fmtChartJS(config,totvalue[axis][j],config.fmtV5),v6:roundToWithThousands(config,fmtChartJS(config,100*data.datasets[i].data[j]/totvalue[axis][j],config.fmtV6),config.roundPct),v6T:roundToWithThousands(config,fmtChartJS(config,100*data.datasets[i].data[j]/grandtotal,config.fmtV6T),config.roundPct),v7:0,v8:0,v9:0,v10:0,v11:fmtChartJS(config,i,config.fmtV11),v12:fmtChartJS(config,j,config.fmtV12),v13:fmtChartJS(config,segmentAngle,config.fmtV13),v14:fmtChartJS(config,McumulativeAngle[j],config.fmtV14),v15:fmtChartJS(config,McumulativeAngle[j]+segmentAngle,config.fmtV15),lgtxt:lgtxt,lgtxt2:lgtxt2,datavalue:1*data.datasets[i].data[j],cumvalue:cumvalue[axis][j],totvalue:totvalue[axis][j],pctvalue:100*data.datasets[i].data[j]/totvalue[axis][j],pctvalueT:100*data.datasets[i].data[j]/grandtotal,maxvalue:mxvalue[axis][j],minvalue:mnvalue[axis][j],lmaxvalue:lmaxvalue[axis][i],lminvalue:lminvalue[axis][i],grandtotal:grandtotal,firstNotMissing:firstNotMissingj[j],lastNotMissing:lastNotMissingj[j],prevNotMissing:prevnotemptyj,prevMissing:prevemptyj,nextNotMissing:-1,segmentAngle:segmentAngle,firstAngle:MstartAngle[j],startAngle:McumulativeAngle[j],realStartAngle:MrealCumulativeAngle[j],endAngle:McumulativeAngle[j]+segmentAngle,radiusOffset:0,midPosX:0,midPosY:0,int_radius:0,ext_radius:0,startRadius:startRadius[j]/totWeight,stopRadius:stopRadius[j]/totWeight,totRadiusWeight:totWeight,j:j,i:i,data:data};McumulativeAngle[j]=McumulativeAngle[j]+segmentAngle;MrealCumulativeAngle[j]=MrealCumulativeAngle[j]-segmentAngle;break;case"Bar":case"StackedBar":case"HorizontalBar":case"HorizontalStackedBar":result[i][j]={config:config,v1:fmtChartJS(config,lgtxt,config.fmtV1),v2:fmtChartJS(config,lgtxt2,config.fmtV2),v3:fmtChartJS(config,1*data.datasets[i].data[j],config.fmtV3),v4:fmtChartJS(config,cumvalue[axis][j],config.fmtV4),v5:fmtChartJS(config,totvalue[axis][j],config.fmtV5),v6:roundToWithThousands(config,fmtChartJS(config,100*data.datasets[i].data[j]/totvalue[axis][j],config.fmtV6),config.roundPct),v6T:roundToWithThousands(config,fmtChartJS(config,100*data.datasets[i].data[j]/grandtotal,config.fmtV6T),config.roundPct),v11:fmtChartJS(config,i,config.fmtV11),v12:fmtChartJS(config,j,config.fmtV12),lgtxt:lgtxt,lgtxt2:lgtxt2,datavalue:1*data.datasets[i].data[j],cumvalue:cumvalue[axis][j],totvalue:totvalue[axis][j],pctvalue:100*data.datasets[i].data[j]/totvalue[axis][j],pctvalueT:100*data.datasets[i].data[j]/grandtotal,maxvalue:mxvalue[axis][j],minvalue:mnvalue[axis][j],lmaxvalue:lmaxvalue[axis][i],lminvalue:lminvalue[axis][i],grandtotal:grandtotal,firstNotMissing:firstNotMissingj[j],lastNotMissing:lastNotMissingj[j],prevNotMissing:prevnotemptyj,prevMissing:prevemptyj,nextNotMissing:-1,j:j,i:i,data:data};if(1*data.datasets[i].data[j]==0&&(tpdraw(ctx,data.datasets[i])=="HorizontalStackedBar"||tpdraw(ctx,data.datasets[i])=="StackedBar"))result[i][j].v3="";break;case"Line":case"Radar":result[i][j]={config:config,v1:fmtChartJS(config,lgtxt,config.fmtV1),v2:fmtChartJS(config,lgtxt2,config.fmtV2),v3:fmtChartJS(config,1*data.datasets[i].data[j],config.fmtV3),v5:fmtChartJS(config,1*data.datasets[i].data[j],config.fmtV5),v6:fmtChartJS(config,mxvalue[axis][j],config.fmtV6),v7:fmtChartJS(config,totvalue[axis][j],config.fmtV7),v8:roundToWithThousands(config,fmtChartJS(config,100*data.datasets[i].data[j]/totvalue[axis][j],config.fmtV8),config.roundPct),v8T:roundToWithThousands(config,fmtChartJS(config,100*data.datasets[i].data[j]/grandtotal,config.fmtV8T),config.roundPct),v11:fmtChartJS(config,i,config.fmtV11),v12:fmtChartJS(config,j,config.fmtV12),lgtxt:lgtxt,lgtxt2:lgtxt2,datavalue:1*data.datasets[i].data[j],diffnext:1*data.datasets[i].data[j],pctvalue:100*data.datasets[i].data[j]/totvalue[axis][j],pctvalueT:100*data.datasets[i].data[j]/grandtotal,totvalue:totvalue[axis][j],cumvalue:cumvalue[axis][j],maxvalue:mxvalue[axis][j],minvalue:mnvalue[axis][j],lmaxvalue:lmaxvalue[axis][i],lminvalue:lminvalue[axis][i],grandtotal:grandtotal,firstNotMissing:firstNotMissingi[i],lastNotMissing:lastNotMissingi[i],prevNotMissing:prevnotemptyj,prevMissing:prevemptyj,nextNotMissing:-1,j:j,i:i,data:data};if(prevpos[axis][j]>=0){result[i][j].v4=fmtChartJS(config,prevpos[axis][j]!=-1?1*data.datasets[i].data[j]-result[prevpos[axis][j]][j].datavalue:1*data.datasets[i].data[j],config.fmtV4);result[i][j].diffprev=prevpos[axis][j]!=-1?1*data.datasets[i].data[j]-result[prevpos[axis][j]][j].datavalue:1*data.datasets[i].data[j];result[prevpos[axis][j]][j].diffnext=data.datasets[prevpos[axis][j]].data[j]-data.datasets[i].data[j];result[prevpos[axis][j]][j].v5=result[prevpos[axis][j]][j].diffnext}else{result[i][j].v4=1*data.datasets[i].data[j]}prevpos[axis][j]=i;break;default:break}if(prevnotemptyj!=-1){for(k=prevnotemptyj;k<j;k++)result[i][k].nextNotMissing=j}prevnotemptyj=j}else{prevemptyj=j;switch(tpdraw(ctx,data.datasets[i])){case"PolarArea":case"Doughnut":case"Pie":if(i==0){if(j==0){var realAmplitude=((config.totalAmplitude*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(realAmplitude<=config.zeroValue)realAmplitude=2*Math.PI}McumulativeAngle[j]=((-config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);MrealCumulativeAngle[j]=((config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(ctx.tpchart=="PolarArea"){McumulativeAngle[j]+=prevnotemptyval[j]*(realAmplitude/nbnotemptyval);MrealCumulativeAngle[j]-=prevnotemptyval[j]*(realAmplitude/nbnotemptyval)}MstartAngle[j]=McumulativeAngle[j]}case"Bar":case"StackedBar":case"HorizontalBar":case"HorizontalStackedBar":result[i][j]={v1:lgtxt,lmaxvalue:lmaxvalue[axis][i],lminvalue:lminvalue[axis][i],firstNotMissing:firstNotMissingj[j],lastNotMissing:lastNotMissingj[j],prevNotMissing:prevnotemptyj,prevMissing:prevemptyj,grandtotal:grandtotal};break;case"Line":case"Radar":result[i][j]={v1:lgtxt,lmaxvalue:lmaxvalue[axis][i],lminvalue:lminvalue[axis][i],firstNotMissing:firstNotMissingi[i],lastNotMissing:lastNotMissingi[i],prevNotMissing:prevnotemptyj,prevMissing:prevemptyj,grandtotal:grandtotal};break}}}}return result}function initPassVariableData_part2(statData,data,config,ctx,othervars){var realbars=0;var i,j;var tempp=new Array(data.datasets.length);var tempn=new Array(data.datasets.length);for(i=0;i<data.datasets.length;i++){switch(tpdraw(ctx,data.datasets[i])){case"PolarArea":case"Pie":case"Doughnut":for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].v7=fmtChartJS(config,othervars.midPosX,config.fmtV7);statData[i][j].v8=fmtChartJS(config,othervars.midPosY,config.fmtV8),statData[i][j].v9=fmtChartJS(config,othervars.int_radius+(othervars.ext_radius-othervars.int_radius)*statData[i][j].startRadius,config.fmtV9);statData[i][j].v10=fmtChartJS(config,othervars.int_radius+(othervars.ext_radius-othervars.int_radius)*statData[i][j].stopRadius,config.fmtV10);if(ctx.tpchart=="PolarArea"){statData[i][j].radiusOffset=calculateOffset(config.logarithmic,1*data.datasets[i].data[j],othervars.calculatedScale,othervars.scaleHop);statData[i][j].v10=fmtChartJS(config,statData[i].radiusOffset,config.fmtV10)}else{statData[i][j].v10=fmtChartJS(config,othervars.ext_radius,config.fmtV10);statData[i][j].radiusOffset=othervars.int_radius+(othervars.ext_radius-othervars.int_radius)*statData[i][j].stopRadius}statData[i][j].outerVal=othervars.outerVal;statData[i][j].midPosX=othervars.midPosX;statData[i][j].midPosY=othervars.midPosY;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].scaleHop=othervars.scaleHop;statData[i][j].int_radius=othervars.int_radius+(othervars.ext_radius-othervars.int_radius)*statData[i][j].startRadius;statData[i][j].ext_radius=othervars.int_radius+(othervars.ext_radius-othervars.int_radius)*statData[i][j].stopRadius}break;case"Line":for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].xAxisPosY=othervars.xAxisPosY;statData[i][j].yAxisPosX=othervars.yAxisPosX;statData[i][j].valueHop=othervars.valueHop;statData[i][j].nbValueHop=othervars.nbValueHop;if(data.datasets[i].axis==2){statData[i][j].scaleHop=othervars.scaleHop2;statData[i][j].zeroY=othervars.zeroY2;statData[i][j].calculatedScale=othervars.calculatedScale2;statData[i][j].logarithmic=othervars.logarithmic2}else{statData[i][j].scaleHop=othervars.scaleHop;statData[i][j].zeroY=othervars.zeroY;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].logarithmic=othervars.logarithmic}statData[i][j].xPos=xPos(i,j,data,othervars.yAxisPosX,othervars.valueHop,othervars.nbValueHop);statData[i][j].yAxisPos=othervars.xAxisPosY-statData[i][j].zeroY;if(ctx.tpchart=="Bar"||ctx.tpchart=="StackedBar"){statData[i][j].xPos+=othervars.valueHop/2;statData[i][j].yAxisPosX+=othervars.valueHop/2}if(j==0){statData[i][j].lmaxvalue_offset=calculateOffset(statData[i][j].logarithmic,statData[i][j].lmaxvalue,statData[i][j].calculatedScale,statData[i][j].scaleHop)-statData[i][j].zeroY;statData[i][j].lminvalue_offset=calculateOffset(statData[i][j].logarithmic,statData[i][j].lminvalue,statData[i][j].calculatedScale,statData[i][j].scaleHop)-statData[i][j].zeroY}else{statData[i][j].lmaxvalue_offset=statData[i][0].lmaxvalue_offset;statData[i][j].lminvalue_offset=statData[i][0].lminvalue_offset}if(!(typeof data.datasets[i].data[j]=="undefined")){statData[i][j].yPosOffset=calculateOffset(statData[i][j].logarithmic,data.datasets[i].data[j],statData[i][j].calculatedScale,statData[i][j].scaleHop)-statData[i][j].zeroY;statData[i][j].posY=statData[i][j].yAxisPos-statData[i][j].yPosOffset}if(typeof data.datasets[i].origin=="object"){if(!(typeof data.datasets[i].origin[j]=="undefined")){statData[i][j].yPosOffsetOrigin=calculateOffset(statData[i][j].logarithmic,data.datasets[i].origin[j],statData[i][j].calculatedScale,statData[i][j].scaleHop)-statData[i][j].zeroY;statData[i][j].posYOrigin=statData[i][j].yAxisPos-statData[i][j].yPosOffsetOrigin}}statData[i][j].posX=statData[i][j].xPos;statData[i][j].v9=statData[i][j].xPos;statData[i][j].v10=statData[i][j].posY;statData[i][j].annotateStartPosX=statData[i][j].xPos;statData[i][j].annotateEndPosX=statData[i][j].xPos;statData[i][j].annotateStartPosY=othervars.xAxisPosY;statData[i][j].annotateEndPosY=othervars.xAxisPosY-othervars.msr.availableHeight;statData[i][j].D1A=undefined;statData[i][j].D1B=undefined}break;case"Radar":var rotationDegree=2*Math.PI/data.datasets[0].data.length;for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].midPosX=othervars.midPosX;statData[i][j].midPosY=othervars.midPosY;statData[i][j].int_radius=0;statData[i][j].ext_radius=othervars.maxSize;statData[i][j].radiusOffset=othervars.maxSize;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].scaleHop=othervars.scaleHop;statData[i][j].calculated_offset=calculateOffset(config.logarithmic,data.datasets[i].data[j],othervars.calculatedScale,othervars.scaleHop);statData[i][j].offsetX=Math.cos(config.startAngle*Math.PI/180-j*rotationDegree)*statData[i][j].calculated_offset;statData[i][j].offsetY=Math.sin(config.startAngle*Math.PI/180-j*rotationDegree)*statData[i][j].calculated_offset;statData[i][j].v9=statData[i][j].midPosX+statData[i][j].offsetX;statData[i][j].v10=statData[i][j].midPosY-statData[i][j].offsetY;statData[i][j].posX=statData[i][j].midPosX+statData[i][j].offsetX;statData[i][j].posY=statData[i][j].midPosY-statData[i][j].offsetY;if(j==0)statData[i][j].calculated_offset_max=calculateOffset(config.logarithmic,statData[i][j].lmaxvalue,othervars.calculatedScale,othervars.scaleHop);else statData[i][j].calculated_offset_max=statData[0][j].calculated_offset_max;statData[i][j].annotateStartPosX=othervars.midPosX;statData[i][j].annotateEndPosX=othervars.midPosX+Math.cos(config.startAngle*Math.PI/180-j*rotationDegree)*othervars.maxSize;statData[i][j].annotateStartPosY=othervars.midPosY;statData[i][j].annotateEndPosY=othervars.midPosY-Math.sin(config.startAngle*Math.PI/180-j*rotationDegree)*othervars.maxSize;if(Math.abs(statData[i][j].annotateStartPosX-statData[i][j].annotateEndPosX)<config.zeroValue){statData[i][j].D1A=undefined;statData[i][j].D1B=undefined;statData[i][j].D2A=0}else{statData[i][j].D1A=(statData[i][j].annotateStartPosY-statData[i][j].annotateEndPosY)/(statData[i][j].annotateStartPosX-statData[i][j].annotateEndPosX);statData[i][j].D1B=-statData[i][j].D1A*statData[i][j].annotateStartPosX+statData[i][j].annotateStartPosY;if(Math.abs(statData[i][j].D1A)>=config.zeroValue)statData[i][j].D2A=-(1/statData[i][j].D1A);else statData[i][j].D2A=undefined}}break;case"Bar":for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].xAxisPosY=othervars.xAxisPosY;statData[i][j].yAxisPosX=othervars.yAxisPosX;statData[i][j].valueHop=othervars.valueHop;statData[i][j].barWidth=othervars.barWidth;statData[i][j].additionalSpaceBetweenBars=othervars.additionalSpaceBetweenBars;statData[i][j].nbValueHop=othervars.nbValueHop;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].scaleHop=othervars.scaleHop;statData[i][j].xPosLeft=othervars.yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+othervars.valueHop*j+othervars.additionalSpaceBetweenBars+othervars.barWidth*realbars+Math.ceil(ctx.chartSpaceScale*config.barDatasetSpacing)*realbars+Math.ceil(ctx.chartLineScale*config.barStrokeWidth)*realbars;statData[i][j].xPosRight=statData[i][j].xPosLeft+othervars.barWidth;if(data.datasets[i].axis==2){statData[i][j].yPosBottom=othervars.xAxisPosY-othervars.zeroY2;statData[i][j].barHeight=calculateOffset(config.logarithmic2,1*data.datasets[i].data[j],othervars.calculatedScale2,othervars.scaleHop2)-othervars.zeroY2}else{statData[i][j].yPosBottom=othervars.xAxisPosY-othervars.zeroY;statData[i][j].barHeight=calculateOffset(config.logarithmic,1*data.datasets[i].data[j],othervars.calculatedScale,othervars.scaleHop)-othervars.zeroY}statData[i][j].yPosTop=statData[i][j].yPosBottom-statData[i][j].barHeight+Math.ceil(ctx.chartLineScale*config.barStrokeWidth)/2;statData[i][j].v7=statData[i][j].xPosLeft;statData[i][j].v8=statData[i][j].yPosBottom;statData[i][j].v9=statData[i][j].xPosRight;statData[i][j].v10=statData[i][j].yPosTop}realbars++;break;case"StackedBar":for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].xAxisPosY=othervars.xAxisPosY;statData[i][j].yAxisPosX=othervars.yAxisPosX;statData[i][j].valueHop=othervars.valueHop;statData[i][j].barWidth=othervars.barWidth;statData[i][j].additionalSpaceBetweenBars=othervars.additionalSpaceBetweenBars;statData[i][j].nbValueHop=othervars.nbValueHop;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].scaleHop=othervars.scaleHop;if(typeof tempp[j]=="undefined"){tempp[j]=0;tempn[j]=0;zeroY=calculateOffset(config.logarithmic,0,othervars.calculatedScale,othervars.scaleHop)}if(typeof data.datasets[i].data[j]=="undefined")continue;statData[i][j].xPosLeft=othervars.yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+othervars.valueHop*j+othervars.additionalSpaceBetweenBars;if(1*data.datasets[i].data[j]<0){statData[i][j].botval=tempn[j];statData[i][j].topval=tempn[j]+1*data.datasets[i].data[j];tempn[j]=tempn[j]+1*data.datasets[i].data[j]}else{statData[i][j].botval=tempp[j];statData[i][j].topval=tempp[j]+1*data.datasets[i].data[j];tempp[j]=tempp[j]+1*data.datasets[i].data[j]}statData[i][j].xPosRight=statData[i][j].xPosLeft+othervars.barWidth;statData[i][j].botOffset=calculateOffset(config.logarithmic,statData[i][j].botval,othervars.calculatedScale,othervars.scaleHop);statData[i][j].topOffset=calculateOffset(config.logarithmic,statData[i][j].topval,othervars.calculatedScale,othervars.scaleHop);statData[i][j].yPosBottom=othervars.xAxisPosY-statData[i][j].botOffset;statData[i][j].yPosTop=othervars.xAxisPosY-statData[i][j].topOffset;if(Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar)>0){if(1*data.datasets[i].data[j]<0){statData[i][j].yPosBottom+=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar);if(tempn[j]==1*data.datasets[i].data[j])statData[i][j].yPosBottom-=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar)/2;if(statData[i][j].yPosTop<statData[i][j].yPosBottom)statData[i][j].yPosBottom=statData[i][j].yPosTop}else if(1*data.datasets[i].data[j]>0){statData[i][j].yPosBottom-=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar);if(tempp[j]==1*data.datasets[i].data[j])statData[i][j].yPosBottom+=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar)/2;if(statData[i][j].yPosTop>statData[i][j].yPosBottom)statData[i][j].yPosBottom=statData[i][j].yPosTop}}statData[i][j].v7=statData[i][j].xPosLeft;statData[i][j].v8=statData[i][j].yPosBottom;statData[i][j].v9=statData[i][j].xPosRight;statData[i][j].v10=statData[i][j].yPosTop}break;case"HorizontalBar":for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].xAxisPosY=othervars.xAxisPosY;statData[i][j].yAxisPosX=othervars.yAxisPosX;statData[i][j].valueHop=othervars.valueHop;statData[i][j].barWidth=othervars.barWidth;statData[i][j].additionalSpaceBetweenBars=othervars.additionalSpaceBetweenBars;statData[i][j].nbValueHop=othervars.nbValueHop;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].scaleHop=othervars.scaleHop;statData[i][j].xPosLeft=othervars.yAxisPosX+othervars.zeroY;statData[i][j].yPosTop=othervars.xAxisPosY+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)-othervars.scaleHop*(j+1)+othervars.additionalSpaceBetweenBars+othervars.barWidth*i+Math.ceil(ctx.chartSpaceScale*config.barDatasetSpacing)*i+Math.ceil(ctx.chartLineScale*config.barStrokeWidth)*i;statData[i][j].yPosBottom=statData[i][j].yPosTop+othervars.barWidth;statData[i][j].barWidth=calculateOffset(config.logarithmic,1*data.datasets[i].data[j],othervars.calculatedScale,othervars.valueHop)-othervars.zeroY;statData[i][j].xPosRight=statData[i][j].xPosLeft+statData[i][j].barWidth;statData[i][j].v7=statData[i][j].xPosLeft;statData[i][j].v8=statData[i][j].yPosBottom;statData[i][j].v9=statData[i][j].xPosRight;statData[i][j].v10=statData[i][j].yPosTop}break;case"HorizontalStackedBar":for(j=0;j<data.datasets[i].data.length;j++){statData[i][j].xAxisPosY=othervars.xAxisPosY;statData[i][j].yAxisPosX=othervars.yAxisPosX;statData[i][j].valueHop=othervars.valueHop;statData[i][j].barWidth=othervars.barWidth;statData[i][j].additionalSpaceBetweenBars=othervars.additionalSpaceBetweenBars;statData[i][j].nbValueHop=othervars.nbValueHop;statData[i][j].calculatedScale=othervars.calculatedScale;statData[i][j].scaleHop=othervars.scaleHop;if(i==0){tempp[j]=0;tempn[j]=0}if(typeof data.datasets[i].data[j]=="undefined")continue;statData[i][j].xPosLeft=othervars.yAxisPosX+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)+othervars.valueHop*j;if(1*data.datasets[i].data[j]<0){statData[i][j].leftval=tempn[j];statData[i][j].rightval=tempn[j]+1*data.datasets[i].data[j];tempn[j]=tempn[j]+1*data.datasets[i].data[j]}else{statData[i][j].leftval=tempp[j];statData[i][j].rightval=tempp[j]+1*data.datasets[i].data[j];tempp[j]=tempp[j]+1*data.datasets[i].data[j]}statData[i][j].rightOffset=HorizontalCalculateOffset(statData[i][j].rightval,othervars.calculatedScale,othervars.valueHop);statData[i][j].leftOffset=HorizontalCalculateOffset(statData[i][j].leftval,othervars.calculatedScale,othervars.valueHop);statData[i][j].xPosRight=othervars.yAxisPosX+statData[i][j].rightOffset;statData[i][j].xPosLeft=othervars.yAxisPosX+statData[i][j].leftOffset;statData[i][j].yPosTop=othervars.xAxisPosY+Math.ceil(ctx.chartSpaceScale*config.barValueSpacing)-othervars.scaleHop*(j+1)+othervars.additionalSpaceBetweenBars;statData[i][j].yPosBottom=statData[i][j].yPosTop+othervars.barWidth;if(Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar)>0){if(1*data.datasets[i].data[j]<0){statData[i][j].xPosLeft-=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar);if(tempn[j]==1*data.datasets[i].data[j])statData[i][j].xPosLeft+=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar)/2;if(statData[i][j].xPosLeft<statData[i][j].xPosRight)statData[i][j].xPosLeft=statData[i][j].xPosRight}else if(1*data.datasets[i].data[j]>0){statData[i][j].xPosLeft+=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar);if(tempp[j]==1*data.datasets[i].data[j])statData[i][j].xPosLeft-=Math.ceil(ctx.chartSpaceScale*config.spaceBetweenBar)/2;if(statData[i][j].xPosLeft>statData[i][j].xPosRight)statData[i][j].xPosLeft=statData[i][j].xPosRight}}statData[i][j].v7=statData[i][j].xPosLeft;statData[i][j].v8=statData[i][j].yPosBottom;statData[i][j].v9=statData[i][j].xPosRight;statData[i][j].v10=statData[i][j].yPosTop}break;default:break}}function xPos(ival,iteration,data,yAxisPosX,valueHop,nbValueHop){if(typeof data.datasets[ival].xPos=="object"){if(!(typeof data.datasets[ival].xPos[Math.floor(iteration+config.zeroValue)]=="undefined")){var width=valueHop*nbValueHop;var deb=typeof data.xBegin!="undefined"?data.xBegin:1*data.labels[0];var fin=typeof data.xEnd!="undefined"?data.xEnd:1*data.labels[data.labels.length-1];if(fin<=deb)fin=deb+100;if(1*data.datasets[ival].xPos[Math.floor(iteration+config.zeroValue)]>=deb&&data.datasets[ival].xPos[Math.floor(iteration+config.zeroValue)]<=fin){var p1=yAxisPosX+width*((1*data.datasets[ival].xPos[Math.floor(iteration+config.zeroValue)]-deb)/(fin-deb));var p2=p1;if(Math.abs(iteration-Math.floor(iteration+config.zeroValue))>config.zeroValue){p2=xPos(ival,Math.ceil(iteration-config.zeroValue),data)}return p1+(iteration-Math.floor(iteration+config.zeroValue))*(p2-p1)}}}return yAxisPosX+valueHop*iteration}function calculateOrderOfMagnitude(val){return Math.floor(Math.log(val)/Math.LN10)}function calculateOffset(logarithmic,val,calculatedScale,scaleHop){if(!logarithmic){var outerValue=calculatedScale.steps*calculatedScale.stepValue;var adjustedValue=val-calculatedScale.graphMin;var scalingFactor=CapValue(adjustedValue/outerValue,1,0);return scaleHop*calculatedScale.steps*scalingFactor}else{return CapValue(log10(val)*scaleHop-log10(calculatedScale.graphMin)*scaleHop,undefined,0)}}function HorizontalCalculateOffset(val,calculatedScale,scaleHop){var outerValue=calculatedScale.steps*calculatedScale.stepValue;var adjustedValue=val-calculatedScale.graphMin;var scalingFactor=CapValue(adjustedValue/outerValue,1,0);return scaleHop*calculatedScale.steps*scalingFactor}function CapValue(valueToCap,maxValue,minValue){if(isNumber(maxValue)){if(valueToCap>maxValue){return maxValue}}if(isNumber(minValue)){if(valueToCap<minValue){return minValue}}return valueToCap}function log10(val){return Math.log(val)/Math.LN10}}function isBooleanOptionTrue(optionVar,defaultvalue){var j;if(typeof optionvar=="undefined"){if(typeof defaultvalue=="function")return true;else if(typeof defaultvalue=="object"){for(j=0;j<defaultvalue.length;j++)if(defaultvalue[j])return true;return false}else return defaultvalue}if(typeof optionvar=="function")return true;else if(typeof optionvar=="object"){for(j=0;j<optionvar.length;j++)if(optionvar[j])return true;return false}else return optionvar}function setOptionValue(config_on_posi,treat_special,rescale,reference,ctx,data,statData,optionvar,defaultvalue,varname,posi,posj,othervars){var rv;if(treat_special==true){if(typeof data.special=="object"){for(var t=data.special.length-1;t>=0;t--){if(typeof data.special[t].posi=="undefined"||typeof data.special[t].posj=="undefined")continue;if(data.special[t].posi!=posi||data.special[t].posj!=posj||posi==-1||posj==-1)continue;if(typeof data.special[t][varname]!="undefined"){return data.special[t][varname]}}}}if(typeof optionvar=="undefined"){if(typeof defaultvalue=="function")return defaultvalue(reference,ctx,data,statData,posi,posj,othervars);else if(typeof defaultvalue=="object"){if(config_on_posi)rv=defaultvalue[Math.min(defaultvalue.length-1,Math.max(0,posi))];else rv=defaultvalue[Math.min(defaultvalue.length-1,Math.max(0,posj))]}else{rv=defaultvalue}if(rescale!=1)rv=Math.ceil(rv*rescale);return rv}if(typeof optionvar=="function")rv=optionvar(reference,ctx,data,statData,posi,posj,othervars);else if(typeof optionvar=="object"){if(posj==-1)rv=optionvar[Math.min(optionvar.length-1,Math.max(0,posi))];else rv=optionvar[Math.min(optionvar.length-1,Math.max(0,posj))]}else rv=optionvar;if(rescale!=1)rv=Math.ceil(rv*rescale);return rv}function tpdraw(ctx,dataval){switch(ctx.tpchart){case"Bar":case"StackedBar":if(dataval.type=="Line"){tp="Line"}else{tp=ctx.tpchart}break;default:tp=ctx.tpchart;break}return tp}function setTextBordersAndBackground(ctx,text,fontsize,xpos,ypos,borders,bordersselection,borderscolor,borderswidth,bordersxspace,bordersyspace,bordersstyle,backgroundcolor,optiongroup,BordersRadius){var textHeight,textWidth;if(typeof text!="string"){var txt=text.toString();textHeight=fontsize*(txt.split("\n").length||1);textWidth=ctx.measureText(txt).width}else{textHeight=fontsize*(text.split("\n").length||1);textWidth=ctx.measureText(text).width}var xright,xleft,ytop,ybot;if(ctx.textAlign=="center"){xright=-textWidth/2;xleft=textWidth/2}else if(ctx.textAlign=="left"){xright=0;xleft=textWidth}else if(ctx.textAlign=="right"){xright=-textWidth;xleft=0}if(ctx.textBaseline=="top"){ytop=0;ybottom=textHeight}else if(ctx.textBaseline=="center"||ctx.textBaseline=="middle"){ytop=-textHeight/2;ybottom=textHeight/2}else if(ctx.textBaseline=="bottom"){ytop=-textHeight;ybottom=0}ctx.save();ctx.beginPath();ctx.translate(xpos,ypos);if(backgroundcolor!="none"){this.lineWidth=0;ctx.strokeStyle="rgba(0,0,0,0)";ctx.fillStyle=backgroundcolor;ctx.drawRectangle({x:xright-bordersxspace,y:ybottom+bordersyspace,width:xleft-xright+2*bordersxspace,height:ytop-ybottom-2*bordersyspace,borders:borders,bordersWidth:borderswidth,borderSelection:bordersselection,borderRadius:BordersRadius,fill:true,stroke:false})}if(borders){ctx.lineWidth=borderswidth;ctx.strokeStyle=borderscolor;if(backgroundcolor!="none")ctx.fillStyle=backgroundcolor;else ctx.fillStyle="rgba(0,0,0,0)";ctx.setLineDash(lineStyleFn(bordersstyle));ctx.drawRectangle({x:xright-bordersxspace-isBorder(bordersselection,"LEFT")*borderswidth/2,y:ybottom+bordersyspace+isBorder(bordersselection,"BOTTOM")*borderswidth/2,width:xleft-xright+2*bordersxspace+(isBorder(bordersselection,"LEFT")+isBorder(bordersselection,"RIGHT"))*borderswidth/2,height:-textHeight-2*bordersyspace-(isBorder(bordersselection,"BOTTOM")+isBorder(bordersselection,"TOP"))*borderswidth/2,borders:borders,bordersWidth:borderswidth,borderSelection:bordersselection,borderRadius:BordersRadius,fill:false,stroke:true});ctx.setLineDash([])}ctx.beginPath();ctx.restore()}function calculatePieDrawingSize(ctx,msr,config,data,statData){var realCumulativeAngle=((config.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var realAmplitude=((config.totalAmplitude*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(realAmplitude<=config.zeroValue)realAmplitude=2*Math.PI;var debAngle=(realCumulativeAngle-realAmplitude+4*Math.PI)%(2*Math.PI);var finAngle=debAngle+realAmplitude;var qposdeb=Math.floor((debAngle+config.zeroValue)/(Math.PI/2)%4);var qposfin=Math.floor((finAngle-config.zeroValue)/(Math.PI/2)%4);var q=[0,0,0,0];if(qposdeb<=qposfin)for(var i=qposdeb;i<=qposfin;i++)q[i]=1;else{for(var i=qposdeb;i<4;i++)q[i]=1;for(var i=0;i<=qposfin;i++)q[i]=1}if(q[0]==0&&q[1]==0){midPieY=msr.topNotUsableHeight+5;doughnutRadius=msr.availableHeight-5}else if(q[2]==0&&q[3]==0){midPieY=msr.topNotUsableHeight+msr.availableHeight;doughnutRadius=msr.availableHeight-5}else{midPieY=msr.topNotUsableHeight+msr.availableHeight/2;doughnutRadius=msr.availableHeight/2-5}var realAvailableWidth;if(q[0]==0&&q[3]==0){midPieX=msr.leftNotUsableWidth+msr.availableWidth-5;doughnutRadius=Math.min(doughnutRadius,msr.availableWidth-5);realAvailableWidth=msr.availableWidth-5}else if(q[1]==0&&q[2]==0){midPieX=msr.leftNotUsableWidth+5;doughnutRadius=Math.min(doughnutRadius,msr.availableWidth-5);realAvailableWidth=msr.availableWidth-5}else{midPieX=msr.leftNotUsableWidth+msr.availableWidth/2;doughnutRadius=Math.min(doughnutRadius,msr.availableWidth/2-5);realAvailableWidth=msr.availableWidth/2-5}var j=data.labels.length-1;if(isBooleanOptionTrue(undefined,config.inGraphDataShow)&&setOptionValue(false,true,1,"INGRAPHDATARADIUSPOSITION",ctx,data,statData,undefined,config.inGraphDataRadiusPosition,"inGraphDataRadiusPosition",0,j,{nullValue:true})==3&&setOptionValue(false,true,1,"INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,"inGraphDataAlign",0,j,{nullValue:true})=="off-center"&&setOptionValue(false,true,1,"INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,"inGraphDataRotate",0,j,{nullValue:true})==0){doughnutRadius=doughnutRadius-setOptionValue(false,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",0,j,{nullValue:true})-setOptionValue(false,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",0,j,{nullValue:true})-5;var posAngle;for(var i=0;i<data.datasets.length;i++){if(!(typeof data.datasets[i].data[j]=="undefined")&&1*data.datasets[i].data[j]>=0){ctx.font=setOptionValue(false,true,1,"INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,"inGraphDataFontStyle",i,j,{nullValue:true})+" "+setOptionValue(false,true,ctx.chartTextScale,"INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,"inGraphDataFontSize",i,j,{nullValue:true})+"px "+setOptionValue(false,true,1,"INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,"inGraphDataFontFamily",i,j,{nullValue:true});if(setOptionValue(false,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==1)posAngle=realCumulativeAngle+setOptionValue(false,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);else if(setOptionValue(false,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==2)posAngle=realCumulativeAngle-statData[i][j].segmentAngle/2+setOptionValue(false,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);else if(setOptionValue(false,true,1,"INGRAPHDATAANGLEPOSITION",ctx,data,statData,undefined,config.inGraphDataAnglePosition,"inGraphDataAnglePosition",i,j,{nullValue:true})==3)posAngle=realCumulativeAngle-statData[i][j].segmentAngle+setOptionValue(false,true,1,"INGRAPHDATAPADDINANGLE",ctx,data,statData,undefined,config.inGraphDataPaddingAngle,"inGraphDataPaddingAngle",i,j,{nullValue:true})*(Math.PI/180);realCumulativeAngle-=statData[i][j].segmentAngle;var dispString=tmplbis(setOptionValue(false,true,1,"INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,"inGraphDataTmpl",i,j,{nullValue:true}),statData[i][j],config);var textMeasurement=ctx.measureTextMultiLine(dispString).textWidth;var MaxRadiusX=Math.abs((realAvailableWidth-textMeasurement)/Math.cos(posAngle))-setOptionValue(false,true,1,"INGRAPHDATAPADDINGRADIUS",ctx,data,statData,undefined,config.inGraphDataPaddingRadius,"inGraphDataPaddingRadius",i,j,{nullValue:true})-5;if(MaxRadiusX<doughnutRadius)doughnutRadius=MaxRadiusX}}}doughnutRadius=doughnutRadius*config.radiusScale;return{radius:doughnutRadius,midPieX:midPieX,midPieY:midPieY}}function drawGridScale(ctx,data,config,msr,yAxisPosX,xAxisPosY,zeroY,valueHop,scaleHop,nbxlines,nbylines){var i,j,tickHop;var lineColor;var lineWidth;var bottomDrawn=false;var topDrawn=false;if(config.drawXScaleLine!==false){for(var s=0;s<config.drawXScaleLine.length;s++){var yPosXScale;switch(config.drawXScaleLine[s].position){case"bottom":yPosXScale=xAxisPosY;bottomDrawn=true;break;case"top":yPosXScale=xAxisPosY-nbxlines*scaleHop;topDrawn=true;break;case"0":case 0:yPosXScale=xAxisPosY;if(zeroY!=0)yPosXScale=xAxisPosY-zeroY;else bottomDrawn=true;if(Math.abs(yPosXScale-(xAxisPosY-nbxlines*scaleHop))<config.zeroValue)topDrawn=true;break}drawScaleLine(ctx,yAxisPosX-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft),yPosXScale,yAxisPosX+msr.availableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight),yPosXScale,config.drawXScaleLine[s].lineWidth?config.drawXScaleLine[s].lineWidth:Math.ceil(ctx.chartLineScale*config.scaleLineWidth),config.drawXScaleLine[s].lineColor?config.drawXScaleLine[s].lineColor:config.scaleLineColor,config.scaleGridLineStyle)}}for(i=-1+(bottomDrawn==true);i<nbxlines;i++){if(i<nbxlines-(topDrawn==true)){if(i==-1&&config.xAxisBottom||i==nbxlines-1&&config.xAxisTop||config.scaleShowGridLines&&(i+1)%config.scaleYGridLinesStep==0){drawFirst=false;if(config.scaleTickSizeLeft>0){drawScaleLine(ctx,yAxisPosX-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft),xAxisPosY-(i+1)*scaleHop,yAxisPosX,xAxisPosY-(i+1)*scaleHop,Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.tickColor!="gridLine"&&config.yAxisLeft?config.scaleLineColor:config.scaleGridLineColor,config.scaleGridLineStyle)}drawScaleLine(ctx,yAxisPosX,xAxisPosY-(i+1)*scaleHop,yAxisPosX+msr.availableWidth,xAxisPosY-(i+1)*scaleHop,Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.scaleGridLineColor,config.scaleGridLineStyle);if(config.scaleTickSizeRight>0){drawScaleLine(ctx,yAxisPosX+msr.availableWidth,xAxisPosY-(i+1)*scaleHop,yAxisPosX+msr.availableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight),xAxisPosY-(i+1)*scaleHop,Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.tickColor!="gridLine"&&config.yAxisRight?config.scaleLineColor:config.scaleGridLineColor,config.scaleGridLineStyle)}}else{if(config.scaleTickSizeLeft>0){drawScaleLine(ctx,yAxisPosX-Math.ceil(ctx.chartLineScale*config.scaleTickSizeLeft),xAxisPosY-(i+1)*scaleHop,yAxisPosX,xAxisPosY-(i+1)*scaleHop,Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.tickColor!="gridLine"&&config.yAxisLeft?config.scaleLineColor:config.scaleGridLineColor,config.scaleGridLineStyle)}if(config.scaleTickSizeRight>0){drawScaleLine(ctx,yAxisPosX+msr.availableWidth,xAxisPosY-(i+1)*scaleHop,yAxisPosX+msr.availableWidth+Math.ceil(ctx.chartLineScale*config.scaleTickSizeRight),xAxisPosY-(i+1)*scaleHop,Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.tickColor!="gridLine"&&config.yAxisRight?config.scaleLineColor:config.scaleGridLineColor,config.scaleGridLineStyle)}}}if(config.scaleMinorTickVerticalCount>0&&i!=-1){tickHop=scaleHop/(config.scaleMinorTickVerticalCount+1);for(j=1;j<config.scaleMinorTickVerticalCount+1;j++){if(config.scaleMinorTickHorizontalLines){if(config.scaleMinorTickSizeLeft>0){drawScaleLine(ctx,yAxisPosX-Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeLeft),xAxisPosY-(i+1)*scaleHop+j*tickHop,yAxisPosX,xAxisPosY-(i+1)*scaleHop+j*tickHop,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&config.yAxisLeft?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}drawScaleLine(ctx,yAxisPosX,xAxisPosY-(i+1)*scaleHop+j*tickHop,yAxisPosX+msr.availableWidth,xAxisPosY-(i+1)*scaleHop+j*tickHop,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.scaleMinorTickColor,config.scaleMinorTickStyle);if(config.scaleMinorTickSizeRight>0){drawScaleLine(ctx,yAxisPosX+msr.availableWidth,xAxisPosY-(i+1)*scaleHop+j*tickHop,yAxisPosX+msr.availableWidth+Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeRight),xAxisPosY-(i+1)*scaleHop+j*tickHop,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&config.yAxisRight?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}}else{if(config.scaleMinorTickSizeLeft>0){drawScaleLine(ctx,yAxisPosX-Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeLeft),xAxisPosY-(i+1)*scaleHop+j*tickHop,yAxisPosX,xAxisPosY-(i+1)*scaleHop+j*tickHop,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&config.yAxisLeft?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}if(config.scaleMinorTickSizeRight>0){drawScaleLine(ctx,yAxisPosX+msr.availableWidth,xAxisPosY-(i+1)*scaleHop+j*tickHop,yAxisPosX+msr.availableWidth+Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeRight),xAxisPosY-(i+1)*scaleHop+j*tickHop,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&config.yAxisRight?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}}}}}var lineColor;var lineWidth;for(i=0;i<nbylines;i++){ctx.beginPath();if(i==0&&config.yAxisLeft||i==nbylines-1&&config.yAxisRight){lineColor=config.scaleLineColor;lineWidth=config.scaleLineWidth}else{lineColor=config.scaleGridLineColor;lineWidth=config.scaleGridLineWidth}if(i==0&&config.yAxisLeft||i==nbylines-1&&config.yAxisRight||i==nbylines-1&&config.scaleTickSizeRight>0||config.scaleShowGridLines&&i%config.scaleXGridLinesStep==0){if(config.scaleTickSizeBottom>0){drawScaleLine(ctx,yAxisPosX+i*valueHop,xAxisPosY+Math.ceil(ctx.chartLineScale*config.scaleTickSizeBottom),yAxisPosX+i*valueHop,xAxisPosY,Math.ceil(ctx.chartLineScale*lineWidth),config.tickColor!="gridLine"&&bottomDrawn?config.scaleLineColor:lineColor,config.scaleGridLineStyle)}drawScaleLine(ctx,yAxisPosX+i*valueHop,xAxisPosY,yAxisPosX+i*valueHop,xAxisPosY-msr.availableHeight,Math.ceil(ctx.chartLineScale*lineWidth),lineColor,config.scaleGridLineStyle);if(config.scaleTickSizeTop>0){drawScaleLine(ctx,yAxisPosX+i*valueHop,xAxisPosY-msr.availableHeight,yAxisPosX+i*valueHop,xAxisPosY-msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop),Math.ceil(ctx.chartLineScale*lineWidth),config.tickColor!="gridLine"&&topDrawn?config.scaleLineColor:lineColor,config.scaleGridLineStyle)}}else{if(config.scaleTickSizeBottom>0){drawScaleLine(ctx,yAxisPosX+i*valueHop,xAxisPosY,yAxisPosX+i*valueHop,xAxisPosY+Math.ceil(ctx.chartLineScale*config.scaleTickSizeBottom),Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.tickColor!="gridLine"&&bottomDrawn?config.scaleLineColor:config.scaleGridLineColor,config.scaleGridLineStyle)}if(config.scaleTickSizeTop>0){drawScaleLine(ctx,yAxisPosX+i*valueHop,xAxisPosY-msr.availableHeight,yAxisPosX+i*valueHop,xAxisPosY-msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleTickSizeTop),Math.ceil(ctx.chartLineScale*config.scaleGridLineWidth),config.tickColor!="gridLine"&&topDrawn?config.scaleLineColor:config.scaleGridLineColor,config.scaleGridLineStyle)}}if(i<nbylines-1){if(config.scaleMinorTickHorizontalCount>0){tickHop=valueHop/(config.scaleMinorTickHorizontalCount+1);for(j=1;j<config.scaleMinorTickHorizontalCount+1;j++){if(config.scaleMinorTickVerticalLines){if(config.scaleMinorTickSizeTop>0){drawScaleLine(ctx,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY-msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeTop),yAxisPosX+i*valueHop+j*tickHop,xAxisPosY-msr.availableHeight,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&bottomDrawn?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}drawScaleLine(ctx,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY-msr.availableHeight,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.scaleMinorTickColor,config.scaleMinorTickStyle);if(config.scaleMinorTickSizeBottom>0){drawScaleLine(ctx,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY+Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeBottom),Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&bottomDrawn?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}}else{if(config.scaleMinorTickSizeBottom>0){drawScaleLine(ctx,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY+Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeBottom),Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&bottomDrawn?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}if(config.scaleMinorTickSizeTop>0){drawScaleLine(ctx,yAxisPosX+i*valueHop+j*tickHop,xAxisPosY-msr.availableHeight-Math.ceil(ctx.chartLineScale*config.scaleMinorTickSizeTop),yAxisPosX+i*valueHop+j*tickHop,xAxisPosY-msr.availableHeight,Math.ceil(ctx.chartLineScale*config.scaleMinorTickWidth),config.minorTickColor!="gridLine"&&topDrawn?config.scaleLineColor:config.scaleMinorTickColor,config.scaleMinorTickStyle)}}}}}}}function drawScaleLine(ctx,x_start,y_start,x_end,y_end,lineWidth,lineColor,lineStyle){ctx.beginPath();ctx.moveTo(x_start,y_start);ctx.lineWidth=lineWidth;ctx.strokeStyle=lineColor;ctx.lineTo(x_end,y_end);ctx.setLineDash(lineStyleFn(lineStyle));ctx.stroke();ctx.setLineDash([])}function drawTick(ctx,direction,x_start,x_end,y_start,y_end,tickCount,tickSize,tickWidth,tickColor,tickStyle){var tickHop,i;if(direction==0)tickHop=(x_end-x_start)/(tickCount+1);else tickHop=(y_end-y_start)/(tickCount+1);for(i=1;i<=tickCount;i++){ctx.beginPath();ctx.moveTo(x_start+i*tickHop*(direction==0),y_start+i*tickHop*(direction==1));ctx.lineWidth=Math.ceil(ctx.chartLineScale*tickWidth);ctx.strokeStyle=tickColor;ctx.lineTo(x_start+i*tickHop*(direction==0)+tickSize*(direction==1),y_start+i*tickHop*(direction==1)-tickSize*(direction==0));ctx.setLineDash(lineStyleFn(tickStyle));ctx.stroke();ctx.setLineDash([])}}function isBorder(option,position){var voption=option;if(voption>=8){if(position=="RIGHT")return true;else voption-=8}if(voption>=4){if(position=="TOP")return true;else voption-=4}if(voption>=2){if(position=="LEFT")return true;else voption-=2}if(voption>=1){if(position=="BOTTOM")return true;else voption-=1}return false}function convertData(data,generate){console.log("GENERATE:"+generate);if(generate)console.log("var data = {");if(generate)console.log('     labels : [""],');if(generate)console.log("     datasets : [");var newData={labels:[""],datasets:[]};for(var i=0;i<data.length;i++){if(generate)console.log("           {");newData.datasets[i]={data:[]};if(typeof data[i].value!="undefined"){if(generate)console.log("      data : ["+data[i].value+"],");newData.datasets[i].data=[data[i].value]}else{if(generate)console.log("      data : ["+data[i].value+"],");newData.datasets[i].data=[]}if(typeof data[i].color!="undefined"){if(generate)console.log('      fillColor : "'+data[i].color+'",');newData.datasets[i].fillColor=data[i].color}if(typeof data[i].title!="undefined"){if(generate)console.log('      title : "'+data[i].title+'",');newData.datasets[i].title=data[i].title}if(typeof data[i].link!="undefined"){if(generate)console.log('      link : "'+data[i].link+'",');newData.datasets[i].link=data[i].link}if(typeof data[i].imageLoad!="undefined"){if(generate)console.log("      imageLoad : <image>,");newData.datasets[i].imageLoad=data[i].imageLoad}if(typeof data[i].imagePos!="undefined"){if(generate)console.log("      imagePos : "+data[i].imagePos+",");newData.datasets[i].imagePos=data[i].imagePos}if(typeof data[i].imageHeight!="undefined"){if(generate)console.log("      imageHeight : "+data[i].imageHeight+",");newData.datasets[i].imageHeight=data[i].imageHeight}if(typeof data[i].imageWidth!="undefined"){if(generate)console.log("      imageWidth : "+data[i].imageWidth+",");newData.datasets[i].imageWidth=data[i].imageWidth}if(typeof data[i].text!="undefined"){if(generate)console.log('      text : "'+data[i].text+'",');newData.datasets[i].text=data[i].text}if(typeof data[i].fontStyle!="undefined"){if(generate)console.log('      fontStyle : "'+data[i].fontStyle+'",');newData.datasets[i].fontStyle=data[i].fontStyle}if(typeof data[i].fontSize!="undefined"){if(generate)console.log("      fontSize : "+data[i].fontSize+",");newData.datasets[i].fontSize=data[i].fontSize}if(typeof data[i].expandOutRadius!="undefined"){if(generate)console.log("      expandOutRadius : "+data[i].expandOutRadius+",");newData.datasets[i].expandOutRadius=data[i].expandOutRadius}if(typeof data[i].expandInRadius!="undefined"){if(generate)console.log("      expandInRadius : "+data[i].expandInRadius+",");newData.datasets[i].expandInRadius=data[i].expandInRadius}if(typeof data[i].gradientColors!="undefined"){if(generate)console.log("      gradientColors : < put here the gradient Colors definitions> "+data[i].gradientColors+",");newData.datasets[i].gradientColors=data[i].gradientColors}if(generate){console.log("      nothing : true    // line added to avoid a comma after last line");if(i==data.length-1)console.log("           }");else console.log("           },")}}if(generate)console.log("]");if(data.length>0){if(typeof data[0].shapesInChart!="undefined")newData.shapesInChart=data[0].shapesInChart;if(generate){console.log("     ,");console.log("     <   put here the shapesInChart    >")}}if(generate)console.log("};");return newData}
var AppChart={getCanvas:function(id){return document.getElementById(id)},getContext:function(id){var canvas=AppChart.getCanvas(id);return canvas.getContext("2d")},getDataUrl:function(id){return AppChart.getCanvas(id).toDataURL()},Line:function(id,data,options){return new Chart(AppChart.getContext(id)).Line(data,options)},Bar:function(id,data,options){return new Chart(AppChart.getContext(id)).Bar(data,options)},projectChart:function(options){var dataSettings={labels:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],datasets:[options]};var range=AppChart.utils.range(options.data);var endValue=Math.ceil(range.max/100)*100;var stepValue=endValue/10;var chartOptions={animationStartWithDataset:1,animationStartWithData:1,animationSteps:25,scaleOverride:true,scaleSteps:endValue/stepValue,scaleStepWidth:stepValue,scaleStartValue:0,scaleEndValue:endValue,canvasBorders:false,graphTitle:"Gerao Mensal (kWh)",graphTitleSpaceAfter:25,legend:false,inGraphDataShow:true,annotateDisplay:false,graphTitleFontSize:18,footNote:"",annotateLabel:"<%=(v3)%>"};AppChart.Bar(options.element,dataSettings,chartOptions)},financialChart:function(options){var data=options.data;var range=AppChart.utils.range(data);var labels=[0];for(var j=1;j<data.length;j++){labels[j]="";if(data[j]<range.min){range.min=data[j]}if(data[j]>range.max){range.max=data[j]}labels[j]=j==data.length-1?data.length-1:""}var dataSettings={labels:labels,datasets:[options]};var chartOptions={animationStartWithDataset:1,animationStartWithData:1,animationLeftToRight:true,animationByDataset:true,animationSteps:100,animationEasing:"linear",canvasBorders:false,canvasBordersWidth:0,canvasBordersColor:"black",graphTitle:"Caixa Acumulado",legend:false,inGraphDataShow:false,annotateDisplay:true,graphTitleFontSize:18,scaleOverride:true,scaleSteps:9,scaleStartValue:range.min,scaleEndValue:range.max,scaleStepWidth:((range.max-range.min)/9).toFixed(0),scaleLabel:"<%=AppChart.utils.formatCurrency(value)%>",annotateLabel:"<%=AppChart.utils.formatTooltip(v3)%>",yAxisLabel:"Valor",xAxisLabel:"Anos",footNote:""};if(options.hasOwnProperty("callback")){chartOptions.onAnimationComplete=options.callback}return AppChart.Line(options.element,dataSettings,chartOptions)},utils:{range:function(data){var range={min:data[0],max:data[0]};for(var i=0;i<data.length;i++){if(data[i]<range.min){range.min=data[i]}if(data[i]>range.max){range.max=data[i]}}return range},addCommas:function(nStr){nStr+="";x=nStr.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,"$1"+"."+"$2")}return x1+x2},formatCurrency:function(value){return"R$ "+AppChart.utils.addCommas(value)},formatTooltip:function(value){return AppChart.utils.formatCurrency(value.toFixed(0))}}};
!function(t){t.fn.cardtable=function(a){var s,d=this,e={headIndex:0},l=t.extend({},e,a);return s=a&&a.headIndex?a.headIndex:0,d.each(function(){var a=t(this);if(!a.hasClass("stacktable")){var s=t(this).prop("class"),d=t("<div></div>");"undefined"!=typeof l.myClass&&d.addClass(l.myClass);var e,n,i,h,r,c="";a.addClass("stacktable large-only"),e=a.find("caption").clone(),n=a.find("tr").eq(0),a.siblings().filter(".small-only").remove(),a.find("tbody tr").each(function(){i="",h="",r=t(this).prop("class"),t(this).find("td,th").each(function(a){""!==t(this).html()&&(h+='<tr class="'+r+'">',h+=n.find("td,th").eq(a).html()?'<td class="st-key">'+n.find("td,th").eq(a).html()+"</td>":'<td class="st-key"></td>',h+='<td class="st-val '+t(this).prop("class")+'">'+t(this).html()+"</td>",h+="</tr>")}),c+='<table class=" '+s+' stacktable small-only"><tbody>'+i+h+"</tbody></table>"}),a.find("tfoot tr td").each(function(a,d){""!==t.trim(t(d).text())&&(c+='<table class="'+s+' stacktable small-only"><tbody><tr><td>'+t(d).html()+"</td></tr></tbody></table>")}),d.prepend(e),d.append(t(c)),a.before(d)}})},t.fn.stacktable=function(a){var s,d=this,e={headIndex:0},l=t.extend({},e,a);return s=a&&a.headIndex?a.headIndex:0,d.each(function(){var a=t(this).prop("class"),d=t('<table class="'+a+' stacktable small-only"><tbody></tbody></table>');"undefined"!=typeof l.myClass&&d.addClass(l.myClass);var e,n,i,h,r,c,o="";e=t(this),e.addClass("stacktable large-only"),n=e.find("caption").clone(),i=e.find("tr").eq(0),e.find("tr").each(function(a){h="",r="",c=t(this).prop("class"),0===a?o+='<tr class=" '+c+' "><th class="st-head-row st-head-row-main" colspan="2">'+t(this).find("th,td").eq(s).html()+"</th></tr>":(t(this).find("td,th").each(function(a){a===s?h='<tr class="'+c+'"><th class="st-head-row" colspan="2">'+t(this).html()+"</th></tr>":""!==t(this).html()&&(r+='<tr class="'+c+'">',r+=i.find("td,th").eq(a).html()?'<td class="st-key">'+i.find("td,th").eq(a).html()+"</td>":'<td class="st-key"></td>',r+='<td class="st-val '+t(this).prop("class")+'">'+t(this).html()+"</td>",r+="</tr>")}),o+=h+r)}),d.prepend(n),d.append(t(o)),e.before(d)})},t.fn.stackcolumns=function(a){var s=this,d={},e=t.extend({},d,a);return s.each(function(){var a=t(this),s=a.find("tr").eq(0).find("td,th").length;if(!(3>s)){var d=t('<table class="stacktable small-only"></table>');"undefined"!=typeof e.myClass&&d.addClass(e.myClass),a.addClass("stacktable large-only");for(var l=t("<tbody></tbody>"),n=1;s>n;)a.find("tr").each(function(a){var s=t("<tr></tr>");0===a&&s.addClass("st-head-row st-head-row-main");var d=t(this).find("td,th").eq(0).clone().addClass("st-key"),e=n;if(t(this).find("*[colspan]").length){var i=0;t(this).find("td,th").each(function(){var a=t(this).attr("colspan");return a?(a=parseInt(a,10),e-=a-1,i+a>n&&(e+=i+a-n-1),i+=a):i++,i>n?!1:void 0})}var h=t(this).find("td,th").eq(e).clone().addClass("st-val").removeAttr("colspan");s.append(d,h),l.append(s)}),++n;d.append(t(l)),a.before(d)}})}}(jQuery);
var card=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){var $,Card,slice=[].slice;Card=__webpack_require__(1);$=__webpack_require__(11);$.card={};$.card.fn={};$.fn.card=function(opts){return $.card.fn.construct.apply(this,opts)};$.fn.extend({card:function(){var args,option;option=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[];return this.each(function(){var $this,data;$this=$(this);data=$this.data("card");if(!data){$.each(option,function(_this){return function(key,value){if(value instanceof jQuery){return option[key]=value[0]}}}(this));option["form"]=this;$this.data("card",data=new Card(option))}if(typeof option==="string"){return data[option].apply(data,args)}})}})},function(module,exports,__webpack_require__){(function(global){var Card,QJ,extend,payment,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};__webpack_require__(2);QJ=__webpack_require__(6);payment=__webpack_require__(7);extend=__webpack_require__(8);Card=function(){var bindVal;Card.prototype.initializedDataAttr="data-jp-card-initialized";Card.prototype.cardTemplate=""+'<div class="jp-card-container">'+'<div class="jp-card">'+'<div class="jp-card-front">'+'<div class="jp-card-logo jp-card-elo">'+'<div class="e">e</div>'+'<div class="l">l</div>'+'<div class="o">o</div>'+"</div>"+'<div class="jp-card-logo jp-card-visa">visa</div>'+'<div class="jp-card-logo jp-card-mastercard">MasterCard</div>'+'<div class="jp-card-logo jp-card-maestro">Maestro</div>'+'<div class="jp-card-logo jp-card-amex"></div>'+'<div class="jp-card-logo jp-card-discover">discover</div>'+'<div class="jp-card-logo jp-card-dinersclub"></div>'+'<div class="jp-card-logo jp-card-dankort"><div class="dk"><div class="d"></div><div class="k"></div></div></div>'+'<div class="jp-card-lower">'+'<div class="jp-card-shiny"></div>'+'<div class="jp-card-cvc jp-card-display">{{cvc}}</div>'+'<div class="jp-card-number jp-card-display">{{number}}</div>'+'<div class="jp-card-name jp-card-display">{{name}}</div>'+'<div class="jp-card-expiry jp-card-display" data-before="{{monthYear}}" data-after="{{validDate}}">{{expiry}}</div>'+"</div>"+"</div>"+'<div class="jp-card-back">'+'<div class="jp-card-bar"></div>'+'<div class="jp-card-cvc jp-card-display">{{cvc}}</div>'+'<div class="jp-card-shiny"></div>'+"</div>"+"</div>"+"</div>";Card.prototype.template=function(tpl,data){return tpl.replace(/\{\{(.*?)\}\}/g,function(match,key,str){return data[key]})};Card.prototype.cardTypes=["jp-card-amex","jp-card-dankort","jp-card-dinersclub","jp-card-discover","jp-card-jcb","jp-card-laser","jp-card-maestro","jp-card-mastercard","jp-card-unionpay","jp-card-visa","jp-card-visaelectron","jp-card-elo"];Card.prototype.defaults={formatting:true,formSelectors:{numberInput:'input[name="number"]',expiryInput:'input[name="expiry"]',cvcInput:'input[name="cvc"]',nameInput:'input[name="name"]'},cardSelectors:{cardContainer:".jp-card-container",card:".jp-card",numberDisplay:".jp-card-number",expiryDisplay:".jp-card-expiry",cvcDisplay:".jp-card-cvc",nameDisplay:".jp-card-name"},messages:{validDate:"valid\nthru",monthYear:"month/year"},placeholders:{number:"&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull;",cvc:"&bull;&bull;&bull;",expiry:"&bull;&bull;/&bull;&bull;",name:"Full Name"},masks:{cardNumber:false},classes:{valid:"jp-card-valid",invalid:"jp-card-invalid"},debug:false};function Card(opts){this.maskCardNumber=bind(this.maskCardNumber,this);var toInitialize;this.options=extend(true,this.defaults,opts);if(!this.options.form){console.log("Please provide a form");return}this.$el=QJ(this.options.form);if(!this.options.container){console.log("Please provide a container");return}this.$container=QJ(this.options.container);toInitialize=QJ.isDOMElement(this.$container)?this.$container:this.$container[0];if(toInitialize.getAttribute(this.initializedDataAttr)){return}toInitialize.setAttribute(this.initializedDataAttr,true);this.render();this.attachHandlers();this.handleInitialPlaceholders()}Card.prototype.render=function(){var $cardContainer,baseWidth,name,obj,ref,ref1,selector,ua;QJ.append(this.$container,this.template(this.cardTemplate,extend({},this.options.messages,this.options.placeholders)));ref=this.options.cardSelectors;for(name in ref){selector=ref[name];this["$"+name]=QJ.find(this.$container,selector)}ref1=this.options.formSelectors;for(name in ref1){selector=ref1[name];selector=this.options[name]?this.options[name]:selector;obj=QJ.find(this.$el,selector);if(!obj.length&&this.options.debug){console.error("Card can't find a "+name+" in your form.")}this["$"+name]=obj}if(this.options.formatting){Payment.formatCardNumber(this.$numberInput);Payment.formatCardCVC(this.$cvcInput);Payment.formatCardExpiry(this.$expiryInput)}if(this.options.width){$cardContainer=QJ(this.options.cardSelectors.cardContainer)[0];baseWidth=parseInt($cardContainer.clientWidth||window.getComputedStyle($cardContainer).width);$cardContainer.style.transform="scale("+this.options.width/baseWidth+")"}if(typeof navigator!=="undefined"&&navigator!==null?navigator.userAgent:void 0){ua=navigator.userAgent.toLowerCase();if(ua.indexOf("safari")!==-1&&ua.indexOf("chrome")===-1){QJ.addClass(this.$card,"jp-card-safari")}}if(/MSIE 10\./i.test(navigator.userAgent)){QJ.addClass(this.$card,"jp-card-ie-10")}if(/rv:11.0/i.test(navigator.userAgent)){return QJ.addClass(this.$card,"jp-card-ie-11")}};Card.prototype.attachHandlers=function(){var expiryFilters,numberInputFilters;numberInputFilters=[this.validToggler("cardNumber")];if(this.options.masks.cardNumber){numberInputFilters.push(this.maskCardNumber)}bindVal(this.$numberInput,this.$numberDisplay,{fill:false,filters:numberInputFilters});QJ.on(this.$numberInput,"payment.cardType",this.handle("setCardType"));expiryFilters=[function(val){return val.replace(/(\s+)/g,"")}];expiryFilters.push(this.validToggler("cardExpiry"));bindVal(this.$expiryInput,this.$expiryDisplay,{join:function(text){if(text[0].length===2||text[1]){return"/"}else{return""}},filters:expiryFilters});bindVal(this.$cvcInput,this.$cvcDisplay,{filters:this.validToggler("cardCVC")});QJ.on(this.$cvcInput,"focus",this.handle("flipCard"));QJ.on(this.$cvcInput,"blur",this.handle("unflipCard"));return bindVal(this.$nameInput,this.$nameDisplay,{fill:false,filters:this.validToggler("cardHolderName"),join:" "})};Card.prototype.handleInitialPlaceholders=function(){var el,name,ref,results,selector;ref=this.options.formSelectors;results=[];for(name in ref){selector=ref[name];el=this["$"+name];if(QJ.val(el)){QJ.trigger(el,"paste");results.push(setTimeout(function(){return QJ.trigger(el,"keyup")}))}else{results.push(void 0)}}return results};Card.prototype.handle=function(fn){return function(_this){return function(e){var args;args=Array.prototype.slice.call(arguments);args.unshift(e.target);return _this.handlers[fn].apply(_this,args)}}(this)};Card.prototype.validToggler=function(validatorName){var isValid;if(validatorName==="cardExpiry"){isValid=function(val){var objVal;objVal=Payment.fns.cardExpiryVal(val);return Payment.fns.validateCardExpiry(objVal.month,objVal.year)}}else if(validatorName==="cardCVC"){isValid=function(_this){return function(val){return Payment.fns.validateCardCVC(val,_this.cardType)}}(this)}else if(validatorName==="cardNumber"){isValid=function(val){return Payment.fns.validateCardNumber(val)}}else if(validatorName==="cardHolderName"){isValid=function(val){return val!==""}}return function(_this){return function(val,$in,$out){var result;result=isValid(val);_this.toggleValidClass($in,result);_this.toggleValidClass($out,result);return val}}(this)};Card.prototype.toggleValidClass=function(el,test){QJ.toggleClass(el,this.options.classes.valid,test);return QJ.toggleClass(el,this.options.classes.invalid,!test)};Card.prototype.maskCardNumber=function(val,el,out){var mask,numbers;mask=this.options.masks.cardNumber;numbers=val.split(" ");if(numbers.length>=3){numbers.forEach(function(item,idx){if(idx!==numbers.length-1){return numbers[idx]=numbers[idx].replace(/\d/g,mask)}});return numbers.join(" ")}else{return val.replace(/\d/g,mask)}};Card.prototype.handlers={setCardType:function($el,e){var cardType;cardType=e.data;if(!QJ.hasClass(this.$card,cardType)){QJ.removeClass(this.$card,"jp-card-unknown");QJ.removeClass(this.$card,this.cardTypes.join(" "));QJ.addClass(this.$card,"jp-card-"+cardType);QJ.toggleClass(this.$card,"jp-card-identified",cardType!=="unknown");return this.cardType=cardType}},flipCard:function(){return QJ.addClass(this.$card,"jp-card-flipped")},unflipCard:function(){return QJ.removeClass(this.$card,"jp-card-flipped")}};bindVal=function(el,out,opts){var joiner,o,outDefaults;if(opts==null){opts={}}opts.fill=opts.fill||false;opts.filters=opts.filters||[];if(!(opts.filters instanceof Array)){opts.filters=[opts.filters]}opts.join=opts.join||"";if(!(typeof opts.join==="function")){joiner=opts.join;opts.join=function(){return joiner}}outDefaults=function(){var j,len,results;results=[];for(j=0,len=out.length;j<len;j++){o=out[j];results.push(o.textContent)}return results}();QJ.on(el,"focus",function(){return QJ.addClass(out,"jp-card-focused")});QJ.on(el,"blur",function(){return QJ.removeClass(out,"jp-card-focused")});QJ.on(el,"keyup change paste",function(e){var elem,filter,i,j,join,k,len,len1,outEl,outVal,ref,results,val;val=function(){var j,len,results;results=[];for(j=0,len=el.length;j<len;j++){elem=el[j];results.push(QJ.val(elem))}return results}();join=opts.join(val);val=val.join(join);if(val===join){val=""}ref=opts.filters;for(j=0,len=ref.length;j<len;j++){filter=ref[j];val=filter(val,el,out)}results=[];for(i=k=0,len1=out.length;k<len1;i=++k){outEl=out[i];if(opts.fill){outVal=val+outDefaults[i].substring(val.length)}else{outVal=val||outDefaults[i]}results.push(outEl.textContent=outVal)}return results});return el};return Card}();module.exports=Card;global.Card=Card}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){var content=__webpack_require__(3);if(typeof content==="string")content=[[module.id,content,""]];var update=__webpack_require__(5)(content,{});if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!./../../node_modules/css-loader/index.js!./../../node_modules/sass-loader/index.js!./card.scss",function(){var newContent=require("!!./../../node_modules/css-loader/index.js!./../../node_modules/sass-loader/index.js!./card.scss");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(4)();exports.push([module.id,'.jp-card.jp-card-safari.jp-card-identified .jp-card-front:before, .jp-card.jp-card-safari.jp-card-identified .jp-card-back:before {\n  background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.05) 1px, rgba(255, 255, 255, 0) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.03) 4px), repeating-linear-gradient(90deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(210deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), -webkit-linear-gradient(-245deg, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.2) 70%, rgba(255, 255, 255, 0) 90%);\n  background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.05) 1px, rgba(255, 255, 255, 0) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.03) 4px), repeating-linear-gradient(90deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(210deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), linear-gradient(-25deg, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.2) 70%, rgba(255, 255, 255, 0) 90%); }\n\n.jp-card.jp-card-ie-10.jp-card-flipped, .jp-card.jp-card-ie-11.jp-card-flipped {\n  -webkit-transform: 0deg;\n  -moz-transform: 0deg;\n  -ms-transform: 0deg;\n  -o-transform: 0deg;\n  transform: 0deg; }\n  .jp-card.jp-card-ie-10.jp-card-flipped .jp-card-front, .jp-card.jp-card-ie-11.jp-card-flipped .jp-card-front {\n    -webkit-transform: rotateY(0deg);\n    -moz-transform: rotateY(0deg);\n    -ms-transform: rotateY(0deg);\n    -o-transform: rotateY(0deg);\n    transform: rotateY(0deg); }\n  .jp-card.jp-card-ie-10.jp-card-flipped .jp-card-back, .jp-card.jp-card-ie-11.jp-card-flipped .jp-card-back {\n    -webkit-transform: rotateY(0deg);\n    -moz-transform: rotateY(0deg);\n    -ms-transform: rotateY(0deg);\n    -o-transform: rotateY(0deg);\n    transform: rotateY(0deg); }\n    .jp-card.jp-card-ie-10.jp-card-flipped .jp-card-back:after, .jp-card.jp-card-ie-11.jp-card-flipped .jp-card-back:after {\n      left: 18%; }\n    .jp-card.jp-card-ie-10.jp-card-flipped .jp-card-back .jp-card-cvc, .jp-card.jp-card-ie-11.jp-card-flipped .jp-card-back .jp-card-cvc {\n      -webkit-transform: rotateY(180deg);\n      -moz-transform: rotateY(180deg);\n      -ms-transform: rotateY(180deg);\n      -o-transform: rotateY(180deg);\n      transform: rotateY(180deg);\n      left: 5%; }\n    .jp-card.jp-card-ie-10.jp-card-flipped .jp-card-back .jp-card-shiny, .jp-card.jp-card-ie-11.jp-card-flipped .jp-card-back .jp-card-shiny {\n      left: 84%; }\n      .jp-card.jp-card-ie-10.jp-card-flipped .jp-card-back .jp-card-shiny:after, .jp-card.jp-card-ie-11.jp-card-flipped .jp-card-back .jp-card-shiny:after {\n        left: -480%;\n        -webkit-transform: rotateY(180deg);\n        -moz-transform: rotateY(180deg);\n        -ms-transform: rotateY(180deg);\n        -o-transform: rotateY(180deg);\n        transform: rotateY(180deg); }\n\n.jp-card.jp-card-ie-10.jp-card-amex .jp-card-back, .jp-card.jp-card-ie-11.jp-card-amex .jp-card-back {\n  display: none; }\n\n.jp-card-logo {\n  height: 36px;\n  width: 60px;\n  font-style: italic; }\n  .jp-card-logo, .jp-card-logo:before, .jp-card-logo:after {\n    box-sizing: border-box; }\n\n.jp-card-logo.jp-card-amex {\n  text-transform: uppercase;\n  font-size: 4px;\n  font-weight: bold;\n  color: white;\n  background-image: repeating-radial-gradient(circle at center, #FFF 1px, #999 2px);\n  background-image: repeating-radial-gradient(circle at center, #FFF 1px, #999 2px);\n  border: 1px solid #EEE; }\n  .jp-card-logo.jp-card-amex:before, .jp-card-logo.jp-card-amex:after {\n    width: 28px;\n    display: block;\n    position: absolute;\n    left: 16px; }\n  .jp-card-logo.jp-card-amex:before {\n    height: 28px;\n    content: "american";\n    top: 3px;\n    text-align: left;\n    padding-left: 2px;\n    padding-top: 11px;\n    background: #267AC3; }\n  .jp-card-logo.jp-card-amex:after {\n    content: "express";\n    bottom: 11px;\n    text-align: right;\n    padding-right: 2px; }\n\n.jp-card.jp-card-amex.jp-card-flipped {\n  -webkit-transform: none;\n  -moz-transform: none;\n  -ms-transform: none;\n  -o-transform: none;\n  transform: none; }\n\n.jp-card.jp-card-amex.jp-card-identified .jp-card-front:before, .jp-card.jp-card-amex.jp-card-identified .jp-card-back:before {\n  background-color: #108168; }\n\n.jp-card.jp-card-amex.jp-card-identified .jp-card-front .jp-card-logo.jp-card-amex {\n  opacity: 1; }\n\n.jp-card.jp-card-amex.jp-card-identified .jp-card-front .jp-card-cvc {\n  visibility: visible; }\n\n.jp-card.jp-card-amex.jp-card-identified .jp-card-front:after {\n  opacity: 1; }\n\n.jp-card-logo.jp-card-discover {\n  background: #FF6600;\n  color: #111;\n  text-transform: uppercase;\n  font-style: normal;\n  font-weight: bold;\n  font-size: 10px;\n  text-align: center;\n  overflow: hidden;\n  z-index: 1;\n  padding-top: 9px;\n  letter-spacing: .03em;\n  border: 1px solid #EEE; }\n  .jp-card-logo.jp-card-discover:before, .jp-card-logo.jp-card-discover:after {\n    content: " ";\n    display: block;\n    position: absolute; }\n  .jp-card-logo.jp-card-discover:before {\n    background: white;\n    width: 200px;\n    height: 200px;\n    border-radius: 200px;\n    bottom: -5%;\n    right: -80%;\n    z-index: -1; }\n  .jp-card-logo.jp-card-discover:after {\n    width: 8px;\n    height: 8px;\n    border-radius: 4px;\n    top: 10px;\n    left: 27px;\n    background-color: #FF6600;\n    background-image: -webkit-radial-gradient(#FF6600, #fff);\n    background-image: radial-gradient(  #FF6600, #fff);\n    content: "network";\n    font-size: 4px;\n    line-height: 24px;\n    text-indent: -7px; }\n\n.jp-card .jp-card-front .jp-card-logo.jp-card-discover {\n  right: 12%;\n  top: 18%; }\n\n.jp-card.jp-card-discover.jp-card-identified .jp-card-front:before, .jp-card.jp-card-discover.jp-card-identified .jp-card-back:before {\n  background-color: #86B8CF; }\n\n.jp-card.jp-card-discover.jp-card-identified .jp-card-logo.jp-card-discover {\n  opacity: 1; }\n\n.jp-card.jp-card-discover.jp-card-identified .jp-card-front:after {\n  -webkit-transition: 400ms;\n  -moz-transition: 400ms;\n  transition: 400ms;\n  content: " ";\n  display: block;\n  background-color: #FF6600;\n  background-image: -webkit-linear-gradient(#FF6600, #ffa366, #FF6600);\n  background-image: linear-gradient(#FF6600, #ffa366, #FF6600);\n  height: 50px;\n  width: 50px;\n  border-radius: 25px;\n  position: absolute;\n  left: 100%;\n  top: 15%;\n  margin-left: -25px;\n  box-shadow: inset 1px 1px 3px 1px rgba(0, 0, 0, 0.5); }\n\n.jp-card-logo.jp-card-visa {\n  background: white;\n  text-transform: uppercase;\n  color: #1A1876;\n  text-align: center;\n  font-weight: bold;\n  font-size: 15px;\n  line-height: 18px; }\n  .jp-card-logo.jp-card-visa:before, .jp-card-logo.jp-card-visa:after {\n    content: " ";\n    display: block;\n    width: 100%;\n    height: 25%; }\n  .jp-card-logo.jp-card-visa:before {\n    background: #1A1876; }\n  .jp-card-logo.jp-card-visa:after {\n    background: #E79800; }\n\n.jp-card.jp-card-visa.jp-card-identified .jp-card-front:before, .jp-card.jp-card-visa.jp-card-identified .jp-card-back:before {\n  background-color: #191278; }\n\n.jp-card.jp-card-visa.jp-card-identified .jp-card-logo.jp-card-visa {\n  opacity: 1; }\n\n.jp-card-logo.jp-card-mastercard {\n  color: white;\n  font-weight: bold;\n  text-align: center;\n  font-size: 9px;\n  line-height: 36px;\n  z-index: 1;\n  text-shadow: 1px 1px rgba(0, 0, 0, 0.6); }\n  .jp-card-logo.jp-card-mastercard:before, .jp-card-logo.jp-card-mastercard:after {\n    content: " ";\n    display: block;\n    width: 36px;\n    top: 0;\n    position: absolute;\n    height: 36px;\n    border-radius: 18px; }\n  .jp-card-logo.jp-card-mastercard:before {\n    left: 0;\n    background: #FF0000;\n    z-index: -1; }\n  .jp-card-logo.jp-card-mastercard:after {\n    right: 0;\n    background: #FFAB00;\n    z-index: -2; }\n\n.jp-card.jp-card-mastercard.jp-card-identified .jp-card-front .jp-card-logo.jp-card-mastercard, .jp-card.jp-card-mastercard.jp-card-identified .jp-card-back .jp-card-logo.jp-card-mastercard {\n  box-shadow: none; }\n\n.jp-card.jp-card-mastercard.jp-card-identified .jp-card-front:before, .jp-card.jp-card-mastercard.jp-card-identified .jp-card-back:before {\n  background-color: #0061A8; }\n\n.jp-card.jp-card-mastercard.jp-card-identified .jp-card-logo.jp-card-mastercard {\n  opacity: 1; }\n\n.jp-card-logo.jp-card-maestro {\n  color: white;\n  font-weight: bold;\n  text-align: center;\n  font-size: 14px;\n  line-height: 36px;\n  z-index: 1;\n  text-shadow: 1px 1px rgba(0, 0, 0, 0.6); }\n  .jp-card-logo.jp-card-maestro:before, .jp-card-logo.jp-card-maestro:after {\n    content: " ";\n    display: block;\n    width: 36px;\n    top: 0;\n    position: absolute;\n    height: 36px;\n    border-radius: 18px; }\n  .jp-card-logo.jp-card-maestro:before {\n    left: 0;\n    background: #0064CB;\n    z-index: -1; }\n  .jp-card-logo.jp-card-maestro:after {\n    right: 0;\n    background: #CC0000;\n    z-index: -2; }\n\n.jp-card.jp-card-maestro.jp-card-identified .jp-card-front .jp-card-logo.jp-card-maestro, .jp-card.jp-card-maestro.jp-card-identified .jp-card-back .jp-card-logo.jp-card-maestro {\n  box-shadow: none; }\n\n.jp-card.jp-card-maestro.jp-card-identified .jp-card-front:before, .jp-card.jp-card-maestro.jp-card-identified .jp-card-back:before {\n  background-color: #0B2C5F; }\n\n.jp-card.jp-card-maestro.jp-card-identified .jp-card-logo.jp-card-maestro {\n  opacity: 1; }\n\n.jp-card-logo.jp-card-dankort {\n  width: 60px;\n  height: 36px;\n  padding: 3px;\n  border-radius: 8px;\n  border: #000000 1px solid;\n  background-color: #FFFFFF; }\n  .jp-card-logo.jp-card-dankort .dk {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden; }\n    .jp-card-logo.jp-card-dankort .dk:before {\n      background-color: #ED1C24;\n      content: \'\';\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      display: block;\n      border-radius: 6px; }\n    .jp-card-logo.jp-card-dankort .dk:after {\n      content: \'\';\n      position: absolute;\n      top: 50%;\n      margin-top: -7.7px;\n      right: 0;\n      width: 0;\n      height: 0;\n      border-style: solid;\n      border-width: 7px 7px 10px 0;\n      border-color: transparent #ED1C24 transparent transparent;\n      z-index: 1; }\n  .jp-card-logo.jp-card-dankort .d, .jp-card-logo.jp-card-dankort .k {\n    position: absolute;\n    top: 50%;\n    width: 50%;\n    display: block;\n    height: 15.4px;\n    margin-top: -7.7px;\n    background: white; }\n  .jp-card-logo.jp-card-dankort .d {\n    left: 0;\n    border-radius: 0 8px 10px 0; }\n    .jp-card-logo.jp-card-dankort .d:before {\n      content: \'\';\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      display: block;\n      background: #ED1C24;\n      border-radius: 2px 4px 6px 0px;\n      height: 5px;\n      width: 7px;\n      margin: -3px 0 0 -4px; }\n  .jp-card-logo.jp-card-dankort .k {\n    right: 0; }\n    .jp-card-logo.jp-card-dankort .k:before, .jp-card-logo.jp-card-dankort .k:after {\n      content: \'\';\n      position: absolute;\n      right: 50%;\n      width: 0;\n      height: 0;\n      border-style: solid;\n      margin-right: -1px; }\n    .jp-card-logo.jp-card-dankort .k:before {\n      top: 0;\n      border-width: 8px 5px 0 0;\n      border-color: #ED1C24 transparent transparent transparent; }\n    .jp-card-logo.jp-card-dankort .k:after {\n      bottom: 0;\n      border-width: 0 5px 8px 0;\n      border-color: transparent transparent #ED1C24 transparent; }\n\n.jp-card.jp-card-dankort.jp-card-identified .jp-card-front:before, .jp-card.jp-card-dankort.jp-card-identified .jp-card-back:before {\n  background-color: #0055C7; }\n\n.jp-card.jp-card-dankort.jp-card-identified .jp-card-logo.jp-card-dankort {\n  opacity: 1; }\n\n.jp-card-logo.jp-card-elo {\n  height: 50px;\n  width: 50px;\n  border-radius: 100%;\n  background: black;\n  color: white;\n  text-align: center;\n  text-transform: lowercase;\n  font-size: 21px;\n  font-style: normal;\n  letter-spacing: 1px;\n  font-weight: bold;\n  padding-top: 13px; }\n  .jp-card-logo.jp-card-elo .e, .jp-card-logo.jp-card-elo .l, .jp-card-logo.jp-card-elo .o {\n    display: inline-block;\n    position: relative; }\n  .jp-card-logo.jp-card-elo .e {\n    -webkit-transform: rotate(-15deg);\n    -moz-transform: rotate(-15deg);\n    -ms-transform: rotate(-15deg);\n    -o-transform: rotate(-15deg);\n    transform: rotate(-15deg); }\n  .jp-card-logo.jp-card-elo .o {\n    position: relative;\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    right: 0;\n    top: 7px;\n    border-radius: 100%;\n    background-image: -webkit-linear-gradient( yellow 50%, red 50%);\n    background-image: linear-gradient( yellow 50%, red 50%);\n    -webkit-transform: rotate(40deg);\n    -moz-transform: rotate(40deg);\n    -ms-transform: rotate(40deg);\n    -o-transform: rotate(40deg);\n    transform: rotate(40deg);\n    text-indent: -9999px; }\n    .jp-card-logo.jp-card-elo .o:before {\n      content: "";\n      position: absolute;\n      width: 49%;\n      height: 49%;\n      background: black;\n      border-radius: 100%;\n      text-indent: -99999px;\n      top: 25%;\n      left: 25%; }\n\n.jp-card.jp-card-elo.jp-card-identified .jp-card-front:before, .jp-card.jp-card-elo.jp-card-identified .jp-card-back:before {\n  background-color: #6F6969; }\n\n.jp-card.jp-card-elo.jp-card-identified .jp-card-logo.jp-card-elo {\n  opacity: 1; }\n\n.jp-card-logo.jp-card-dinersclub {\n  font-family: serif;\n  height: 40px;\n  width: 100px;\n  color: white;\n  font-size: 17px;\n  font-style: normal;\n  letter-spacing: 1px; }\n  .jp-card-logo.jp-card-dinersclub::before, .jp-card-logo.jp-card-dinersclub::after {\n    display: block;\n    position: relative; }\n  .jp-card-logo.jp-card-dinersclub::before {\n    content: \'Diners Club\'; }\n  .jp-card-logo.jp-card-dinersclub::after {\n    content: \'International\';\n    text-transform: uppercase;\n    font-size: 0.6em; }\n\n.jp-card.jp-card-dinersclub .jp-card-front .jp-card-logo {\n  box-shadow: none !important; }\n\n.jp-card.jp-card-dinersclub.jp-card-identified .jp-card-front:before, .jp-card.jp-card-dinersclub.jp-card-identified .jp-card-back:before {\n  background-color: #999; }\n\n.jp-card.jp-card-dinersclub.jp-card-identified .jp-card-logo.jp-card-dinersclub {\n  opacity: 1; }\n\n.jp-card-container {\n  -webkit-perspective: 1000px;\n  -moz-perspective: 1000px;\n  perspective: 1000px;\n  width: 350px;\n  max-width: 100%;\n  height: 200px;\n  margin: auto;\n  z-index: 1;\n  position: relative; }\n\n.jp-card {\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  line-height: 1;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  min-width: 315px;\n  border-radius: 10px;\n  -webkit-transform-style: preserve-3d;\n  -moz-transform-style: preserve-3d;\n  -ms-transform-style: preserve-3d;\n  -o-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n  -webkit-transition: all 400ms linear;\n  -moz-transition: all 400ms linear;\n  transition: all 400ms linear; }\n  .jp-card > *, .jp-card > *:before, .jp-card > *:after {\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    font-family: inherit; }\n  .jp-card.jp-card-flipped {\n    -webkit-transform: rotateY(180deg);\n    -moz-transform: rotateY(180deg);\n    -ms-transform: rotateY(180deg);\n    -o-transform: rotateY(180deg);\n    transform: rotateY(180deg); }\n  .jp-card .jp-card-front, .jp-card .jp-card-back {\n    -webkit-backface-visibility: hidden;\n    backface-visibility: hidden;\n    -webkit-transform-style: preserve-3d;\n    -moz-transform-style: preserve-3d;\n    -ms-transform-style: preserve-3d;\n    -o-transform-style: preserve-3d;\n    transform-style: preserve-3d;\n    -webkit-transition: all 400ms linear;\n    -moz-transition: all 400ms linear;\n    transition: all 400ms linear;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    overflow: hidden;\n    border-radius: 10px;\n    background: #DDD; }\n    .jp-card .jp-card-front:before, .jp-card .jp-card-back:before {\n      content: " ";\n      display: block;\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      top: 0;\n      left: 0;\n      opacity: 0;\n      border-radius: 10px;\n      -webkit-transition: all 400ms ease;\n      -moz-transition: all 400ms ease;\n      transition: all 400ms ease; }\n    .jp-card .jp-card-front:after, .jp-card .jp-card-back:after {\n      content: " ";\n      display: block; }\n    .jp-card .jp-card-front .jp-card-display, .jp-card .jp-card-back .jp-card-display {\n      color: white;\n      font-weight: normal;\n      opacity: 0.5;\n      -webkit-transition: opacity 400ms linear;\n      -moz-transition: opacity 400ms linear;\n      transition: opacity 400ms linear; }\n      .jp-card .jp-card-front .jp-card-display.jp-card-focused, .jp-card .jp-card-back .jp-card-display.jp-card-focused {\n        opacity: 1;\n        font-weight: 700; }\n    .jp-card .jp-card-front .jp-card-cvc, .jp-card .jp-card-back .jp-card-cvc {\n      font-family: "Bitstream Vera Sans Mono", Consolas, Courier, monospace;\n      font-size: 14px; }\n    .jp-card .jp-card-front .jp-card-shiny, .jp-card .jp-card-back .jp-card-shiny {\n      width: 50px;\n      height: 35px;\n      border-radius: 5px;\n      background: #CCC;\n      position: relative; }\n      .jp-card .jp-card-front .jp-card-shiny:before, .jp-card .jp-card-back .jp-card-shiny:before {\n        content: " ";\n        display: block;\n        width: 70%;\n        height: 60%;\n        border-top-right-radius: 5px;\n        border-bottom-right-radius: 5px;\n        background: #d9d9d9;\n        position: absolute;\n        top: 20%; }\n  .jp-card .jp-card-front .jp-card-logo {\n    position: absolute;\n    opacity: 0;\n    right: 5%;\n    top: 8%;\n    -webkit-transition: 400ms;\n    -moz-transition: 400ms;\n    transition: 400ms; }\n  .jp-card .jp-card-front .jp-card-lower {\n    width: 80%;\n    position: absolute;\n    left: 10%;\n    bottom: 30px; }\n    @media only screen and (max-width: 480px) {\n      .jp-card .jp-card-front .jp-card-lower {\n        width: 90%;\n        left: 5%; } }\n    .jp-card .jp-card-front .jp-card-lower .jp-card-cvc {\n      visibility: hidden;\n      float: right;\n      position: relative;\n      bottom: 5px; }\n    .jp-card .jp-card-front .jp-card-lower .jp-card-number {\n      font-family: "Bitstream Vera Sans Mono", Consolas, Courier, monospace;\n      font-size: 24px;\n      clear: both;\n      margin-bottom: 30px; }\n    .jp-card .jp-card-front .jp-card-lower .jp-card-expiry {\n      font-family: "Bitstream Vera Sans Mono", Consolas, Courier, monospace;\n      letter-spacing: 0em;\n      position: relative;\n      float: right;\n      width: 25%; }\n      .jp-card .jp-card-front .jp-card-lower .jp-card-expiry:before, .jp-card .jp-card-front .jp-card-lower .jp-card-expiry:after {\n        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n        font-weight: bold;\n        font-size: 7px;\n        white-space: pre;\n        display: block;\n        opacity: .5; }\n      .jp-card .jp-card-front .jp-card-lower .jp-card-expiry:before {\n        content: attr(data-before);\n        margin-bottom: 2px;\n        font-size: 7px;\n        text-transform: uppercase; }\n      .jp-card .jp-card-front .jp-card-lower .jp-card-expiry:after {\n        position: absolute;\n        content: attr(data-after);\n        text-align: right;\n        right: 100%;\n        margin-right: 5px;\n        margin-top: 2px;\n        bottom: 0; }\n    .jp-card .jp-card-front .jp-card-lower .jp-card-name {\n      text-transform: uppercase;\n      font-family: "Bitstream Vera Sans Mono", Consolas, Courier, monospace;\n      font-size: 20px;\n      max-height: 45px;\n      position: absolute;\n      bottom: 0;\n      width: 190px;\n      display: -webkit-box;\n      -webkit-line-clamp: 2;\n      -webkit-box-orient: horizontal;\n      overflow: hidden;\n      text-overflow: ellipsis; }\n  .jp-card .jp-card-back {\n    -webkit-transform: rotateY(180deg);\n    -moz-transform: rotateY(180deg);\n    -ms-transform: rotateY(180deg);\n    -o-transform: rotateY(180deg);\n    transform: rotateY(180deg); }\n    .jp-card .jp-card-back .jp-card-bar {\n      background-color: #444;\n      background-image: -webkit-linear-gradient(#444, #333);\n      background-image: linear-gradient(#444, #333);\n      width: 100%;\n      height: 20%;\n      position: absolute;\n      top: 10%; }\n    .jp-card .jp-card-back:after {\n      content: " ";\n      display: block;\n      background-color: #FFF;\n      background-image: -webkit-linear-gradient(#FFF, #FFF);\n      background-image: linear-gradient(#FFF, #FFF);\n      width: 80%;\n      height: 16%;\n      position: absolute;\n      top: 40%;\n      left: 2%; }\n    .jp-card .jp-card-back .jp-card-cvc {\n      position: absolute;\n      top: 40%;\n      left: 85%;\n      -webkit-transition-delay: 600ms;\n      -moz-transition-delay: 600ms;\n      transition-delay: 600ms; }\n    .jp-card .jp-card-back .jp-card-shiny {\n      position: absolute;\n      top: 66%;\n      left: 2%; }\n      .jp-card .jp-card-back .jp-card-shiny:after {\n        content: "This card has been issued by Jesse Pollak and is licensed for anyone to use anywhere for free. It comes with no warranty. For support issues, please visit: github.com/jessepollak/card.";\n        position: absolute;\n        left: 120%;\n        top: 5%;\n        color: white;\n        font-size: 7px;\n        width: 230px;\n        opacity: .5; }\n  .jp-card.jp-card-identified {\n    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3); }\n    .jp-card.jp-card-identified .jp-card-front, .jp-card.jp-card-identified .jp-card-back {\n      background-color: #000;\n      background-color: rgba(0, 0, 0, 0.5); }\n      .jp-card.jp-card-identified .jp-card-front:before, .jp-card.jp-card-identified .jp-card-back:before {\n        -webkit-transition: all 400ms ease;\n        -moz-transition: all 400ms ease;\n        transition: all 400ms ease;\n        background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.05) 1px, rgba(255, 255, 255, 0) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.03) 4px), repeating-linear-gradient(90deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(210deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 90% 20%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 15% 80%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), -webkit-linear-gradient(-245deg, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.2) 70%, rgba(255, 255, 255, 0) 90%);\n        background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.05) 1px, rgba(255, 255, 255, 0) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.03) 4px), repeating-linear-gradient(90deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(210deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 90% 20%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-radial-gradient(circle at 15% 80%, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), linear-gradient(-25deg, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.2) 70%, rgba(255, 255, 255, 0) 90%);\n        opacity: 1; }\n      .jp-card.jp-card-identified .jp-card-front .jp-card-logo, .jp-card.jp-card-identified .jp-card-back .jp-card-logo {\n        box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3); }\n    .jp-card.jp-card-identified.no-radial-gradient .jp-card-front:before, .jp-card.jp-card-identified.no-radial-gradient .jp-card-back:before {\n      background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.05) 1px, rgba(255, 255, 255, 0) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.03) 4px), repeating-linear-gradient(90deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(210deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), -webkit-linear-gradient(-245deg, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.2) 70%, rgba(255, 255, 255, 0) 90%);\n      background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.05) 1px, rgba(255, 255, 255, 0) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.03) 4px), repeating-linear-gradient(90deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), repeating-linear-gradient(210deg, rgba(255, 255, 255, 0) 1px, rgba(255, 255, 255, 0.03) 2px, rgba(255, 255, 255, 0.04) 3px, rgba(255, 255, 255, 0.05) 4px), linear-gradient(-25deg, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.2) 70%, rgba(255, 255, 255, 0) 90%); }\n',""])},function(module,exports){module.exports=function(){var list=[];list.toString=function toString(){var result=[];for(var i=0;i<this.length;i++){var item=this[i];if(item[2]){result.push("@media "+item[2]+"{"+item[1]+"}")}else{result.push(item[1])}}return result.join("")};list.i=function(modules,mediaQuery){if(typeof modules==="string")modules=[[null,modules,""]];var alreadyImportedModules={};for(var i=0;i<this.length;i++){var id=this[i][0];if(typeof id==="number")alreadyImportedModules[id]=true}for(i=0;i<modules.length;i++){var item=modules[i];if(typeof item[0]!=="number"||!alreadyImportedModules[item[0]]){if(mediaQuery&&!item[2]){item[2]=mediaQuery}else if(mediaQuery){item[2]="("+item[2]+") and ("+mediaQuery+")"}list.push(item)}}};return list}},function(module,exports,__webpack_require__){var stylesInDom={},memoize=function(fn){var memo;return function(){if(typeof memo==="undefined")memo=fn.apply(this,arguments);return memo}},isOldIE=memoize(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),getHeadElement=memoize(function(){return document.head||document.getElementsByTagName("head")[0]}),singletonElement=null,singletonCounter=0,styleElementsInsertedAtTop=[];module.exports=function(list,options){if(false){if(typeof document!=="object")throw new Error("The style-loader cannot be used in a non-browser environment")}options=options||{};if(typeof options.singleton==="undefined")options.singleton=isOldIE();if(typeof options.insertAt==="undefined")options.insertAt="bottom";var styles=listToStyles(list);addStylesToDom(styles,options);return function update(newList){var mayRemove=[];for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];domStyle.refs--;mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList);addStylesToDom(newStyles,options)}for(var i=0;i<mayRemove.length;i++){var domStyle=mayRemove[i];if(domStyle.refs===0){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++){domStyle.parts[j](item.parts[j])}for(;j<item.parts.length;j++){domStyle.parts.push(addStyle(item.parts[j],options))}}else{var parts=[];for(var j=0;j<item.parts.length;j++){parts.push(addStyle(item.parts[j],options))}stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list){var styles=[];var newStyles={};for(var i=0;i<list.length;i++){var item=list[i];var id=item[0];var css=item[1];var media=item[2];var sourceMap=item[3];var part={css:css,media:media,sourceMap:sourceMap};if(!newStyles[id])styles.push(newStyles[id]={id:id,parts:[part]});else newStyles[id].parts.push(part)}return styles}function insertStyleElement(options,styleElement){var head=getHeadElement();var lastStyleElementInsertedAtTop=styleElementsInsertedAtTop[styleElementsInsertedAtTop.length-1];if(options.insertAt==="top"){if(!lastStyleElementInsertedAtTop){head.insertBefore(styleElement,head.firstChild)}else if(lastStyleElementInsertedAtTop.nextSibling){head.insertBefore(styleElement,lastStyleElementInsertedAtTop.nextSibling)}else{head.appendChild(styleElement)}styleElementsInsertedAtTop.push(styleElement)}else if(options.insertAt==="bottom"){head.appendChild(styleElement)}else{throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")}}function removeStyleElement(styleElement){styleElement.parentNode.removeChild(styleElement);var idx=styleElementsInsertedAtTop.indexOf(styleElement);if(idx>=0){styleElementsInsertedAtTop.splice(idx,1)}}function createStyleElement(options){var styleElement=document.createElement("style");styleElement.type="text/css";insertStyleElement(options,styleElement);return styleElement}function createLinkElement(options){var linkElement=document.createElement("link");linkElement.rel="stylesheet";insertStyleElement(options,linkElement);return linkElement}function addStyle(obj,options){var styleElement,update,remove;if(options.singleton){var styleIndex=singletonCounter++;styleElement=singletonElement||(singletonElement=createStyleElement(options));update=applyToSingletonTag.bind(null,styleElement,styleIndex,false);remove=applyToSingletonTag.bind(null,styleElement,styleIndex,true)}else if(obj.sourceMap&&typeof URL==="function"&&typeof URL.createObjectURL==="function"&&typeof URL.revokeObjectURL==="function"&&typeof Blob==="function"&&typeof btoa==="function"){styleElement=createLinkElement(options);update=updateLink.bind(null,styleElement);remove=function(){removeStyleElement(styleElement);if(styleElement.href)URL.revokeObjectURL(styleElement.href)}}else{styleElement=createStyleElement(options);update=applyToTag.bind(null,styleElement);remove=function(){removeStyleElement(styleElement)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else{remove()}}}var replaceText=function(){var textStore=[];return function(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet){styleElement.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=styleElement.childNodes;if(childNodes[index])styleElement.removeChild(childNodes[index]);if(childNodes.length){styleElement.insertBefore(cssNode,childNodes[index])}else{styleElement.appendChild(cssNode)}}}function applyToTag(styleElement,obj){var css=obj.css;var media=obj.media;if(media){styleElement.setAttribute("media",media)}if(styleElement.styleSheet){styleElement.styleSheet.cssText=css}else{while(styleElement.firstChild){styleElement.removeChild(styleElement.firstChild)}styleElement.appendChild(document.createTextNode(css))}}function updateLink(linkElement,obj){var css=obj.css;var sourceMap=obj.sourceMap;if(sourceMap){css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"}var blob=new Blob([css],{type:"text/css"});var oldSrc=linkElement.href;linkElement.href=URL.createObjectURL(blob);if(oldSrc)URL.revokeObjectURL(oldSrc)}},function(module,exports){(function(){var QJ,rreturn,rtrim;QJ=function(selector){if(QJ.isDOMElement(selector)){return selector}return document.querySelectorAll(selector)};QJ.isDOMElement=function(el){return el&&el.nodeName!=null};rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;QJ.trim=function(text){if(text===null){return""}else{return(text+"").replace(rtrim,"")}};rreturn=/\r/g;QJ.val=function(el,val){var ret;if(arguments.length>1){return el.value=val}else{ret=el.value;if(typeof ret==="string"){return ret.replace(rreturn,"")}else{if(ret===null){return""}else{return ret}}}};QJ.preventDefault=function(eventObject){if(typeof eventObject.preventDefault==="function"){eventObject.preventDefault();return}eventObject.returnValue=false;return false};QJ.normalizeEvent=function(e){var original;original=e;e={which:original.which!=null?original.which:void 0,target:original.target||original.srcElement,preventDefault:function(){return QJ.preventDefault(original)},originalEvent:original,data:original.data||original.detail};if(e.which==null){e.which=original.charCode!=null?original.charCode:original.keyCode}return e};QJ.on=function(element,eventName,callback){var el,i,j,len,len1,multEventName,originalCallback,ref;if(element.length){for(i=0,len=element.length;i<len;i++){el=element[i];QJ.on(el,eventName,callback)}return}if(eventName.match(" ")){ref=eventName.split(" ");for(j=0,len1=ref.length;j<len1;j++){multEventName=ref[j];QJ.on(element,multEventName,callback)}return}originalCallback=callback;callback=function(e){e=QJ.normalizeEvent(e);return originalCallback(e)};if(element.addEventListener){return element.addEventListener(eventName,callback,false)}if(element.attachEvent){eventName="on"+eventName;return element.attachEvent(eventName,callback)}element["on"+eventName]=callback};QJ.addClass=function(el,className){var e;if(el.length){return function(){var i,len,results;results=[];for(i=0,len=el.length;i<len;i++){e=el[i];results.push(QJ.addClass(e,className))}return results}()}if(el.classList){return el.classList.add(className)}else{return el.className+=" "+className}};QJ.hasClass=function(el,className){var e,hasClass,i,len;if(el.length){hasClass=true;for(i=0,len=el.length;i<len;i++){e=el[i];hasClass=hasClass&&QJ.hasClass(e,className)}return hasClass}if(el.classList){return el.classList.contains(className)}else{return new RegExp("(^| )"+className+"( |$)","gi").test(el.className)}};QJ.removeClass=function(el,className){var cls,e,i,len,ref,results;if(el.length){return function(){var i,len,results;results=[];for(i=0,len=el.length;i<len;i++){e=el[i];results.push(QJ.removeClass(e,className))}return results}()}if(el.classList){ref=className.split(" ");results=[];for(i=0,len=ref.length;i<len;i++){cls=ref[i];results.push(el.classList.remove(cls))}return results}else{return el.className=el.className.replace(new RegExp("(^|\\b)"+className.split(" ").join("|")+"(\\b|$)","gi")," ")}};QJ.toggleClass=function(el,className,bool){var e;if(el.length){return function(){var i,len,results;results=[];for(i=0,len=el.length;i<len;i++){e=el[i];results.push(QJ.toggleClass(e,className,bool))}return results}()}if(bool){if(!QJ.hasClass(el,className)){return QJ.addClass(el,className)}}else{return QJ.removeClass(el,className)}};QJ.append=function(el,toAppend){var e;if(el.length){return function(){var i,len,results;results=[];for(i=0,len=el.length;i<len;i++){e=el[i];results.push(QJ.append(e,toAppend))}return results}()}return el.insertAdjacentHTML("beforeend",toAppend)};QJ.find=function(el,selector){if(el instanceof NodeList||el instanceof Array){el=el[0]}return el.querySelectorAll(selector)};QJ.trigger=function(el,name,data){var e,error,ev;try{ev=new CustomEvent(name,{detail:data})}catch(error){e=error;ev=document.createEvent("CustomEvent");if(ev.initCustomEvent){ev.initCustomEvent(name,true,true,data)}else{ev.initEvent(name,true,true,data)}}return el.dispatchEvent(ev)};module.exports=QJ}).call(this)},function(module,exports,__webpack_require__){(function(global){(function(){var Payment,QJ,cardFromNumber,cardFromType,cards,defaultFormat,formatBackCardNumber,formatBackExpiry,formatCardNumber,formatExpiry,formatForwardExpiry,formatForwardSlash,formatMonthExpiry,hasTextSelected,luhnCheck,reFormatCardNumber,restrictCVC,restrictCardNumber,restrictCombinedExpiry,restrictExpiry,restrictMonthExpiry,restrictNumeric,restrictYearExpiry,setCardType,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};QJ=__webpack_require__(6);defaultFormat=/(\d{1,4})/g;cards=[{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:true},{type:"dankort",pattern:/^5019/,format:defaultFormat,length:[16],cvcLength:[3],luhn:true},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:true},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:defaultFormat,length:[16],cvcLength:[3],luhn:true},{type:"jcb",pattern:/^35/,format:defaultFormat,length:[16],cvcLength:[3],luhn:true},{type:"laser",pattern:/^(6706|6771|6709)/,format:defaultFormat,length:[16,17,18,19],cvcLength:[3],luhn:true},{type:"maestro",pattern:/^(5018|5020|5038|6304|6703|6708|6759|676[1-3])/,format:defaultFormat,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:true},{type:"mastercard",pattern:/^(5[1-5]|677189)|^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)/,format:defaultFormat,length:[16],cvcLength:[3],luhn:true},{type:"unionpay",pattern:/^62/,format:defaultFormat,length:[16,17,18,19],cvcLength:[3],luhn:false},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:defaultFormat,length:[16],cvcLength:[3],luhn:true},{type:"elo",pattern:/^(4011|438935|45(1416|76|7393)|50(4175|6699|67|90[4-7])|63(6297|6368))/,format:defaultFormat,length:[16],cvcLength:[3],luhn:true},{type:"visa",pattern:/^4/,format:defaultFormat,length:[13,16,19],cvcLength:[3],luhn:true}];cardFromNumber=function(num){var card,j,len;num=(num+"").replace(/\D/g,"");for(j=0,len=cards.length;j<len;j++){card=cards[j];if(card.pattern.test(num)){return card}}};cardFromType=function(type){var card,j,len;for(j=0,len=cards.length;j<len;j++){card=cards[j];if(card.type===type){return card}}};luhnCheck=function(num){var digit,digits,j,len,odd,sum;odd=true;sum=0;digits=(num+"").split("").reverse();for(j=0,len=digits.length;j<len;j++){digit=digits[j];digit=parseInt(digit,10);if(odd=!odd){digit*=2}if(digit>9){digit-=9}sum+=digit}return sum%10===0};hasTextSelected=function(target){var e,error,ref;try{if(target.selectionStart!=null&&target.selectionStart!==target.selectionEnd){return true}if((typeof document!=="undefined"&&document!==null?(ref=document.selection)!=null?ref.createRange:void 0:void 0)!=null){if(document.selection.createRange().text){return true}}}catch(error){e=error}return false};reFormatCardNumber=function(e){return setTimeout(function(_this){return function(){var target,value;target=e.target;value=QJ.val(target);value=Payment.fns.formatCardNumber(value);QJ.val(target,value);return QJ.trigger(target,"change")}}(this))};formatCardNumber=function(e){var card,digit,i,j,len,length,re,target,upperLength,upperLengths,value;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}target=e.target;value=QJ.val(target);card=cardFromNumber(value+digit);length=(value.replace(/\D/g,"")+digit).length;upperLengths=[16];if(card){upperLengths=card.length}for(i=j=0,len=upperLengths.length;j<len;i=++j){upperLength=upperLengths[i];if(length>=upperLength&&upperLengths[i+1]){continue}if(length>=upperLength){return}}if(hasTextSelected(target)){return}if(card&&card.type==="amex"){re=/^(\d{4}|\d{4}\s\d{6})$/}else{re=/(?:^|\s)(\d{4})$/}if(re.test(value)){e.preventDefault();QJ.val(target,value+" "+digit);return QJ.trigger(target,"change")}};formatBackCardNumber=function(e){var target,value;target=e.target;value=QJ.val(target);if(e.meta){return}if(e.which!==8){return}if(hasTextSelected(target)){return}if(/\d\s$/.test(value)){e.preventDefault();QJ.val(target,value.replace(/\d\s$/,""));return QJ.trigger(target,"change")}else if(/\s\d?$/.test(value)){e.preventDefault();QJ.val(target,value.replace(/\s\d?$/,""));return QJ.trigger(target,"change")}};formatExpiry=function(e){var digit,target,val;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}target=e.target;val=QJ.val(target)+digit;if(/^\d$/.test(val)&&(val!=="0"&&val!=="1")){e.preventDefault();QJ.val(target,"0"+val+" / ");return QJ.trigger(target,"change")}else if(/^\d\d$/.test(val)){e.preventDefault();QJ.val(target,val+" / ");return QJ.trigger(target,"change")}};formatMonthExpiry=function(e){var digit,target,val;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}target=e.target;val=QJ.val(target)+digit;if(/^\d$/.test(val)&&(val!=="0"&&val!=="1")){e.preventDefault();QJ.val(target,"0"+val);return QJ.trigger(target,"change")}else if(/^\d\d$/.test(val)){e.preventDefault();QJ.val(target,""+val);return QJ.trigger(target,"change")}};formatForwardExpiry=function(e){var digit,target,val;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}target=e.target;val=QJ.val(target);if(/^\d\d$/.test(val)){QJ.val(target,val+" / ");return QJ.trigger(target,"change")}};formatForwardSlash=function(e){var slash,target,val;slash=String.fromCharCode(e.which);if(slash!=="/"){return}target=e.target;val=QJ.val(target);if(/^\d$/.test(val)&&val!=="0"){QJ.val(target,"0"+val+" / ");return QJ.trigger(target,"change")}};formatBackExpiry=function(e){var target,value;if(e.metaKey){return}target=e.target;value=QJ.val(target);if(e.which!==8){return}if(hasTextSelected(target)){return}if(/\d(\s|\/)+$/.test(value)){e.preventDefault();QJ.val(target,value.replace(/\d(\s|\/)*$/,""));return QJ.trigger(target,"change")}else if(/\s\/\s?\d?$/.test(value)){e.preventDefault();QJ.val(target,value.replace(/\s\/\s?\d?$/,""));return QJ.trigger(target,"change")}};restrictNumeric=function(e){var input;if(e.metaKey||e.ctrlKey){return true}if(e.which===32){return e.preventDefault()}if(e.which===0){return true}if(e.which<33){return true}input=String.fromCharCode(e.which);if(!/[\d\s]/.test(input)){return e.preventDefault()}};restrictCardNumber=function(e){var card,digit,target,value;target=e.target;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}if(hasTextSelected(target)){return}value=(QJ.val(target)+digit).replace(/\D/g,"");card=cardFromNumber(value);if(card){if(!(value.length<=card.length[card.length.length-1])){return e.preventDefault()}}else{if(!(value.length<=16)){return e.preventDefault()}}};restrictExpiry=function(e,length){var digit,target,value;target=e.target;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}if(hasTextSelected(target)){return}value=QJ.val(target)+digit;value=value.replace(/\D/g,"");if(value.length>length){return e.preventDefault()}};restrictCombinedExpiry=function(e){return restrictExpiry(e,6)};restrictMonthExpiry=function(e){return restrictExpiry(e,2)};restrictYearExpiry=function(e){return restrictExpiry(e,4)};restrictCVC=function(e){var digit,target,val;target=e.target;digit=String.fromCharCode(e.which);if(!/^\d+$/.test(digit)){return}if(hasTextSelected(target)){return}val=QJ.val(target)+digit;if(!(val.length<=4)){return e.preventDefault()}};setCardType=function(e){var allTypes,card,cardType,target,val;target=e.target;val=QJ.val(target);cardType=Payment.fns.cardType(val)||"unknown";if(!QJ.hasClass(target,cardType)){allTypes=function(){var j,len,results;results=[];for(j=0,len=cards.length;j<len;j++){card=cards[j];results.push(card.type)}return results}();QJ.removeClass(target,"unknown");QJ.removeClass(target,allTypes.join(" "));QJ.addClass(target,cardType);QJ.toggleClass(target,"identified",cardType!=="unknown");return QJ.trigger(target,"payment.cardType",cardType)}};Payment=function(){function Payment(){}Payment.fns={cardExpiryVal:function(value){var month,prefix,ref,year;value=value.replace(/\s/g,"");ref=value.split("/",2),month=ref[0],year=ref[1];if((year!=null?year.length:void 0)===2&&/^\d+$/.test(year)){prefix=(new Date).getFullYear();prefix=prefix.toString().slice(0,2);year=prefix+year}month=parseInt(month,10);year=parseInt(year,10);return{month:month,year:year}},validateCardNumber:function(num){var card,ref;num=(num+"").replace(/\s+|-/g,"");if(!/^\d+$/.test(num)){return false}card=cardFromNumber(num);if(!card){return false}return(ref=num.length,indexOf.call(card.length,ref)>=0)&&(card.luhn===false||luhnCheck(num))},validateCardExpiry:function(month,year){var currentTime,expiry,prefix,ref,ref1;if(typeof month==="object"&&"month"in month){ref=month,month=ref.month,year=ref.year}else if(typeof month==="string"&&indexOf.call(month,"/")>=0){ref1=Payment.fns.cardExpiryVal(month),month=ref1.month,year=ref1.year}if(!(month&&year)){return false}month=QJ.trim(month);year=QJ.trim(year);if(!/^\d+$/.test(month)){return false}if(!/^\d+$/.test(year)){return false}month=parseInt(month,10);if(!(month&&month<=12)){return false}if(year.length===2){prefix=(new Date).getFullYear();prefix=prefix.toString().slice(0,2);year=prefix+year}expiry=new Date(year,month);currentTime=new Date;expiry.setMonth(expiry.getMonth()-1);expiry.setMonth(expiry.getMonth()+1,1);return expiry>currentTime},validateCardCVC:function(cvc,type){var ref,ref1;cvc=QJ.trim(cvc);if(!/^\d+$/.test(cvc)){return false}if(type&&cardFromType(type)){return ref=cvc.length,indexOf.call((ref1=cardFromType(type))!=null?ref1.cvcLength:void 0,ref)>=0}else{return cvc.length>=3&&cvc.length<=4}},cardType:function(num){var ref;if(!num){return null}return((ref=cardFromNumber(num))!=null?ref.type:void 0)||null},formatCardNumber:function(num){var card,groups,ref,upperLength;card=cardFromNumber(num);if(!card){return num}upperLength=card.length[card.length.length-1];num=num.replace(/\D/g,"");num=num.slice(0,upperLength);if(card.format.global){return(ref=num.match(card.format))!=null?ref.join(" "):void 0}else{groups=card.format.exec(num);if(groups!=null){groups.shift()}return groups!=null?groups.join(" "):void 0}}};Payment.restrictNumeric=function(el){return QJ.on(el,"keypress",restrictNumeric)};Payment.cardExpiryVal=function(el){return Payment.fns.cardExpiryVal(QJ.val(el))};Payment.formatCardCVC=function(el){Payment.restrictNumeric(el);QJ.on(el,"keypress",restrictCVC);return el};Payment.formatCardExpiry=function(el){var month,year;Payment.restrictNumeric(el);if(el.length&&el.length===2){month=el[0],year=el[1];this.formatCardExpiryMultiple(month,year)}else{QJ.on(el,"keypress",restrictCombinedExpiry);QJ.on(el,"keypress",formatExpiry);QJ.on(el,"keypress",formatForwardSlash);QJ.on(el,"keypress",formatForwardExpiry);QJ.on(el,"keydown",formatBackExpiry)}return el};Payment.formatCardExpiryMultiple=function(month,year){QJ.on(month,"keypress",restrictMonthExpiry);QJ.on(month,"keypress",formatMonthExpiry);return QJ.on(year,"keypress",restrictYearExpiry)};Payment.formatCardNumber=function(el){Payment.restrictNumeric(el);QJ.on(el,"keypress",restrictCardNumber);QJ.on(el,"keypress",formatCardNumber);QJ.on(el,"keydown",formatBackCardNumber);QJ.on(el,"keyup blur",setCardType);QJ.on(el,"paste",reFormatCardNumber);return el};Payment.getCardArray=function(){return cards};Payment.setCardArray=function(cardArray){cards=cardArray;return true};Payment.addToCardArray=function(cardObject){return cards.push(cardObject)};Payment.removeFromCardArray=function(type){var key,value;for(key in cards){value=cards[key];if(value.type===type){cards.splice(key,1)}}return true};return Payment}();module.exports=Payment;global.Payment=Payment}).call(this)}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(9)},function(module,exports,__webpack_require__){"use strict";var is=__webpack_require__(10);var extend=function extend(){var target=arguments[0]||{};var i=1;var length=arguments.length;var deep=false;var options,name,src,copy,copyIsArray,clone;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!is.fn(target)){target={}}for(;i<length;i++){options=arguments[i];if(options!=null){if(typeof options==="string"){options=options.split("")}for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(is.hash(copy)||(copyIsArray=is.array(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&is.array(src)?src:[]}else{clone=src&&is.hash(src)?src:{}}target[name]=extend(deep,clone,copy)}else if(typeof copy!=="undefined"){target[name]=copy}}}}return target};extend.version="1.1.3";module.exports=extend},function(module,exports){"use strict";var objProto=Object.prototype;var owns=objProto.hasOwnProperty;var toStr=objProto.toString;var symbolValueOf;if(typeof Symbol==="function"){symbolValueOf=Symbol.prototype.valueOf}var isActualNaN=function(value){return value!==value};var NON_HOST_TYPES={boolean:1,number:1,string:1,undefined:1};var base64Regex=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/;var hexRegex=/^[A-Fa-f0-9]+$/;var is={};is.a=is.type=function(value,type){return typeof value===type};is.defined=function(value){return typeof value!=="undefined"};is.empty=function(value){var type=toStr.call(value);var key;if(type==="[object Array]"||type==="[object Arguments]"||type==="[object String]"){return value.length===0}if(type==="[object Object]"){for(key in value){if(owns.call(value,key)){return false}}return true}return!value};is.equal=function equal(value,other){if(value===other){return true}var type=toStr.call(value);var key;if(type!==toStr.call(other)){return false}if(type==="[object Object]"){for(key in value){if(!is.equal(value[key],other[key])||!(key in other)){return false}}for(key in other){if(!is.equal(value[key],other[key])||!(key in value)){return false}}return true}if(type==="[object Array]"){key=value.length;if(key!==other.length){return false}while(key--){if(!is.equal(value[key],other[key])){return false}}return true}if(type==="[object Function]"){return value.prototype===other.prototype}if(type==="[object Date]"){return value.getTime()===other.getTime()}return false};is.hosted=function(value,host){var type=typeof host[value];return type==="object"?!!host[value]:!NON_HOST_TYPES[type]};is.instance=is["instanceof"]=function(value,constructor){return value instanceof constructor};is.nil=is["null"]=function(value){return value===null};is.undef=is.undefined=function(value){return typeof value==="undefined"};is.args=is.arguments=function(value){var isStandardArguments=toStr.call(value)==="[object Arguments]";var isOldArguments=!is.array(value)&&is.arraylike(value)&&is.object(value)&&is.fn(value.callee);return isStandardArguments||isOldArguments};is.array=Array.isArray||function(value){return toStr.call(value)==="[object Array]"};is.args.empty=function(value){return is.args(value)&&value.length===0};is.array.empty=function(value){return is.array(value)&&value.length===0};is.arraylike=function(value){return!!value&&!is.bool(value)&&owns.call(value,"length")&&isFinite(value.length)&&is.number(value.length)&&value.length>=0};is.bool=is["boolean"]=function(value){return toStr.call(value)==="[object Boolean]"};is["false"]=function(value){return is.bool(value)&&Boolean(Number(value))===false};is["true"]=function(value){return is.bool(value)&&Boolean(Number(value))===true};is.date=function(value){return toStr.call(value)==="[object Date]"};is.date.valid=function(value){return is.date(value)&&!isNaN(Number(value))};is.element=function(value){return value!==undefined&&typeof HTMLElement!=="undefined"&&value instanceof HTMLElement&&value.nodeType===1};is.error=function(value){return toStr.call(value)==="[object Error]"};is.fn=is["function"]=function(value){var isAlert=typeof window!=="undefined"&&value===window.alert;return isAlert||toStr.call(value)==="[object Function]"};is.number=function(value){return toStr.call(value)==="[object Number]"};is.infinite=function(value){return value===Infinity||value===-Infinity};is.decimal=function(value){return is.number(value)&&!isActualNaN(value)&&!is.infinite(value)&&value%1!==0};is.divisibleBy=function(value,n){var isDividendInfinite=is.infinite(value);var isDivisorInfinite=is.infinite(n);var isNonZeroNumber=is.number(value)&&!isActualNaN(value)&&is.number(n)&&!isActualNaN(n)&&n!==0;return isDividendInfinite||isDivisorInfinite||isNonZeroNumber&&value%n===0};is.integer=is["int"]=function(value){return is.number(value)&&!isActualNaN(value)&&value%1===0};is.maximum=function(value,others){if(isActualNaN(value)){throw new TypeError("NaN is not a valid value")}else if(!is.arraylike(others)){throw new TypeError("second argument must be array-like")}var len=others.length;while(--len>=0){if(value<others[len]){return false}}return true};is.minimum=function(value,others){if(isActualNaN(value)){throw new TypeError("NaN is not a valid value")}else if(!is.arraylike(others)){throw new TypeError("second argument must be array-like")}var len=others.length;while(--len>=0){if(value>others[len]){return false}}return true};is.nan=function(value){return!is.number(value)||value!==value};is.even=function(value){return is.infinite(value)||is.number(value)&&value===value&&value%2===0};is.odd=function(value){return is.infinite(value)||is.number(value)&&value===value&&value%2!==0};is.ge=function(value,other){if(isActualNaN(value)||isActualNaN(other)){throw new TypeError("NaN is not a valid value")}return!is.infinite(value)&&!is.infinite(other)&&value>=other};is.gt=function(value,other){if(isActualNaN(value)||isActualNaN(other)){throw new TypeError("NaN is not a valid value")}return!is.infinite(value)&&!is.infinite(other)&&value>other};is.le=function(value,other){if(isActualNaN(value)||isActualNaN(other)){throw new TypeError("NaN is not a valid value")}return!is.infinite(value)&&!is.infinite(other)&&value<=other};is.lt=function(value,other){if(isActualNaN(value)||isActualNaN(other)){throw new TypeError("NaN is not a valid value")}return!is.infinite(value)&&!is.infinite(other)&&value<other};is.within=function(value,start,finish){if(isActualNaN(value)||isActualNaN(start)||isActualNaN(finish)){throw new TypeError("NaN is not a valid value")}else if(!is.number(value)||!is.number(start)||!is.number(finish)){throw new TypeError("all arguments must be numbers")}var isAnyInfinite=is.infinite(value)||is.infinite(start)||is.infinite(finish);return isAnyInfinite||value>=start&&value<=finish};is.object=function(value){return toStr.call(value)==="[object Object]"};is.primitive=function isPrimitive(value){if(!value){return true}if(typeof value==="object"||is.object(value)||is.fn(value)||is.array(value)){return false}return true};is.hash=function(value){return is.object(value)&&value.constructor===Object&&!value.nodeType&&!value.setInterval};is.regexp=function(value){return toStr.call(value)==="[object RegExp]"};is.string=function(value){return toStr.call(value)==="[object String]"};is.base64=function(value){return is.string(value)&&(!value.length||base64Regex.test(value))};is.hex=function(value){return is.string(value)&&(!value.length||hexRegex.test(value))};is.symbol=function(value){return typeof Symbol==="function"&&toStr.call(value)==="[object Symbol]"&&typeof symbolValueOf.call(value)==="symbol"};module.exports=is},function(module,exports){module.exports=jQuery}]);
(function(global,factory){if(typeof define==="function"&&define.amd){define(factory)}else if(typeof module==="object"&&module.exports){module.exports=factory()}else{global.numeral=factory()}})(this,function(){var numeral,_,VERSION="2.0.4",formats={},locales={},defaults={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0"},options={currentLocale:defaults.currentLocale,zeroFormat:defaults.zeroFormat,nullFormat:defaults.nullFormat,defaultFormat:defaults.defaultFormat};function Numeral(input,number){this._input=input;this._value=number}numeral=function(input){var value,kind,unformatFunction,regexp;if(numeral.isNumeral(input)){value=input.value()}else if(input===0||typeof input==="undefined"){value=0}else if(input===null||_.isNaN(input)){value=null}else if(typeof input==="string"){if(options.zeroFormat&&input===options.zeroFormat){value=0}else if(options.nullFormat&&input===options.nullFormat||!input.replace(/[^0-9]+/g,"").length){value=null}else{for(kind in formats){regexp=typeof formats[kind].regexps.unformat==="function"?formats[kind].regexps.unformat():formats[kind].regexps.unformat;if(regexp&&input.match(regexp)){unformatFunction=formats[kind].unformat;break}}unformatFunction=unformatFunction||numeral._.stringToNumber;value=unformatFunction(input)}}else{value=Number(input)||null}return new Numeral(input,value)};numeral.version=VERSION;numeral.isNumeral=function(obj){return obj instanceof Numeral};numeral._=_={numberToFormat:function(value,format,roundingFunction){var locale=locales[numeral.options.currentLocale],negP=false,optDec=false,abbr="",trillion=1e12,billion=1e9,million=1e6,thousand=1e3,decimal="",neg=false,abbrForce,abs,min,max,power,int,precision,signed,thousands,output;value=value||0;abs=Math.abs(value);if(numeral._.includes(format,"(")){negP=true;format=format.replace(/[\(|\)]/g,"")}else if(numeral._.includes(format,"+")||numeral._.includes(format,"-")){signed=numeral._.includes(format,"+")?format.indexOf("+"):value<0?format.indexOf("-"):-1;format=format.replace(/[\+|\-]/g,"")}if(numeral._.includes(format,"a")){abbrForce=format.match(/a(k|m|b|t)?/);abbrForce=abbrForce?abbrForce[1]:false;if(numeral._.includes(format," a")){abbr=" "}format=format.replace(new RegExp(abbr+"a[kmbt]?"),"");if(abs>=trillion&&!abbrForce||abbrForce==="t"){abbr+=locale.abbreviations.trillion;value=value/trillion}else if(abs<trillion&&abs>=billion&&!abbrForce||abbrForce==="b"){abbr+=locale.abbreviations.billion;value=value/billion}else if(abs<billion&&abs>=million&&!abbrForce||abbrForce==="m"){abbr+=locale.abbreviations.million;value=value/million}else if(abs<million&&abs>=thousand&&!abbrForce||abbrForce==="k"){abbr+=locale.abbreviations.thousand;value=value/thousand}}if(numeral._.includes(format,"[.]")){optDec=true;format=format.replace("[.]",".")}int=value.toString().split(".")[0];precision=format.split(".")[1];thousands=format.indexOf(",");if(precision){if(numeral._.includes(precision,"[")){precision=precision.replace("]","");precision=precision.split("[");decimal=numeral._.toFixed(value,precision[0].length+precision[1].length,roundingFunction,precision[1].length)}else{decimal=numeral._.toFixed(value,precision.length,roundingFunction)}int=decimal.split(".")[0];if(numeral._.includes(decimal,".")){decimal=locale.delimiters.decimal+decimal.split(".")[1]}else{decimal=""}if(optDec&&Number(decimal.slice(1))===0){decimal=""}}else{int=numeral._.toFixed(value,null,roundingFunction)}if(abbr&&!abbrForce&&Number(int)>=1e3&&abbr!==locale.abbreviations.trillion){int=String(Number(int)/1e3);switch(abbr){case locale.abbreviations.thousand:abbr=locale.abbreviations.million;break;case locale.abbreviations.million:abbr=locale.abbreviations.billion;break;case locale.abbreviations.billion:abbr=locale.abbreviations.trillion;break}}if(numeral._.includes(int,"-")){int=int.slice(1);neg=true}if(thousands>-1){int=int.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+locale.delimiters.thousands)}if(format.indexOf(".")===0){int=""}output=int+decimal+(abbr?abbr:"");if(negP){output=(negP&&neg?"(":"")+output+(negP&&neg?")":"")}else{if(signed>=0){output=signed===0?(neg?"-":"+")+output:output+(neg?"-":"+")}else if(neg){output="-"+output}}return output},stringToNumber:function(string){var locale=locales[options.currentLocale],stringOriginal=string,abbreviations={thousand:3,million:6,billion:9,trillion:12},abbreviation,value,i,regexp;if(options.zeroFormat&&string===options.zeroFormat){value=0}else if(options.nullFormat&&string===options.nullFormat||!string.replace(/[^0-9]+/g,"").length){value=null}else{value=1;if(locale.delimiters.decimal!=="."){string=string.replace(/\./g,"").replace(locale.delimiters.decimal,".")}for(abbreviation in abbreviations){regexp=new RegExp("[^a-zA-Z]"+locale.abbreviations[abbreviation]+"(?:\\)|(\\"+locale.currency.symbol+")?(?:\\))?)?$");if(stringOriginal.match(regexp)){value*=Math.pow(10,abbreviations[abbreviation]);break}}value*=(string.split("-").length+Math.min(string.split("(").length-1,string.split(")").length-1))%2?1:-1;string=string.replace(/[^0-9\.]+/g,"");value*=Number(string)}return value},isNaN:function(value){return typeof value==="number"&&isNaN(value)},includes:function(string,search){return string.indexOf(search)!==-1},insert:function(string,subString,start){return string.slice(0,start)+subString+string.slice(start)},reduce:function(array,callback){if(this===null){throw new TypeError("Array.prototype.reduce called on null or undefined")}if(typeof callback!=="function"){throw new TypeError(callback+" is not a function")}var t=Object(array),len=t.length>>>0,k=0,value;if(arguments.length===3){value=arguments[2]}else{while(k<len&&!(k in t)){k++}if(k>=len){throw new TypeError("Reduce of empty array with no initial value")}value=t[k++]}for(;k<len;k++){if(k in t){value=callback(value,t[k],k,t)}}return value},multiplier:function(x){var parts=x.toString().split(".");return parts.length<2?1:Math.pow(10,parts[1].length)},correctionFactor:function(){var args=Array.prototype.slice.call(arguments);return args.reduce(function(accum,next){var mn=_.multiplier(next);return accum>mn?accum:mn},1)},toFixed:function(value,maxDecimals,roundingFunction,optionals){var splitValue=value.toString().split("."),minDecimals=maxDecimals-(optionals||0),boundedPrecision,optionalsRegExp,power,output;if(splitValue.length===2){boundedPrecision=Math.min(Math.max(splitValue[1].length,minDecimals),maxDecimals)}else{boundedPrecision=minDecimals}power=Math.pow(10,boundedPrecision);output=(roundingFunction(value*power)/power).toFixed(boundedPrecision);if(optionals>maxDecimals-boundedPrecision){optionalsRegExp=new RegExp("\\.?0{1,"+(optionals-(maxDecimals-boundedPrecision))+"}$");output=output.replace(optionalsRegExp,"")}return output}};numeral.options=options;numeral.formats=formats;numeral.locales=locales;numeral.locale=function(key){if(key){options.currentLocale=key.toLowerCase()}return options.currentLocale};numeral.localeData=function(key){if(!key){return locales[options.currentLocale]}key=key.toLowerCase();if(!locales[key]){throw new Error("Unknown locale : "+key)}return locales[key]};numeral.reset=function(){for(var property in defaults){options[property]=defaults[property]}};numeral.zeroFormat=function(format){options.zeroFormat=typeof format==="string"?format:null};numeral.nullFormat=function(format){options.nullFormat=typeof format==="string"?format:null};numeral.defaultFormat=function(format){options.defaultFormat=typeof format==="string"?format:"0.0"};numeral.register=function(type,name,format){name=name.toLowerCase();if(this[type+"s"][name]){throw new TypeError(name+" "+type+" already registered.")}this[type+"s"][name]=format;return format};numeral.validate=function(val,culture){var _decimalSep,_thousandSep,_currSymbol,_valArray,_abbrObj,_thousandRegEx,localeData,temp;if(typeof val!=="string"){val+="";if(console.warn){console.warn("Numeral.js: Value is not string. It has been co-erced to: ",val)}}val=val.trim();if(!!val.match(/^\d+$/)){return true}if(val===""){return false}try{localeData=numeral.localeData(culture)}catch(e){localeData=numeral.localeData(numeral.locale())}_currSymbol=localeData.currency.symbol;_abbrObj=localeData.abbreviations;_decimalSep=localeData.delimiters.decimal;if(localeData.delimiters.thousands==="."){_thousandSep="\\."}else{_thousandSep=localeData.delimiters.thousands}temp=val.match(/^[^\d]+/);if(temp!==null){val=val.substr(1);if(temp[0]!==_currSymbol){return false}}temp=val.match(/[^\d]+$/);if(temp!==null){val=val.slice(0,-1);if(temp[0]!==_abbrObj.thousand&&temp[0]!==_abbrObj.million&&temp[0]!==_abbrObj.billion&&temp[0]!==_abbrObj.trillion){return false}}_thousandRegEx=new RegExp(_thousandSep+"{2}");if(!val.match(/[^\d.,]/g)){_valArray=val.split(_decimalSep);if(_valArray.length>2){return false}else{if(_valArray.length<2){return!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)}else{if(_valArray[0].length===1){return!!_valArray[0].match(/^\d+$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)}else{return!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)}}}}return false};numeral.fn=Numeral.prototype={clone:function(){return numeral(this)},format:function(inputString,roundingFunction){var value=this._value,format=inputString||options.defaultFormat,kind,output,formatFunction;roundingFunction=roundingFunction||Math.round;if(value===0&&options.zeroFormat!==null){output=options.zeroFormat}else if(value===null&&options.nullFormat!==null){output=options.nullFormat}else{for(kind in formats){if(format.match(formats[kind].regexps.format)){formatFunction=formats[kind].format;break}}formatFunction=formatFunction||numeral._.numberToFormat;output=formatFunction(value,format,roundingFunction)}return output},value:function(){return this._value},input:function(){return this._input},set:function(value){this._value=Number(value);return this},add:function(value){var corrFactor=_.correctionFactor.call(null,this._value,value);function cback(accum,curr,currI,O){return accum+Math.round(corrFactor*curr)}this._value=_.reduce([this._value,value],cback,0)/corrFactor;return this},subtract:function(value){var corrFactor=_.correctionFactor.call(null,this._value,value);function cback(accum,curr,currI,O){return accum-Math.round(corrFactor*curr)}this._value=_.reduce([value],cback,Math.round(this._value*corrFactor))/corrFactor;return this},multiply:function(value){function cback(accum,curr,currI,O){var corrFactor=_.correctionFactor(accum,curr);return Math.round(accum*corrFactor)*Math.round(curr*corrFactor)/Math.round(corrFactor*corrFactor)}this._value=_.reduce([this._value,value],cback,1);return this},divide:function(value){function cback(accum,curr,currI,O){var corrFactor=_.correctionFactor(accum,curr);return Math.round(accum*corrFactor)/Math.round(curr*corrFactor)}this._value=_.reduce([this._value,value],cback);return this},difference:function(value){return Math.abs(numeral(this._value).subtract(value).value())}};numeral.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(number){var b=number%10;return~~(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th"},currency:{symbol:"$"}});(function(){var decimal={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},binary={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]};numeral.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp("("+decimal.suffixes.concat(binary.suffixes).join("|")+")")},format:function(value,format,roundingFunction){var output,bytes=numeral._.includes(format,"ib")?binary:decimal,suffix=numeral._.includes(format," b")||numeral._.includes(format," ib")?" ":"",power,min,max;format=format.replace(/\s?i?b/,"");for(power=0;power<=bytes.suffixes.length;power++){min=Math.pow(bytes.base,power);max=Math.pow(bytes.base,power+1);if(value===null||value===0||value>=min&&value<max){suffix+=bytes.suffixes[power];if(min>0){value=value/min}break}}output=numeral._.numberToFormat(value,format,roundingFunction);return output+suffix},unformat:function(string){var value=numeral._.stringToNumber(string),power,bytesMultiplier;if(value){for(power=decimal.suffixes.length-1;power>=0;power--){if(numeral._.includes(string,decimal.suffixes[power])){bytesMultiplier=Math.pow(decimal.base,power);break}if(numeral._.includes(string,binary.suffixes[power])){bytesMultiplier=Math.pow(binary.base,power);break}}value*=bytesMultiplier||1}return value}})})();(function(){numeral.register("format","currency",{regexps:{format:/(\$)/},format:function(value,format,roundingFunction){var locale=numeral.locales[numeral.options.currentLocale],symbols={before:format.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:format.match(/([\+|\-|\)|\s|\$]*)$/)[0]},output,symbol,i;format=format.replace(/\s?\$\s?/,"");output=numeral._.numberToFormat(value,format,roundingFunction);if(value>=0){symbols.before=symbols.before.replace(/[\-\(]/,"");symbols.after=symbols.after.replace(/[\-\)]/,"")}else if(value<0&&(!numeral._.includes(symbols.before,"-")&&!numeral._.includes(symbols.before,"("))){symbols.before="-"+symbols.before}for(i=0;i<symbols.before.length;i++){symbol=symbols.before[i];switch(symbol){case"$":output=numeral._.insert(output,locale.currency.symbol,i);break;case" ":output=numeral._.insert(output," ",i);break}}for(i=symbols.after.length-1;i>=0;i--){symbol=symbols.after[i];switch(symbol){case"$":output=i===symbols.after.length-1?output+locale.currency.symbol:numeral._.insert(output,locale.currency.symbol,-(symbols.after.length-(1+i)));break;case" ":output=i===symbols.after.length-1?output+" ":numeral._.insert(output," ",-(symbols.after.length-(1+i)));break}}return output}})})();(function(){numeral.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(value,format,roundingFunction){var output,exponential=typeof value==="number"&&!numeral._.isNaN(value)?value.toExponential():"0e+0",parts=exponential.split("e");format=format.replace(/e[\+|\-]{1}0/,"");output=numeral._.numberToFormat(Number(parts[0]),format,roundingFunction);return output+"e"+parts[1]},unformat:function(string){var parts=numeral._.includes(string,"e+")?string.split("e+"):string.split("e-"),value=Number(parts[0]),power=Number(parts[1]);power=numeral._.includes(string,"e-")?power*=-1:power;function cback(accum,curr,currI,O){var corrFactor=numeral._.correctionFactor(accum,curr),num=accum*corrFactor*(curr*corrFactor)/(corrFactor*corrFactor);return num}return numeral._.reduce([value,Math.pow(10,power)],cback,1)}})})();(function(){numeral.register("format","ordinal",{regexps:{format:/(o)/},format:function(value,format,roundingFunction){var locale=numeral.locales[numeral.options.currentLocale],output,ordinal=numeral._.includes(format," o")?" ":"";format=format.replace(/\s?o/,"");ordinal+=locale.ordinal(value);output=numeral._.numberToFormat(value,format,roundingFunction);return output+ordinal}})})();(function(){numeral.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(value,format,roundingFunction){var space=numeral._.includes(format," %")?" ":"",output;value=value*100;format=format.replace(/\s?\%/,"");output=numeral._.numberToFormat(value,format,roundingFunction);if(numeral._.includes(output,")")){output=output.split("");output.splice(-1,0,space+"%");output=output.join("")}else{output=output+space+"%"}return output},unformat:function(string){return numeral._.stringToNumber(string)*.01}})})();(function(){numeral.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(value,format,roundingFunction){var hours=Math.floor(value/60/60),minutes=Math.floor((value-hours*60*60)/60),seconds=Math.round(value-hours*60*60-minutes*60);return hours+":"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)},unformat:function(string){var timeArray=string.split(":"),seconds=0;if(timeArray.length===3){seconds=seconds+Number(timeArray[0])*60*60;seconds=seconds+Number(timeArray[1])*60;seconds=seconds+Number(timeArray[2])}else if(timeArray.length===2){seconds=seconds+Number(timeArray[0])*60;seconds=seconds+Number(timeArray[1])}return Number(seconds)}})})();return numeral});
(function(e,q,h){var o=function(a,b){var c=q.createElementNS("http://www.w3.org/2000/svg",a);e.each(b,function(a,b){c.setAttribute(a,b)});return c},t="createElementNS"in q&&o("svg",{}).createSVGRect,r=1/(window.devicePixelRatio||1),j=e.fn.peity=function(a,b){t&&this.each(function(){var c=e(this),d=c.data("peity");if(d)a&&(d.type=a),e.extend(d.opts,b);else{var f=j.defaults[a],g={};e.each(c.data(),function(a,b){a in f&&(g[a]=b)});var h=e.extend({},f,g,b),d=new s(c,a,h);c.change(function(){d.draw()}).data("peity",d)}d.draw()});return this},s=function(a,b,c){this.$el=a;this.type=b;this.opts=c},m=s.prototype;m.draw=function(){j.graphers[this.type].call(this,this.opts)};m.fill=function(){var a=this.opts.fill,b=a;e.isFunction(b)||(b=function(b,d){return a[d%a.length]});return b};m.prepare=function(a,b){var c;this.svg?c=e(this.svg).empty():(this.svg=o("svg",{class:"peity"}),this.$el.hide().after(this.svg),c=e(this.svg).data("peity",this));this.svg.setAttribute("height",b);this.svg.setAttribute("width",a);return c};m.values=function(){return e.map(this.$el.text().split(this.opts.delimiter),function(a){return parseFloat(a)})};j.defaults={};j.graphers={};j.register=function(a,b,c){this.defaults[a]=b;this.graphers[a]=c};j.register("pie",{delimiter:null,diameter:16,fill:["#ff9900","#fff4dd","#ffc66e"]},function(a){if(!a.delimiter){var b=this.$el.text().match(/[^0-9\.]/);a.delimiter=b?b[0]:","}b=this.values();if("/"==a.delimiter)var c=b[0],b=[c,h.max(0,b[1]-c)];for(var d=0,c=b.length,f=0;d<c;d++)f+=b[d];for(var a=this.prepare(a.width||a.diameter,a.height||a.diameter),d=a.width(),g=a.height(),a=d/2,g=g/2,p=h.min(a,g),e=h.PI,j=this.fill(),i=-e/2,d=0;d<c;d++){var n=b[d],l=n/f,k;if(0!=l){if(1==l)k=o("circle",{cx:a,cy:g,r:p});else{k=2*l*e;var l=i+k,m=p*h.cos(i)+a,i=p*h.sin(i)+g,q=p*h.cos(l)+a,r=p*h.sin(l)+g;k=o("path",{d:["M",a,g,"L",m,i,"A",p,p,0,k>e?1:0,1,q,r,"Z"].join(" ")});i=l}k.setAttribute("fill",j.call(this,n,d,b));this.svg.appendChild(k)}}});j.register("line",{delimiter:",",fill:"#c6d9fd",height:16,max:null,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(a){var b=this.values();1==b.length&&b.push(b[0]);for(var c=h.max.apply(h,b.concat([a.max])),d=h.min.apply(h,b.concat([a.min])),f=this.prepare(a.width,a.height),g=f.width(),f=f.height()-a.strokeWidth,e=g/(b.length-1),c=c-d,j=0==c?f:f/c,m=f+d*j,c=[0,m],i=0;i<b.length;i++)c.push(i*e,f-j*(b[i]-d)+a.strokeWidth/2);c.push(g,m);b=o("polygon",{fill:a.fill,points:c.join(" ")});this.svg.appendChild(b);a.strokeWidth&&(a=o("polyline",{fill:"transparent",points:c.slice(2,c.length-2).join(" "),stroke:a.stroke,"stroke-width":a.strokeWidth,"stroke-linecap":"square"}),this.svg.appendChild(a))});j.register("bar",{delimiter:",",fill:["#4D89F9"],gap:1,height:16,max:null,min:0,width:32},function(a){for(var b=this.values(),c=h.max.apply(h,b.concat([a.max])),d=h.min.apply(h,b.concat([a.min])),f=this.prepare(a.width,a.height),g=f.width(),f=f.height(),e=c-d,j=0==e?0:f/e,a=a.gap,g=(g+a)/b.length,m=this.fill(),i=0;i<b.length;i++){var n=b[i],l=f-j*(n-d),k=j*n;if(0==k){if(k=r,0>=d&&0<c||0==e)l-=r}else 0>k&&(l+=k,k=-k);n=o("rect",{fill:m.call(this,n,i,b),x:i*g,y:l,width:g-a,height:k});this.svg.appendChild(n)}})})(jQuery,document,Math);
(function(){var Dropzone,Emitter,camelize,contentLoaded,detectVerticalSquash,drawImageIOSFix,noop,without,__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};noop=function(){};Emitter=function(){function Emitter(){}Emitter.prototype.addEventListener=Emitter.prototype.on;Emitter.prototype.on=function(event,fn){this._callbacks=this._callbacks||{};if(!this._callbacks[event]){this._callbacks[event]=[]}this._callbacks[event].push(fn);return this};Emitter.prototype.emit=function(){var args,callback,callbacks,event,_i,_len;event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];this._callbacks=this._callbacks||{};callbacks=this._callbacks[event];if(callbacks){for(_i=0,_len=callbacks.length;_i<_len;_i++){callback=callbacks[_i];callback.apply(this,args)}}return this};Emitter.prototype.removeListener=Emitter.prototype.off;Emitter.prototype.removeAllListeners=Emitter.prototype.off;Emitter.prototype.removeEventListener=Emitter.prototype.off;Emitter.prototype.off=function(event,fn){var callback,callbacks,i,_i,_len;if(!this._callbacks||arguments.length===0){this._callbacks={};return this}callbacks=this._callbacks[event];if(!callbacks){return this}if(arguments.length===1){delete this._callbacks[event];return this}for(i=_i=0,_len=callbacks.length;_i<_len;i=++_i){callback=callbacks[i];if(callback===fn){callbacks.splice(i,1);break}}return this};return Emitter}();Dropzone=function(_super){var extend,resolveOption;__extends(Dropzone,_super);Dropzone.prototype.Emitter=Emitter;Dropzone.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"];Dropzone.prototype.defaultOptions={url:null,method:"post",withCredentials:false,parallelUploads:2,uploadMultiple:false,maxFilesize:256,paramName:"file",createImageThumbnails:true,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,params:{},clickable:true,ignoreHiddenFiles:true,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:true,autoQueue:true,addRemoveLinks:false,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(file,done){return done()},init:function(){return noop},forceFallback:false,fallback:function(){var child,messageElement,span,_i,_len,_ref;this.element.className=""+this.element.className+" dz-browser-not-supported";_ref=this.element.getElementsByTagName("div");for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];if(/(^| )dz-message($| )/.test(child.className)){messageElement=child;child.className="dz-message";continue}}if(!messageElement){messageElement=Dropzone.createElement('<div class="dz-message"><span></span></div>');this.element.appendChild(messageElement)}span=messageElement.getElementsByTagName("span")[0];if(span){if(span.textContent!=null){span.textContent=this.options.dictFallbackMessage}else if(span.innerText!=null){span.innerText=this.options.dictFallbackMessage}}return this.element.appendChild(this.getFallbackForm())},resize:function(file){var info,srcRatio,trgRatio;info={srcX:0,srcY:0,srcWidth:file.width,srcHeight:file.height};srcRatio=file.width/file.height;info.optWidth=this.options.thumbnailWidth;info.optHeight=this.options.thumbnailHeight;if(info.optWidth==null&&info.optHeight==null){info.optWidth=info.srcWidth;info.optHeight=info.srcHeight}else if(info.optWidth==null){info.optWidth=srcRatio*info.optHeight}else if(info.optHeight==null){info.optHeight=1/srcRatio*info.optWidth}trgRatio=info.optWidth/info.optHeight;if(file.height<info.optHeight||file.width<info.optWidth){info.trgHeight=info.srcHeight;info.trgWidth=info.srcWidth}else{if(srcRatio>trgRatio){info.srcHeight=file.height;info.srcWidth=info.srcHeight*trgRatio}else{info.srcWidth=file.width;info.srcHeight=info.srcWidth/trgRatio}}info.srcX=(file.width-info.srcWidth)/2;info.srcY=(file.height-info.srcHeight)/2;return info},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:noop,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:noop,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(file){var node,removeFileEvent,removeLink,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2,_results;if(this.element===this.previewsContainer){this.element.classList.add("dz-started")}if(this.previewsContainer){file.previewElement=Dropzone.createElement(this.options.previewTemplate.trim());file.previewTemplate=file.previewElement;this.previewsContainer.appendChild(file.previewElement);_ref=file.previewElement.querySelectorAll("[data-dz-name]");for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];node.textContent=this._renameFilename(file.name)}_ref1=file.previewElement.querySelectorAll("[data-dz-size]");for(_j=0,_len1=_ref1.length;_j<_len1;_j++){node=_ref1[_j];node.innerHTML=this.filesize(file.size)}if(this.options.addRemoveLinks){file._removeLink=Dropzone.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>");file.previewElement.appendChild(file._removeLink)}removeFileEvent=function(_this){return function(e){e.preventDefault();e.stopPropagation();if(file.status===Dropzone.UPLOADING){return Dropzone.confirm(_this.options.dictCancelUploadConfirmation,function(){return _this.removeFile(file)})}else{if(_this.options.dictRemoveFileConfirmation){return Dropzone.confirm(_this.options.dictRemoveFileConfirmation,function(){return _this.removeFile(file)})}else{return _this.removeFile(file)}}}}(this);_ref2=file.previewElement.querySelectorAll("[data-dz-remove]");_results=[];for(_k=0,_len2=_ref2.length;_k<_len2;_k++){removeLink=_ref2[_k];_results.push(removeLink.addEventListener("click",removeFileEvent))}return _results}},removedfile:function(file){var _ref;if(file.previewElement){if((_ref=file.previewElement)!=null){_ref.parentNode.removeChild(file.previewElement)}}return this._updateMaxFilesReachedClass()},thumbnail:function(file,dataUrl){var thumbnailElement,_i,_len,_ref;if(file.previewElement){file.previewElement.classList.remove("dz-file-preview");_ref=file.previewElement.querySelectorAll("[data-dz-thumbnail]");for(_i=0,_len=_ref.length;_i<_len;_i++){thumbnailElement=_ref[_i];thumbnailElement.alt=file.name;thumbnailElement.src=dataUrl}return setTimeout(function(_this){return function(){return file.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(file,message){var node,_i,_len,_ref,_results;if(file.previewElement){file.previewElement.classList.add("dz-error");if(typeof message!=="String"&&message.error){message=message.error}_ref=file.previewElement.querySelectorAll("[data-dz-errormessage]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];_results.push(node.textContent=message)}return _results}},errormultiple:noop,processing:function(file){if(file.previewElement){file.previewElement.classList.add("dz-processing");if(file._removeLink){return file._removeLink.textContent=this.options.dictCancelUpload}}},processingmultiple:noop,uploadprogress:function(file,progress,bytesSent){var node,_i,_len,_ref,_results;if(file.previewElement){_ref=file.previewElement.querySelectorAll("[data-dz-uploadprogress]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];if(node.nodeName==="PROGRESS"){_results.push(node.value=progress)}else{_results.push(node.style.width=""+progress+"%")}}return _results}},totaluploadprogress:noop,sending:noop,sendingmultiple:noop,success:function(file){if(file.previewElement){return file.previewElement.classList.add("dz-success")}},successmultiple:noop,canceled:function(file){return this.emit("error",file,"Upload canceled.")},canceledmultiple:noop,complete:function(file){if(file._removeLink){file._removeLink.textContent=this.options.dictRemoveFile}if(file.previewElement){return file.previewElement.classList.add("dz-complete")}},completemultiple:noop,maxfilesexceeded:noop,maxfilesreached:noop,queuecomplete:noop,addedfiles:noop,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'};extend=function(){var key,object,objects,target,val,_i,_len;target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[];for(_i=0,_len=objects.length;_i<_len;_i++){object=objects[_i];for(key in object){val=object[key];target[key]=val}}return target};function Dropzone(element,options){var elementOptions,fallback,_ref;this.element=element;this.version=Dropzone.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=[];this.listeners=[];this.files=[];if(typeof this.element==="string"){this.element=document.querySelector(this.element)}if(!(this.element&&this.element.nodeType!=null)){throw new Error("Invalid dropzone element.")}if(this.element.dropzone){throw new Error("Dropzone already attached.")}Dropzone.instances.push(this);this.element.dropzone=this;elementOptions=(_ref=Dropzone.optionsForElement(this.element))!=null?_ref:{};this.options=extend({},this.defaultOptions,elementOptions,options!=null?options:{});if(this.options.forceFallback||!Dropzone.isBrowserSupported()){return this.options.fallback.call(this)}if(this.options.url==null){this.options.url=this.element.getAttribute("action")}if(!this.options.url){throw new Error("No URL provided.")}if(this.options.acceptedFiles&&this.options.acceptedMimeTypes){throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.")}if(this.options.acceptedMimeTypes){this.options.acceptedFiles=this.options.acceptedMimeTypes;delete this.options.acceptedMimeTypes}this.options.method=this.options.method.toUpperCase();if((fallback=this.getExistingFallback())&&fallback.parentNode){fallback.parentNode.removeChild(fallback)}if(this.options.previewsContainer!==false){if(this.options.previewsContainer){this.previewsContainer=Dropzone.getElement(this.options.previewsContainer,"previewsContainer")}else{this.previewsContainer=this.element}}if(this.options.clickable){if(this.options.clickable===true){this.clickableElements=[this.element]}else{this.clickableElements=Dropzone.getElements(this.options.clickable,"clickable")}}this.init()}Dropzone.prototype.getAcceptedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.accepted){_results.push(file)}}return _results};Dropzone.prototype.getRejectedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(!file.accepted){_results.push(file)}}return _results};Dropzone.prototype.getFilesWithStatus=function(status){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===status){_results.push(file)}}return _results};Dropzone.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(Dropzone.QUEUED)};Dropzone.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(Dropzone.UPLOADING)};Dropzone.prototype.getAddedFiles=function(){return this.getFilesWithStatus(Dropzone.ADDED)};Dropzone.prototype.getActiveFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===Dropzone.UPLOADING||file.status===Dropzone.QUEUED){_results.push(file)}}return _results};Dropzone.prototype.init=function(){var eventName,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1;if(this.element.tagName==="form"){this.element.setAttribute("enctype","multipart/form-data")}if(this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")){this.element.appendChild(Dropzone.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>"))}if(this.clickableElements.length){setupHiddenFileInput=function(_this){return function(){if(_this.hiddenFileInput){_this.hiddenFileInput.parentNode.removeChild(_this.hiddenFileInput)}_this.hiddenFileInput=document.createElement("input");_this.hiddenFileInput.setAttribute("type","file");if(_this.options.maxFiles==null||_this.options.maxFiles>1){_this.hiddenFileInput.setAttribute("multiple","multiple")}_this.hiddenFileInput.className="dz-hidden-input";if(_this.options.acceptedFiles!=null){_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedFiles)}if(_this.options.capture!=null){_this.hiddenFileInput.setAttribute("capture",_this.options.capture)}_this.hiddenFileInput.style.visibility="hidden";_this.hiddenFileInput.style.position="absolute";_this.hiddenFileInput.style.top="0";_this.hiddenFileInput.style.left="0";_this.hiddenFileInput.style.height="0";_this.hiddenFileInput.style.width="0";document.querySelector(_this.options.hiddenInputContainer).appendChild(_this.hiddenFileInput);return _this.hiddenFileInput.addEventListener("change",function(){var file,files,_i,_len;files=_this.hiddenFileInput.files;if(files.length){for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_this.addFile(file)}}_this.emit("addedfiles",files);return setupHiddenFileInput()})}}(this);setupHiddenFileInput()}this.URL=(_ref=window.URL)!=null?_ref:window.webkitURL;_ref1=this.events;for(_i=0,_len=_ref1.length;_i<_len;_i++){eventName=_ref1[_i];this.on(eventName,this.options[eventName])}this.on("uploadprogress",function(_this){return function(){return _this.updateTotalUploadProgress()}}(this));this.on("removedfile",function(_this){return function(){return _this.updateTotalUploadProgress()}}(this));this.on("canceled",function(_this){return function(file){return _this.emit("complete",file)}}(this));this.on("complete",function(_this){return function(file){if(_this.getAddedFiles().length===0&&_this.getUploadingFiles().length===0&&_this.getQueuedFiles().length===0){return setTimeout(function(){return _this.emit("queuecomplete")},0)}}}(this));noPropagation=function(e){e.stopPropagation();if(e.preventDefault){return e.preventDefault()}else{return e.returnValue=false}};this.listeners=[{element:this.element,events:{dragstart:function(_this){return function(e){return _this.emit("dragstart",e)}}(this),dragenter:function(_this){return function(e){noPropagation(e);return _this.emit("dragenter",e)}}(this),dragover:function(_this){return function(e){var efct;try{efct=e.dataTransfer.effectAllowed}catch(_error){}e.dataTransfer.dropEffect="move"===efct||"linkMove"===efct?"move":"copy";noPropagation(e);return _this.emit("dragover",e)}}(this),dragleave:function(_this){return function(e){return _this.emit("dragleave",e)}}(this),drop:function(_this){return function(e){noPropagation(e);return _this.drop(e)}}(this),dragend:function(_this){return function(e){return _this.emit("dragend",e)}}(this)}}];this.clickableElements.forEach(function(_this){return function(clickableElement){return _this.listeners.push({element:clickableElement,events:{click:function(evt){if(clickableElement!==_this.element||(evt.target===_this.element||Dropzone.elementInside(evt.target,_this.element.querySelector(".dz-message")))){_this.hiddenFileInput.click()}return true}}})}}(this));this.enable();return this.options.init.call(this)};Dropzone.prototype.destroy=function(){var _ref;this.disable();this.removeAllFiles(true);if((_ref=this.hiddenFileInput)!=null?_ref.parentNode:void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null}delete this.element.dropzone;return Dropzone.instances.splice(Dropzone.instances.indexOf(this),1)};Dropzone.prototype.updateTotalUploadProgress=function(){var activeFiles,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;totalBytesSent=0;totalBytes=0;activeFiles=this.getActiveFiles();if(activeFiles.length){_ref=this.getActiveFiles();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];totalBytesSent+=file.upload.bytesSent;totalBytes+=file.upload.total}totalUploadProgress=100*totalBytesSent/totalBytes}else{totalUploadProgress=100}return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent)};Dropzone.prototype._getParamName=function(n){if(typeof this.options.paramName==="function"){return this.options.paramName(n)}else{return""+this.options.paramName+(this.options.uploadMultiple?"["+n+"]":"")}};Dropzone.prototype._renameFilename=function(name){if(typeof this.options.renameFilename!=="function"){return name}return this.options.renameFilename(name)};Dropzone.prototype.getFallbackForm=function(){var existingFallback,fields,fieldsString,form;if(existingFallback=this.getExistingFallback()){return existingFallback}fieldsString='<div class="dz-fallback">';if(this.options.dictFallbackText){fieldsString+="<p>"+this.options.dictFallbackText+"</p>"}fieldsString+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>';fields=Dropzone.createElement(fieldsString);if(this.element.tagName!=="FORM"){form=Dropzone.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>');form.appendChild(fields)}else{this.element.setAttribute("enctype","multipart/form-data");this.element.setAttribute("method",this.options.method)}return form!=null?form:fields};Dropzone.prototype.getExistingFallback=function(){var fallback,getFallback,tagName,_i,_len,_ref;getFallback=function(elements){var el,_i,_len;for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )fallback($| )/.test(el.className)){return el}}};_ref=["div","form"];for(_i=0,_len=_ref.length;_i<_len;_i++){tagName=_ref[_i];if(fallback=getFallback(this.element.getElementsByTagName(tagName))){return fallback}}};Dropzone.prototype.setupEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.addEventListener(event,listener,false))}return _results1}())}return _results};Dropzone.prototype.removeEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.removeEventListener(event,listener,false))}return _results1}())}return _results};Dropzone.prototype.disable=function(){var file,_i,_len,_ref,_results;this.clickableElements.forEach(function(element){return element.classList.remove("dz-clickable")});this.removeEventListeners();_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];_results.push(this.cancelUpload(file))}return _results};Dropzone.prototype.enable=function(){this.clickableElements.forEach(function(element){return element.classList.add("dz-clickable")});return this.setupEventListeners()};Dropzone.prototype.filesize=function(size){var cutoff,i,selectedSize,selectedUnit,unit,units,_i,_len;selectedSize=0;selectedUnit="b";if(size>0){units=["TB","GB","MB","KB","b"];for(i=_i=0,_len=units.length;_i<_len;i=++_i){unit=units[i];cutoff=Math.pow(this.options.filesizeBase,4-i)/10;if(size>=cutoff){selectedSize=size/Math.pow(this.options.filesizeBase,4-i);selectedUnit=unit;break}}selectedSize=Math.round(10*selectedSize)/10}return"<strong>"+selectedSize+"</strong> "+selectedUnit};Dropzone.prototype._updateMaxFilesReachedClass=function(){if(this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles){if(this.getAcceptedFiles().length===this.options.maxFiles){this.emit("maxfilesreached",this.files)}return this.element.classList.add("dz-max-files-reached")}else{return this.element.classList.remove("dz-max-files-reached")}};Dropzone.prototype.drop=function(e){var files,items;if(!e.dataTransfer){return}this.emit("drop",e);files=e.dataTransfer.files;this.emit("addedfiles",files);if(files.length){items=e.dataTransfer.items;if(items&&items.length&&items[0].webkitGetAsEntry!=null){this._addFilesFromItems(items)}else{this.handleFiles(files)}}};Dropzone.prototype.paste=function(e){var items,_ref;if((e!=null?(_ref=e.clipboardData)!=null?_ref.items:void 0:void 0)==null){return}this.emit("paste",e);items=e.clipboardData.items;if(items.length){return this._addFilesFromItems(items)}};Dropzone.prototype.handleFiles=function(files){var file,_i,_len,_results;_results=[];for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_results.push(this.addFile(file))}return _results};Dropzone.prototype._addFilesFromItems=function(items){var entry,item,_i,_len,_results;_results=[];for(_i=0,_len=items.length;_i<_len;_i++){item=items[_i];if(item.webkitGetAsEntry!=null&&(entry=item.webkitGetAsEntry())){if(entry.isFile){_results.push(this.addFile(item.getAsFile()))}else if(entry.isDirectory){_results.push(this._addFilesFromDirectory(entry,entry.name))}else{_results.push(void 0)}}else if(item.getAsFile!=null){if(item.kind==null||item.kind==="file"){_results.push(this.addFile(item.getAsFile()))}else{_results.push(void 0)}}else{_results.push(void 0)}}return _results};Dropzone.prototype._addFilesFromDirectory=function(directory,path){var dirReader,errorHandler,readEntries;dirReader=directory.createReader();errorHandler=function(error){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(error):void 0:void 0};readEntries=function(_this){return function(){return dirReader.readEntries(function(entries){var entry,_i,_len;if(entries.length>0){for(_i=0,_len=entries.length;_i<_len;_i++){entry=entries[_i];if(entry.isFile){entry.file(function(file){if(_this.options.ignoreHiddenFiles&&file.name.substring(0,1)==="."){return}file.fullPath=""+path+"/"+file.name;return _this.addFile(file)})}else if(entry.isDirectory){_this._addFilesFromDirectory(entry,""+path+"/"+entry.name)}}readEntries()}return null},errorHandler)}}(this);return readEntries()};Dropzone.prototype.accept=function(file,done){if(file.size>this.options.maxFilesize*1024*1024){return done(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(file.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize))}else if(!Dropzone.isValidFile(file,this.options.acceptedFiles)){return done(this.options.dictInvalidFileType)}else if(this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles){done(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles));return this.emit("maxfilesexceeded",file)}else{return this.options.accept.call(this,file,done)}};Dropzone.prototype.addFile=function(file){file.upload={progress:0,total:file.size,bytesSent:0};this.files.push(file);file.status=Dropzone.ADDED;this.emit("addedfile",file);this._enqueueThumbnail(file);return this.accept(file,function(_this){return function(error){if(error){file.accepted=false;_this._errorProcessing([file],error)}else{file.accepted=true;if(_this.options.autoQueue){_this.enqueueFile(file)}}return _this._updateMaxFilesReachedClass()}}(this))};Dropzone.prototype.enqueueFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];this.enqueueFile(file)}return null};Dropzone.prototype.enqueueFile=function(file){if(file.status===Dropzone.ADDED&&file.accepted===true){file.status=Dropzone.QUEUED;if(this.options.autoProcessQueue){return setTimeout(function(_this){return function(){return _this.processQueue()}}(this),0)}}else{throw new Error("This file can't be queued because it has already been processed or was rejected.")}};Dropzone.prototype._thumbnailQueue=[];Dropzone.prototype._processingThumbnail=false;Dropzone.prototype._enqueueThumbnail=function(file){if(this.options.createImageThumbnails&&file.type.match(/image.*/)&&file.size<=this.options.maxThumbnailFilesize*1024*1024){this._thumbnailQueue.push(file);return setTimeout(function(_this){return function(){return _this._processThumbnailQueue()}}(this),0)}};Dropzone.prototype._processThumbnailQueue=function(){if(this._processingThumbnail||this._thumbnailQueue.length===0){return}this._processingThumbnail=true;return this.createThumbnail(this._thumbnailQueue.shift(),function(_this){return function(){_this._processingThumbnail=false;return _this._processThumbnailQueue()}}(this))};Dropzone.prototype.removeFile=function(file){if(file.status===Dropzone.UPLOADING){this.cancelUpload(file)}this.files=without(this.files,file);this.emit("removedfile",file);if(this.files.length===0){return this.emit("reset")}};Dropzone.prototype.removeAllFiles=function(cancelIfNecessary){var file,_i,_len,_ref;if(cancelIfNecessary==null){cancelIfNecessary=false}_ref=this.files.slice();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status!==Dropzone.UPLOADING||cancelIfNecessary){this.removeFile(file)}}return null};Dropzone.prototype.createThumbnail=function(file,callback){var fileReader;fileReader=new FileReader;fileReader.onload=function(_this){return function(){if(file.type==="image/svg+xml"){_this.emit("thumbnail",file,fileReader.result);if(callback!=null){callback()}return}return _this.createThumbnailFromUrl(file,fileReader.result,callback)}}(this);return fileReader.readAsDataURL(file)};Dropzone.prototype.createThumbnailFromUrl=function(file,imageUrl,callback,crossOrigin){var img;img=document.createElement("img");if(crossOrigin){img.crossOrigin=crossOrigin}img.onload=function(_this){return function(){var canvas,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;file.width=img.width;file.height=img.height;resizeInfo=_this.options.resize.call(_this,file);if(resizeInfo.trgWidth==null){resizeInfo.trgWidth=resizeInfo.optWidth}if(resizeInfo.trgHeight==null){resizeInfo.trgHeight=resizeInfo.optHeight}canvas=document.createElement("canvas");ctx=canvas.getContext("2d");canvas.width=resizeInfo.trgWidth;canvas.height=resizeInfo.trgHeight;drawImageIOSFix(ctx,img,(_ref=resizeInfo.srcX)!=null?_ref:0,(_ref1=resizeInfo.srcY)!=null?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,(_ref2=resizeInfo.trgX)!=null?_ref2:0,(_ref3=resizeInfo.trgY)!=null?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight);thumbnail=canvas.toDataURL("image/png");_this.emit("thumbnail",file,thumbnail);if(callback!=null){return callback()}}}(this);if(callback!=null){img.onerror=callback}return img.src=imageUrl};Dropzone.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;parallelUploads=this.options.parallelUploads;processingLength=this.getUploadingFiles().length;i=processingLength;if(processingLength>=parallelUploads){return}queuedFiles=this.getQueuedFiles();if(!(queuedFiles.length>0)){return}if(this.options.uploadMultiple){return this.processFiles(queuedFiles.slice(0,parallelUploads-processingLength))}else{while(i<parallelUploads){if(!queuedFiles.length){return}this.processFile(queuedFiles.shift());i++}}};Dropzone.prototype.processFile=function(file){return this.processFiles([file])};Dropzone.prototype.processFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.processing=true;file.status=Dropzone.UPLOADING;this.emit("processing",file)}if(this.options.uploadMultiple){this.emit("processingmultiple",files)}return this.uploadFiles(files)};Dropzone.prototype._getFilesWithXhr=function(xhr){var file,files;return files=function(){var _i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.xhr===xhr){_results.push(file)}}return _results}.call(this)};Dropzone.prototype.cancelUpload=function(file){var groupedFile,groupedFiles,_i,_j,_len,_len1,_ref;if(file.status===Dropzone.UPLOADING){groupedFiles=this._getFilesWithXhr(file.xhr);for(_i=0,_len=groupedFiles.length;_i<_len;_i++){groupedFile=groupedFiles[_i];groupedFile.status=Dropzone.CANCELED}file.xhr.abort();for(_j=0,_len1=groupedFiles.length;_j<_len1;_j++){groupedFile=groupedFiles[_j];this.emit("canceled",groupedFile)}if(this.options.uploadMultiple){this.emit("canceledmultiple",groupedFiles)}}else if((_ref=file.status)===Dropzone.ADDED||_ref===Dropzone.QUEUED){file.status=Dropzone.CANCELED;this.emit("canceled",file);if(this.options.uploadMultiple){this.emit("canceledmultiple",[file])}}if(this.options.autoProcessQueue){return this.processQueue()}};resolveOption=function(){var args,option;option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];if(typeof option==="function"){return option.apply(this,args)}return option};Dropzone.prototype.uploadFile=function(file){return this.uploadFiles([file])};Dropzone.prototype.uploadFiles=function(files){var file,formData,handleError,headerName,headerValue,headers,i,input,inputName,inputType,key,method,option,progressObj,response,updateProgress,url,value,xhr,_i,_j,_k,_l,_len,_len1,_len2,_len3,_m,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;xhr=new XMLHttpRequest;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.xhr=xhr}method=resolveOption(this.options.method,files);url=resolveOption(this.options.url,files);xhr.open(method,url,true);xhr.withCredentials=!!this.options.withCredentials;response=null;handleError=function(_this){return function(){var _j,_len1,_results;_results=[];for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];_results.push(_this._errorProcessing(files,response||_this.options.dictResponseError.replace("{{statusCode}}",xhr.status),xhr))}return _results}}(this);updateProgress=function(_this){return function(e){var allFilesFinished,progress,_j,_k,_l,_len1,_len2,_len3,_results;if(e!=null){progress=100*e.loaded/e.total;for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];file.upload={progress:progress,total:e.total,bytesSent:e.loaded}}}else{allFilesFinished=true;progress=100;for(_k=0,_len2=files.length;_k<_len2;_k++){file=files[_k];if(!(file.upload.progress===100&&file.upload.bytesSent===file.upload.total)){allFilesFinished=false}file.upload.progress=progress;file.upload.bytesSent=file.upload.total}if(allFilesFinished){return}}_results=[];for(_l=0,_len3=files.length;_l<_len3;_l++){file=files[_l];_results.push(_this.emit("uploadprogress",file,progress,file.upload.bytesSent))}return _results}}(this);xhr.onload=function(_this){return function(e){var _ref;if(files[0].status===Dropzone.CANCELED){return}if(xhr.readyState!==4){return}response=xhr.responseText;if(xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json")){try{response=JSON.parse(response)}catch(_error){e=_error;response="Invalid JSON response from server."}}updateProgress();if(!(200<=(_ref=xhr.status)&&_ref<300)){return handleError()}else{return _this._finished(files,response,e)}}}(this);xhr.onerror=function(_this){return function(){if(files[0].status===Dropzone.CANCELED){return}return handleError()}}(this);progressObj=(_ref=xhr.upload)!=null?_ref:xhr;progressObj.onprogress=updateProgress;headers={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};if(this.options.headers){extend(headers,this.options.headers)}for(headerName in headers){headerValue=headers[headerName];if(headerValue){xhr.setRequestHeader(headerName,headerValue)}}formData=new FormData;if(this.options.params){_ref1=this.options.params;for(key in _ref1){value=_ref1[key];formData.append(key,value)}}for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];this.emit("sending",file,xhr,formData)}if(this.options.uploadMultiple){this.emit("sendingmultiple",files,xhr,formData)}if(this.element.tagName==="FORM"){_ref2=this.element.querySelectorAll("input, textarea, select, button");for(_k=0,_len2=_ref2.length;_k<_len2;_k++){input=_ref2[_k];inputName=input.getAttribute("name");inputType=input.getAttribute("type");if(input.tagName==="SELECT"&&input.hasAttribute("multiple")){_ref3=input.options;for(_l=0,_len3=_ref3.length;_l<_len3;_l++){option=_ref3[_l];if(option.selected){formData.append(inputName,option.value)}}}else if(!inputType||(_ref4=inputType.toLowerCase())!=="checkbox"&&_ref4!=="radio"||input.checked){formData.append(inputName,input.value)}}}for(i=_m=0,_ref5=files.length-1;0<=_ref5?_m<=_ref5:_m>=_ref5;i=0<=_ref5?++_m:--_m){formData.append(this._getParamName(i),files[i],this._renameFilename(files[i].name))}return this.submitRequest(xhr,formData,files)};Dropzone.prototype.submitRequest=function(xhr,formData,files){return xhr.send(formData)};Dropzone.prototype._finished=function(files,responseText,e){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Dropzone.SUCCESS;this.emit("success",file,responseText,e);this.emit("complete",file)}if(this.options.uploadMultiple){this.emit("successmultiple",files,responseText,e);this.emit("completemultiple",files)}if(this.options.autoProcessQueue){return this.processQueue()}};Dropzone.prototype._errorProcessing=function(files,message,xhr){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Dropzone.ERROR;this.emit("error",file,message,xhr);this.emit("complete",file)}if(this.options.uploadMultiple){this.emit("errormultiple",files,message,xhr);this.emit("completemultiple",files)}if(this.options.autoProcessQueue){return this.processQueue()}};return Dropzone}(Emitter);Dropzone.version="4.3.0";Dropzone.options={};Dropzone.optionsForElement=function(element){if(element.getAttribute("id")){return Dropzone.options[camelize(element.getAttribute("id"))]}else{return void 0}};Dropzone.instances=[];Dropzone.forElement=function(element){if(typeof element==="string"){element=document.querySelector(element)}if((element!=null?element.dropzone:void 0)==null){throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.")}return element.dropzone};Dropzone.autoDiscover=true;Dropzone.discover=function(){var checkElements,dropzone,dropzones,_i,_len,_results;if(document.querySelectorAll){dropzones=document.querySelectorAll(".dropzone")}else{dropzones=[];checkElements=function(elements){var el,_i,_len,_results;_results=[];for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )dropzone($| )/.test(el.className)){_results.push(dropzones.push(el))}else{_results.push(void 0)}}return _results};checkElements(document.getElementsByTagName("div"));checkElements(document.getElementsByTagName("form"))}_results=[];for(_i=0,_len=dropzones.length;_i<_len;_i++){dropzone=dropzones[_i];if(Dropzone.optionsForElement(dropzone)!==false){_results.push(new Dropzone(dropzone))}else{_results.push(void 0)}}return _results};Dropzone.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];Dropzone.isBrowserSupported=function(){var capableBrowser,regex,_i,_len,_ref;capableBrowser=true;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector){if(!("classList"in document.createElement("a"))){capableBrowser=false}else{_ref=Dropzone.blacklistedBrowsers;for(_i=0,_len=_ref.length;_i<_len;_i++){regex=_ref[_i];if(regex.test(navigator.userAgent)){capableBrowser=false;continue}}}}else{capableBrowser=false}return capableBrowser};without=function(list,rejectedItem){var item,_i,_len,_results;_results=[];for(_i=0,_len=list.length;_i<_len;_i++){item=list[_i];if(item!==rejectedItem){_results.push(item)}}return _results};camelize=function(str){return str.replace(/[\-_](\w)/g,function(match){return match.charAt(1).toUpperCase()})};Dropzone.createElement=function(string){var div;div=document.createElement("div");div.innerHTML=string;return div.childNodes[0]};Dropzone.elementInside=function(element,container){if(element===container){return true}while(element=element.parentNode){if(element===container){return true}}return false};Dropzone.getElement=function(el,name){var element;if(typeof el==="string"){element=document.querySelector(el)}else if(el.nodeType!=null){element=el}if(element==null){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector or a plain HTML element.")}return element};Dropzone.getElements=function(els,name){var e,el,elements,_i,_j,_len,_len1,_ref;if(els instanceof Array){elements=[];try{for(_i=0,_len=els.length;_i<_len;_i++){el=els[_i];elements.push(this.getElement(el,name))}}catch(_error){e=_error;elements=null}}else if(typeof els==="string"){elements=[];_ref=document.querySelectorAll(els);for(_j=0,_len1=_ref.length;_j<_len1;_j++){el=_ref[_j];elements.push(el)}}else if(els.nodeType!=null){elements=[els]}if(!(elements!=null&&elements.length)){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.")}return elements};Dropzone.confirm=function(question,accepted,rejected){if(window.confirm(question)){return accepted()}else if(rejected!=null){return rejected()}};Dropzone.isValidFile=function(file,acceptedFiles){var baseMimeType,mimeType,validType,_i,_len;if(!acceptedFiles){return true}acceptedFiles=acceptedFiles.split(",");mimeType=file.type;baseMimeType=mimeType.replace(/\/.*$/,"");for(_i=0,_len=acceptedFiles.length;_i<_len;_i++){validType=acceptedFiles[_i];validType=validType.trim();if(validType.charAt(0)==="."){if(file.name.toLowerCase().indexOf(validType.toLowerCase(),file.name.length-validType.length)!==-1){return true}}else if(/\/\*$/.test(validType)){if(baseMimeType===validType.replace(/\/.*$/,"")){return true}}else{if(mimeType===validType){return true}}}return false};if(typeof jQuery!=="undefined"&&jQuery!==null){jQuery.fn.dropzone=function(options){return this.each(function(){return new Dropzone(this,options)})}}if(typeof module!=="undefined"&&module!==null){module.exports=Dropzone}else{window.Dropzone=Dropzone}Dropzone.ADDED="added";Dropzone.QUEUED="queued";Dropzone.ACCEPTED=Dropzone.QUEUED;Dropzone.UPLOADING="uploading";Dropzone.PROCESSING=Dropzone.UPLOADING;Dropzone.CANCELED="canceled";Dropzone.ERROR="error";Dropzone.SUCCESS="success";detectVerticalSquash=function(img){var alpha,canvas,ctx,data,ey,ih,iw,py,ratio,sy;iw=img.naturalWidth;ih=img.naturalHeight;canvas=document.createElement("canvas");canvas.width=1;canvas.height=ih;ctx=canvas.getContext("2d");ctx.drawImage(img,0,0);data=ctx.getImageData(0,0,1,ih).data;sy=0;ey=ih;py=ih;while(py>sy){alpha=data[(py-1)*4+3];if(alpha===0){ey=py}else{sy=py}py=ey+sy>>1}ratio=py/ih;if(ratio===0){return 1}else{return ratio}};drawImageIOSFix=function(ctx,img,sx,sy,sw,sh,dx,dy,dw,dh){var vertSquashRatio;vertSquashRatio=detectVerticalSquash(img);return ctx.drawImage(img,sx,sy,sw,sh,dx,dy,dw,dh/vertSquashRatio)};contentLoaded=function(win,fn){var add,doc,done,init,poll,pre,rem,root,top;done=false;top=true;doc=win.document;root=doc.documentElement;add=doc.addEventListener?"addEventListener":"attachEvent";rem=doc.addEventListener?"removeEventListener":"detachEvent";pre=doc.addEventListener?"":"on";init=function(e){if(e.type==="readystatechange"&&doc.readyState!=="complete"){return}(e.type==="load"?win:doc)[rem](pre+e.type,init,false);if(!done&&(done=true)){return fn.call(win,e.type||e)}};poll=function(){var e;try{root.doScroll("left")}catch(_error){e=_error;setTimeout(poll,50);return}return init("poll")};if(doc.readyState!=="complete"){if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement}catch(_error){}if(top){poll()}}doc[add](pre+"DOMContentLoaded",init,false);doc[add](pre+"readystatechange",init,false);return win[add](pre+"load",init,false)}};Dropzone._autoDiscoverFunction=function(){if(Dropzone.autoDiscover){return Dropzone.discover()}};contentLoaded(window,Dropzone._autoDiscoverFunction)}).call(this);